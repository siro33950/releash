(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))h(g);new MutationObserver(g=>{for(const m of g)if(m.type==="childList")for(const w of m.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&h(w)}).observe(document,{childList:!0,subtree:!0});function l(g){const m={};return g.integrity&&(m.integrity=g.integrity),g.referrerPolicy&&(m.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?m.credentials="include":g.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function h(g){if(g.ep)return;g.ep=!0;const m=l(g);fetch(g.href,m)}})();var lh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function b2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Mf={exports:{}},So={};var $g;function Up(){if($g)return So;$g=1;var e=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function l(h,g,m){var w=null;if(m!==void 0&&(w=""+m),g.key!==void 0&&(w=""+g.key),"key"in g){m={};for(var b in g)b!=="key"&&(m[b]=g[b])}else m=g;return g=m.ref,{$$typeof:e,type:h,key:w,ref:g!==void 0?g:null,props:m}}return So.Fragment=s,So.jsx=l,So.jsxs=l,So}var e_;function Vp(){return e_||(e_=1,Mf.exports=Up()),Mf.exports}var ee=Vp(),Bf={exports:{}},Je={};var t_;function Wp(){if(t_)return Je;t_=1;var e=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),w=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),S=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),k=Symbol.iterator;function P(H){return H===null||typeof H!="object"?null:(H=k&&H[k]||H["@@iterator"],typeof H=="function"?H:null)}var L={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,pe={};function me(H,re,ye){this.props=H,this.context=re,this.refs=pe,this.updater=ye||L}me.prototype.isReactComponent={},me.prototype.setState=function(H,re){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,re,"setState")},me.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function he(){}he.prototype=me.prototype;function te(H,re,ye){this.props=H,this.context=re,this.refs=pe,this.updater=ye||L}var le=te.prototype=new he;le.constructor=te,X(le,me.prototype),le.isPureReactComponent=!0;var Oe=Array.isArray;function Re(){}var Y={H:null,A:null,T:null,S:null},Ne=Object.prototype.hasOwnProperty;function de(H,re,ye){var be=ye.ref;return{$$typeof:e,type:H,key:re,ref:be!==void 0?be:null,props:ye}}function Gt(H,re){return de(H.type,re,H.props)}function je(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function oe(H){var re={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ye){return re[ye]})}var ae=/\/+/g;function Ee(H,re){return typeof H=="object"&&H!==null&&H.key!=null?oe(""+H.key):re.toString(36)}function U(H){switch(H.status){case"fulfilled":return H.value;case"rejected":throw H.reason;default:switch(typeof H.status=="string"?H.then(Re,Re):(H.status="pending",H.then(function(re){H.status==="pending"&&(H.status="fulfilled",H.value=re)},function(re){H.status==="pending"&&(H.status="rejected",H.reason=re)})),H.status){case"fulfilled":return H.value;case"rejected":throw H.reason}}throw H}function W(H,re,ye,be,Ve){var Se=typeof H;(Se==="undefined"||Se==="boolean")&&(H=null);var $e=!1;if(H===null)$e=!0;else switch(Se){case"bigint":case"string":case"number":$e=!0;break;case"object":switch(H.$$typeof){case e:case s:$e=!0;break;case M:return $e=H._init,W($e(H._payload),re,ye,be,Ve)}}if($e)return Ve=Ve(H),$e=be===""?"."+Ee(H,0):be,Oe(Ve)?(ye="",$e!=null&&(ye=$e.replace(ae,"$&/")+"/"),W(Ve,re,ye,"",function($i){return $i})):Ve!=null&&(je(Ve)&&(Ve=Gt(Ve,ye+(Ve.key==null||H&&H.key===Ve.key?"":(""+Ve.key).replace(ae,"$&/")+"/")+$e)),re.push(Ve)),1;$e=0;var ot=be===""?".":be+":";if(Oe(H))for(var dt=0;dt<H.length;dt++)be=H[dt],Se=ot+Ee(be,dt),$e+=W(be,re,ye,Se,Ve);else if(dt=P(H),typeof dt=="function")for(H=dt.call(H),dt=0;!(be=H.next()).done;)be=be.value,Se=ot+Ee(be,dt++),$e+=W(be,re,ye,Se,Ve);else if(Se==="object"){if(typeof H.then=="function")return W(U(H),re,ye,be,Ve);throw re=String(H),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return $e}function Z(H,re,ye){if(H==null)return H;var be=[],Ve=0;return W(H,be,"","",function(Se){return re.call(ye,Se,Ve++)}),be}function ue(H){if(H._status===-1){var re=H._result;re=re(),re.then(function(ye){(H._status===0||H._status===-1)&&(H._status=1,H._result=ye)},function(ye){(H._status===0||H._status===-1)&&(H._status=2,H._result=ye)}),H._status===-1&&(H._status=0,H._result=re)}if(H._status===1)return H._result.default;throw H._result}var Le=typeof reportError=="function"?reportError:function(H){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof H=="object"&&H!==null&&typeof H.message=="string"?String(H.message):String(H),error:H});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",H);return}console.error(H)},Me={map:Z,forEach:function(H,re,ye){Z(H,function(){re.apply(this,arguments)},ye)},count:function(H){var re=0;return Z(H,function(){re++}),re},toArray:function(H){return Z(H,function(re){return re})||[]},only:function(H){if(!je(H))throw Error("React.Children.only expected to receive a single React element child.");return H}};return Je.Activity=N,Je.Children=Me,Je.Component=me,Je.Fragment=l,Je.Profiler=g,Je.PureComponent=te,Je.StrictMode=h,Je.Suspense=C,Je.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Y,Je.__COMPILER_RUNTIME={__proto__:null,c:function(H){return Y.H.useMemoCache(H)}},Je.cache=function(H){return function(){return H.apply(null,arguments)}},Je.cacheSignal=function(){return null},Je.cloneElement=function(H,re,ye){if(H==null)throw Error("The argument must be a React element, but you passed "+H+".");var be=X({},H.props),Ve=H.key;if(re!=null)for(Se in re.key!==void 0&&(Ve=""+re.key),re)!Ne.call(re,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&re.ref===void 0||(be[Se]=re[Se]);var Se=arguments.length-2;if(Se===1)be.children=ye;else if(1<Se){for(var $e=Array(Se),ot=0;ot<Se;ot++)$e[ot]=arguments[ot+2];be.children=$e}return de(H.type,Ve,be)},Je.createContext=function(H){return H={$$typeof:w,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null},H.Provider=H,H.Consumer={$$typeof:m,_context:H},H},Je.createElement=function(H,re,ye){var be,Ve={},Se=null;if(re!=null)for(be in re.key!==void 0&&(Se=""+re.key),re)Ne.call(re,be)&&be!=="key"&&be!=="__self"&&be!=="__source"&&(Ve[be]=re[be]);var $e=arguments.length-2;if($e===1)Ve.children=ye;else if(1<$e){for(var ot=Array($e),dt=0;dt<$e;dt++)ot[dt]=arguments[dt+2];Ve.children=ot}if(H&&H.defaultProps)for(be in $e=H.defaultProps,$e)Ve[be]===void 0&&(Ve[be]=$e[be]);return de(H,Se,Ve)},Je.createRef=function(){return{current:null}},Je.forwardRef=function(H){return{$$typeof:b,render:H}},Je.isValidElement=je,Je.lazy=function(H){return{$$typeof:M,_payload:{_status:-1,_result:H},_init:ue}},Je.memo=function(H,re){return{$$typeof:S,type:H,compare:re===void 0?null:re}},Je.startTransition=function(H){var re=Y.T,ye={};Y.T=ye;try{var be=H(),Ve=Y.S;Ve!==null&&Ve(ye,be),typeof be=="object"&&be!==null&&typeof be.then=="function"&&be.then(Re,Le)}catch(Se){Le(Se)}finally{re!==null&&ye.types!==null&&(re.types=ye.types),Y.T=re}},Je.unstable_useCacheRefresh=function(){return Y.H.useCacheRefresh()},Je.use=function(H){return Y.H.use(H)},Je.useActionState=function(H,re,ye){return Y.H.useActionState(H,re,ye)},Je.useCallback=function(H,re){return Y.H.useCallback(H,re)},Je.useContext=function(H){return Y.H.useContext(H)},Je.useDebugValue=function(){},Je.useDeferredValue=function(H,re){return Y.H.useDeferredValue(H,re)},Je.useEffect=function(H,re){return Y.H.useEffect(H,re)},Je.useEffectEvent=function(H){return Y.H.useEffectEvent(H)},Je.useId=function(){return Y.H.useId()},Je.useImperativeHandle=function(H,re,ye){return Y.H.useImperativeHandle(H,re,ye)},Je.useInsertionEffect=function(H,re){return Y.H.useInsertionEffect(H,re)},Je.useLayoutEffect=function(H,re){return Y.H.useLayoutEffect(H,re)},Je.useMemo=function(H,re){return Y.H.useMemo(H,re)},Je.useOptimistic=function(H,re){return Y.H.useOptimistic(H,re)},Je.useReducer=function(H,re,ye){return Y.H.useReducer(H,re,ye)},Je.useRef=function(H){return Y.H.useRef(H)},Je.useState=function(H){return Y.H.useState(H)},Je.useSyncExternalStore=function(H,re,ye){return Y.H.useSyncExternalStore(H,re,ye)},Je.useTransition=function(){return Y.H.useTransition()},Je.version="19.2.4",Je}var i_;function zd(){return i_||(i_=1,Bf.exports=Wp()),Bf.exports}var Te=zd();const Gp=b2(Te);var If={exports:{}},yo={},kf={exports:{}},Lf={};var s_;function Xp(){return s_||(s_=1,(function(e){function s(W,Z){var ue=W.length;W.push(Z);e:for(;0<ue;){var Le=ue-1>>>1,Me=W[Le];if(0<g(Me,Z))W[Le]=Z,W[ue]=Me,ue=Le;else break e}}function l(W){return W.length===0?null:W[0]}function h(W){if(W.length===0)return null;var Z=W[0],ue=W.pop();if(ue!==Z){W[0]=ue;e:for(var Le=0,Me=W.length,H=Me>>>1;Le<H;){var re=2*(Le+1)-1,ye=W[re],be=re+1,Ve=W[be];if(0>g(ye,ue))be<Me&&0>g(Ve,ye)?(W[Le]=Ve,W[be]=ue,Le=be):(W[Le]=ye,W[re]=ue,Le=re);else if(be<Me&&0>g(Ve,ue))W[Le]=Ve,W[be]=ue,Le=be;else break e}}return Z}function g(W,Z){var ue=W.sortIndex-Z.sortIndex;return ue!==0?ue:W.id-Z.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var m=performance;e.unstable_now=function(){return m.now()}}else{var w=Date,b=w.now();e.unstable_now=function(){return w.now()-b}}var C=[],S=[],M=1,N=null,k=3,P=!1,L=!1,X=!1,pe=!1,me=typeof setTimeout=="function"?setTimeout:null,he=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;function le(W){for(var Z=l(S);Z!==null;){if(Z.callback===null)h(S);else if(Z.startTime<=W)h(S),Z.sortIndex=Z.expirationTime,s(C,Z);else break;Z=l(S)}}function Oe(W){if(X=!1,le(W),!L)if(l(C)!==null)L=!0,Re||(Re=!0,oe());else{var Z=l(S);Z!==null&&U(Oe,Z.startTime-W)}}var Re=!1,Y=-1,Ne=5,de=-1;function Gt(){return pe?!0:!(e.unstable_now()-de<Ne)}function je(){if(pe=!1,Re){var W=e.unstable_now();de=W;var Z=!0;try{e:{L=!1,X&&(X=!1,he(Y),Y=-1),P=!0;var ue=k;try{t:{for(le(W),N=l(C);N!==null&&!(N.expirationTime>W&&Gt());){var Le=N.callback;if(typeof Le=="function"){N.callback=null,k=N.priorityLevel;var Me=Le(N.expirationTime<=W);if(W=e.unstable_now(),typeof Me=="function"){N.callback=Me,le(W),Z=!0;break t}N===l(C)&&h(C),le(W)}else h(C);N=l(C)}if(N!==null)Z=!0;else{var H=l(S);H!==null&&U(Oe,H.startTime-W),Z=!1}}break e}finally{N=null,k=ue,P=!1}Z=void 0}}finally{Z?oe():Re=!1}}}var oe;if(typeof te=="function")oe=function(){te(je)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,Ee=ae.port2;ae.port1.onmessage=je,oe=function(){Ee.postMessage(null)}}else oe=function(){me(je,0)};function U(W,Z){Y=me(function(){W(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ne=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return k},e.unstable_next=function(W){switch(k){case 1:case 2:case 3:var Z=3;break;default:Z=k}var ue=k;k=Z;try{return W()}finally{k=ue}},e.unstable_requestPaint=function(){pe=!0},e.unstable_runWithPriority=function(W,Z){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ue=k;k=W;try{return Z()}finally{k=ue}},e.unstable_scheduleCallback=function(W,Z,ue){var Le=e.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?Le+ue:Le):ue=Le,W){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=ue+Me,W={id:M++,callback:Z,priorityLevel:W,startTime:ue,expirationTime:Me,sortIndex:-1},ue>Le?(W.sortIndex=ue,s(S,W),l(C)===null&&W===l(S)&&(X?(he(Y),Y=-1):X=!0,U(Oe,ue-Le))):(W.sortIndex=Me,s(C,W),L||P||(L=!0,Re||(Re=!0,oe()))),W},e.unstable_shouldYield=Gt,e.unstable_wrapCallback=function(W){var Z=k;return function(){var ue=k;k=Z;try{return W.apply(this,arguments)}finally{k=ue}}}})(Lf)),Lf}var r_;function Yp(){return r_||(r_=1,kf.exports=Xp()),kf.exports}var Pf={exports:{}},es={};var n_;function jp(){if(n_)return es;n_=1;var e=zd();function s(C){var S="https://react.dev/errors/"+C;if(1<arguments.length){S+="?args[]="+encodeURIComponent(arguments[1]);for(var M=2;M<arguments.length;M++)S+="&args[]="+encodeURIComponent(arguments[M])}return"Minified React error #"+C+"; visit "+S+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(){}var h={d:{f:l,r:function(){throw Error(s(522))},D:l,C:l,L:l,m:l,X:l,S:l,M:l},p:0,findDOMNode:null},g=Symbol.for("react.portal");function m(C,S,M){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:g,key:N==null?null:""+N,children:C,containerInfo:S,implementation:M}}var w=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function b(C,S){if(C==="font")return"";if(typeof S=="string")return S==="use-credentials"?S:""}return es.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=h,es.createPortal=function(C,S){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S||S.nodeType!==1&&S.nodeType!==9&&S.nodeType!==11)throw Error(s(299));return m(C,S,null,M)},es.flushSync=function(C){var S=w.T,M=h.p;try{if(w.T=null,h.p=2,C)return C()}finally{w.T=S,h.p=M,h.d.f()}},es.preconnect=function(C,S){typeof C=="string"&&(S?(S=S.crossOrigin,S=typeof S=="string"?S==="use-credentials"?S:"":void 0):S=null,h.d.C(C,S))},es.prefetchDNS=function(C){typeof C=="string"&&h.d.D(C)},es.preinit=function(C,S){if(typeof C=="string"&&S&&typeof S.as=="string"){var M=S.as,N=b(M,S.crossOrigin),k=typeof S.integrity=="string"?S.integrity:void 0,P=typeof S.fetchPriority=="string"?S.fetchPriority:void 0;M==="style"?h.d.S(C,typeof S.precedence=="string"?S.precedence:void 0,{crossOrigin:N,integrity:k,fetchPriority:P}):M==="script"&&h.d.X(C,{crossOrigin:N,integrity:k,fetchPriority:P,nonce:typeof S.nonce=="string"?S.nonce:void 0})}},es.preinitModule=function(C,S){if(typeof C=="string")if(typeof S=="object"&&S!==null){if(S.as==null||S.as==="script"){var M=b(S.as,S.crossOrigin);h.d.M(C,{crossOrigin:M,integrity:typeof S.integrity=="string"?S.integrity:void 0,nonce:typeof S.nonce=="string"?S.nonce:void 0})}}else S==null&&h.d.M(C)},es.preload=function(C,S){if(typeof C=="string"&&typeof S=="object"&&S!==null&&typeof S.as=="string"){var M=S.as,N=b(M,S.crossOrigin);h.d.L(C,M,{crossOrigin:N,integrity:typeof S.integrity=="string"?S.integrity:void 0,nonce:typeof S.nonce=="string"?S.nonce:void 0,type:typeof S.type=="string"?S.type:void 0,fetchPriority:typeof S.fetchPriority=="string"?S.fetchPriority:void 0,referrerPolicy:typeof S.referrerPolicy=="string"?S.referrerPolicy:void 0,imageSrcSet:typeof S.imageSrcSet=="string"?S.imageSrcSet:void 0,imageSizes:typeof S.imageSizes=="string"?S.imageSizes:void 0,media:typeof S.media=="string"?S.media:void 0})}},es.preloadModule=function(C,S){if(typeof C=="string")if(S){var M=b(S.as,S.crossOrigin);h.d.m(C,{as:typeof S.as=="string"&&S.as!=="script"?S.as:void 0,crossOrigin:M,integrity:typeof S.integrity=="string"?S.integrity:void 0})}else h.d.m(C)},es.requestFormReset=function(C){h.d.r(C)},es.unstable_batchedUpdates=function(C,S){return C(S)},es.useFormState=function(C,S,M){return w.H.useFormState(C,S,M)},es.useFormStatus=function(){return w.H.useHostTransitionStatus()},es.version="19.2.4",es}var a_;function qp(){if(a_)return Pf.exports;a_=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(s){console.error(s)}}return e(),Pf.exports=jp(),Pf.exports}var l_;function Kp(){if(l_)return yo;l_=1;var e=Yp(),s=zd(),l=qp();function h(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)r+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function g(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function m(t){var r=t,o=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(o=r.return),t=r.return;while(t)}return r.tag===3?o:null}function w(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function b(t){if(t.tag===31){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function C(t){if(m(t)!==t)throw Error(h(188))}function S(t){var r=t.alternate;if(!r){if(r=m(t),r===null)throw Error(h(188));return r!==t?null:t}for(var o=t,f=r;;){var p=o.return;if(p===null)break;var v=p.alternate;if(v===null){if(f=p.return,f!==null){o=f;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===o)return C(p),t;if(v===f)return C(p),r;v=v.sibling}throw Error(h(188))}if(o.return!==f.return)o=p,f=v;else{for(var A=!1,O=p.child;O;){if(O===o){A=!0,o=p,f=v;break}if(O===f){A=!0,f=p,o=v;break}O=O.sibling}if(!A){for(O=v.child;O;){if(O===o){A=!0,o=v,f=p;break}if(O===f){A=!0,f=v,o=p;break}O=O.sibling}if(!A)throw Error(h(189))}}if(o.alternate!==f)throw Error(h(190))}if(o.tag!==3)throw Error(h(188));return o.stateNode.current===o?t:r}function M(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=M(t),r!==null)return r;t=t.sibling}return null}var N=Object.assign,k=Symbol.for("react.element"),P=Symbol.for("react.transitional.element"),L=Symbol.for("react.portal"),X=Symbol.for("react.fragment"),pe=Symbol.for("react.strict_mode"),me=Symbol.for("react.profiler"),he=Symbol.for("react.consumer"),te=Symbol.for("react.context"),le=Symbol.for("react.forward_ref"),Oe=Symbol.for("react.suspense"),Re=Symbol.for("react.suspense_list"),Y=Symbol.for("react.memo"),Ne=Symbol.for("react.lazy"),de=Symbol.for("react.activity"),Gt=Symbol.for("react.memo_cache_sentinel"),je=Symbol.iterator;function oe(t){return t===null||typeof t!="object"?null:(t=je&&t[je]||t["@@iterator"],typeof t=="function"?t:null)}var ae=Symbol.for("react.client.reference");function Ee(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===ae?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case X:return"Fragment";case me:return"Profiler";case pe:return"StrictMode";case Oe:return"Suspense";case Re:return"SuspenseList";case de:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case L:return"Portal";case te:return t.displayName||"Context";case he:return(t._context.displayName||"Context")+".Consumer";case le:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Y:return r=t.displayName||null,r!==null?r:Ee(t.type)||"Memo";case Ne:r=t._payload,t=t._init;try{return Ee(t(r))}catch{}}return null}var U=Array.isArray,W=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue={pending:!1,data:null,method:null,action:null},Le=[],Me=-1;function H(t){return{current:t}}function re(t){0>Me||(t.current=Le[Me],Le[Me]=null,Me--)}function ye(t,r){Me++,Le[Me]=t.current,t.current=r}var be=H(null),Ve=H(null),Se=H(null),$e=H(null);function ot(t,r){switch(ye(Se,r),ye(Ve,t),ye(be,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?wg(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=wg(r),t=bg(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}re(be),ye(be,t)}function dt(){re(be),re(Ve),re(Se)}function $i(t){t.memoizedState!==null&&ye($e,t);var r=be.current,o=bg(r,t.type);r!==o&&(ye(Ve,t),ye(be,o))}function Xt(t){Ve.current===t&&(re(be),re(Ve)),$e.current===t&&(re($e),mo._currentValue=ue)}var Gi,ze;function Li(t){if(Gi===void 0)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);Gi=r&&r[1]||"",ze=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Gi+t+ze}var fs=!1;function Br(t,r){if(!t||fs)return"";fs=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(r){var ge=function(){throw Error()};if(Object.defineProperty(ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ge,[])}catch(ne){var $=ne}Reflect.construct(t,[],ge)}else{try{ge.call()}catch(ne){$=ne}t.call(ge.prototype)}}else{try{throw Error()}catch(ne){$=ne}(ge=t())&&typeof ge.catch=="function"&&ge.catch(function(){})}}catch(ne){if(ne&&$&&typeof ne.stack=="string")return[ne.stack,$.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),A=v[0],O=v[1];if(A&&O){var z=A.split(`
`),J=O.split(`
`);for(p=f=0;f<z.length&&!z[f].includes("DetermineComponentFrameRoot");)f++;for(;p<J.length&&!J[p].includes("DetermineComponentFrameRoot");)p++;if(f===z.length||p===J.length)for(f=z.length-1,p=J.length-1;1<=f&&0<=p&&z[f]!==J[p];)p--;for(;1<=f&&0<=p;f--,p--)if(z[f]!==J[p]){if(f!==1||p!==1)do if(f--,p--,0>p||z[f]!==J[p]){var ce=`
`+z[f].replace(" at new "," at ");return t.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",t.displayName)),ce}while(1<=f&&0<=p);break}}}finally{fs=!1,Error.prepareStackTrace=o}return(o=t?t.displayName||t.name:"")?Li(o):""}function Ti(t,r){switch(t.tag){case 26:case 27:case 5:return Li(t.type);case 16:return Li("Lazy");case 13:return t.child!==r&&r!==null?Li("Suspense Fallback"):Li("Suspense");case 19:return Li("SuspenseList");case 0:case 15:return Br(t.type,!1);case 11:return Br(t.type.render,!1);case 1:return Br(t.type,!0);case 31:return Li("Activity");default:return""}}function Dt(t){try{var r="",o=null;do r+=Ti(t,o),o=t,t=t.return;while(t);return r}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var ct=Object.prototype.hasOwnProperty,cn=e.unstable_scheduleCallback,Pe=e.unstable_cancelCallback,Ia=e.unstable_shouldYield,Wo=e.unstable_requestPaint,ti=e.unstable_now,Al=e.unstable_getCurrentPriorityLevel,ds=e.unstable_ImmediatePriority,Tl=e.unstable_UserBlockingPriority,Cs=e.unstable_NormalPriority,Xi=e.unstable_LowPriority,Rl=e.unstable_IdlePriority,ka=e.log,Lh=e.unstable_setDisableYieldValue,Wt=null,Ae=null;function It(t){if(typeof ka=="function"&&Lh(t),Ae&&typeof Ae.setStrictMode=="function")try{Ae.setStrictMode(Wt,t)}catch{}}var tt=Math.clz32?Math.clz32:Nl,Qt=Math.log,ea=Math.LN2;function Nl(t){return t>>>=0,t===0?32:31-(Qt(t)/ea|0)|0}var ta=256,gt=262144,Us=4194304;function gr(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function ia(t,r,o){var f=t.pendingLanes;if(f===0)return 0;var p=0,v=t.suspendedLanes,A=t.pingedLanes;t=t.warmLanes;var O=f&134217727;return O!==0?(f=O&~v,f!==0?p=gr(f):(A&=O,A!==0?p=gr(A):o||(o=O&~t,o!==0&&(p=gr(o))))):(O=f&~v,O!==0?p=gr(O):A!==0?p=gr(A):o||(o=f&~t,o!==0&&(p=gr(o)))),p===0?0:r!==0&&r!==p&&(r&v)===0&&(v=p&-p,o=r&-r,v>=o||v===32&&(o&4194048)!==0)?r:p}function Yi(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function Dl(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ri(){var t=Us;return Us<<=1,(Us&62914560)===0&&(Us=4194304),t}function _r(t){for(var r=[],o=0;31>o;o++)r.push(t);return r}function mr(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Vs(t,r,o,f,p,v){var A=t.pendingLanes;t.pendingLanes=o,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=o,t.entangledLanes&=o,t.errorRecoveryDisabledLanes&=o,t.shellSuspendCounter=0;var O=t.entanglements,z=t.expirationTimes,J=t.hiddenUpdates;for(o=A&~o;0<o;){var ce=31-tt(o),ge=1<<ce;O[ce]=0,z[ce]=-1;var $=J[ce];if($!==null)for(J[ce]=null,ce=0;ce<$.length;ce++){var ne=$[ce];ne!==null&&(ne.lane&=-536870913)}o&=~ge}f!==0&&Go(t,f,0),v!==0&&p===0&&t.tag!==0&&(t.suspendedLanes|=v&~(A&~r))}function Go(t,r,o){t.pendingLanes|=r,t.suspendedLanes&=~r;var f=31-tt(r);t.entangledLanes|=r,t.entanglements[f]=t.entanglements[f]|1073741824|o&261930}function pr(t,r){var o=t.entangledLanes|=r;for(t=t.entanglements;o;){var f=31-tt(o),p=1<<f;p&r|t[f]&r&&(t[f]|=r),o&=~p}}function La(t,r){var o=r&-r;return o=(o&42)!==0?1:Pi(o),(o&(t.suspendedLanes|r))!==0?0:o}function Pi(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function nr(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function is(){var t=Z.p;return t!==0?t:(t=window.event,t===void 0?32:Yg(t.type))}function Ie(t,r){var o=Z.p;try{return Z.p=t,r()}finally{Z.p=o}}var ss=Math.random().toString(36).slice(2),di="__reactFiber$"+ss,Ot="__reactProps$"+ss,Es="__reactContainer$"+ss,hn="__reactEvents$"+ss,Pa="__reactListeners$"+ss,Ws="__reactHandles$"+ss,Xo="__reactResources$"+ss,sa="__reactMarker$"+ss;function gs(t){delete t[di],delete t[Ot],delete t[hn],delete t[Pa],delete t[Ws]}function ni(t){var r=t[di];if(r)return r;for(var o=t.parentNode;o;){if(r=o[Es]||o[di]){if(o=r.alternate,r.child!==null||o!==null&&o.child!==null)for(t=Dg(t);t!==null;){if(o=t[di])return o;t=Dg(t)}return r}t=o,o=t.parentNode}return null}function Ct(t){if(t=t[di]||t[Es]){var r=t.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return t}return null}function un(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(h(33))}function rs(t){var r=t[Xo];return r||(r=t[Xo]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function ai(t){t[sa]=!0}var xe=new Set,Yo={};function Tt(t,r){As(t,r),As(t+"Capture",r)}function As(t,r){for(Yo[t]=r,t=0;t<r.length;t++)xe.add(r[t])}var Ph=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),St={},vt={};function ht(t){return ct.call(vt,t)?!0:ct.call(St,t)?!1:Ph.test(t)?vt[t]=!0:(St[t]=!0,!1)}function fn(t,r,o){if(ht(r))if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var f=r.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+o)}}function dn(t,r,o){if(o===null)t.removeAttribute(r);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+o)}}function Ts(t,r,o,f){if(f===null)t.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(o);return}t.setAttributeNS(r,o,""+f)}}function yt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ar(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Hh(t,r,o){var f=Object.getOwnPropertyDescriptor(t.constructor.prototype,r);if(!t.hasOwnProperty(r)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var p=f.get,v=f.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return p.call(this)},set:function(A){o=""+A,v.call(this,A)}}),Object.defineProperty(t,r,{enumerable:f.enumerable}),{getValue:function(){return o},setValue:function(A){o=""+A},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function Yt(t){if(!t._valueTracker){var r=ar(t)?"checked":"value";t._valueTracker=Hh(t,r,""+t[r])}}function lr(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var o=r.getValue(),f="";return t&&(f=ar(t)?t.checked?"true":"false":t.value),t=f,t!==o?(r.setValue(t),!0):!1}function Ha(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var gn=/[\n"\\]/g;function nt(t){return t.replace(gn,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function vi(t,r,o,f,p,v,A,O){t.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?t.type=A:t.removeAttribute("type"),r!=null?A==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+yt(r)):t.value!==""+yt(r)&&(t.value=""+yt(r)):A!=="submit"&&A!=="reset"||t.removeAttribute("value"),r!=null?B(t,A,yt(r)):o!=null?B(t,A,yt(o)):f!=null&&t.removeAttribute("value"),p==null&&v!=null&&(t.defaultChecked=!!v),p!=null&&(t.checked=p&&typeof p!="function"&&typeof p!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?t.name=""+yt(O):t.removeAttribute("name")}function K(t,r,o,f,p,v,A,O){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(t.type=v),r!=null||o!=null){if(!(v!=="submit"&&v!=="reset"||r!=null)){Yt(t);return}o=o!=null?""+yt(o):"",r=r!=null?""+yt(r):o,O||r===t.value||(t.value=r),t.defaultValue=r}f=f??p,f=typeof f!="function"&&typeof f!="symbol"&&!!f,t.checked=O?t.checked:!!f,t.defaultChecked=!!f,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(t.name=A),Yt(t)}function B(t,r,o){r==="number"&&Ha(t.ownerDocument)===t||t.defaultValue===""+o||(t.defaultValue=""+o)}function Fe(t,r,o,f){if(t=t.options,r){r={};for(var p=0;p<o.length;p++)r["$"+o[p]]=!0;for(o=0;o<t.length;o++)p=r.hasOwnProperty("$"+t[o].value),t[o].selected!==p&&(t[o].selected=p),p&&f&&(t[o].defaultSelected=!0)}else{for(o=""+yt(o),r=null,p=0;p<t.length;p++){if(t[p].value===o){t[p].selected=!0,f&&(t[p].defaultSelected=!0);return}r!==null||t[p].disabled||(r=t[p])}r!==null&&(r.selected=!0)}}function gi(t,r,o){if(r!=null&&(r=""+yt(r),r!==t.value&&(t.value=r),o==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=o!=null?""+yt(o):""}function ns(t,r,o,f){if(r==null){if(f!=null){if(o!=null)throw Error(h(92));if(U(f)){if(1<f.length)throw Error(h(93));f=f[0]}o=f}o==null&&(o=""),r=o}o=yt(r),t.defaultValue=o,f=t.textContent,f===o&&f!==""&&f!==null&&(t.value=f),Yt(t)}function _n(t,r){if(r){var o=t.firstChild;if(o&&o===t.lastChild&&o.nodeType===3){o.nodeValue=r;return}}t.textContent=r}var Ol=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function as(t,r,o){var f=r.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?f?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":f?t.setProperty(r,o):typeof o!="number"||o===0||Ol.has(r)?r==="float"?t.cssFloat=o:t[r]=(""+o).trim():t[r]=o+"px"}function We(t,r,o){if(r!=null&&typeof r!="object")throw Error(h(62));if(t=t.style,o!=null){for(var f in o)!o.hasOwnProperty(f)||r!=null&&r.hasOwnProperty(f)||(f.indexOf("--")===0?t.setProperty(f,""):f==="float"?t.cssFloat="":t[f]="");for(var p in r)f=r[p],r.hasOwnProperty(p)&&o[p]!==f&&as(t,p,f)}else for(var v in r)r.hasOwnProperty(v)&&as(t,v,r[v])}function zt(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mn(t){return zh.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function _s(){}var ra=null;function Ml(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var jt=null,Gs=null;function or(t){var r=Ct(t);if(r&&(t=r.stateNode)){var o=t[Ot]||null;e:switch(t=r.stateNode,r.type){case"input":if(vi(t,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),r=o.name,o.type==="radio"&&r!=null){for(o=t;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+nt(""+r)+'"][type="radio"]'),r=0;r<o.length;r++){var f=o[r];if(f!==t&&f.form===t.form){var p=f[Ot]||null;if(!p)throw Error(h(90));vi(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(r=0;r<o.length;r++)f=o[r],f.form===t.form&&lr(f)}break e;case"textarea":gi(t,o.value,o.defaultValue);break e;case"select":r=o.value,r!=null&&Fe(t,!!o.multiple,r,!1)}}}var Xe=!1;function qo(t,r,o){if(Xe)return t(r,o);Xe=!0;try{var f=t(r);return f}finally{if(Xe=!1,(jt!==null||Gs!==null)&&(zc(),jt&&(r=jt,t=Gs,Gs=jt=null,or(r),t)))for(r=0;r<t.length;r++)or(t[r])}}function Ze(t,r){var o=t.stateNode;if(o===null)return null;var f=o[Ot]||null;if(f===null)return null;o=f[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(t=t.type,f=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!f;break e;default:t=!1}if(t)return null;if(o&&typeof o!="function")throw Error(h(231,r,typeof o));return o}var Ft=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bl=!1;if(Ft)try{var Ir={};Object.defineProperty(Ir,"passive",{get:function(){Bl=!0}}),window.addEventListener("test",Ir,Ir),window.removeEventListener("test",Ir,Ir)}catch{Bl=!1}var cr=null,hr=null,za=null;function pn(){if(za)return za;var t,r=hr,o=r.length,f,p="value"in cr?cr.value:cr.textContent,v=p.length;for(t=0;t<o&&r[t]===p[t];t++);var A=o-t;for(f=1;f<=A&&r[o-f]===p[v-f];f++);return za=p.slice(t,1<f?1-f:void 0)}function xr(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function vr(){return!0}function Il(){return!1}function Si(t){function r(o,f,p,v,A){this._reactName=o,this._targetInst=p,this.type=f,this.nativeEvent=v,this.target=A,this.currentTarget=null;for(var O in t)t.hasOwnProperty(O)&&(o=t[O],this[O]=o?o(v):v[O]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?vr:Il,this.isPropagationStopped=Il,this}return N(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=vr)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=vr)},persist:function(){},isPersistent:vr}),r}var Rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ni=Si(Rs),xn=N({},Rs,{view:0,detail:0}),Ko=Si(xn),Fa,kl,na,Ua=N({},xn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:aa,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==na&&(na&&t.type==="mousemove"?(Fa=t.screenX-na.screenX,kl=t.screenY-na.screenY):kl=Fa=0,na=t),Fa)},movementY:function(t){return"movementY"in t?t.movementY:kl}}),Et=Si(Ua),Zo=N({},Ua,{dataTransfer:0}),Va=Si(Zo),Sr=N({},xn,{relatedTarget:0}),Ll=Si(Sr),se=N({},Rs,{animationName:0,elapsedTime:0,pseudoElement:0}),it=Si(se),Di=N({},Rs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Wa=Si(Di),Qo=N({},Rs,{data:0}),Jo=Si(Qo),Fh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Uh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _i(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=Pl[t])?!!r[t]:!1}function aa(){return _i}var Jt=N({},xn,{key:function(t){if(t.key){var r=Fh[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=xr(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Uh[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:aa,charCode:function(t){return t.type==="keypress"?xr(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?xr(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ga=Si(Jt),kr=N({},Ua,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rt=Si(kr),Ye=N({},xn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:aa}),Vh=Si(Ye),Ut=N({},Rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lr=Si(Ut),vn=N({},Ua,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Wh=Si(vn),Xs=N({},Rs,{newState:0,oldState:0}),Hl=Si(Xs),$o=[9,13,27,32],la=Ft&&"CompositionEvent"in window,Sn=null;Ft&&"documentMode"in document&&(Sn=document.documentMode);var ec=Ft&&"TextEvent"in window&&!Sn,tc=Ft&&(!la||Sn&&8<Sn&&11>=Sn),Pr=" ",Xa=!1;function ic(t,r){switch(t){case"keyup":return $o.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yn(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var wn=!1;function yr(t,r){switch(t){case"compositionend":return yn(r);case"keypress":return r.which!==32?null:(Xa=!0,Pr);case"textInput":return t=r.data,t===Pr&&Xa?null:t;default:return null}}function Ya(t,r){if(wn)return t==="compositionend"||!la&&ic(t,r)?(t=pn(),za=hr=cr=null,wn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return tc&&r.locale!=="ko"?null:r.data;default:return null}}var ms={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zl(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!ms[t.type]:r==="textarea"}function Ns(t,r,o,f){jt?Gs?Gs.push(f):Gs=[f]:jt=f,r=Yc(r,"onChange"),0<r.length&&(o=new Ni("onChange","change",null,o,f),t.push({event:o,listeners:r}))}var oa=null,Hr=null;function Gh(t){mg(t,0)}function ca(t){var r=un(t);if(lr(r))return t}function Ds(t,r){if(t==="change")return r}var sc=!1;if(Ft){var ha;if(Ft){var zr="oninput"in document;if(!zr){var _t=document.createElement("div");_t.setAttribute("oninput","return;"),zr=typeof _t.oninput=="function"}ha=zr}else ha=!1;sc=ha&&(!document.documentMode||9<document.documentMode)}function ua(){oa&&(oa.detachEvent("onpropertychange",T),Hr=oa=null)}function T(t){if(t.propertyName==="value"&&ca(Hr)){var r=[];Ns(r,Hr,t,Ml(t)),qo(Gh,r)}}function i(t,r,o){t==="focusin"?(ua(),oa=r,Hr=o,oa.attachEvent("onpropertychange",T)):t==="focusout"&&ua()}function n(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ca(Hr)}function a(t,r){if(t==="click")return ca(r)}function c(t,r){if(t==="input"||t==="change")return ca(r)}function u(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var d=typeof Object.is=="function"?Object.is:u;function _(t,r){if(d(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var o=Object.keys(t),f=Object.keys(r);if(o.length!==f.length)return!1;for(f=0;f<o.length;f++){var p=o[f];if(!ct.call(r,p)||!d(t[p],r[p]))return!1}return!0}function x(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function y(t,r){var o=x(t);t=0;for(var f;o;){if(o.nodeType===3){if(f=t+o.textContent.length,t<=r&&f>=r)return{node:o,offset:r-t};t=f}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=x(o)}}function E(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?E(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function R(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=Ha(t.document);r instanceof t.HTMLIFrameElement;){try{var o=typeof r.contentWindow.location.href=="string"}catch{o=!1}if(o)t=r.contentWindow;else break;r=Ha(t.document)}return r}function D(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var I=Ft&&"documentMode"in document&&11>=document.documentMode,F=null,V=null,q=null,ie=!1;function Ce(t,r,o){var f=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;ie||F==null||F!==Ha(f)||(f=F,"selectionStart"in f&&D(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),q&&_(q,f)||(q=f,f=Yc(V,"onSelect"),0<f.length&&(r=new Ni("onSelect","select",null,r,o),t.push({event:r,listeners:f}),r.target=F)))}function we(t,r){var o={};return o[t.toLowerCase()]=r.toLowerCase(),o["Webkit"+t]="webkit"+r,o["Moz"+t]="moz"+r,o}var ve={animationend:we("Animation","AnimationEnd"),animationiteration:we("Animation","AnimationIteration"),animationstart:we("Animation","AnimationStart"),transitionrun:we("Transition","TransitionRun"),transitionstart:we("Transition","TransitionStart"),transitioncancel:we("Transition","TransitionCancel"),transitionend:we("Transition","TransitionEnd")},rt={},Qe={};Ft&&(Qe=document.createElement("div").style,"AnimationEvent"in window||(delete ve.animationend.animation,delete ve.animationiteration.animation,delete ve.animationstart.animation),"TransitionEvent"in window||delete ve.transitionend.transition);function li(t){if(rt[t])return rt[t];if(!ve[t])return t;var r=ve[t],o;for(o in r)if(r.hasOwnProperty(o)&&o in Qe)return rt[t]=r[o];return t}var ps=li("animationend"),ji=li("animationiteration"),Nt=li("animationstart"),Oi=li("transitionrun"),ls=li("transitionstart"),bn=li("transitioncancel"),Fr=li("transitionend"),rc=new Map,Fl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Fl.push("scrollEnd");function ur(t,r){rc.set(t,r),Tt(r,[t])}var nc=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Ys=[],ja=0,Xh=0;function ac(){for(var t=ja,r=Xh=ja=0;r<t;){var o=Ys[r];Ys[r++]=null;var f=Ys[r];Ys[r++]=null;var p=Ys[r];Ys[r++]=null;var v=Ys[r];if(Ys[r++]=null,f!==null&&p!==null){var A=f.pending;A===null?p.next=p:(p.next=A.next,A.next=p),f.pending=p}v!==0&&Qd(o,p,v)}}function lc(t,r,o,f){Ys[ja++]=t,Ys[ja++]=r,Ys[ja++]=o,Ys[ja++]=f,Xh|=f,t.lanes|=f,t=t.alternate,t!==null&&(t.lanes|=f)}function Yh(t,r,o,f){return lc(t,r,o,f),oc(t)}function fa(t,r){return lc(t,null,null,r),oc(t)}function Qd(t,r,o){t.lanes|=o;var f=t.alternate;f!==null&&(f.lanes|=o);for(var p=!1,v=t.return;v!==null;)v.childLanes|=o,f=v.alternate,f!==null&&(f.childLanes|=o),v.tag===22&&(t=v.stateNode,t===null||t._visibility&1||(p=!0)),t=v,v=v.return;return t.tag===3?(v=t.stateNode,p&&r!==null&&(p=31-tt(o),t=v.hiddenUpdates,f=t[p],f===null?t[p]=[r]:f.push(r),r.lane=o|536870912),v):null}function oc(t){if(50<oo)throw oo=0,tf=null,Error(h(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var qa={};function Cm(t,r,o,f){this.tag=t,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Os(t,r,o,f){return new Cm(t,r,o,f)}function jh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Ur(t,r){var o=t.alternate;return o===null?(o=Os(t.tag,r,t.key,t.mode),o.elementType=t.elementType,o.type=t.type,o.stateNode=t.stateNode,o.alternate=t,t.alternate=o):(o.pendingProps=r,o.type=t.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=t.flags&65011712,o.childLanes=t.childLanes,o.lanes=t.lanes,o.child=t.child,o.memoizedProps=t.memoizedProps,o.memoizedState=t.memoizedState,o.updateQueue=t.updateQueue,r=t.dependencies,o.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},o.sibling=t.sibling,o.index=t.index,o.ref=t.ref,o.refCleanup=t.refCleanup,o}function Jd(t,r){t.flags&=65011714;var o=t.alternate;return o===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,r=o.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function cc(t,r,o,f,p,v){var A=0;if(f=t,typeof t=="function")jh(t)&&(A=1);else if(typeof t=="string")A=Np(t,o,be.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case de:return t=Os(31,o,r,p),t.elementType=de,t.lanes=v,t;case X:return da(o.children,p,v,r);case pe:A=8,p|=24;break;case me:return t=Os(12,o,r,p|2),t.elementType=me,t.lanes=v,t;case Oe:return t=Os(13,o,r,p),t.elementType=Oe,t.lanes=v,t;case Re:return t=Os(19,o,r,p),t.elementType=Re,t.lanes=v,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case te:A=10;break e;case he:A=9;break e;case le:A=11;break e;case Y:A=14;break e;case Ne:A=16,f=null;break e}A=29,o=Error(h(130,t===null?"null":typeof t,"")),f=null}return r=Os(A,o,r,p),r.elementType=t,r.type=f,r.lanes=v,r}function da(t,r,o,f){return t=Os(7,t,f,r),t.lanes=o,t}function qh(t,r,o){return t=Os(6,t,null,r),t.lanes=o,t}function $d(t){var r=Os(18,null,null,0);return r.stateNode=t,r}function Kh(t,r,o){return r=Os(4,t.children!==null?t.children:[],t.key,r),r.lanes=o,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var e0=new WeakMap;function js(t,r){if(typeof t=="object"&&t!==null){var o=e0.get(t);return o!==void 0?o:(r={value:t,source:r,stack:Dt(r)},e0.set(t,r),r)}return{value:t,source:r,stack:Dt(r)}}var Ka=[],Za=0,hc=null,Ul=0,qs=[],Ks=0,Cn=null,wr=1,br="";function Vr(t,r){Ka[Za++]=Ul,Ka[Za++]=hc,hc=t,Ul=r}function t0(t,r,o){qs[Ks++]=wr,qs[Ks++]=br,qs[Ks++]=Cn,Cn=t;var f=wr;t=br;var p=32-tt(f)-1;f&=~(1<<p),o+=1;var v=32-tt(r)+p;if(30<v){var A=p-p%5;v=(f&(1<<A)-1).toString(32),f>>=A,p-=A,wr=1<<32-tt(r)+p|o<<p|f,br=v+t}else wr=1<<v|o<<p|f,br=t}function Zh(t){t.return!==null&&(Vr(t,1),t0(t,1,0))}function Qh(t){for(;t===hc;)hc=Ka[--Za],Ka[Za]=null,Ul=Ka[--Za],Ka[Za]=null;for(;t===Cn;)Cn=qs[--Ks],qs[Ks]=null,br=qs[--Ks],qs[Ks]=null,wr=qs[--Ks],qs[Ks]=null}function i0(t,r){qs[Ks++]=wr,qs[Ks++]=br,qs[Ks++]=Cn,wr=r.id,br=r.overflow,Cn=t}var qi=null,qt=null,xt=!1,En=null,Zs=!1,Jh=Error(h(519));function An(t){var r=Error(h(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Vl(js(r,t)),Jh}function s0(t){var r=t.stateNode,o=t.type,f=t.memoizedProps;switch(r[di]=t,r[Ot]=f,o){case"dialog":ft("cancel",r),ft("close",r);break;case"iframe":case"object":case"embed":ft("load",r);break;case"video":case"audio":for(o=0;o<ho.length;o++)ft(ho[o],r);break;case"source":ft("error",r);break;case"img":case"image":case"link":ft("error",r),ft("load",r);break;case"details":ft("toggle",r);break;case"input":ft("invalid",r),K(r,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":ft("invalid",r);break;case"textarea":ft("invalid",r),ns(r,f.value,f.defaultValue,f.children)}o=f.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||r.textContent===""+o||f.suppressHydrationWarning===!0||Sg(r.textContent,o)?(f.popover!=null&&(ft("beforetoggle",r),ft("toggle",r)),f.onScroll!=null&&ft("scroll",r),f.onScrollEnd!=null&&ft("scrollend",r),f.onClick!=null&&(r.onclick=_s),r=!0):r=!1,r||An(t,!0)}function r0(t){for(qi=t.return;qi;)switch(qi.tag){case 5:case 31:case 13:Zs=!1;return;case 27:case 3:Zs=!0;return;default:qi=qi.return}}function Qa(t){if(t!==qi)return!1;if(!xt)return r0(t),xt=!0,!1;var r=t.tag,o;if((o=r!==3&&r!==27)&&((o=r===5)&&(o=t.type,o=!(o!=="form"&&o!=="button")||pf(t.type,t.memoizedProps)),o=!o),o&&qt&&An(t),r0(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(h(317));qt=Ng(t)}else if(r===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(h(317));qt=Ng(t)}else r===27?(r=qt,Fn(t.type)?(t=wf,wf=null,qt=t):qt=r):qt=qi?Js(t.stateNode.nextSibling):null;return!0}function ga(){qt=qi=null,xt=!1}function $h(){var t=En;return t!==null&&(ys===null?ys=t:ys.push.apply(ys,t),En=null),t}function Vl(t){En===null?En=[t]:En.push(t)}var eu=H(null),_a=null,Wr=null;function Tn(t,r,o){ye(eu,r._currentValue),r._currentValue=o}function Gr(t){t._currentValue=eu.current,re(eu)}function tu(t,r,o){for(;t!==null;){var f=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,f!==null&&(f.childLanes|=r)):f!==null&&(f.childLanes&r)!==r&&(f.childLanes|=r),t===o)break;t=t.return}}function iu(t,r,o,f){var p=t.child;for(p!==null&&(p.return=t);p!==null;){var v=p.dependencies;if(v!==null){var A=p.child;v=v.firstContext;e:for(;v!==null;){var O=v;v=p;for(var z=0;z<r.length;z++)if(O.context===r[z]){v.lanes|=o,O=v.alternate,O!==null&&(O.lanes|=o),tu(v.return,o,t),f||(A=null);break e}v=O.next}}else if(p.tag===18){if(A=p.return,A===null)throw Error(h(341));A.lanes|=o,v=A.alternate,v!==null&&(v.lanes|=o),tu(A,o,t),A=null}else A=p.child;if(A!==null)A.return=p;else for(A=p;A!==null;){if(A===t){A=null;break}if(p=A.sibling,p!==null){p.return=A.return,A=p;break}A=A.return}p=A}}function Ja(t,r,o,f){t=null;for(var p=r,v=!1;p!==null;){if(!v){if((p.flags&524288)!==0)v=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var A=p.alternate;if(A===null)throw Error(h(387));if(A=A.memoizedProps,A!==null){var O=p.type;d(p.pendingProps.value,A.value)||(t!==null?t.push(O):t=[O])}}else if(p===$e.current){if(A=p.alternate,A===null)throw Error(h(387));A.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(t!==null?t.push(mo):t=[mo])}p=p.return}t!==null&&iu(r,t,o,f),r.flags|=262144}function uc(t){for(t=t.firstContext;t!==null;){if(!d(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ma(t){_a=t,Wr=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Ki(t){return n0(_a,t)}function fc(t,r){return _a===null&&ma(t),n0(t,r)}function n0(t,r){var o=r._currentValue;if(r={context:r,memoizedValue:o,next:null},Wr===null){if(t===null)throw Error(h(308));Wr=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else Wr=Wr.next=r;return o}var Em=typeof AbortController<"u"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(o,f){t.push(f)}};this.abort=function(){r.aborted=!0,t.forEach(function(o){return o()})}},Am=e.unstable_scheduleCallback,Tm=e.unstable_NormalPriority,yi={$$typeof:te,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function su(){return{controller:new Em,data:new Map,refCount:0}}function Wl(t){t.refCount--,t.refCount===0&&Am(Tm,function(){t.controller.abort()})}var Gl=null,ru=0,$a=0,el=null;function Rm(t,r){if(Gl===null){var o=Gl=[];ru=0,$a=of(),el={status:"pending",value:void 0,then:function(f){o.push(f)}}}return ru++,r.then(a0,a0),r}function a0(){if(--ru===0&&Gl!==null){el!==null&&(el.status="fulfilled");var t=Gl;Gl=null,$a=0,el=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function Nm(t,r){var o=[],f={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return t.then(function(){f.status="fulfilled",f.value=r;for(var p=0;p<o.length;p++)(0,o[p])(r)},function(p){for(f.status="rejected",f.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),f}var l0=W.S;W.S=function(t,r){G1=ti(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&Rm(t,r),l0!==null&&l0(t,r)};var pa=H(null);function nu(){var t=pa.current;return t!==null?t:Vt.pooledCache}function dc(t,r){r===null?ye(pa,pa.current):ye(pa,r.pool)}function o0(){var t=nu();return t===null?null:{parent:yi._currentValue,pool:t}}var tl=Error(h(460)),au=Error(h(474)),gc=Error(h(542)),_c={then:function(){}};function c0(t){return t=t.status,t==="fulfilled"||t==="rejected"}function h0(t,r,o){switch(o=t[o],o===void 0?t.push(r):o!==r&&(r.then(_s,_s),r=o),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,f0(t),t;default:if(typeof r.status=="string")r.then(_s,_s);else{if(t=Vt,t!==null&&100<t.shellSuspendCounter)throw Error(h(482));t=r,t.status="pending",t.then(function(f){if(r.status==="pending"){var p=r;p.status="fulfilled",p.value=f}},function(f){if(r.status==="pending"){var p=r;p.status="rejected",p.reason=f}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,f0(t),t}throw va=r,tl}}function xa(t){try{var r=t._init;return r(t._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(va=o,tl):o}}var va=null;function u0(){if(va===null)throw Error(h(459));var t=va;return va=null,t}function f0(t){if(t===tl||t===gc)throw Error(h(483))}var il=null,Xl=0;function mc(t){var r=Xl;return Xl+=1,il===null&&(il=[]),h0(il,t,r)}function Yl(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function pc(t,r){throw r.$$typeof===k?Error(h(525)):(t=Object.prototype.toString.call(r),Error(h(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function d0(t){function r(j,G){if(t){var Q=j.deletions;Q===null?(j.deletions=[G],j.flags|=16):Q.push(G)}}function o(j,G){if(!t)return null;for(;G!==null;)r(j,G),G=G.sibling;return null}function f(j){for(var G=new Map;j!==null;)j.key!==null?G.set(j.key,j):G.set(j.index,j),j=j.sibling;return G}function p(j,G){return j=Ur(j,G),j.index=0,j.sibling=null,j}function v(j,G,Q){return j.index=Q,t?(Q=j.alternate,Q!==null?(Q=Q.index,Q<G?(j.flags|=67108866,G):Q):(j.flags|=67108866,G)):(j.flags|=1048576,G)}function A(j){return t&&j.alternate===null&&(j.flags|=67108866),j}function O(j,G,Q,fe){return G===null||G.tag!==6?(G=qh(Q,j.mode,fe),G.return=j,G):(G=p(G,Q),G.return=j,G)}function z(j,G,Q,fe){var Ge=Q.type;return Ge===X?ce(j,G,Q.props.children,fe,Q.key):G!==null&&(G.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Ne&&xa(Ge)===G.type)?(G=p(G,Q.props),Yl(G,Q),G.return=j,G):(G=cc(Q.type,Q.key,Q.props,null,j.mode,fe),Yl(G,Q),G.return=j,G)}function J(j,G,Q,fe){return G===null||G.tag!==4||G.stateNode.containerInfo!==Q.containerInfo||G.stateNode.implementation!==Q.implementation?(G=Kh(Q,j.mode,fe),G.return=j,G):(G=p(G,Q.children||[]),G.return=j,G)}function ce(j,G,Q,fe,Ge){return G===null||G.tag!==7?(G=da(Q,j.mode,fe,Ge),G.return=j,G):(G=p(G,Q),G.return=j,G)}function ge(j,G,Q){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=qh(""+G,j.mode,Q),G.return=j,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case P:return Q=cc(G.type,G.key,G.props,null,j.mode,Q),Yl(Q,G),Q.return=j,Q;case L:return G=Kh(G,j.mode,Q),G.return=j,G;case Ne:return G=xa(G),ge(j,G,Q)}if(U(G)||oe(G))return G=da(G,j.mode,Q,null),G.return=j,G;if(typeof G.then=="function")return ge(j,mc(G),Q);if(G.$$typeof===te)return ge(j,fc(j,G),Q);pc(j,G)}return null}function $(j,G,Q,fe){var Ge=G!==null?G.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Ge!==null?null:O(j,G,""+Q,fe);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case P:return Q.key===Ge?z(j,G,Q,fe):null;case L:return Q.key===Ge?J(j,G,Q,fe):null;case Ne:return Q=xa(Q),$(j,G,Q,fe)}if(U(Q)||oe(Q))return Ge!==null?null:ce(j,G,Q,fe,null);if(typeof Q.then=="function")return $(j,G,mc(Q),fe);if(Q.$$typeof===te)return $(j,G,fc(j,Q),fe);pc(j,Q)}return null}function ne(j,G,Q,fe,Ge){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return j=j.get(Q)||null,O(G,j,""+fe,Ge);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case P:return j=j.get(fe.key===null?Q:fe.key)||null,z(G,j,fe,Ge);case L:return j=j.get(fe.key===null?Q:fe.key)||null,J(G,j,fe,Ge);case Ne:return fe=xa(fe),ne(j,G,Q,fe,Ge)}if(U(fe)||oe(fe))return j=j.get(Q)||null,ce(G,j,fe,Ge,null);if(typeof fe.then=="function")return ne(j,G,Q,mc(fe),Ge);if(fe.$$typeof===te)return ne(j,G,Q,fc(G,fe),Ge);pc(G,fe)}return null}function He(j,G,Q,fe){for(var Ge=null,wt=null,Ue=G,st=G=0,pt=null;Ue!==null&&st<Q.length;st++){Ue.index>st?(pt=Ue,Ue=null):pt=Ue.sibling;var bt=$(j,Ue,Q[st],fe);if(bt===null){Ue===null&&(Ue=pt);break}t&&Ue&&bt.alternate===null&&r(j,Ue),G=v(bt,G,st),wt===null?Ge=bt:wt.sibling=bt,wt=bt,Ue=pt}if(st===Q.length)return o(j,Ue),xt&&Vr(j,st),Ge;if(Ue===null){for(;st<Q.length;st++)Ue=ge(j,Q[st],fe),Ue!==null&&(G=v(Ue,G,st),wt===null?Ge=Ue:wt.sibling=Ue,wt=Ue);return xt&&Vr(j,st),Ge}for(Ue=f(Ue);st<Q.length;st++)pt=ne(Ue,j,st,Q[st],fe),pt!==null&&(t&&pt.alternate!==null&&Ue.delete(pt.key===null?st:pt.key),G=v(pt,G,st),wt===null?Ge=pt:wt.sibling=pt,wt=pt);return t&&Ue.forEach(function(Xn){return r(j,Xn)}),xt&&Vr(j,st),Ge}function qe(j,G,Q,fe){if(Q==null)throw Error(h(151));for(var Ge=null,wt=null,Ue=G,st=G=0,pt=null,bt=Q.next();Ue!==null&&!bt.done;st++,bt=Q.next()){Ue.index>st?(pt=Ue,Ue=null):pt=Ue.sibling;var Xn=$(j,Ue,bt.value,fe);if(Xn===null){Ue===null&&(Ue=pt);break}t&&Ue&&Xn.alternate===null&&r(j,Ue),G=v(Xn,G,st),wt===null?Ge=Xn:wt.sibling=Xn,wt=Xn,Ue=pt}if(bt.done)return o(j,Ue),xt&&Vr(j,st),Ge;if(Ue===null){for(;!bt.done;st++,bt=Q.next())bt=ge(j,bt.value,fe),bt!==null&&(G=v(bt,G,st),wt===null?Ge=bt:wt.sibling=bt,wt=bt);return xt&&Vr(j,st),Ge}for(Ue=f(Ue);!bt.done;st++,bt=Q.next())bt=ne(Ue,j,st,bt.value,fe),bt!==null&&(t&&bt.alternate!==null&&Ue.delete(bt.key===null?st:bt.key),G=v(bt,G,st),wt===null?Ge=bt:wt.sibling=bt,wt=bt);return t&&Ue.forEach(function(Fp){return r(j,Fp)}),xt&&Vr(j,st),Ge}function Pt(j,G,Q,fe){if(typeof Q=="object"&&Q!==null&&Q.type===X&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case P:e:{for(var Ge=Q.key;G!==null;){if(G.key===Ge){if(Ge=Q.type,Ge===X){if(G.tag===7){o(j,G.sibling),fe=p(G,Q.props.children),fe.return=j,j=fe;break e}}else if(G.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Ne&&xa(Ge)===G.type){o(j,G.sibling),fe=p(G,Q.props),Yl(fe,Q),fe.return=j,j=fe;break e}o(j,G);break}else r(j,G);G=G.sibling}Q.type===X?(fe=da(Q.props.children,j.mode,fe,Q.key),fe.return=j,j=fe):(fe=cc(Q.type,Q.key,Q.props,null,j.mode,fe),Yl(fe,Q),fe.return=j,j=fe)}return A(j);case L:e:{for(Ge=Q.key;G!==null;){if(G.key===Ge)if(G.tag===4&&G.stateNode.containerInfo===Q.containerInfo&&G.stateNode.implementation===Q.implementation){o(j,G.sibling),fe=p(G,Q.children||[]),fe.return=j,j=fe;break e}else{o(j,G);break}else r(j,G);G=G.sibling}fe=Kh(Q,j.mode,fe),fe.return=j,j=fe}return A(j);case Ne:return Q=xa(Q),Pt(j,G,Q,fe)}if(U(Q))return He(j,G,Q,fe);if(oe(Q)){if(Ge=oe(Q),typeof Ge!="function")throw Error(h(150));return Q=Ge.call(Q),qe(j,G,Q,fe)}if(typeof Q.then=="function")return Pt(j,G,mc(Q),fe);if(Q.$$typeof===te)return Pt(j,G,fc(j,Q),fe);pc(j,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,G!==null&&G.tag===6?(o(j,G.sibling),fe=p(G,Q),fe.return=j,j=fe):(o(j,G),fe=qh(Q,j.mode,fe),fe.return=j,j=fe),A(j)):o(j,G)}return function(j,G,Q,fe){try{Xl=0;var Ge=Pt(j,G,Q,fe);return il=null,Ge}catch(Ue){if(Ue===tl||Ue===gc)throw Ue;var wt=Os(29,Ue,null,j.mode);return wt.lanes=fe,wt.return=j,wt}}}var Sa=d0(!0),g0=d0(!1),Rn=!1;function lu(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ou(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Nn(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Dn(t,r,o){var f=t.updateQueue;if(f===null)return null;if(f=f.shared,(At&2)!==0){var p=f.pending;return p===null?r.next=r:(r.next=p.next,p.next=r),f.pending=r,r=oc(t),Qd(t,null,o),r}return lc(t,f,r,o),oc(t)}function jl(t,r,o){if(r=r.updateQueue,r!==null&&(r=r.shared,(o&4194048)!==0)){var f=r.lanes;f&=t.pendingLanes,o|=f,r.lanes=o,pr(t,o)}}function cu(t,r){var o=t.updateQueue,f=t.alternate;if(f!==null&&(f=f.updateQueue,o===f)){var p=null,v=null;if(o=o.firstBaseUpdate,o!==null){do{var A={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};v===null?p=v=A:v=v.next=A,o=o.next}while(o!==null);v===null?p=v=r:v=v.next=r}else p=v=r;o={baseState:f.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},t.updateQueue=o;return}t=o.lastBaseUpdate,t===null?o.firstBaseUpdate=r:t.next=r,o.lastBaseUpdate=r}var hu=!1;function ql(){if(hu){var t=el;if(t!==null)throw t}}function Kl(t,r,o,f){hu=!1;var p=t.updateQueue;Rn=!1;var v=p.firstBaseUpdate,A=p.lastBaseUpdate,O=p.shared.pending;if(O!==null){p.shared.pending=null;var z=O,J=z.next;z.next=null,A===null?v=J:A.next=J,A=z;var ce=t.alternate;ce!==null&&(ce=ce.updateQueue,O=ce.lastBaseUpdate,O!==A&&(O===null?ce.firstBaseUpdate=J:O.next=J,ce.lastBaseUpdate=z))}if(v!==null){var ge=p.baseState;A=0,ce=J=z=null,O=v;do{var $=O.lane&-536870913,ne=$!==O.lane;if(ne?(mt&$)===$:(f&$)===$){$!==0&&$===$a&&(hu=!0),ce!==null&&(ce=ce.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var He=t,qe=O;$=r;var Pt=o;switch(qe.tag){case 1:if(He=qe.payload,typeof He=="function"){ge=He.call(Pt,ge,$);break e}ge=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=qe.payload,$=typeof He=="function"?He.call(Pt,ge,$):He,$==null)break e;ge=N({},ge,$);break e;case 2:Rn=!0}}$=O.callback,$!==null&&(t.flags|=64,ne&&(t.flags|=8192),ne=p.callbacks,ne===null?p.callbacks=[$]:ne.push($))}else ne={lane:$,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ce===null?(J=ce=ne,z=ge):ce=ce.next=ne,A|=$;if(O=O.next,O===null){if(O=p.shared.pending,O===null)break;ne=O,O=ne.next,ne.next=null,p.lastBaseUpdate=ne,p.shared.pending=null}}while(!0);ce===null&&(z=ge),p.baseState=z,p.firstBaseUpdate=J,p.lastBaseUpdate=ce,v===null&&(p.shared.lanes=0),kn|=A,t.lanes=A,t.memoizedState=ge}}function _0(t,r){if(typeof t!="function")throw Error(h(191,t));t.call(r)}function m0(t,r){var o=t.callbacks;if(o!==null)for(t.callbacks=null,t=0;t<o.length;t++)_0(o[t],r)}var sl=H(null),xc=H(0);function p0(t,r){t=$r,ye(xc,t),ye(sl,r),$r=t|r.baseLanes}function uu(){ye(xc,$r),ye(sl,sl.current)}function fu(){$r=xc.current,re(sl),re(xc)}var Ms=H(null),Qs=null;function On(t){var r=t.alternate;ye(mi,mi.current&1),ye(Ms,t),Qs===null&&(r===null||sl.current!==null||r.memoizedState!==null)&&(Qs=t)}function du(t){ye(mi,mi.current),ye(Ms,t),Qs===null&&(Qs=t)}function x0(t){t.tag===22?(ye(mi,mi.current),ye(Ms,t),Qs===null&&(Qs=t)):Mn()}function Mn(){ye(mi,mi.current),ye(Ms,Ms.current)}function Bs(t){re(Ms),Qs===t&&(Qs=null),re(mi)}var mi=H(0);function vc(t){for(var r=t;r!==null;){if(r.tag===13){var o=r.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Sf(o)||yf(o)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Xr=0,et=null,kt=null,wi=null,Sc=!1,rl=!1,ya=!1,yc=0,Zl=0,nl=null,Dm=0;function oi(){throw Error(h(321))}function gu(t,r){if(r===null)return!1;for(var o=0;o<r.length&&o<t.length;o++)if(!d(t[o],r[o]))return!1;return!0}function _u(t,r,o,f,p,v){return Xr=v,et=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,W.H=t===null||t.memoizedState===null?t1:Du,ya=!1,v=o(f,p),ya=!1,rl&&(v=S0(r,o,f,p)),v0(t),v}function v0(t){W.H=$l;var r=kt!==null&&kt.next!==null;if(Xr=0,wi=kt=et=null,Sc=!1,Zl=0,nl=null,r)throw Error(h(300));t===null||bi||(t=t.dependencies,t!==null&&uc(t)&&(bi=!0))}function S0(t,r,o,f){et=t;var p=0;do{if(rl&&(nl=null),Zl=0,rl=!1,25<=p)throw Error(h(301));if(p+=1,wi=kt=null,t.updateQueue!=null){var v=t.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}W.H=i1,v=r(o,f)}while(rl);return v}function Om(){var t=W.H,r=t.useState()[0];return r=typeof r.then=="function"?Ql(r):r,t=t.useState()[0],(kt!==null?kt.memoizedState:null)!==t&&(et.flags|=1024),r}function mu(){var t=yc!==0;return yc=0,t}function pu(t,r,o){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~o}function xu(t){if(Sc){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}Sc=!1}Xr=0,wi=kt=et=null,rl=!1,Zl=yc=0,nl=null}function os(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wi===null?et.memoizedState=wi=t:wi=wi.next=t,wi}function pi(){if(kt===null){var t=et.alternate;t=t!==null?t.memoizedState:null}else t=kt.next;var r=wi===null?et.memoizedState:wi.next;if(r!==null)wi=r,kt=t;else{if(t===null)throw et.alternate===null?Error(h(467)):Error(h(310));kt=t,t={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},wi===null?et.memoizedState=wi=t:wi=wi.next=t}return wi}function wc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ql(t){var r=Zl;return Zl+=1,nl===null&&(nl=[]),t=h0(nl,t,r),r=et,(wi===null?r.memoizedState:wi.next)===null&&(r=r.alternate,W.H=r===null||r.memoizedState===null?t1:Du),t}function bc(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Ql(t);if(t.$$typeof===te)return Ki(t)}throw Error(h(438,String(t)))}function vu(t){var r=null,o=et.updateQueue;if(o!==null&&(r=o.memoCache),r==null){var f=et.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(r={data:f.data.map(function(p){return p.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),o===null&&(o=wc(),et.updateQueue=o),o.memoCache=r,o=r.data[r.index],o===void 0)for(o=r.data[r.index]=Array(t),f=0;f<t;f++)o[f]=Gt;return r.index++,o}function Yr(t,r){return typeof r=="function"?r(t):r}function Cc(t){var r=pi();return Su(r,kt,t)}function Su(t,r,o){var f=t.queue;if(f===null)throw Error(h(311));f.lastRenderedReducer=o;var p=t.baseQueue,v=f.pending;if(v!==null){if(p!==null){var A=p.next;p.next=v.next,v.next=A}r.baseQueue=p=v,f.pending=null}if(v=t.baseState,p===null)t.memoizedState=v;else{r=p.next;var O=A=null,z=null,J=r,ce=!1;do{var ge=J.lane&-536870913;if(ge!==J.lane?(mt&ge)===ge:(Xr&ge)===ge){var $=J.revertLane;if($===0)z!==null&&(z=z.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),ge===$a&&(ce=!0);else if((Xr&$)===$){J=J.next,$===$a&&(ce=!0);continue}else ge={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},z===null?(O=z=ge,A=v):z=z.next=ge,et.lanes|=$,kn|=$;ge=J.action,ya&&o(v,ge),v=J.hasEagerState?J.eagerState:o(v,ge)}else $={lane:ge,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},z===null?(O=z=$,A=v):z=z.next=$,et.lanes|=ge,kn|=ge;J=J.next}while(J!==null&&J!==r);if(z===null?A=v:z.next=O,!d(v,t.memoizedState)&&(bi=!0,ce&&(o=el,o!==null)))throw o;t.memoizedState=v,t.baseState=A,t.baseQueue=z,f.lastRenderedState=v}return p===null&&(f.lanes=0),[t.memoizedState,f.dispatch]}function yu(t){var r=pi(),o=r.queue;if(o===null)throw Error(h(311));o.lastRenderedReducer=t;var f=o.dispatch,p=o.pending,v=r.memoizedState;if(p!==null){o.pending=null;var A=p=p.next;do v=t(v,A.action),A=A.next;while(A!==p);d(v,r.memoizedState)||(bi=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),o.lastRenderedState=v}return[v,f]}function y0(t,r,o){var f=et,p=pi(),v=xt;if(v){if(o===void 0)throw Error(h(407));o=o()}else o=r();var A=!d((kt||p).memoizedState,o);if(A&&(p.memoizedState=o,bi=!0),p=p.queue,Cu(C0.bind(null,f,p,t),[t]),p.getSnapshot!==r||A||wi!==null&&wi.memoizedState.tag&1){if(f.flags|=2048,al(9,{destroy:void 0},b0.bind(null,f,p,o,r),null),Vt===null)throw Error(h(349));v||(Xr&127)!==0||w0(f,r,o)}return o}function w0(t,r,o){t.flags|=16384,t={getSnapshot:r,value:o},r=et.updateQueue,r===null?(r=wc(),et.updateQueue=r,r.stores=[t]):(o=r.stores,o===null?r.stores=[t]:o.push(t))}function b0(t,r,o,f){r.value=o,r.getSnapshot=f,E0(r)&&A0(t)}function C0(t,r,o){return o(function(){E0(r)&&A0(t)})}function E0(t){var r=t.getSnapshot;t=t.value;try{var o=r();return!d(t,o)}catch{return!0}}function A0(t){var r=fa(t,2);r!==null&&ws(r,t,2)}function wu(t){var r=os();if(typeof t=="function"){var o=t;if(t=o(),ya){It(!0);try{o()}finally{It(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yr,lastRenderedState:t},r}function T0(t,r,o,f){return t.baseState=o,Su(t,kt,typeof f=="function"?f:Yr)}function Mm(t,r,o,f,p){if(Tc(t))throw Error(h(485));if(t=r.action,t!==null){var v={payload:p,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){v.listeners.push(A)}};W.T!==null?o(!0):v.isTransition=!1,f(v),o=r.pending,o===null?(v.next=r.pending=v,R0(r,v)):(v.next=o.next,r.pending=o.next=v)}}function R0(t,r){var o=r.action,f=r.payload,p=t.state;if(r.isTransition){var v=W.T,A={};W.T=A;try{var O=o(p,f),z=W.S;z!==null&&z(A,O),N0(t,r,O)}catch(J){bu(t,r,J)}finally{v!==null&&A.types!==null&&(v.types=A.types),W.T=v}}else try{v=o(p,f),N0(t,r,v)}catch(J){bu(t,r,J)}}function N0(t,r,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(f){D0(t,r,f)},function(f){return bu(t,r,f)}):D0(t,r,o)}function D0(t,r,o){r.status="fulfilled",r.value=o,O0(r),t.state=o,r=t.pending,r!==null&&(o=r.next,o===r?t.pending=null:(o=o.next,r.next=o,R0(t,o)))}function bu(t,r,o){var f=t.pending;if(t.pending=null,f!==null){f=f.next;do r.status="rejected",r.reason=o,O0(r),r=r.next;while(r!==f)}t.action=null}function O0(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function M0(t,r){return r}function B0(t,r){if(xt){var o=Vt.formState;if(o!==null){e:{var f=et;if(xt){if(qt){t:{for(var p=qt,v=Zs;p.nodeType!==8;){if(!v){p=null;break t}if(p=Js(p.nextSibling),p===null){p=null;break t}}v=p.data,p=v==="F!"||v==="F"?p:null}if(p){qt=Js(p.nextSibling),f=p.data==="F!";break e}}An(f)}f=!1}f&&(r=o[0])}}return o=os(),o.memoizedState=o.baseState=r,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:M0,lastRenderedState:r},o.queue=f,o=J0.bind(null,et,f),f.dispatch=o,f=wu(!1),v=Nu.bind(null,et,!1,f.queue),f=os(),p={state:r,dispatch:null,action:t,pending:null},f.queue=p,o=Mm.bind(null,et,p,v,o),p.dispatch=o,f.memoizedState=t,[r,o,!1]}function I0(t){var r=pi();return k0(r,kt,t)}function k0(t,r,o){if(r=Su(t,r,M0)[0],t=Cc(Yr)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var f=Ql(r)}catch(A){throw A===tl?gc:A}else f=r;r=pi();var p=r.queue,v=p.dispatch;return o!==r.memoizedState&&(et.flags|=2048,al(9,{destroy:void 0},Bm.bind(null,p,o),null)),[f,v,t]}function Bm(t,r){t.action=r}function L0(t){var r=pi(),o=kt;if(o!==null)return k0(r,o,t);pi(),r=r.memoizedState,o=pi();var f=o.queue.dispatch;return o.memoizedState=t,[r,f,!1]}function al(t,r,o,f){return t={tag:t,create:o,deps:f,inst:r,next:null},r=et.updateQueue,r===null&&(r=wc(),et.updateQueue=r),o=r.lastEffect,o===null?r.lastEffect=t.next=t:(f=o.next,o.next=t,t.next=f,r.lastEffect=t),t}function P0(){return pi().memoizedState}function Ec(t,r,o,f){var p=os();et.flags|=t,p.memoizedState=al(1|r,{destroy:void 0},o,f===void 0?null:f)}function Ac(t,r,o,f){var p=pi();f=f===void 0?null:f;var v=p.memoizedState.inst;kt!==null&&f!==null&&gu(f,kt.memoizedState.deps)?p.memoizedState=al(r,v,o,f):(et.flags|=t,p.memoizedState=al(1|r,v,o,f))}function H0(t,r){Ec(8390656,8,t,r)}function Cu(t,r){Ac(2048,8,t,r)}function Im(t){et.flags|=4;var r=et.updateQueue;if(r===null)r=wc(),et.updateQueue=r,r.events=[t];else{var o=r.events;o===null?r.events=[t]:o.push(t)}}function z0(t){var r=pi().memoizedState;return Im({ref:r,nextImpl:t}),function(){if((At&2)!==0)throw Error(h(440));return r.impl.apply(void 0,arguments)}}function F0(t,r){return Ac(4,2,t,r)}function U0(t,r){return Ac(4,4,t,r)}function V0(t,r){if(typeof r=="function"){t=t();var o=r(t);return function(){typeof o=="function"?o():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function W0(t,r,o){o=o!=null?o.concat([t]):null,Ac(4,4,V0.bind(null,r,t),o)}function Eu(){}function G0(t,r){var o=pi();r=r===void 0?null:r;var f=o.memoizedState;return r!==null&&gu(r,f[1])?f[0]:(o.memoizedState=[t,r],t)}function X0(t,r){var o=pi();r=r===void 0?null:r;var f=o.memoizedState;if(r!==null&&gu(r,f[1]))return f[0];if(f=t(),ya){It(!0);try{t()}finally{It(!1)}}return o.memoizedState=[f,r],f}function Au(t,r,o){return o===void 0||(Xr&1073741824)!==0&&(mt&261930)===0?t.memoizedState=r:(t.memoizedState=o,t=Y1(),et.lanes|=t,kn|=t,o)}function Y0(t,r,o,f){return d(o,r)?o:sl.current!==null?(t=Au(t,o,f),d(t,r)||(bi=!0),t):(Xr&42)===0||(Xr&1073741824)!==0&&(mt&261930)===0?(bi=!0,t.memoizedState=o):(t=Y1(),et.lanes|=t,kn|=t,r)}function j0(t,r,o,f,p){var v=Z.p;Z.p=v!==0&&8>v?v:8;var A=W.T,O={};W.T=O,Nu(t,!1,r,o);try{var z=p(),J=W.S;if(J!==null&&J(O,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var ce=Nm(z,f);Jl(t,r,ce,Ls(t))}else Jl(t,r,f,Ls(t))}catch(ge){Jl(t,r,{then:function(){},status:"rejected",reason:ge},Ls())}finally{Z.p=v,A!==null&&O.types!==null&&(A.types=O.types),W.T=A}}function km(){}function Tu(t,r,o,f){if(t.tag!==5)throw Error(h(476));var p=q0(t).queue;j0(t,p,r,ue,o===null?km:function(){return K0(t),o(f)})}function q0(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:ue,baseState:ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yr,lastRenderedState:ue},next:null};var o={};return r.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yr,lastRenderedState:o},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function K0(t){var r=q0(t);r.next===null&&(r=t.alternate.memoizedState),Jl(t,r.next.queue,{},Ls())}function Ru(){return Ki(mo)}function Z0(){return pi().memoizedState}function Q0(){return pi().memoizedState}function Lm(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var o=Ls();t=Nn(o);var f=Dn(r,t,o);f!==null&&(ws(f,r,o),jl(f,r,o)),r={cache:su()},t.payload=r;return}r=r.return}}function Pm(t,r,o){var f=Ls();o={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Tc(t)?$0(r,o):(o=Yh(t,r,o,f),o!==null&&(ws(o,t,f),e1(o,r,f)))}function J0(t,r,o){var f=Ls();Jl(t,r,o,f)}function Jl(t,r,o,f){var p={lane:f,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Tc(t))$0(r,p);else{var v=t.alternate;if(t.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var A=r.lastRenderedState,O=v(A,o);if(p.hasEagerState=!0,p.eagerState=O,d(O,A))return lc(t,r,p,0),Vt===null&&ac(),!1}catch{}if(o=Yh(t,r,p,f),o!==null)return ws(o,t,f),e1(o,r,f),!0}return!1}function Nu(t,r,o,f){if(f={lane:2,revertLane:of(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Tc(t)){if(r)throw Error(h(479))}else r=Yh(t,o,f,2),r!==null&&ws(r,t,2)}function Tc(t){var r=t.alternate;return t===et||r!==null&&r===et}function $0(t,r){rl=Sc=!0;var o=t.pending;o===null?r.next=r:(r.next=o.next,o.next=r),t.pending=r}function e1(t,r,o){if((o&4194048)!==0){var f=r.lanes;f&=t.pendingLanes,o|=f,r.lanes=o,pr(t,o)}}var $l={readContext:Ki,use:bc,useCallback:oi,useContext:oi,useEffect:oi,useImperativeHandle:oi,useLayoutEffect:oi,useInsertionEffect:oi,useMemo:oi,useReducer:oi,useRef:oi,useState:oi,useDebugValue:oi,useDeferredValue:oi,useTransition:oi,useSyncExternalStore:oi,useId:oi,useHostTransitionStatus:oi,useFormState:oi,useActionState:oi,useOptimistic:oi,useMemoCache:oi,useCacheRefresh:oi};$l.useEffectEvent=oi;var t1={readContext:Ki,use:bc,useCallback:function(t,r){return os().memoizedState=[t,r===void 0?null:r],t},useContext:Ki,useEffect:H0,useImperativeHandle:function(t,r,o){o=o!=null?o.concat([t]):null,Ec(4194308,4,V0.bind(null,r,t),o)},useLayoutEffect:function(t,r){return Ec(4194308,4,t,r)},useInsertionEffect:function(t,r){Ec(4,2,t,r)},useMemo:function(t,r){var o=os();r=r===void 0?null:r;var f=t();if(ya){It(!0);try{t()}finally{It(!1)}}return o.memoizedState=[f,r],f},useReducer:function(t,r,o){var f=os();if(o!==void 0){var p=o(r);if(ya){It(!0);try{o(r)}finally{It(!1)}}}else p=r;return f.memoizedState=f.baseState=p,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:p},f.queue=t,t=t.dispatch=Pm.bind(null,et,t),[f.memoizedState,t]},useRef:function(t){var r=os();return t={current:t},r.memoizedState=t},useState:function(t){t=wu(t);var r=t.queue,o=J0.bind(null,et,r);return r.dispatch=o,[t.memoizedState,o]},useDebugValue:Eu,useDeferredValue:function(t,r){var o=os();return Au(o,t,r)},useTransition:function(){var t=wu(!1);return t=j0.bind(null,et,t.queue,!0,!1),os().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,o){var f=et,p=os();if(xt){if(o===void 0)throw Error(h(407));o=o()}else{if(o=r(),Vt===null)throw Error(h(349));(mt&127)!==0||w0(f,r,o)}p.memoizedState=o;var v={value:o,getSnapshot:r};return p.queue=v,H0(C0.bind(null,f,v,t),[t]),f.flags|=2048,al(9,{destroy:void 0},b0.bind(null,f,v,o,r),null),o},useId:function(){var t=os(),r=Vt.identifierPrefix;if(xt){var o=br,f=wr;o=(f&~(1<<32-tt(f)-1)).toString(32)+o,r="_"+r+"R_"+o,o=yc++,0<o&&(r+="H"+o.toString(32)),r+="_"}else o=Dm++,r="_"+r+"r_"+o.toString(32)+"_";return t.memoizedState=r},useHostTransitionStatus:Ru,useFormState:B0,useActionState:B0,useOptimistic:function(t){var r=os();r.memoizedState=r.baseState=t;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=o,r=Nu.bind(null,et,!0,o),o.dispatch=r,[t,r]},useMemoCache:vu,useCacheRefresh:function(){return os().memoizedState=Lm.bind(null,et)},useEffectEvent:function(t){var r=os(),o={impl:t};return r.memoizedState=o,function(){if((At&2)!==0)throw Error(h(440));return o.impl.apply(void 0,arguments)}}},Du={readContext:Ki,use:bc,useCallback:G0,useContext:Ki,useEffect:Cu,useImperativeHandle:W0,useInsertionEffect:F0,useLayoutEffect:U0,useMemo:X0,useReducer:Cc,useRef:P0,useState:function(){return Cc(Yr)},useDebugValue:Eu,useDeferredValue:function(t,r){var o=pi();return Y0(o,kt.memoizedState,t,r)},useTransition:function(){var t=Cc(Yr)[0],r=pi().memoizedState;return[typeof t=="boolean"?t:Ql(t),r]},useSyncExternalStore:y0,useId:Z0,useHostTransitionStatus:Ru,useFormState:I0,useActionState:I0,useOptimistic:function(t,r){var o=pi();return T0(o,kt,t,r)},useMemoCache:vu,useCacheRefresh:Q0};Du.useEffectEvent=z0;var i1={readContext:Ki,use:bc,useCallback:G0,useContext:Ki,useEffect:Cu,useImperativeHandle:W0,useInsertionEffect:F0,useLayoutEffect:U0,useMemo:X0,useReducer:yu,useRef:P0,useState:function(){return yu(Yr)},useDebugValue:Eu,useDeferredValue:function(t,r){var o=pi();return kt===null?Au(o,t,r):Y0(o,kt.memoizedState,t,r)},useTransition:function(){var t=yu(Yr)[0],r=pi().memoizedState;return[typeof t=="boolean"?t:Ql(t),r]},useSyncExternalStore:y0,useId:Z0,useHostTransitionStatus:Ru,useFormState:L0,useActionState:L0,useOptimistic:function(t,r){var o=pi();return kt!==null?T0(o,kt,t,r):(o.baseState=t,[t,o.queue.dispatch])},useMemoCache:vu,useCacheRefresh:Q0};i1.useEffectEvent=z0;function Ou(t,r,o,f){r=t.memoizedState,o=o(f,r),o=o==null?r:N({},r,o),t.memoizedState=o,t.lanes===0&&(t.updateQueue.baseState=o)}var Mu={enqueueSetState:function(t,r,o){t=t._reactInternals;var f=Ls(),p=Nn(f);p.payload=r,o!=null&&(p.callback=o),r=Dn(t,p,f),r!==null&&(ws(r,t,f),jl(r,t,f))},enqueueReplaceState:function(t,r,o){t=t._reactInternals;var f=Ls(),p=Nn(f);p.tag=1,p.payload=r,o!=null&&(p.callback=o),r=Dn(t,p,f),r!==null&&(ws(r,t,f),jl(r,t,f))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var o=Ls(),f=Nn(o);f.tag=2,r!=null&&(f.callback=r),r=Dn(t,f,o),r!==null&&(ws(r,t,o),jl(r,t,o))}};function s1(t,r,o,f,p,v,A){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(f,v,A):r.prototype&&r.prototype.isPureReactComponent?!_(o,f)||!_(p,v):!0}function r1(t,r,o,f){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(o,f),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(o,f),r.state!==t&&Mu.enqueueReplaceState(r,r.state,null)}function wa(t,r){var o=r;if("ref"in r){o={};for(var f in r)f!=="ref"&&(o[f]=r[f])}if(t=t.defaultProps){o===r&&(o=N({},o));for(var p in t)o[p]===void 0&&(o[p]=t[p])}return o}function n1(t){nc(t)}function a1(t){console.error(t)}function l1(t){nc(t)}function Rc(t,r){try{var o=t.onUncaughtError;o(r.value,{componentStack:r.stack})}catch(f){setTimeout(function(){throw f})}}function o1(t,r,o){try{var f=t.onCaughtError;f(o.value,{componentStack:o.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Bu(t,r,o){return o=Nn(o),o.tag=3,o.payload={element:null},o.callback=function(){Rc(t,r)},o}function c1(t){return t=Nn(t),t.tag=3,t}function h1(t,r,o,f){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var v=f.value;t.payload=function(){return p(v)},t.callback=function(){o1(r,o,f)}}var A=o.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(t.callback=function(){o1(r,o,f),typeof p!="function"&&(Ln===null?Ln=new Set([this]):Ln.add(this));var O=f.stack;this.componentDidCatch(f.value,{componentStack:O!==null?O:""})})}function Hm(t,r,o,f,p){if(o.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(r=o.alternate,r!==null&&Ja(r,o,p,!0),o=Ms.current,o!==null){switch(o.tag){case 31:case 13:return Qs===null?Fc():o.alternate===null&&ci===0&&(ci=3),o.flags&=-257,o.flags|=65536,o.lanes=p,f===_c?o.flags|=16384:(r=o.updateQueue,r===null?o.updateQueue=new Set([f]):r.add(f),nf(t,f,p)),!1;case 22:return o.flags|=65536,f===_c?o.flags|=16384:(r=o.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([f])},o.updateQueue=r):(o=r.retryQueue,o===null?r.retryQueue=new Set([f]):o.add(f)),nf(t,f,p)),!1}throw Error(h(435,o.tag))}return nf(t,f,p),Fc(),!1}if(xt)return r=Ms.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=p,f!==Jh&&(t=Error(h(422),{cause:f}),Vl(js(t,o)))):(f!==Jh&&(r=Error(h(423),{cause:f}),Vl(js(r,o))),t=t.current.alternate,t.flags|=65536,p&=-p,t.lanes|=p,f=js(f,o),p=Bu(t.stateNode,f,p),cu(t,p),ci!==4&&(ci=2)),!1;var v=Error(h(520),{cause:f});if(v=js(v,o),lo===null?lo=[v]:lo.push(v),ci!==4&&(ci=2),r===null)return!0;f=js(f,o),o=r;do{switch(o.tag){case 3:return o.flags|=65536,t=p&-p,o.lanes|=t,t=Bu(o.stateNode,f,t),cu(o,t),!1;case 1:if(r=o.type,v=o.stateNode,(o.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Ln===null||!Ln.has(v))))return o.flags|=65536,p&=-p,o.lanes|=p,p=c1(p),h1(p,t,o,f),cu(o,p),!1}o=o.return}while(o!==null);return!1}var Iu=Error(h(461)),bi=!1;function Zi(t,r,o,f){r.child=t===null?g0(r,null,o,f):Sa(r,t.child,o,f)}function u1(t,r,o,f,p){o=o.render;var v=r.ref;if("ref"in f){var A={};for(var O in f)O!=="ref"&&(A[O]=f[O])}else A=f;return ma(r),f=_u(t,r,o,A,v,p),O=mu(),t!==null&&!bi?(pu(t,r,p),jr(t,r,p)):(xt&&O&&Zh(r),r.flags|=1,Zi(t,r,f,p),r.child)}function f1(t,r,o,f,p){if(t===null){var v=o.type;return typeof v=="function"&&!jh(v)&&v.defaultProps===void 0&&o.compare===null?(r.tag=15,r.type=v,d1(t,r,v,f,p)):(t=cc(o.type,null,f,r,r.mode,p),t.ref=r.ref,t.return=r,r.child=t)}if(v=t.child,!Vu(t,p)){var A=v.memoizedProps;if(o=o.compare,o=o!==null?o:_,o(A,f)&&t.ref===r.ref)return jr(t,r,p)}return r.flags|=1,t=Ur(v,f),t.ref=r.ref,t.return=r,r.child=t}function d1(t,r,o,f,p){if(t!==null){var v=t.memoizedProps;if(_(v,f)&&t.ref===r.ref)if(bi=!1,r.pendingProps=f=v,Vu(t,p))(t.flags&131072)!==0&&(bi=!0);else return r.lanes=t.lanes,jr(t,r,p)}return ku(t,r,o,f,p)}function g1(t,r,o,f){var p=f.children,v=t!==null?t.memoizedState:null;if(t===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((r.flags&128)!==0){if(v=v!==null?v.baseLanes|o:o,t!==null){for(f=r.child=t.child,p=0;f!==null;)p=p|f.lanes|f.childLanes,f=f.sibling;f=p&~v}else f=0,r.child=null;return _1(t,r,v,o,f)}if((o&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&dc(r,v!==null?v.cachePool:null),v!==null?p0(r,v):uu(),x0(r);else return f=r.lanes=536870912,_1(t,r,v!==null?v.baseLanes|o:o,o,f)}else v!==null?(dc(r,v.cachePool),p0(r,v),Mn(),r.memoizedState=null):(t!==null&&dc(r,null),uu(),Mn());return Zi(t,r,p,o),r.child}function eo(t,r){return t!==null&&t.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function _1(t,r,o,f,p){var v=nu();return v=v===null?null:{parent:yi._currentValue,pool:v},r.memoizedState={baseLanes:o,cachePool:v},t!==null&&dc(r,null),uu(),x0(r),t!==null&&Ja(t,r,f,!0),r.childLanes=p,null}function Nc(t,r){return r=Oc({mode:r.mode,children:r.children},t.mode),r.ref=t.ref,t.child=r,r.return=t,r}function m1(t,r,o){return Sa(r,t.child,null,o),t=Nc(r,r.pendingProps),t.flags|=2,Bs(r),r.memoizedState=null,t}function zm(t,r,o){var f=r.pendingProps,p=(r.flags&128)!==0;if(r.flags&=-129,t===null){if(xt){if(f.mode==="hidden")return t=Nc(r,f),r.lanes=536870912,eo(null,t);if(du(r),(t=qt)?(t=Rg(t,Zs),t=t!==null&&t.data==="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:Cn!==null?{id:wr,overflow:br}:null,retryLane:536870912,hydrationErrors:null},o=$d(t),o.return=r,r.child=o,qi=r,qt=null)):t=null,t===null)throw An(r);return r.lanes=536870912,null}return Nc(r,f)}var v=t.memoizedState;if(v!==null){var A=v.dehydrated;if(du(r),p)if(r.flags&256)r.flags&=-257,r=m1(t,r,o);else if(r.memoizedState!==null)r.child=t.child,r.flags|=128,r=null;else throw Error(h(558));else if(bi||Ja(t,r,o,!1),p=(o&t.childLanes)!==0,bi||p){if(f=Vt,f!==null&&(A=La(f,o),A!==0&&A!==v.retryLane))throw v.retryLane=A,fa(t,A),ws(f,t,A),Iu;Fc(),r=m1(t,r,o)}else t=v.treeContext,qt=Js(A.nextSibling),qi=r,xt=!0,En=null,Zs=!1,t!==null&&i0(r,t),r=Nc(r,f),r.flags|=4096;return r}return t=Ur(t.child,{mode:f.mode,children:f.children}),t.ref=r.ref,r.child=t,t.return=r,t}function Dc(t,r){var o=r.ref;if(o===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(h(284));(t===null||t.ref!==o)&&(r.flags|=4194816)}}function ku(t,r,o,f,p){return ma(r),o=_u(t,r,o,f,void 0,p),f=mu(),t!==null&&!bi?(pu(t,r,p),jr(t,r,p)):(xt&&f&&Zh(r),r.flags|=1,Zi(t,r,o,p),r.child)}function p1(t,r,o,f,p,v){return ma(r),r.updateQueue=null,o=S0(r,f,o,p),v0(t),f=mu(),t!==null&&!bi?(pu(t,r,v),jr(t,r,v)):(xt&&f&&Zh(r),r.flags|=1,Zi(t,r,o,v),r.child)}function x1(t,r,o,f,p){if(ma(r),r.stateNode===null){var v=qa,A=o.contextType;typeof A=="object"&&A!==null&&(v=Ki(A)),v=new o(f,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Mu,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=f,v.state=r.memoizedState,v.refs={},lu(r),A=o.contextType,v.context=typeof A=="object"&&A!==null?Ki(A):qa,v.state=r.memoizedState,A=o.getDerivedStateFromProps,typeof A=="function"&&(Ou(r,o,A,f),v.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(A=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),A!==v.state&&Mu.enqueueReplaceState(v,v.state,null),Kl(r,f,v,p),ql(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),f=!0}else if(t===null){v=r.stateNode;var O=r.memoizedProps,z=wa(o,O);v.props=z;var J=v.context,ce=o.contextType;A=qa,typeof ce=="object"&&ce!==null&&(A=Ki(ce));var ge=o.getDerivedStateFromProps;ce=typeof ge=="function"||typeof v.getSnapshotBeforeUpdate=="function",O=r.pendingProps!==O,ce||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(O||J!==A)&&r1(r,v,f,A),Rn=!1;var $=r.memoizedState;v.state=$,Kl(r,f,v,p),ql(),J=r.memoizedState,O||$!==J||Rn?(typeof ge=="function"&&(Ou(r,o,ge,f),J=r.memoizedState),(z=Rn||s1(r,o,z,f,$,J,A))?(ce||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=f,r.memoizedState=J),v.props=f,v.state=J,v.context=A,f=z):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),f=!1)}else{v=r.stateNode,ou(t,r),A=r.memoizedProps,ce=wa(o,A),v.props=ce,ge=r.pendingProps,$=v.context,J=o.contextType,z=qa,typeof J=="object"&&J!==null&&(z=Ki(J)),O=o.getDerivedStateFromProps,(J=typeof O=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(A!==ge||$!==z)&&r1(r,v,f,z),Rn=!1,$=r.memoizedState,v.state=$,Kl(r,f,v,p),ql();var ne=r.memoizedState;A!==ge||$!==ne||Rn||t!==null&&t.dependencies!==null&&uc(t.dependencies)?(typeof O=="function"&&(Ou(r,o,O,f),ne=r.memoizedState),(ce=Rn||s1(r,o,ce,f,$,ne,z)||t!==null&&t.dependencies!==null&&uc(t.dependencies))?(J||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,ne,z),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,ne,z)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||A===t.memoizedProps&&$===t.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===t.memoizedProps&&$===t.memoizedState||(r.flags|=1024),r.memoizedProps=f,r.memoizedState=ne),v.props=f,v.state=ne,v.context=z,f=ce):(typeof v.componentDidUpdate!="function"||A===t.memoizedProps&&$===t.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||A===t.memoizedProps&&$===t.memoizedState||(r.flags|=1024),f=!1)}return v=f,Dc(t,r),f=(r.flags&128)!==0,v||f?(v=r.stateNode,o=f&&typeof o.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,t!==null&&f?(r.child=Sa(r,t.child,null,p),r.child=Sa(r,null,o,p)):Zi(t,r,o,p),r.memoizedState=v.state,t=r.child):t=jr(t,r,p),t}function v1(t,r,o,f){return ga(),r.flags|=256,Zi(t,r,o,f),r.child}var Lu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pu(t){return{baseLanes:t,cachePool:o0()}}function Hu(t,r,o){return t=t!==null?t.childLanes&~o:0,r&&(t|=ks),t}function S1(t,r,o){var f=r.pendingProps,p=!1,v=(r.flags&128)!==0,A;if((A=v)||(A=t!==null&&t.memoizedState===null?!1:(mi.current&2)!==0),A&&(p=!0,r.flags&=-129),A=(r.flags&32)!==0,r.flags&=-33,t===null){if(xt){if(p?On(r):Mn(),(t=qt)?(t=Rg(t,Zs),t=t!==null&&t.data!=="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:Cn!==null?{id:wr,overflow:br}:null,retryLane:536870912,hydrationErrors:null},o=$d(t),o.return=r,r.child=o,qi=r,qt=null)):t=null,t===null)throw An(r);return yf(t)?r.lanes=32:r.lanes=536870912,null}var O=f.children;return f=f.fallback,p?(Mn(),p=r.mode,O=Oc({mode:"hidden",children:O},p),f=da(f,p,o,null),O.return=r,f.return=r,O.sibling=f,r.child=O,f=r.child,f.memoizedState=Pu(o),f.childLanes=Hu(t,A,o),r.memoizedState=Lu,eo(null,f)):(On(r),zu(r,O))}var z=t.memoizedState;if(z!==null&&(O=z.dehydrated,O!==null)){if(v)r.flags&256?(On(r),r.flags&=-257,r=Fu(t,r,o)):r.memoizedState!==null?(Mn(),r.child=t.child,r.flags|=128,r=null):(Mn(),O=f.fallback,p=r.mode,f=Oc({mode:"visible",children:f.children},p),O=da(O,p,o,null),O.flags|=2,f.return=r,O.return=r,f.sibling=O,r.child=f,Sa(r,t.child,null,o),f=r.child,f.memoizedState=Pu(o),f.childLanes=Hu(t,A,o),r.memoizedState=Lu,r=eo(null,f));else if(On(r),yf(O)){if(A=O.nextSibling&&O.nextSibling.dataset,A)var J=A.dgst;A=J,f=Error(h(419)),f.stack="",f.digest=A,Vl({value:f,source:null,stack:null}),r=Fu(t,r,o)}else if(bi||Ja(t,r,o,!1),A=(o&t.childLanes)!==0,bi||A){if(A=Vt,A!==null&&(f=La(A,o),f!==0&&f!==z.retryLane))throw z.retryLane=f,fa(t,f),ws(A,t,f),Iu;Sf(O)||Fc(),r=Fu(t,r,o)}else Sf(O)?(r.flags|=192,r.child=t.child,r=null):(t=z.treeContext,qt=Js(O.nextSibling),qi=r,xt=!0,En=null,Zs=!1,t!==null&&i0(r,t),r=zu(r,f.children),r.flags|=4096);return r}return p?(Mn(),O=f.fallback,p=r.mode,z=t.child,J=z.sibling,f=Ur(z,{mode:"hidden",children:f.children}),f.subtreeFlags=z.subtreeFlags&65011712,J!==null?O=Ur(J,O):(O=da(O,p,o,null),O.flags|=2),O.return=r,f.return=r,f.sibling=O,r.child=f,eo(null,f),f=r.child,O=t.child.memoizedState,O===null?O=Pu(o):(p=O.cachePool,p!==null?(z=yi._currentValue,p=p.parent!==z?{parent:z,pool:z}:p):p=o0(),O={baseLanes:O.baseLanes|o,cachePool:p}),f.memoizedState=O,f.childLanes=Hu(t,A,o),r.memoizedState=Lu,eo(t.child,f)):(On(r),o=t.child,t=o.sibling,o=Ur(o,{mode:"visible",children:f.children}),o.return=r,o.sibling=null,t!==null&&(A=r.deletions,A===null?(r.deletions=[t],r.flags|=16):A.push(t)),r.child=o,r.memoizedState=null,o)}function zu(t,r){return r=Oc({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function Oc(t,r){return t=Os(22,t,null,r),t.lanes=0,t}function Fu(t,r,o){return Sa(r,t.child,null,o),t=zu(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function y1(t,r,o){t.lanes|=r;var f=t.alternate;f!==null&&(f.lanes|=r),tu(t.return,r,o)}function Uu(t,r,o,f,p,v){var A=t.memoizedState;A===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:f,tail:o,tailMode:p,treeForkCount:v}:(A.isBackwards=r,A.rendering=null,A.renderingStartTime=0,A.last=f,A.tail=o,A.tailMode=p,A.treeForkCount=v)}function w1(t,r,o){var f=r.pendingProps,p=f.revealOrder,v=f.tail;f=f.children;var A=mi.current,O=(A&2)!==0;if(O?(A=A&1|2,r.flags|=128):A&=1,ye(mi,A),Zi(t,r,f,o),f=xt?Ul:0,!O&&t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&y1(t,o,r);else if(t.tag===19)y1(t,o,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(p){case"forwards":for(o=r.child,p=null;o!==null;)t=o.alternate,t!==null&&vc(t)===null&&(p=o),o=o.sibling;o=p,o===null?(p=r.child,r.child=null):(p=o.sibling,o.sibling=null),Uu(r,!1,p,o,v,f);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=r.child,r.child=null;p!==null;){if(t=p.alternate,t!==null&&vc(t)===null){r.child=p;break}t=p.sibling,p.sibling=o,o=p,p=t}Uu(r,!0,o,null,v,f);break;case"together":Uu(r,!1,null,null,void 0,f);break;default:r.memoizedState=null}return r.child}function jr(t,r,o){if(t!==null&&(r.dependencies=t.dependencies),kn|=r.lanes,(o&r.childLanes)===0)if(t!==null){if(Ja(t,r,o,!1),(o&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(h(153));if(r.child!==null){for(t=r.child,o=Ur(t,t.pendingProps),r.child=o,o.return=r;t.sibling!==null;)t=t.sibling,o=o.sibling=Ur(t,t.pendingProps),o.return=r;o.sibling=null}return r.child}function Vu(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&uc(t)))}function Fm(t,r,o){switch(r.tag){case 3:ot(r,r.stateNode.containerInfo),Tn(r,yi,t.memoizedState.cache),ga();break;case 27:case 5:$i(r);break;case 4:ot(r,r.stateNode.containerInfo);break;case 10:Tn(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,du(r),null;break;case 13:var f=r.memoizedState;if(f!==null)return f.dehydrated!==null?(On(r),r.flags|=128,null):(o&r.child.childLanes)!==0?S1(t,r,o):(On(r),t=jr(t,r,o),t!==null?t.sibling:null);On(r);break;case 19:var p=(t.flags&128)!==0;if(f=(o&r.childLanes)!==0,f||(Ja(t,r,o,!1),f=(o&r.childLanes)!==0),p){if(f)return w1(t,r,o);r.flags|=128}if(p=r.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),ye(mi,mi.current),f)break;return null;case 22:return r.lanes=0,g1(t,r,o,r.pendingProps);case 24:Tn(r,yi,t.memoizedState.cache)}return jr(t,r,o)}function b1(t,r,o){if(t!==null)if(t.memoizedProps!==r.pendingProps)bi=!0;else{if(!Vu(t,o)&&(r.flags&128)===0)return bi=!1,Fm(t,r,o);bi=(t.flags&131072)!==0}else bi=!1,xt&&(r.flags&1048576)!==0&&t0(r,Ul,r.index);switch(r.lanes=0,r.tag){case 16:e:{var f=r.pendingProps;if(t=xa(r.elementType),r.type=t,typeof t=="function")jh(t)?(f=wa(t,f),r.tag=1,r=x1(null,r,t,f,o)):(r.tag=0,r=ku(null,r,t,f,o));else{if(t!=null){var p=t.$$typeof;if(p===le){r.tag=11,r=u1(null,r,t,f,o);break e}else if(p===Y){r.tag=14,r=f1(null,r,t,f,o);break e}}throw r=Ee(t)||t,Error(h(306,r,""))}}return r;case 0:return ku(t,r,r.type,r.pendingProps,o);case 1:return f=r.type,p=wa(f,r.pendingProps),x1(t,r,f,p,o);case 3:e:{if(ot(r,r.stateNode.containerInfo),t===null)throw Error(h(387));f=r.pendingProps;var v=r.memoizedState;p=v.element,ou(t,r),Kl(r,f,null,o);var A=r.memoizedState;if(f=A.cache,Tn(r,yi,f),f!==v.cache&&iu(r,[yi],o,!0),ql(),f=A.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:A.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=v1(t,r,f,o);break e}else if(f!==p){p=js(Error(h(424)),r),Vl(p),r=v1(t,r,f,o);break e}else for(t=r.stateNode.containerInfo,t.nodeType===9?t=t.body:t=t.nodeName==="HTML"?t.ownerDocument.body:t,qt=Js(t.firstChild),qi=r,xt=!0,En=null,Zs=!0,o=g0(r,null,f,o),r.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(ga(),f===p){r=jr(t,r,o);break e}Zi(t,r,f,o)}r=r.child}return r;case 26:return Dc(t,r),t===null?(o=Ig(r.type,null,r.pendingProps,null))?r.memoizedState=o:xt||(o=r.type,t=r.pendingProps,f=jc(Se.current).createElement(o),f[di]=r,f[Ot]=t,Qi(f,o,t),ai(f),r.stateNode=f):r.memoizedState=Ig(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return $i(r),t===null&&xt&&(f=r.stateNode=Og(r.type,r.pendingProps,Se.current),qi=r,Zs=!0,p=qt,Fn(r.type)?(wf=p,qt=Js(f.firstChild)):qt=p),Zi(t,r,r.pendingProps.children,o),Dc(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&xt&&((p=f=qt)&&(f=mp(f,r.type,r.pendingProps,Zs),f!==null?(r.stateNode=f,qi=r,qt=Js(f.firstChild),Zs=!1,p=!0):p=!1),p||An(r)),$i(r),p=r.type,v=r.pendingProps,A=t!==null?t.memoizedProps:null,f=v.children,pf(p,v)?f=null:A!==null&&pf(p,A)&&(r.flags|=32),r.memoizedState!==null&&(p=_u(t,r,Om,null,null,o),mo._currentValue=p),Dc(t,r),Zi(t,r,f,o),r.child;case 6:return t===null&&xt&&((t=o=qt)&&(o=pp(o,r.pendingProps,Zs),o!==null?(r.stateNode=o,qi=r,qt=null,t=!0):t=!1),t||An(r)),null;case 13:return S1(t,r,o);case 4:return ot(r,r.stateNode.containerInfo),f=r.pendingProps,t===null?r.child=Sa(r,null,f,o):Zi(t,r,f,o),r.child;case 11:return u1(t,r,r.type,r.pendingProps,o);case 7:return Zi(t,r,r.pendingProps,o),r.child;case 8:return Zi(t,r,r.pendingProps.children,o),r.child;case 12:return Zi(t,r,r.pendingProps.children,o),r.child;case 10:return f=r.pendingProps,Tn(r,r.type,f.value),Zi(t,r,f.children,o),r.child;case 9:return p=r.type._context,f=r.pendingProps.children,ma(r),p=Ki(p),f=f(p),r.flags|=1,Zi(t,r,f,o),r.child;case 14:return f1(t,r,r.type,r.pendingProps,o);case 15:return d1(t,r,r.type,r.pendingProps,o);case 19:return w1(t,r,o);case 31:return zm(t,r,o);case 22:return g1(t,r,o,r.pendingProps);case 24:return ma(r),f=Ki(yi),t===null?(p=nu(),p===null&&(p=Vt,v=su(),p.pooledCache=v,v.refCount++,v!==null&&(p.pooledCacheLanes|=o),p=v),r.memoizedState={parent:f,cache:p},lu(r),Tn(r,yi,p)):((t.lanes&o)!==0&&(ou(t,r),Kl(r,null,null,o),ql()),p=t.memoizedState,v=r.memoizedState,p.parent!==f?(p={parent:f,cache:f},r.memoizedState=p,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=p),Tn(r,yi,f)):(f=v.cache,Tn(r,yi,f),f!==p.cache&&iu(r,[yi],o,!0))),Zi(t,r,r.pendingProps.children,o),r.child;case 29:throw r.pendingProps}throw Error(h(156,r.tag))}function qr(t){t.flags|=4}function Wu(t,r,o,f,p){if((r=(t.mode&32)!==0)&&(r=!1),r){if(t.flags|=16777216,(p&335544128)===p)if(t.stateNode.complete)t.flags|=8192;else if(Z1())t.flags|=8192;else throw va=_c,au}else t.flags&=-16777217}function C1(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!zg(r))if(Z1())t.flags|=8192;else throw va=_c,au}function Mc(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?Ri():536870912,t.lanes|=r,hl|=r)}function to(t,r){if(!xt)switch(t.tailMode){case"hidden":r=t.tail;for(var o=null;r!==null;)r.alternate!==null&&(o=r),r=r.sibling;o===null?t.tail=null:o.sibling=null;break;case"collapsed":o=t.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:f.sibling=null}}function Kt(t){var r=t.alternate!==null&&t.alternate.child===t.child,o=0,f=0;if(r)for(var p=t.child;p!==null;)o|=p.lanes|p.childLanes,f|=p.subtreeFlags&65011712,f|=p.flags&65011712,p.return=t,p=p.sibling;else for(p=t.child;p!==null;)o|=p.lanes|p.childLanes,f|=p.subtreeFlags,f|=p.flags,p.return=t,p=p.sibling;return t.subtreeFlags|=f,t.childLanes=o,r}function Um(t,r,o){var f=r.pendingProps;switch(Qh(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(r),null;case 1:return Kt(r),null;case 3:return o=r.stateNode,f=null,t!==null&&(f=t.memoizedState.cache),r.memoizedState.cache!==f&&(r.flags|=2048),Gr(yi),dt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(t===null||t.child===null)&&(Qa(r)?qr(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,$h())),Kt(r),null;case 26:var p=r.type,v=r.memoizedState;return t===null?(qr(r),v!==null?(Kt(r),C1(r,v)):(Kt(r),Wu(r,p,null,f,o))):v?v!==t.memoizedState?(qr(r),Kt(r),C1(r,v)):(Kt(r),r.flags&=-16777217):(t=t.memoizedProps,t!==f&&qr(r),Kt(r),Wu(r,p,t,f,o)),null;case 27:if(Xt(r),o=Se.current,p=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==f&&qr(r);else{if(!f){if(r.stateNode===null)throw Error(h(166));return Kt(r),null}t=be.current,Qa(r)?s0(r):(t=Og(p,f,o),r.stateNode=t,qr(r))}return Kt(r),null;case 5:if(Xt(r),p=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==f&&qr(r);else{if(!f){if(r.stateNode===null)throw Error(h(166));return Kt(r),null}if(v=be.current,Qa(r))s0(r);else{var A=jc(Se.current);switch(v){case 1:v=A.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:v=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":v=A.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":v=A.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":v=A.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof f.is=="string"?A.createElement("select",{is:f.is}):A.createElement("select"),f.multiple?v.multiple=!0:f.size&&(v.size=f.size);break;default:v=typeof f.is=="string"?A.createElement(p,{is:f.is}):A.createElement(p)}}v[di]=r,v[Ot]=f;e:for(A=r.child;A!==null;){if(A.tag===5||A.tag===6)v.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===r)break e;for(;A.sibling===null;){if(A.return===null||A.return===r)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}r.stateNode=v;e:switch(Qi(v,p,f),p){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&qr(r)}}return Kt(r),Wu(r,r.type,t===null?null:t.memoizedProps,r.pendingProps,o),null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==f&&qr(r);else{if(typeof f!="string"&&r.stateNode===null)throw Error(h(166));if(t=Se.current,Qa(r)){if(t=r.stateNode,o=r.memoizedProps,f=null,p=qi,p!==null)switch(p.tag){case 27:case 5:f=p.memoizedProps}t[di]=r,t=!!(t.nodeValue===o||f!==null&&f.suppressHydrationWarning===!0||Sg(t.nodeValue,o)),t||An(r,!0)}else t=jc(t).createTextNode(f),t[di]=r,r.stateNode=t}return Kt(r),null;case 31:if(o=r.memoizedState,t===null||t.memoizedState!==null){if(f=Qa(r),o!==null){if(t===null){if(!f)throw Error(h(318));if(t=r.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(h(557));t[di]=r}else ga(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Kt(r),t=!1}else o=$h(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=o),t=!0;if(!t)return r.flags&256?(Bs(r),r):(Bs(r),null);if((r.flags&128)!==0)throw Error(h(558))}return Kt(r),null;case 13:if(f=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(p=Qa(r),f!==null&&f.dehydrated!==null){if(t===null){if(!p)throw Error(h(318));if(p=r.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(h(317));p[di]=r}else ga(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Kt(r),p=!1}else p=$h(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=p),p=!0;if(!p)return r.flags&256?(Bs(r),r):(Bs(r),null)}return Bs(r),(r.flags&128)!==0?(r.lanes=o,r):(o=f!==null,t=t!==null&&t.memoizedState!==null,o&&(f=r.child,p=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(p=f.alternate.memoizedState.cachePool.pool),v=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==p&&(f.flags|=2048)),o!==t&&o&&(r.child.flags|=8192),Mc(r,r.updateQueue),Kt(r),null);case 4:return dt(),t===null&&ff(r.stateNode.containerInfo),Kt(r),null;case 10:return Gr(r.type),Kt(r),null;case 19:if(re(mi),f=r.memoizedState,f===null)return Kt(r),null;if(p=(r.flags&128)!==0,v=f.rendering,v===null)if(p)to(f,!1);else{if(ci!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(v=vc(t),v!==null){for(r.flags|=128,to(f,!1),t=v.updateQueue,r.updateQueue=t,Mc(r,t),r.subtreeFlags=0,t=o,o=r.child;o!==null;)Jd(o,t),o=o.sibling;return ye(mi,mi.current&1|2),xt&&Vr(r,f.treeForkCount),r.child}t=t.sibling}f.tail!==null&&ti()>Pc&&(r.flags|=128,p=!0,to(f,!1),r.lanes=4194304)}else{if(!p)if(t=vc(v),t!==null){if(r.flags|=128,p=!0,t=t.updateQueue,r.updateQueue=t,Mc(r,t),to(f,!0),f.tail===null&&f.tailMode==="hidden"&&!v.alternate&&!xt)return Kt(r),null}else 2*ti()-f.renderingStartTime>Pc&&o!==536870912&&(r.flags|=128,p=!0,to(f,!1),r.lanes=4194304);f.isBackwards?(v.sibling=r.child,r.child=v):(t=f.last,t!==null?t.sibling=v:r.child=v,f.last=v)}return f.tail!==null?(t=f.tail,f.rendering=t,f.tail=t.sibling,f.renderingStartTime=ti(),t.sibling=null,o=mi.current,ye(mi,p?o&1|2:o&1),xt&&Vr(r,f.treeForkCount),t):(Kt(r),null);case 22:case 23:return Bs(r),fu(),f=r.memoizedState!==null,t!==null?t.memoizedState!==null!==f&&(r.flags|=8192):f&&(r.flags|=8192),f?(o&536870912)!==0&&(r.flags&128)===0&&(Kt(r),r.subtreeFlags&6&&(r.flags|=8192)):Kt(r),o=r.updateQueue,o!==null&&Mc(r,o.retryQueue),o=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),f=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(f=r.memoizedState.cachePool.pool),f!==o&&(r.flags|=2048),t!==null&&re(pa),null;case 24:return o=null,t!==null&&(o=t.memoizedState.cache),r.memoizedState.cache!==o&&(r.flags|=2048),Gr(yi),Kt(r),null;case 25:return null;case 30:return null}throw Error(h(156,r.tag))}function Vm(t,r){switch(Qh(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return Gr(yi),dt(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return Xt(r),null;case 31:if(r.memoizedState!==null){if(Bs(r),r.alternate===null)throw Error(h(340));ga()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 13:if(Bs(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(h(340));ga()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return re(mi),null;case 4:return dt(),null;case 10:return Gr(r.type),null;case 22:case 23:return Bs(r),fu(),t!==null&&re(pa),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return Gr(yi),null;case 25:return null;default:return null}}function E1(t,r){switch(Qh(r),r.tag){case 3:Gr(yi),dt();break;case 26:case 27:case 5:Xt(r);break;case 4:dt();break;case 31:r.memoizedState!==null&&Bs(r);break;case 13:Bs(r);break;case 19:re(mi);break;case 10:Gr(r.type);break;case 22:case 23:Bs(r),fu(),t!==null&&re(pa);break;case 24:Gr(yi)}}function io(t,r){try{var o=r.updateQueue,f=o!==null?o.lastEffect:null;if(f!==null){var p=f.next;o=p;do{if((o.tag&t)===t){f=void 0;var v=o.create,A=o.inst;f=v(),A.destroy=f}o=o.next}while(o!==p)}}catch(O){Bt(r,r.return,O)}}function Bn(t,r,o){try{var f=r.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var v=p.next;f=v;do{if((f.tag&t)===t){var A=f.inst,O=A.destroy;if(O!==void 0){A.destroy=void 0,p=r;var z=o,J=O;try{J()}catch(ce){Bt(p,z,ce)}}}f=f.next}while(f!==v)}}catch(ce){Bt(r,r.return,ce)}}function A1(t){var r=t.updateQueue;if(r!==null){var o=t.stateNode;try{m0(r,o)}catch(f){Bt(t,t.return,f)}}}function T1(t,r,o){o.props=wa(t.type,t.memoizedProps),o.state=t.memoizedState;try{o.componentWillUnmount()}catch(f){Bt(t,r,f)}}function so(t,r){try{var o=t.ref;if(o!==null){switch(t.tag){case 26:case 27:case 5:var f=t.stateNode;break;case 30:f=t.stateNode;break;default:f=t.stateNode}typeof o=="function"?t.refCleanup=o(f):o.current=f}}catch(p){Bt(t,r,p)}}function Cr(t,r){var o=t.ref,f=t.refCleanup;if(o!==null)if(typeof f=="function")try{f()}catch(p){Bt(t,r,p)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){Bt(t,r,p)}else o.current=null}function R1(t){var r=t.type,o=t.memoizedProps,f=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":o.autoFocus&&f.focus();break e;case"img":o.src?f.src=o.src:o.srcSet&&(f.srcset=o.srcSet)}}catch(p){Bt(t,t.return,p)}}function Gu(t,r,o){try{var f=t.stateNode;hp(f,t.type,o,r),f[Ot]=r}catch(p){Bt(t,t.return,p)}}function N1(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Fn(t.type)||t.tag===4}function Xu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||N1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Fn(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Yu(t,r,o){var f=t.tag;if(f===5||f===6)t=t.stateNode,r?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(t,r):(r=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,r.appendChild(t),o=o._reactRootContainer,o!=null||r.onclick!==null||(r.onclick=_s));else if(f!==4&&(f===27&&Fn(t.type)&&(o=t.stateNode,r=null),t=t.child,t!==null))for(Yu(t,r,o),t=t.sibling;t!==null;)Yu(t,r,o),t=t.sibling}function Bc(t,r,o){var f=t.tag;if(f===5||f===6)t=t.stateNode,r?o.insertBefore(t,r):o.appendChild(t);else if(f!==4&&(f===27&&Fn(t.type)&&(o=t.stateNode),t=t.child,t!==null))for(Bc(t,r,o),t=t.sibling;t!==null;)Bc(t,r,o),t=t.sibling}function D1(t){var r=t.stateNode,o=t.memoizedProps;try{for(var f=t.type,p=r.attributes;p.length;)r.removeAttributeNode(p[0]);Qi(r,f,o),r[di]=t,r[Ot]=o}catch(v){Bt(t,t.return,v)}}var Kr=!1,Ci=!1,ju=!1,O1=typeof WeakSet=="function"?WeakSet:Set,Hi=null;function Wm(t,r){if(t=t.containerInfo,_f=eh,t=R(t),D(t)){if("selectionStart"in t)var o={start:t.selectionStart,end:t.selectionEnd};else e:{o=(o=t.ownerDocument)&&o.defaultView||window;var f=o.getSelection&&o.getSelection();if(f&&f.rangeCount!==0){o=f.anchorNode;var p=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{o.nodeType,v.nodeType}catch{o=null;break e}var A=0,O=-1,z=-1,J=0,ce=0,ge=t,$=null;t:for(;;){for(var ne;ge!==o||p!==0&&ge.nodeType!==3||(O=A+p),ge!==v||f!==0&&ge.nodeType!==3||(z=A+f),ge.nodeType===3&&(A+=ge.nodeValue.length),(ne=ge.firstChild)!==null;)$=ge,ge=ne;for(;;){if(ge===t)break t;if($===o&&++J===p&&(O=A),$===v&&++ce===f&&(z=A),(ne=ge.nextSibling)!==null)break;ge=$,$=ge.parentNode}ge=ne}o=O===-1||z===-1?null:{start:O,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(mf={focusedElem:t,selectionRange:o},eh=!1,Hi=r;Hi!==null;)if(r=Hi,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,Hi=t;else for(;Hi!==null;){switch(r=Hi,v=r.alternate,t=r.flags,r.tag){case 0:if((t&4)!==0&&(t=r.updateQueue,t=t!==null?t.events:null,t!==null))for(o=0;o<t.length;o++)p=t[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&v!==null){t=void 0,o=r,p=v.memoizedProps,v=v.memoizedState,f=o.stateNode;try{var He=wa(o.type,p);t=f.getSnapshotBeforeUpdate(He,v),f.__reactInternalSnapshotBeforeUpdate=t}catch(qe){Bt(o,o.return,qe)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,o=t.nodeType,o===9)vf(t);else if(o===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":vf(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(h(163))}if(t=r.sibling,t!==null){t.return=r.return,Hi=t;break}Hi=r.return}}function M1(t,r,o){var f=o.flags;switch(o.tag){case 0:case 11:case 15:Qr(t,o),f&4&&io(5,o);break;case 1:if(Qr(t,o),f&4)if(t=o.stateNode,r===null)try{t.componentDidMount()}catch(A){Bt(o,o.return,A)}else{var p=wa(o.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(p,r,t.__reactInternalSnapshotBeforeUpdate)}catch(A){Bt(o,o.return,A)}}f&64&&A1(o),f&512&&so(o,o.return);break;case 3:if(Qr(t,o),f&64&&(t=o.updateQueue,t!==null)){if(r=null,o.child!==null)switch(o.child.tag){case 27:case 5:r=o.child.stateNode;break;case 1:r=o.child.stateNode}try{m0(t,r)}catch(A){Bt(o,o.return,A)}}break;case 27:r===null&&f&4&&D1(o);case 26:case 5:Qr(t,o),r===null&&f&4&&R1(o),f&512&&so(o,o.return);break;case 12:Qr(t,o);break;case 31:Qr(t,o),f&4&&k1(t,o);break;case 13:Qr(t,o),f&4&&L1(t,o),f&64&&(t=o.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(o=Jm.bind(null,o),xp(t,o))));break;case 22:if(f=o.memoizedState!==null||Kr,!f){r=r!==null&&r.memoizedState!==null||Ci,p=Kr;var v=Ci;Kr=f,(Ci=r)&&!v?Jr(t,o,(o.subtreeFlags&8772)!==0):Qr(t,o),Kr=p,Ci=v}break;case 30:break;default:Qr(t,o)}}function B1(t){var r=t.alternate;r!==null&&(t.alternate=null,B1(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&gs(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var $t=null,xs=!1;function Zr(t,r,o){for(o=o.child;o!==null;)I1(t,r,o),o=o.sibling}function I1(t,r,o){if(Ae&&typeof Ae.onCommitFiberUnmount=="function")try{Ae.onCommitFiberUnmount(Wt,o)}catch{}switch(o.tag){case 26:Ci||Cr(o,r),Zr(t,r,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Ci||Cr(o,r);var f=$t,p=xs;Fn(o.type)&&($t=o.stateNode,xs=!1),Zr(t,r,o),fo(o.stateNode),$t=f,xs=p;break;case 5:Ci||Cr(o,r);case 6:if(f=$t,p=xs,$t=null,Zr(t,r,o),$t=f,xs=p,$t!==null)if(xs)try{($t.nodeType===9?$t.body:$t.nodeName==="HTML"?$t.ownerDocument.body:$t).removeChild(o.stateNode)}catch(v){Bt(o,r,v)}else try{$t.removeChild(o.stateNode)}catch(v){Bt(o,r,v)}break;case 18:$t!==null&&(xs?(t=$t,Ag(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,o.stateNode),xl(t)):Ag($t,o.stateNode));break;case 4:f=$t,p=xs,$t=o.stateNode.containerInfo,xs=!0,Zr(t,r,o),$t=f,xs=p;break;case 0:case 11:case 14:case 15:Bn(2,o,r),Ci||Bn(4,o,r),Zr(t,r,o);break;case 1:Ci||(Cr(o,r),f=o.stateNode,typeof f.componentWillUnmount=="function"&&T1(o,r,f)),Zr(t,r,o);break;case 21:Zr(t,r,o);break;case 22:Ci=(f=Ci)||o.memoizedState!==null,Zr(t,r,o),Ci=f;break;default:Zr(t,r,o)}}function k1(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{xl(t)}catch(o){Bt(r,r.return,o)}}}function L1(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{xl(t)}catch(o){Bt(r,r.return,o)}}function Gm(t){switch(t.tag){case 31:case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new O1),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new O1),r;default:throw Error(h(435,t.tag))}}function Ic(t,r){var o=Gm(t);r.forEach(function(f){if(!o.has(f)){o.add(f);var p=$m.bind(null,t,f);f.then(p,p)}})}function vs(t,r){var o=r.deletions;if(o!==null)for(var f=0;f<o.length;f++){var p=o[f],v=t,A=r,O=A;e:for(;O!==null;){switch(O.tag){case 27:if(Fn(O.type)){$t=O.stateNode,xs=!1;break e}break;case 5:$t=O.stateNode,xs=!1;break e;case 3:case 4:$t=O.stateNode.containerInfo,xs=!0;break e}O=O.return}if($t===null)throw Error(h(160));I1(v,A,p),$t=null,xs=!1,v=p.alternate,v!==null&&(v.return=null),p.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)P1(r,t),r=r.sibling}var fr=null;function P1(t,r){var o=t.alternate,f=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:vs(r,t),Ss(t),f&4&&(Bn(3,t,t.return),io(3,t),Bn(5,t,t.return));break;case 1:vs(r,t),Ss(t),f&512&&(Ci||o===null||Cr(o,o.return)),f&64&&Kr&&(t=t.updateQueue,t!==null&&(f=t.callbacks,f!==null&&(o=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=o===null?f:o.concat(f))));break;case 26:var p=fr;if(vs(r,t),Ss(t),f&512&&(Ci||o===null||Cr(o,o.return)),f&4){var v=o!==null?o.memoizedState:null;if(f=t.memoizedState,o===null)if(f===null)if(t.stateNode===null){e:{f=t.type,o=t.memoizedProps,p=p.ownerDocument||p;t:switch(f){case"title":v=p.getElementsByTagName("title")[0],(!v||v[sa]||v[di]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=p.createElement(f),p.head.insertBefore(v,p.querySelector("head > title"))),Qi(v,f,o),v[di]=t,ai(v),f=v;break e;case"link":var A=Pg("link","href",p).get(f+(o.href||""));if(A){for(var O=0;O<A.length;O++)if(v=A[O],v.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&v.getAttribute("rel")===(o.rel==null?null:o.rel)&&v.getAttribute("title")===(o.title==null?null:o.title)&&v.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){A.splice(O,1);break t}}v=p.createElement(f),Qi(v,f,o),p.head.appendChild(v);break;case"meta":if(A=Pg("meta","content",p).get(f+(o.content||""))){for(O=0;O<A.length;O++)if(v=A[O],v.getAttribute("content")===(o.content==null?null:""+o.content)&&v.getAttribute("name")===(o.name==null?null:o.name)&&v.getAttribute("property")===(o.property==null?null:o.property)&&v.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&v.getAttribute("charset")===(o.charSet==null?null:o.charSet)){A.splice(O,1);break t}}v=p.createElement(f),Qi(v,f,o),p.head.appendChild(v);break;default:throw Error(h(468,f))}v[di]=t,ai(v),f=v}t.stateNode=f}else Hg(p,t.type,t.stateNode);else t.stateNode=Lg(p,f,t.memoizedProps);else v!==f?(v===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):v.count--,f===null?Hg(p,t.type,t.stateNode):Lg(p,f,t.memoizedProps)):f===null&&t.stateNode!==null&&Gu(t,t.memoizedProps,o.memoizedProps)}break;case 27:vs(r,t),Ss(t),f&512&&(Ci||o===null||Cr(o,o.return)),o!==null&&f&4&&Gu(t,t.memoizedProps,o.memoizedProps);break;case 5:if(vs(r,t),Ss(t),f&512&&(Ci||o===null||Cr(o,o.return)),t.flags&32){p=t.stateNode;try{_n(p,"")}catch(He){Bt(t,t.return,He)}}f&4&&t.stateNode!=null&&(p=t.memoizedProps,Gu(t,p,o!==null?o.memoizedProps:p)),f&1024&&(ju=!0);break;case 6:if(vs(r,t),Ss(t),f&4){if(t.stateNode===null)throw Error(h(162));f=t.memoizedProps,o=t.stateNode;try{o.nodeValue=f}catch(He){Bt(t,t.return,He)}}break;case 3:if(Zc=null,p=fr,fr=qc(r.containerInfo),vs(r,t),fr=p,Ss(t),f&4&&o!==null&&o.memoizedState.isDehydrated)try{xl(r.containerInfo)}catch(He){Bt(t,t.return,He)}ju&&(ju=!1,H1(t));break;case 4:f=fr,fr=qc(t.stateNode.containerInfo),vs(r,t),Ss(t),fr=f;break;case 12:vs(r,t),Ss(t);break;case 31:vs(r,t),Ss(t),f&4&&(f=t.updateQueue,f!==null&&(t.updateQueue=null,Ic(t,f)));break;case 13:vs(r,t),Ss(t),t.child.flags&8192&&t.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Lc=ti()),f&4&&(f=t.updateQueue,f!==null&&(t.updateQueue=null,Ic(t,f)));break;case 22:p=t.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,J=Kr,ce=Ci;if(Kr=J||p,Ci=ce||z,vs(r,t),Ci=ce,Kr=J,Ss(t),f&8192)e:for(r=t.stateNode,r._visibility=p?r._visibility&-2:r._visibility|1,p&&(o===null||z||Kr||Ci||ba(t)),o=null,r=t;;){if(r.tag===5||r.tag===26){if(o===null){z=o=r;try{if(v=z.stateNode,p)A=v.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{O=z.stateNode;var ge=z.memoizedProps.style,$=ge!=null&&ge.hasOwnProperty("display")?ge.display:null;O.style.display=$==null||typeof $=="boolean"?"":(""+$).trim()}}catch(He){Bt(z,z.return,He)}}}else if(r.tag===6){if(o===null){z=r;try{z.stateNode.nodeValue=p?"":z.memoizedProps}catch(He){Bt(z,z.return,He)}}}else if(r.tag===18){if(o===null){z=r;try{var ne=z.stateNode;p?Tg(ne,!0):Tg(z.stateNode,!1)}catch(He){Bt(z,z.return,He)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;o===r&&(o=null),r=r.return}o===r&&(o=null),r.sibling.return=r.return,r=r.sibling}f&4&&(f=t.updateQueue,f!==null&&(o=f.retryQueue,o!==null&&(f.retryQueue=null,Ic(t,o))));break;case 19:vs(r,t),Ss(t),f&4&&(f=t.updateQueue,f!==null&&(t.updateQueue=null,Ic(t,f)));break;case 30:break;case 21:break;default:vs(r,t),Ss(t)}}function Ss(t){var r=t.flags;if(r&2){try{for(var o,f=t.return;f!==null;){if(N1(f)){o=f;break}f=f.return}if(o==null)throw Error(h(160));switch(o.tag){case 27:var p=o.stateNode,v=Xu(t);Bc(t,v,p);break;case 5:var A=o.stateNode;o.flags&32&&(_n(A,""),o.flags&=-33);var O=Xu(t);Bc(t,O,A);break;case 3:case 4:var z=o.stateNode.containerInfo,J=Xu(t);Yu(t,J,z);break;default:throw Error(h(161))}}catch(ce){Bt(t,t.return,ce)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function H1(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;H1(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function Qr(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)M1(t,r.alternate,r),r=r.sibling}function ba(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:Bn(4,r,r.return),ba(r);break;case 1:Cr(r,r.return);var o=r.stateNode;typeof o.componentWillUnmount=="function"&&T1(r,r.return,o),ba(r);break;case 27:fo(r.stateNode);case 26:case 5:Cr(r,r.return),ba(r);break;case 22:r.memoizedState===null&&ba(r);break;case 30:ba(r);break;default:ba(r)}t=t.sibling}}function Jr(t,r,o){for(o=o&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var f=r.alternate,p=t,v=r,A=v.flags;switch(v.tag){case 0:case 11:case 15:Jr(p,v,o),io(4,v);break;case 1:if(Jr(p,v,o),f=v,p=f.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(J){Bt(f,f.return,J)}if(f=v,p=f.updateQueue,p!==null){var O=f.stateNode;try{var z=p.shared.hiddenCallbacks;if(z!==null)for(p.shared.hiddenCallbacks=null,p=0;p<z.length;p++)_0(z[p],O)}catch(J){Bt(f,f.return,J)}}o&&A&64&&A1(v),so(v,v.return);break;case 27:D1(v);case 26:case 5:Jr(p,v,o),o&&f===null&&A&4&&R1(v),so(v,v.return);break;case 12:Jr(p,v,o);break;case 31:Jr(p,v,o),o&&A&4&&k1(p,v);break;case 13:Jr(p,v,o),o&&A&4&&L1(p,v);break;case 22:v.memoizedState===null&&Jr(p,v,o),so(v,v.return);break;case 30:break;default:Jr(p,v,o)}r=r.sibling}}function qu(t,r){var o=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(o=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==o&&(t!=null&&t.refCount++,o!=null&&Wl(o))}function Ku(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&Wl(t))}function dr(t,r,o,f){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)z1(t,r,o,f),r=r.sibling}function z1(t,r,o,f){var p=r.flags;switch(r.tag){case 0:case 11:case 15:dr(t,r,o,f),p&2048&&io(9,r);break;case 1:dr(t,r,o,f);break;case 3:dr(t,r,o,f),p&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&Wl(t)));break;case 12:if(p&2048){dr(t,r,o,f),t=r.stateNode;try{var v=r.memoizedProps,A=v.id,O=v.onPostCommit;typeof O=="function"&&O(A,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(z){Bt(r,r.return,z)}}else dr(t,r,o,f);break;case 31:dr(t,r,o,f);break;case 13:dr(t,r,o,f);break;case 23:break;case 22:v=r.stateNode,A=r.alternate,r.memoizedState!==null?v._visibility&2?dr(t,r,o,f):ro(t,r):v._visibility&2?dr(t,r,o,f):(v._visibility|=2,ll(t,r,o,f,(r.subtreeFlags&10256)!==0||!1)),p&2048&&qu(A,r);break;case 24:dr(t,r,o,f),p&2048&&Ku(r.alternate,r);break;default:dr(t,r,o,f)}}function ll(t,r,o,f,p){for(p=p&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var v=t,A=r,O=o,z=f,J=A.flags;switch(A.tag){case 0:case 11:case 15:ll(v,A,O,z,p),io(8,A);break;case 23:break;case 22:var ce=A.stateNode;A.memoizedState!==null?ce._visibility&2?ll(v,A,O,z,p):ro(v,A):(ce._visibility|=2,ll(v,A,O,z,p)),p&&J&2048&&qu(A.alternate,A);break;case 24:ll(v,A,O,z,p),p&&J&2048&&Ku(A.alternate,A);break;default:ll(v,A,O,z,p)}r=r.sibling}}function ro(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var o=t,f=r,p=f.flags;switch(f.tag){case 22:ro(o,f),p&2048&&qu(f.alternate,f);break;case 24:ro(o,f),p&2048&&Ku(f.alternate,f);break;default:ro(o,f)}r=r.sibling}}var no=8192;function ol(t,r,o){if(t.subtreeFlags&no)for(t=t.child;t!==null;)F1(t,r,o),t=t.sibling}function F1(t,r,o){switch(t.tag){case 26:ol(t,r,o),t.flags&no&&t.memoizedState!==null&&Dp(o,fr,t.memoizedState,t.memoizedProps);break;case 5:ol(t,r,o);break;case 3:case 4:var f=fr;fr=qc(t.stateNode.containerInfo),ol(t,r,o),fr=f;break;case 22:t.memoizedState===null&&(f=t.alternate,f!==null&&f.memoizedState!==null?(f=no,no=16777216,ol(t,r,o),no=f):ol(t,r,o));break;default:ol(t,r,o)}}function U1(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function ao(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var f=r[o];Hi=f,W1(f,t)}U1(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)V1(t),t=t.sibling}function V1(t){switch(t.tag){case 0:case 11:case 15:ao(t),t.flags&2048&&Bn(9,t,t.return);break;case 3:ao(t);break;case 12:ao(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,kc(t)):ao(t);break;default:ao(t)}}function kc(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var o=0;o<r.length;o++){var f=r[o];Hi=f,W1(f,t)}U1(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:Bn(8,r,r.return),kc(r);break;case 22:o=r.stateNode,o._visibility&2&&(o._visibility&=-3,kc(r));break;default:kc(r)}t=t.sibling}}function W1(t,r){for(;Hi!==null;){var o=Hi;switch(o.tag){case 0:case 11:case 15:Bn(8,o,r);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var f=o.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Wl(o.memoizedState.cache)}if(f=o.child,f!==null)f.return=o,Hi=f;else e:for(o=t;Hi!==null;){f=Hi;var p=f.sibling,v=f.return;if(B1(f),f===o){Hi=null;break e}if(p!==null){p.return=v,Hi=p;break e}Hi=v}}}var Xm={getCacheForType:function(t){var r=Ki(yi),o=r.data.get(t);return o===void 0&&(o=t(),r.data.set(t,o)),o},cacheSignal:function(){return Ki(yi).controller.signal}},Ym=typeof WeakMap=="function"?WeakMap:Map,At=0,Vt=null,ut=null,mt=0,Mt=0,Is=null,In=!1,cl=!1,Zu=!1,$r=0,ci=0,kn=0,Ca=0,Qu=0,ks=0,hl=0,lo=null,ys=null,Ju=!1,Lc=0,G1=0,Pc=1/0,Hc=null,Ln=null,Mi=0,Pn=null,ul=null,en=0,$u=0,ef=null,X1=null,oo=0,tf=null;function Ls(){return(At&2)!==0&&mt!==0?mt&-mt:W.T!==null?of():is()}function Y1(){if(ks===0)if((mt&536870912)===0||xt){var t=gt;gt<<=1,(gt&3932160)===0&&(gt=262144),ks=t}else ks=536870912;return t=Ms.current,t!==null&&(t.flags|=32),ks}function ws(t,r,o){(t===Vt&&(Mt===2||Mt===9)||t.cancelPendingCommit!==null)&&(fl(t,0),Hn(t,mt,ks,!1)),mr(t,o),((At&2)===0||t!==Vt)&&(t===Vt&&((At&2)===0&&(Ca|=o),ci===4&&Hn(t,mt,ks,!1)),Er(t))}function j1(t,r,o){if((At&6)!==0)throw Error(h(327));var f=!o&&(r&127)===0&&(r&t.expiredLanes)===0||Yi(t,r),p=f?Km(t,r):rf(t,r,!0),v=f;do{if(p===0){cl&&!f&&Hn(t,r,0,!1);break}else{if(o=t.current.alternate,v&&!jm(o)){p=rf(t,r,!1),v=!1;continue}if(p===2){if(v=r,t.errorRecoveryDisabledLanes&v)var A=0;else A=t.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){r=A;e:{var O=t;p=lo;var z=O.current.memoizedState.isDehydrated;if(z&&(fl(O,A).flags|=256),A=rf(O,A,!1),A!==2){if(Zu&&!z){O.errorRecoveryDisabledLanes|=v,Ca|=v,p=4;break e}v=ys,ys=p,v!==null&&(ys===null?ys=v:ys.push.apply(ys,v))}p=A}if(v=!1,p!==2)continue}}if(p===1){fl(t,0),Hn(t,r,0,!0);break}e:{switch(f=t,v=p,v){case 0:case 1:throw Error(h(345));case 4:if((r&4194048)!==r)break;case 6:Hn(f,r,ks,!In);break e;case 2:ys=null;break;case 3:case 5:break;default:throw Error(h(329))}if((r&62914560)===r&&(p=Lc+300-ti(),10<p)){if(Hn(f,r,ks,!In),ia(f,0,!0)!==0)break e;en=r,f.timeoutHandle=Cg(q1.bind(null,f,o,ys,Hc,Ju,r,ks,Ca,hl,In,v,"Throttled",-0,0),p);break e}q1(f,o,ys,Hc,Ju,r,ks,Ca,hl,In,v,null,-0,0)}}break}while(!0);Er(t)}function q1(t,r,o,f,p,v,A,O,z,J,ce,ge,$,ne){if(t.timeoutHandle=-1,ge=r.subtreeFlags,ge&8192||(ge&16785408)===16785408){ge={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_s},F1(r,v,ge);var He=(v&62914560)===v?Lc-ti():(v&4194048)===v?G1-ti():0;if(He=Op(ge,He),He!==null){en=v,t.cancelPendingCommit=He(ig.bind(null,t,r,v,o,f,p,A,O,z,ce,ge,null,$,ne)),Hn(t,v,A,!J);return}}ig(t,r,v,o,f,p,A,O,z)}function jm(t){for(var r=t;;){var o=r.tag;if((o===0||o===11||o===15)&&r.flags&16384&&(o=r.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var f=0;f<o.length;f++){var p=o[f],v=p.getSnapshot;p=p.value;try{if(!d(v(),p))return!1}catch{return!1}}if(o=r.child,r.subtreeFlags&16384&&o!==null)o.return=r,r=o;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Hn(t,r,o,f){r&=~Qu,r&=~Ca,t.suspendedLanes|=r,t.pingedLanes&=~r,f&&(t.warmLanes|=r),f=t.expirationTimes;for(var p=r;0<p;){var v=31-tt(p),A=1<<v;f[v]=-1,p&=~A}o!==0&&Go(t,o,r)}function zc(){return(At&6)===0?(co(0),!1):!0}function sf(){if(ut!==null){if(Mt===0)var t=ut.return;else t=ut,Wr=_a=null,xu(t),il=null,Xl=0,t=ut;for(;t!==null;)E1(t.alternate,t),t=t.return;ut=null}}function fl(t,r){var o=t.timeoutHandle;o!==-1&&(t.timeoutHandle=-1,dp(o)),o=t.cancelPendingCommit,o!==null&&(t.cancelPendingCommit=null,o()),en=0,sf(),Vt=t,ut=o=Ur(t.current,null),mt=r,Mt=0,Is=null,In=!1,cl=Yi(t,r),Zu=!1,hl=ks=Qu=Ca=kn=ci=0,ys=lo=null,Ju=!1,(r&8)!==0&&(r|=r&32);var f=t.entangledLanes;if(f!==0)for(t=t.entanglements,f&=r;0<f;){var p=31-tt(f),v=1<<p;r|=t[p],f&=~v}return $r=r,ac(),o}function K1(t,r){et=null,W.H=$l,r===tl||r===gc?(r=u0(),Mt=3):r===au?(r=u0(),Mt=4):Mt=r===Iu?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Is=r,ut===null&&(ci=1,Rc(t,js(r,t.current)))}function Z1(){var t=Ms.current;return t===null?!0:(mt&4194048)===mt?Qs===null:(mt&62914560)===mt||(mt&536870912)!==0?t===Qs:!1}function Q1(){var t=W.H;return W.H=$l,t===null?$l:t}function J1(){var t=W.A;return W.A=Xm,t}function Fc(){ci=4,In||(mt&4194048)!==mt&&Ms.current!==null||(cl=!0),(kn&134217727)===0&&(Ca&134217727)===0||Vt===null||Hn(Vt,mt,ks,!1)}function rf(t,r,o){var f=At;At|=2;var p=Q1(),v=J1();(Vt!==t||mt!==r)&&(Hc=null,fl(t,r)),r=!1;var A=ci;e:do try{if(Mt!==0&&ut!==null){var O=ut,z=Is;switch(Mt){case 8:sf(),A=6;break e;case 3:case 2:case 9:case 6:Ms.current===null&&(r=!0);var J=Mt;if(Mt=0,Is=null,dl(t,O,z,J),o&&cl){A=0;break e}break;default:J=Mt,Mt=0,Is=null,dl(t,O,z,J)}}qm(),A=ci;break}catch(ce){K1(t,ce)}while(!0);return r&&t.shellSuspendCounter++,Wr=_a=null,At=f,W.H=p,W.A=v,ut===null&&(Vt=null,mt=0,ac()),A}function qm(){for(;ut!==null;)$1(ut)}function Km(t,r){var o=At;At|=2;var f=Q1(),p=J1();Vt!==t||mt!==r?(Hc=null,Pc=ti()+500,fl(t,r)):cl=Yi(t,r);e:do try{if(Mt!==0&&ut!==null){r=ut;var v=Is;t:switch(Mt){case 1:Mt=0,Is=null,dl(t,r,v,1);break;case 2:case 9:if(c0(v)){Mt=0,Is=null,eg(r);break}r=function(){Mt!==2&&Mt!==9||Vt!==t||(Mt=7),Er(t)},v.then(r,r);break e;case 3:Mt=7;break e;case 4:Mt=5;break e;case 7:c0(v)?(Mt=0,Is=null,eg(r)):(Mt=0,Is=null,dl(t,r,v,7));break;case 5:var A=null;switch(ut.tag){case 26:A=ut.memoizedState;case 5:case 27:var O=ut;if(A?zg(A):O.stateNode.complete){Mt=0,Is=null;var z=O.sibling;if(z!==null)ut=z;else{var J=O.return;J!==null?(ut=J,Uc(J)):ut=null}break t}}Mt=0,Is=null,dl(t,r,v,5);break;case 6:Mt=0,Is=null,dl(t,r,v,6);break;case 8:sf(),ci=6;break e;default:throw Error(h(462))}}Zm();break}catch(ce){K1(t,ce)}while(!0);return Wr=_a=null,W.H=f,W.A=p,At=o,ut!==null?0:(Vt=null,mt=0,ac(),ci)}function Zm(){for(;ut!==null&&!Ia();)$1(ut)}function $1(t){var r=b1(t.alternate,t,$r);t.memoizedProps=t.pendingProps,r===null?Uc(t):ut=r}function eg(t){var r=t,o=r.alternate;switch(r.tag){case 15:case 0:r=p1(o,r,r.pendingProps,r.type,void 0,mt);break;case 11:r=p1(o,r,r.pendingProps,r.type.render,r.ref,mt);break;case 5:xu(r);default:E1(o,r),r=ut=Jd(r,$r),r=b1(o,r,$r)}t.memoizedProps=t.pendingProps,r===null?Uc(t):ut=r}function dl(t,r,o,f){Wr=_a=null,xu(r),il=null,Xl=0;var p=r.return;try{if(Hm(t,p,r,o,mt)){ci=1,Rc(t,js(o,t.current)),ut=null;return}}catch(v){if(p!==null)throw ut=p,v;ci=1,Rc(t,js(o,t.current)),ut=null;return}r.flags&32768?(xt||f===1?t=!0:cl||(mt&536870912)!==0?t=!1:(In=t=!0,(f===2||f===9||f===3||f===6)&&(f=Ms.current,f!==null&&f.tag===13&&(f.flags|=16384))),tg(r,t)):Uc(r)}function Uc(t){var r=t;do{if((r.flags&32768)!==0){tg(r,In);return}t=r.return;var o=Um(r.alternate,r,$r);if(o!==null){ut=o;return}if(r=r.sibling,r!==null){ut=r;return}ut=r=t}while(r!==null);ci===0&&(ci=5)}function tg(t,r){do{var o=Vm(t.alternate,t);if(o!==null){o.flags&=32767,ut=o;return}if(o=t.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!r&&(t=t.sibling,t!==null)){ut=t;return}ut=t=o}while(t!==null);ci=6,ut=null}function ig(t,r,o,f,p,v,A,O,z){t.cancelPendingCommit=null;do Vc();while(Mi!==0);if((At&6)!==0)throw Error(h(327));if(r!==null){if(r===t.current)throw Error(h(177));if(v=r.lanes|r.childLanes,v|=Xh,Vs(t,o,v,A,O,z),t===Vt&&(ut=Vt=null,mt=0),ul=r,Pn=t,en=o,$u=v,ef=p,X1=f,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,ep(Cs,function(){return lg(),null})):(t.callbackNode=null,t.callbackPriority=0),f=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||f){f=W.T,W.T=null,p=Z.p,Z.p=2,A=At,At|=4;try{Wm(t,r,o)}finally{At=A,Z.p=p,W.T=f}}Mi=1,sg(),rg(),ng()}}function sg(){if(Mi===1){Mi=0;var t=Pn,r=ul,o=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||o){o=W.T,W.T=null;var f=Z.p;Z.p=2;var p=At;At|=4;try{P1(r,t);var v=mf,A=R(t.containerInfo),O=v.focusedElem,z=v.selectionRange;if(A!==O&&O&&O.ownerDocument&&E(O.ownerDocument.documentElement,O)){if(z!==null&&D(O)){var J=z.start,ce=z.end;if(ce===void 0&&(ce=J),"selectionStart"in O)O.selectionStart=J,O.selectionEnd=Math.min(ce,O.value.length);else{var ge=O.ownerDocument||document,$=ge&&ge.defaultView||window;if($.getSelection){var ne=$.getSelection(),He=O.textContent.length,qe=Math.min(z.start,He),Pt=z.end===void 0?qe:Math.min(z.end,He);!ne.extend&&qe>Pt&&(A=Pt,Pt=qe,qe=A);var j=y(O,qe),G=y(O,Pt);if(j&&G&&(ne.rangeCount!==1||ne.anchorNode!==j.node||ne.anchorOffset!==j.offset||ne.focusNode!==G.node||ne.focusOffset!==G.offset)){var Q=ge.createRange();Q.setStart(j.node,j.offset),ne.removeAllRanges(),qe>Pt?(ne.addRange(Q),ne.extend(G.node,G.offset)):(Q.setEnd(G.node,G.offset),ne.addRange(Q))}}}}for(ge=[],ne=O;ne=ne.parentNode;)ne.nodeType===1&&ge.push({element:ne,left:ne.scrollLeft,top:ne.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<ge.length;O++){var fe=ge[O];fe.element.scrollLeft=fe.left,fe.element.scrollTop=fe.top}}eh=!!_f,mf=_f=null}finally{At=p,Z.p=f,W.T=o}}t.current=r,Mi=2}}function rg(){if(Mi===2){Mi=0;var t=Pn,r=ul,o=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||o){o=W.T,W.T=null;var f=Z.p;Z.p=2;var p=At;At|=4;try{M1(t,r.alternate,r)}finally{At=p,Z.p=f,W.T=o}}Mi=3}}function ng(){if(Mi===4||Mi===3){Mi=0,Wo();var t=Pn,r=ul,o=en,f=X1;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Mi=5:(Mi=0,ul=Pn=null,ag(t,t.pendingLanes));var p=t.pendingLanes;if(p===0&&(Ln=null),nr(o),r=r.stateNode,Ae&&typeof Ae.onCommitFiberRoot=="function")try{Ae.onCommitFiberRoot(Wt,r,void 0,(r.current.flags&128)===128)}catch{}if(f!==null){r=W.T,p=Z.p,Z.p=2,W.T=null;try{for(var v=t.onRecoverableError,A=0;A<f.length;A++){var O=f[A];v(O.value,{componentStack:O.stack})}}finally{W.T=r,Z.p=p}}(en&3)!==0&&Vc(),Er(t),p=t.pendingLanes,(o&261930)!==0&&(p&42)!==0?t===tf?oo++:(oo=0,tf=t):oo=0,co(0)}}function ag(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,Wl(r)))}function Vc(){return sg(),rg(),ng(),lg()}function lg(){if(Mi!==5)return!1;var t=Pn,r=$u;$u=0;var o=nr(en),f=W.T,p=Z.p;try{Z.p=32>o?32:o,W.T=null,o=ef,ef=null;var v=Pn,A=en;if(Mi=0,ul=Pn=null,en=0,(At&6)!==0)throw Error(h(331));var O=At;if(At|=4,V1(v.current),z1(v,v.current,A,o),At=O,co(0,!1),Ae&&typeof Ae.onPostCommitFiberRoot=="function")try{Ae.onPostCommitFiberRoot(Wt,v)}catch{}return!0}finally{Z.p=p,W.T=f,ag(t,r)}}function og(t,r,o){r=js(o,r),r=Bu(t.stateNode,r,2),t=Dn(t,r,2),t!==null&&(mr(t,2),Er(t))}function Bt(t,r,o){if(t.tag===3)og(t,t,o);else for(;r!==null;){if(r.tag===3){og(r,t,o);break}else if(r.tag===1){var f=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Ln===null||!Ln.has(f))){t=js(o,t),o=c1(2),f=Dn(r,o,2),f!==null&&(h1(o,f,r,t),mr(f,2),Er(f));break}}r=r.return}}function nf(t,r,o){var f=t.pingCache;if(f===null){f=t.pingCache=new Ym;var p=new Set;f.set(r,p)}else p=f.get(r),p===void 0&&(p=new Set,f.set(r,p));p.has(o)||(Zu=!0,p.add(o),t=Qm.bind(null,t,r,o),r.then(t,t))}function Qm(t,r,o){var f=t.pingCache;f!==null&&f.delete(r),t.pingedLanes|=t.suspendedLanes&o,t.warmLanes&=~o,Vt===t&&(mt&o)===o&&(ci===4||ci===3&&(mt&62914560)===mt&&300>ti()-Lc?(At&2)===0&&fl(t,0):Qu|=o,hl===mt&&(hl=0)),Er(t)}function cg(t,r){r===0&&(r=Ri()),t=fa(t,r),t!==null&&(mr(t,r),Er(t))}function Jm(t){var r=t.memoizedState,o=0;r!==null&&(o=r.retryLane),cg(t,o)}function $m(t,r){var o=0;switch(t.tag){case 31:case 13:var f=t.stateNode,p=t.memoizedState;p!==null&&(o=p.retryLane);break;case 19:f=t.stateNode;break;case 22:f=t.stateNode._retryCache;break;default:throw Error(h(314))}f!==null&&f.delete(r),cg(t,o)}function ep(t,r){return cn(t,r)}var Wc=null,gl=null,af=!1,Gc=!1,lf=!1,zn=0;function Er(t){t!==gl&&t.next===null&&(gl===null?Wc=gl=t:gl=gl.next=t),Gc=!0,af||(af=!0,ip())}function co(t,r){if(!lf&&Gc){lf=!0;do for(var o=!1,f=Wc;f!==null;){if(t!==0){var p=f.pendingLanes;if(p===0)var v=0;else{var A=f.suspendedLanes,O=f.pingedLanes;v=(1<<31-tt(42|t)+1)-1,v&=p&~(A&~O),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(o=!0,dg(f,v))}else v=mt,v=ia(f,f===Vt?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(v&3)===0||Yi(f,v)||(o=!0,dg(f,v));f=f.next}while(o);lf=!1}}function tp(){hg()}function hg(){Gc=af=!1;var t=0;zn!==0&&fp()&&(t=zn);for(var r=ti(),o=null,f=Wc;f!==null;){var p=f.next,v=ug(f,r);v===0?(f.next=null,o===null?Wc=p:o.next=p,p===null&&(gl=o)):(o=f,(t!==0||(v&3)!==0)&&(Gc=!0)),f=p}Mi!==0&&Mi!==5||co(t),zn!==0&&(zn=0)}function ug(t,r){for(var o=t.suspendedLanes,f=t.pingedLanes,p=t.expirationTimes,v=t.pendingLanes&-62914561;0<v;){var A=31-tt(v),O=1<<A,z=p[A];z===-1?((O&o)===0||(O&f)!==0)&&(p[A]=Dl(O,r)):z<=r&&(t.expiredLanes|=O),v&=~O}if(r=Vt,o=mt,o=ia(t,t===r?o:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),f=t.callbackNode,o===0||t===r&&(Mt===2||Mt===9)||t.cancelPendingCommit!==null)return f!==null&&f!==null&&Pe(f),t.callbackNode=null,t.callbackPriority=0;if((o&3)===0||Yi(t,o)){if(r=o&-o,r===t.callbackPriority)return r;switch(f!==null&&Pe(f),nr(o)){case 2:case 8:o=Tl;break;case 32:o=Cs;break;case 268435456:o=Rl;break;default:o=Cs}return f=fg.bind(null,t),o=cn(o,f),t.callbackPriority=r,t.callbackNode=o,r}return f!==null&&f!==null&&Pe(f),t.callbackPriority=2,t.callbackNode=null,2}function fg(t,r){if(Mi!==0&&Mi!==5)return t.callbackNode=null,t.callbackPriority=0,null;var o=t.callbackNode;if(Vc()&&t.callbackNode!==o)return null;var f=mt;return f=ia(t,t===Vt?f:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),f===0?null:(j1(t,f,r),ug(t,ti()),t.callbackNode!=null&&t.callbackNode===o?fg.bind(null,t):null)}function dg(t,r){if(Vc())return null;j1(t,r,!0)}function ip(){gp(function(){(At&6)!==0?cn(ds,tp):hg()})}function of(){if(zn===0){var t=$a;t===0&&(t=ta,ta<<=1,(ta&261888)===0&&(ta=256)),zn=t}return zn}function gg(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:mn(""+t)}function _g(t,r){var o=r.ownerDocument.createElement("input");return o.name=r.name,o.value=r.value,t.id&&o.setAttribute("form",t.id),r.parentNode.insertBefore(o,r),t=new FormData(t),o.parentNode.removeChild(o),t}function sp(t,r,o,f,p){if(r==="submit"&&o&&o.stateNode===p){var v=gg((p[Ot]||null).action),A=f.submitter;A&&(r=(r=A[Ot]||null)?gg(r.formAction):A.getAttribute("formAction"),r!==null&&(v=r,A=null));var O=new Ni("action","action",null,f,p);t.push({event:O,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(zn!==0){var z=A?_g(p,A):new FormData(p);Tu(o,{pending:!0,data:z,method:p.method,action:v},null,z)}}else typeof v=="function"&&(O.preventDefault(),z=A?_g(p,A):new FormData(p),Tu(o,{pending:!0,data:z,method:p.method,action:v},v,z))},currentTarget:p}]})}}for(var cf=0;cf<Fl.length;cf++){var hf=Fl[cf],rp=hf.toLowerCase(),np=hf[0].toUpperCase()+hf.slice(1);ur(rp,"on"+np)}ur(ps,"onAnimationEnd"),ur(ji,"onAnimationIteration"),ur(Nt,"onAnimationStart"),ur("dblclick","onDoubleClick"),ur("focusin","onFocus"),ur("focusout","onBlur"),ur(Oi,"onTransitionRun"),ur(ls,"onTransitionStart"),ur(bn,"onTransitionCancel"),ur(Fr,"onTransitionEnd"),As("onMouseEnter",["mouseout","mouseover"]),As("onMouseLeave",["mouseout","mouseover"]),As("onPointerEnter",["pointerout","pointerover"]),As("onPointerLeave",["pointerout","pointerover"]),Tt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Tt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Tt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Tt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Tt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Tt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ap=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ho));function mg(t,r){r=(r&4)!==0;for(var o=0;o<t.length;o++){var f=t[o],p=f.event;f=f.listeners;e:{var v=void 0;if(r)for(var A=f.length-1;0<=A;A--){var O=f[A],z=O.instance,J=O.currentTarget;if(O=O.listener,z!==v&&p.isPropagationStopped())break e;v=O,p.currentTarget=J;try{v(p)}catch(ce){nc(ce)}p.currentTarget=null,v=z}else for(A=0;A<f.length;A++){if(O=f[A],z=O.instance,J=O.currentTarget,O=O.listener,z!==v&&p.isPropagationStopped())break e;v=O,p.currentTarget=J;try{v(p)}catch(ce){nc(ce)}p.currentTarget=null,v=z}}}}function ft(t,r){var o=r[hn];o===void 0&&(o=r[hn]=new Set);var f=t+"__bubble";o.has(f)||(pg(r,t,2,!1),o.add(f))}function uf(t,r,o){var f=0;r&&(f|=4),pg(o,t,f,r)}var Xc="_reactListening"+Math.random().toString(36).slice(2);function ff(t){if(!t[Xc]){t[Xc]=!0,xe.forEach(function(o){o!=="selectionchange"&&(ap.has(o)||uf(o,!1,t),uf(o,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[Xc]||(r[Xc]=!0,uf("selectionchange",!1,r))}}function pg(t,r,o,f){switch(Yg(r)){case 2:var p=Ip;break;case 8:p=kp;break;default:p=Tf}o=p.bind(null,r,o,t),p=void 0,!Bl||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(p=!0),f?p!==void 0?t.addEventListener(r,o,{capture:!0,passive:p}):t.addEventListener(r,o,!0):p!==void 0?t.addEventListener(r,o,{passive:p}):t.addEventListener(r,o,!1)}function df(t,r,o,f,p){var v=f;if((r&1)===0&&(r&2)===0&&f!==null)e:for(;;){if(f===null)return;var A=f.tag;if(A===3||A===4){var O=f.stateNode.containerInfo;if(O===p)break;if(A===4)for(A=f.return;A!==null;){var z=A.tag;if((z===3||z===4)&&A.stateNode.containerInfo===p)return;A=A.return}for(;O!==null;){if(A=ni(O),A===null)return;if(z=A.tag,z===5||z===6||z===26||z===27){f=v=A;continue e}O=O.parentNode}}f=f.return}qo(function(){var J=v,ce=Ml(o),ge=[];e:{var $=rc.get(t);if($!==void 0){var ne=Ni,He=t;switch(t){case"keypress":if(xr(o)===0)break e;case"keydown":case"keyup":ne=Ga;break;case"focusin":He="focus",ne=Ll;break;case"focusout":He="blur",ne=Ll;break;case"beforeblur":case"afterblur":ne=Ll;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=Et;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=Va;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=Vh;break;case ps:case ji:case Nt:ne=it;break;case Fr:ne=Lr;break;case"scroll":case"scrollend":ne=Ko;break;case"wheel":ne=Wh;break;case"copy":case"cut":case"paste":ne=Wa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=Rt;break;case"toggle":case"beforetoggle":ne=Hl}var qe=(r&4)!==0,Pt=!qe&&(t==="scroll"||t==="scrollend"),j=qe?$!==null?$+"Capture":null:$;qe=[];for(var G=J,Q;G!==null;){var fe=G;if(Q=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||Q===null||j===null||(fe=Ze(G,j),fe!=null&&qe.push(uo(G,fe,Q))),Pt)break;G=G.return}0<qe.length&&($=new ne($,He,null,o,ce),ge.push({event:$,listeners:qe}))}}if((r&7)===0){e:{if($=t==="mouseover"||t==="pointerover",ne=t==="mouseout"||t==="pointerout",$&&o!==ra&&(He=o.relatedTarget||o.fromElement)&&(ni(He)||He[Es]))break e;if((ne||$)&&($=ce.window===ce?ce:($=ce.ownerDocument)?$.defaultView||$.parentWindow:window,ne?(He=o.relatedTarget||o.toElement,ne=J,He=He?ni(He):null,He!==null&&(Pt=m(He),qe=He.tag,He!==Pt||qe!==5&&qe!==27&&qe!==6)&&(He=null)):(ne=null,He=J),ne!==He)){if(qe=Et,fe="onMouseLeave",j="onMouseEnter",G="mouse",(t==="pointerout"||t==="pointerover")&&(qe=Rt,fe="onPointerLeave",j="onPointerEnter",G="pointer"),Pt=ne==null?$:un(ne),Q=He==null?$:un(He),$=new qe(fe,G+"leave",ne,o,ce),$.target=Pt,$.relatedTarget=Q,fe=null,ni(ce)===J&&(qe=new qe(j,G+"enter",He,o,ce),qe.target=Q,qe.relatedTarget=Pt,fe=qe),Pt=fe,ne&&He)t:{for(qe=lp,j=ne,G=He,Q=0,fe=j;fe;fe=qe(fe))Q++;fe=0;for(var Ge=G;Ge;Ge=qe(Ge))fe++;for(;0<Q-fe;)j=qe(j),Q--;for(;0<fe-Q;)G=qe(G),fe--;for(;Q--;){if(j===G||G!==null&&j===G.alternate){qe=j;break t}j=qe(j),G=qe(G)}qe=null}else qe=null;ne!==null&&xg(ge,$,ne,qe,!1),He!==null&&Pt!==null&&xg(ge,Pt,He,qe,!0)}}e:{if($=J?un(J):window,ne=$.nodeName&&$.nodeName.toLowerCase(),ne==="select"||ne==="input"&&$.type==="file")var wt=Ds;else if(zl($))if(sc)wt=c;else{wt=n;var Ue=i}else ne=$.nodeName,!ne||ne.toLowerCase()!=="input"||$.type!=="checkbox"&&$.type!=="radio"?J&&zt(J.elementType)&&(wt=Ds):wt=a;if(wt&&(wt=wt(t,J))){Ns(ge,wt,o,ce);break e}Ue&&Ue(t,$,J),t==="focusout"&&J&&$.type==="number"&&J.memoizedProps.value!=null&&B($,"number",$.value)}switch(Ue=J?un(J):window,t){case"focusin":(zl(Ue)||Ue.contentEditable==="true")&&(F=Ue,V=J,q=null);break;case"focusout":q=V=F=null;break;case"mousedown":ie=!0;break;case"contextmenu":case"mouseup":case"dragend":ie=!1,Ce(ge,o,ce);break;case"selectionchange":if(I)break;case"keydown":case"keyup":Ce(ge,o,ce)}var st;if(la)e:{switch(t){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else wn?ic(t,o)&&(pt="onCompositionEnd"):t==="keydown"&&o.keyCode===229&&(pt="onCompositionStart");pt&&(tc&&o.locale!=="ko"&&(wn||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&wn&&(st=pn()):(cr=ce,hr="value"in cr?cr.value:cr.textContent,wn=!0)),Ue=Yc(J,pt),0<Ue.length&&(pt=new Jo(pt,t,null,o,ce),ge.push({event:pt,listeners:Ue}),st?pt.data=st:(st=yn(o),st!==null&&(pt.data=st)))),(st=ec?yr(t,o):Ya(t,o))&&(pt=Yc(J,"onBeforeInput"),0<pt.length&&(Ue=new Jo("onBeforeInput","beforeinput",null,o,ce),ge.push({event:Ue,listeners:pt}),Ue.data=st)),sp(ge,t,J,o,ce)}mg(ge,r)})}function uo(t,r,o){return{instance:t,listener:r,currentTarget:o}}function Yc(t,r){for(var o=r+"Capture",f=[];t!==null;){var p=t,v=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||v===null||(p=Ze(t,o),p!=null&&f.unshift(uo(t,p,v)),p=Ze(t,r),p!=null&&f.push(uo(t,p,v))),t.tag===3)return f;t=t.return}return[]}function lp(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function xg(t,r,o,f,p){for(var v=r._reactName,A=[];o!==null&&o!==f;){var O=o,z=O.alternate,J=O.stateNode;if(O=O.tag,z!==null&&z===f)break;O!==5&&O!==26&&O!==27||J===null||(z=J,p?(J=Ze(o,v),J!=null&&A.unshift(uo(o,J,z))):p||(J=Ze(o,v),J!=null&&A.push(uo(o,J,z)))),o=o.return}A.length!==0&&t.push({event:r,listeners:A})}var op=/\r\n?/g,cp=/\u0000|\uFFFD/g;function vg(t){return(typeof t=="string"?t:""+t).replace(op,`
`).replace(cp,"")}function Sg(t,r){return r=vg(r),vg(t)===r}function Lt(t,r,o,f,p,v){switch(o){case"children":typeof f=="string"?r==="body"||r==="textarea"&&f===""||_n(t,f):(typeof f=="number"||typeof f=="bigint")&&r!=="body"&&_n(t,""+f);break;case"className":dn(t,"class",f);break;case"tabIndex":dn(t,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":dn(t,o,f);break;case"style":We(t,f,v);break;case"data":if(r!=="object"){dn(t,"data",f);break}case"src":case"href":if(f===""&&(r!=="a"||o!=="href")){t.removeAttribute(o);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){t.removeAttribute(o);break}f=mn(""+f),t.setAttribute(o,f);break;case"action":case"formAction":if(typeof f=="function"){t.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(o==="formAction"?(r!=="input"&&Lt(t,r,"name",p.name,p,null),Lt(t,r,"formEncType",p.formEncType,p,null),Lt(t,r,"formMethod",p.formMethod,p,null),Lt(t,r,"formTarget",p.formTarget,p,null)):(Lt(t,r,"encType",p.encType,p,null),Lt(t,r,"method",p.method,p,null),Lt(t,r,"target",p.target,p,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){t.removeAttribute(o);break}f=mn(""+f),t.setAttribute(o,f);break;case"onClick":f!=null&&(t.onclick=_s);break;case"onScroll":f!=null&&ft("scroll",t);break;case"onScrollEnd":f!=null&&ft("scrollend",t);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(h(61));if(o=f.__html,o!=null){if(p.children!=null)throw Error(h(60));t.innerHTML=o}}break;case"multiple":t.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":t.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){t.removeAttribute("xlink:href");break}o=mn(""+f),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?t.setAttribute(o,""+f):t.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?t.setAttribute(o,""):t.removeAttribute(o);break;case"capture":case"download":f===!0?t.setAttribute(o,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?t.setAttribute(o,f):t.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?t.setAttribute(o,f):t.removeAttribute(o);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?t.removeAttribute(o):t.setAttribute(o,f);break;case"popover":ft("beforetoggle",t),ft("toggle",t),fn(t,"popover",f);break;case"xlinkActuate":Ts(t,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ts(t,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ts(t,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ts(t,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ts(t,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ts(t,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ts(t,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ts(t,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ts(t,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":fn(t,"is",f);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=jo.get(o)||o,fn(t,o,f))}}function gf(t,r,o,f,p,v){switch(o){case"style":We(t,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(h(61));if(o=f.__html,o!=null){if(p.children!=null)throw Error(h(60));t.innerHTML=o}}break;case"children":typeof f=="string"?_n(t,f):(typeof f=="number"||typeof f=="bigint")&&_n(t,""+f);break;case"onScroll":f!=null&&ft("scroll",t);break;case"onScrollEnd":f!=null&&ft("scrollend",t);break;case"onClick":f!=null&&(t.onclick=_s);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yo.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),r=o.slice(2,p?o.length-7:void 0),v=t[Ot]||null,v=v!=null?v[o]:null,typeof v=="function"&&t.removeEventListener(r,v,p),typeof f=="function")){typeof v!="function"&&v!==null&&(o in t?t[o]=null:t.hasAttribute(o)&&t.removeAttribute(o)),t.addEventListener(r,f,p);break e}o in t?t[o]=f:f===!0?t.setAttribute(o,""):fn(t,o,f)}}}function Qi(t,r,o){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",t),ft("load",t);var f=!1,p=!1,v;for(v in o)if(o.hasOwnProperty(v)){var A=o[v];if(A!=null)switch(v){case"src":f=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(h(137,r));default:Lt(t,r,v,A,o,null)}}p&&Lt(t,r,"srcSet",o.srcSet,o,null),f&&Lt(t,r,"src",o.src,o,null);return;case"input":ft("invalid",t);var O=v=A=p=null,z=null,J=null;for(f in o)if(o.hasOwnProperty(f)){var ce=o[f];if(ce!=null)switch(f){case"name":p=ce;break;case"type":A=ce;break;case"checked":z=ce;break;case"defaultChecked":J=ce;break;case"value":v=ce;break;case"defaultValue":O=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(h(137,r));break;default:Lt(t,r,f,ce,o,null)}}K(t,v,O,z,J,A,p,!1);return;case"select":ft("invalid",t),f=A=v=null;for(p in o)if(o.hasOwnProperty(p)&&(O=o[p],O!=null))switch(p){case"value":v=O;break;case"defaultValue":A=O;break;case"multiple":f=O;default:Lt(t,r,p,O,o,null)}r=v,o=A,t.multiple=!!f,r!=null?Fe(t,!!f,r,!1):o!=null&&Fe(t,!!f,o,!0);return;case"textarea":ft("invalid",t),v=p=f=null;for(A in o)if(o.hasOwnProperty(A)&&(O=o[A],O!=null))switch(A){case"value":f=O;break;case"defaultValue":p=O;break;case"children":v=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(h(91));break;default:Lt(t,r,A,O,o,null)}ns(t,f,p,v);return;case"option":for(z in o)o.hasOwnProperty(z)&&(f=o[z],f!=null)&&(z==="selected"?t.selected=f&&typeof f!="function"&&typeof f!="symbol":Lt(t,r,z,f,o,null));return;case"dialog":ft("beforetoggle",t),ft("toggle",t),ft("cancel",t),ft("close",t);break;case"iframe":case"object":ft("load",t);break;case"video":case"audio":for(f=0;f<ho.length;f++)ft(ho[f],t);break;case"image":ft("error",t),ft("load",t);break;case"details":ft("toggle",t);break;case"embed":case"source":case"link":ft("error",t),ft("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in o)if(o.hasOwnProperty(J)&&(f=o[J],f!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(h(137,r));default:Lt(t,r,J,f,o,null)}return;default:if(zt(r)){for(ce in o)o.hasOwnProperty(ce)&&(f=o[ce],f!==void 0&&gf(t,r,ce,f,o,void 0));return}}for(O in o)o.hasOwnProperty(O)&&(f=o[O],f!=null&&Lt(t,r,O,f,o,null))}function hp(t,r,o,f){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,v=null,A=null,O=null,z=null,J=null,ce=null;for(ne in o){var ge=o[ne];if(o.hasOwnProperty(ne)&&ge!=null)switch(ne){case"checked":break;case"value":break;case"defaultValue":z=ge;default:f.hasOwnProperty(ne)||Lt(t,r,ne,null,f,ge)}}for(var $ in f){var ne=f[$];if(ge=o[$],f.hasOwnProperty($)&&(ne!=null||ge!=null))switch($){case"type":v=ne;break;case"name":p=ne;break;case"checked":J=ne;break;case"defaultChecked":ce=ne;break;case"value":A=ne;break;case"defaultValue":O=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(h(137,r));break;default:ne!==ge&&Lt(t,r,$,ne,f,ge)}}vi(t,A,O,z,J,ce,v,p);return;case"select":ne=A=O=$=null;for(v in o)if(z=o[v],o.hasOwnProperty(v)&&z!=null)switch(v){case"value":break;case"multiple":ne=z;default:f.hasOwnProperty(v)||Lt(t,r,v,null,f,z)}for(p in f)if(v=f[p],z=o[p],f.hasOwnProperty(p)&&(v!=null||z!=null))switch(p){case"value":$=v;break;case"defaultValue":O=v;break;case"multiple":A=v;default:v!==z&&Lt(t,r,p,v,f,z)}r=O,o=A,f=ne,$!=null?Fe(t,!!o,$,!1):!!f!=!!o&&(r!=null?Fe(t,!!o,r,!0):Fe(t,!!o,o?[]:"",!1));return;case"textarea":ne=$=null;for(O in o)if(p=o[O],o.hasOwnProperty(O)&&p!=null&&!f.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Lt(t,r,O,null,f,p)}for(A in f)if(p=f[A],v=o[A],f.hasOwnProperty(A)&&(p!=null||v!=null))switch(A){case"value":$=p;break;case"defaultValue":ne=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(h(91));break;default:p!==v&&Lt(t,r,A,p,f,v)}gi(t,$,ne);return;case"option":for(var He in o)$=o[He],o.hasOwnProperty(He)&&$!=null&&!f.hasOwnProperty(He)&&(He==="selected"?t.selected=!1:Lt(t,r,He,null,f,$));for(z in f)$=f[z],ne=o[z],f.hasOwnProperty(z)&&$!==ne&&($!=null||ne!=null)&&(z==="selected"?t.selected=$&&typeof $!="function"&&typeof $!="symbol":Lt(t,r,z,$,f,ne));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var qe in o)$=o[qe],o.hasOwnProperty(qe)&&$!=null&&!f.hasOwnProperty(qe)&&Lt(t,r,qe,null,f,$);for(J in f)if($=f[J],ne=o[J],f.hasOwnProperty(J)&&$!==ne&&($!=null||ne!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(h(137,r));break;default:Lt(t,r,J,$,f,ne)}return;default:if(zt(r)){for(var Pt in o)$=o[Pt],o.hasOwnProperty(Pt)&&$!==void 0&&!f.hasOwnProperty(Pt)&&gf(t,r,Pt,void 0,f,$);for(ce in f)$=f[ce],ne=o[ce],!f.hasOwnProperty(ce)||$===ne||$===void 0&&ne===void 0||gf(t,r,ce,$,f,ne);return}}for(var j in o)$=o[j],o.hasOwnProperty(j)&&$!=null&&!f.hasOwnProperty(j)&&Lt(t,r,j,null,f,$);for(ge in f)$=f[ge],ne=o[ge],!f.hasOwnProperty(ge)||$===ne||$==null&&ne==null||Lt(t,r,ge,$,f,ne)}function yg(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function up(){if(typeof performance.getEntriesByType=="function"){for(var t=0,r=0,o=performance.getEntriesByType("resource"),f=0;f<o.length;f++){var p=o[f],v=p.transferSize,A=p.initiatorType,O=p.duration;if(v&&O&&yg(A)){for(A=0,O=p.responseEnd,f+=1;f<o.length;f++){var z=o[f],J=z.startTime;if(J>O)break;var ce=z.transferSize,ge=z.initiatorType;ce&&yg(ge)&&(z=z.responseEnd,A+=ce*(z<O?1:(O-J)/(z-J)))}if(--f,r+=8*(v+A)/(p.duration/1e3),t++,10<t)break}}if(0<t)return r/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var _f=null,mf=null;function jc(t){return t.nodeType===9?t:t.ownerDocument}function wg(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bg(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function pf(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var xf=null;function fp(){var t=window.event;return t&&t.type==="popstate"?t===xf?!1:(xf=t,!0):(xf=null,!1)}var Cg=typeof setTimeout=="function"?setTimeout:void 0,dp=typeof clearTimeout=="function"?clearTimeout:void 0,Eg=typeof Promise=="function"?Promise:void 0,gp=typeof queueMicrotask=="function"?queueMicrotask:typeof Eg<"u"?function(t){return Eg.resolve(null).then(t).catch(_p)}:Cg;function _p(t){setTimeout(function(){throw t})}function Fn(t){return t==="head"}function Ag(t,r){var o=r,f=0;do{var p=o.nextSibling;if(t.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(f===0){t.removeChild(p),xl(r);return}f--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")f++;else if(o==="html")fo(t.ownerDocument.documentElement);else if(o==="head"){o=t.ownerDocument.head,fo(o);for(var v=o.firstChild;v;){var A=v.nextSibling,O=v.nodeName;v[sa]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&v.rel.toLowerCase()==="stylesheet"||o.removeChild(v),v=A}}else o==="body"&&fo(t.ownerDocument.body);o=p}while(o);xl(r)}function Tg(t,r){var o=t;t=0;do{var f=o.nextSibling;if(o.nodeType===1?r?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(r?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),f&&f.nodeType===8)if(o=f.data,o==="/$"){if(t===0)break;t--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||t++;o=f}while(o)}function vf(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var o=r;switch(r=r.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":vf(o),gs(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}t.removeChild(o)}}function mp(t,r,o,f){for(;t.nodeType===1;){var p=o;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!f&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(f){if(!t[sa])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(v=t.getAttribute("rel"),v==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(v!==p.rel||t.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||t.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||t.getAttribute("title")!==(p.title==null?null:p.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(v=t.getAttribute("src"),(v!==(p.src==null?null:p.src)||t.getAttribute("type")!==(p.type==null?null:p.type)||t.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&v&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var v=p.name==null?null:""+p.name;if(p.type==="hidden"&&t.getAttribute("name")===v)return t}else return t;if(t=Js(t.nextSibling),t===null)break}return null}function pp(t,r,o){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!o||(t=Js(t.nextSibling),t===null))return null;return t}function Rg(t,r){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=Js(t.nextSibling),t===null))return null;return t}function Sf(t){return t.data==="$?"||t.data==="$~"}function yf(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function xp(t,r){var o=t.ownerDocument;if(t.data==="$~")t._reactRetry=r;else if(t.data!=="$?"||o.readyState!=="loading")r();else{var f=function(){r(),o.removeEventListener("DOMContentLoaded",f)};o.addEventListener("DOMContentLoaded",f),t._reactRetry=f}}function Js(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return t}var wf=null;function Ng(t){t=t.nextSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="/$"||o==="/&"){if(r===0)return Js(t.nextSibling);r--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||r++}t=t.nextSibling}return null}function Dg(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var o=t.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(r===0)return t;r--}else o!=="/$"&&o!=="/&"||r++}t=t.previousSibling}return null}function Og(t,r,o){switch(r=jc(o),t){case"html":if(t=r.documentElement,!t)throw Error(h(452));return t;case"head":if(t=r.head,!t)throw Error(h(453));return t;case"body":if(t=r.body,!t)throw Error(h(454));return t;default:throw Error(h(451))}}function fo(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);gs(t)}var $s=new Map,Mg=new Set;function qc(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var tn=Z.d;Z.d={f:vp,r:Sp,D:yp,C:wp,L:bp,m:Cp,X:Ap,S:Ep,M:Tp};function vp(){var t=tn.f(),r=zc();return t||r}function Sp(t){var r=Ct(t);r!==null&&r.tag===5&&r.type==="form"?K0(r):tn.r(t)}var _l=typeof document>"u"?null:document;function Bg(t,r,o){var f=_l;if(f&&typeof r=="string"&&r){var p=nt(r);p='link[rel="'+t+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),Mg.has(p)||(Mg.add(p),t={rel:t,crossOrigin:o,href:r},f.querySelector(p)===null&&(r=f.createElement("link"),Qi(r,"link",t),ai(r),f.head.appendChild(r)))}}function yp(t){tn.D(t),Bg("dns-prefetch",t,null)}function wp(t,r){tn.C(t,r),Bg("preconnect",t,r)}function bp(t,r,o){tn.L(t,r,o);var f=_l;if(f&&t&&r){var p='link[rel="preload"][as="'+nt(r)+'"]';r==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+nt(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+nt(o.imageSizes)+'"]')):p+='[href="'+nt(t)+'"]';var v=p;switch(r){case"style":v=ml(t);break;case"script":v=pl(t)}$s.has(v)||(t=N({rel:"preload",href:r==="image"&&o&&o.imageSrcSet?void 0:t,as:r},o),$s.set(v,t),f.querySelector(p)!==null||r==="style"&&f.querySelector(go(v))||r==="script"&&f.querySelector(_o(v))||(r=f.createElement("link"),Qi(r,"link",t),ai(r),f.head.appendChild(r)))}}function Cp(t,r){tn.m(t,r);var o=_l;if(o&&t){var f=r&&typeof r.as=="string"?r.as:"script",p='link[rel="modulepreload"][as="'+nt(f)+'"][href="'+nt(t)+'"]',v=p;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=pl(t)}if(!$s.has(v)&&(t=N({rel:"modulepreload",href:t},r),$s.set(v,t),o.querySelector(p)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(_o(v)))return}f=o.createElement("link"),Qi(f,"link",t),ai(f),o.head.appendChild(f)}}}function Ep(t,r,o){tn.S(t,r,o);var f=_l;if(f&&t){var p=rs(f).hoistableStyles,v=ml(t);r=r||"default";var A=p.get(v);if(!A){var O={loading:0,preload:null};if(A=f.querySelector(go(v)))O.loading=5;else{t=N({rel:"stylesheet",href:t,"data-precedence":r},o),(o=$s.get(v))&&bf(t,o);var z=A=f.createElement("link");ai(z),Qi(z,"link",t),z._p=new Promise(function(J,ce){z.onload=J,z.onerror=ce}),z.addEventListener("load",function(){O.loading|=1}),z.addEventListener("error",function(){O.loading|=2}),O.loading|=4,Kc(A,r,f)}A={type:"stylesheet",instance:A,count:1,state:O},p.set(v,A)}}}function Ap(t,r){tn.X(t,r);var o=_l;if(o&&t){var f=rs(o).hoistableScripts,p=pl(t),v=f.get(p);v||(v=o.querySelector(_o(p)),v||(t=N({src:t,async:!0},r),(r=$s.get(p))&&Cf(t,r),v=o.createElement("script"),ai(v),Qi(v,"link",t),o.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(p,v))}}function Tp(t,r){tn.M(t,r);var o=_l;if(o&&t){var f=rs(o).hoistableScripts,p=pl(t),v=f.get(p);v||(v=o.querySelector(_o(p)),v||(t=N({src:t,async:!0,type:"module"},r),(r=$s.get(p))&&Cf(t,r),v=o.createElement("script"),ai(v),Qi(v,"link",t),o.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(p,v))}}function Ig(t,r,o,f){var p=(p=Se.current)?qc(p):null;if(!p)throw Error(h(446));switch(t){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(r=ml(o.href),o=rs(p).hoistableStyles,f=o.get(r),f||(f={type:"style",instance:null,count:0,state:null},o.set(r,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){t=ml(o.href);var v=rs(p).hoistableStyles,A=v.get(t);if(A||(p=p.ownerDocument||p,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(t,A),(v=p.querySelector(go(t)))&&!v._p&&(A.instance=v,A.state.loading=5),$s.has(t)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},$s.set(t,o),v||Rp(p,t,o,A.state))),r&&f===null)throw Error(h(528,""));return A}if(r&&f!==null)throw Error(h(529,""));return null;case"script":return r=o.async,o=o.src,typeof o=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=pl(o),o=rs(p).hoistableScripts,f=o.get(r),f||(f={type:"script",instance:null,count:0,state:null},o.set(r,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(h(444,t))}}function ml(t){return'href="'+nt(t)+'"'}function go(t){return'link[rel="stylesheet"]['+t+"]"}function kg(t){return N({},t,{"data-precedence":t.precedence,precedence:null})}function Rp(t,r,o,f){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?f.loading=1:(r=t.createElement("link"),f.preload=r,r.addEventListener("load",function(){return f.loading|=1}),r.addEventListener("error",function(){return f.loading|=2}),Qi(r,"link",o),ai(r),t.head.appendChild(r))}function pl(t){return'[src="'+nt(t)+'"]'}function _o(t){return"script[async]"+t}function Lg(t,r,o){if(r.count++,r.instance===null)switch(r.type){case"style":var f=t.querySelector('style[data-href~="'+nt(o.href)+'"]');if(f)return r.instance=f,ai(f),f;var p=N({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return f=(t.ownerDocument||t).createElement("style"),ai(f),Qi(f,"style",p),Kc(f,o.precedence,t),r.instance=f;case"stylesheet":p=ml(o.href);var v=t.querySelector(go(p));if(v)return r.state.loading|=4,r.instance=v,ai(v),v;f=kg(o),(p=$s.get(p))&&bf(f,p),v=(t.ownerDocument||t).createElement("link"),ai(v);var A=v;return A._p=new Promise(function(O,z){A.onload=O,A.onerror=z}),Qi(v,"link",f),r.state.loading|=4,Kc(v,o.precedence,t),r.instance=v;case"script":return v=pl(o.src),(p=t.querySelector(_o(v)))?(r.instance=p,ai(p),p):(f=o,(p=$s.get(v))&&(f=N({},o),Cf(f,p)),t=t.ownerDocument||t,p=t.createElement("script"),ai(p),Qi(p,"link",f),t.head.appendChild(p),r.instance=p);case"void":return null;default:throw Error(h(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(f=r.instance,r.state.loading|=4,Kc(f,o.precedence,t));return r.instance}function Kc(t,r,o){for(var f=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=f.length?f[f.length-1]:null,v=p,A=0;A<f.length;A++){var O=f[A];if(O.dataset.precedence===r)v=O;else if(v!==p)break}v?v.parentNode.insertBefore(t,v.nextSibling):(r=o.nodeType===9?o.head:o,r.insertBefore(t,r.firstChild))}function bf(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function Cf(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var Zc=null;function Pg(t,r,o){if(Zc===null){var f=new Map,p=Zc=new Map;p.set(o,f)}else p=Zc,f=p.get(o),f||(f=new Map,p.set(o,f));if(f.has(t))return f;for(f.set(t,null),o=o.getElementsByTagName(t),p=0;p<o.length;p++){var v=o[p];if(!(v[sa]||v[di]||t==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var A=v.getAttribute(r)||"";A=t+A;var O=f.get(A);O?O.push(v):f.set(A,[v])}}return f}function Hg(t,r,o){t=t.ownerDocument||t,t.head.insertBefore(o,r==="title"?t.querySelector("head > title"):null)}function Np(t,r,o){if(o===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(t=r.disabled,typeof r.precedence=="string"&&t==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function zg(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function Dp(t,r,o,f){if(o.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=ml(f.href),v=r.querySelector(go(p));if(v){r=v._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(t.count++,t=Qc.bind(t),r.then(t,t)),o.state.loading|=4,o.instance=v,ai(v);return}v=r.ownerDocument||r,f=kg(f),(p=$s.get(p))&&bf(f,p),v=v.createElement("link"),ai(v);var A=v;A._p=new Promise(function(O,z){A.onload=O,A.onerror=z}),Qi(v,"link",f),o.instance=v}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(o,r),(r=o.state.preload)&&(o.state.loading&3)===0&&(t.count++,o=Qc.bind(t),r.addEventListener("load",o),r.addEventListener("error",o))}}var Ef=0;function Op(t,r){return t.stylesheets&&t.count===0&&$c(t,t.stylesheets),0<t.count||0<t.imgCount?function(o){var f=setTimeout(function(){if(t.stylesheets&&$c(t,t.stylesheets),t.unsuspend){var v=t.unsuspend;t.unsuspend=null,v()}},6e4+r);0<t.imgBytes&&Ef===0&&(Ef=62500*up());var p=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&$c(t,t.stylesheets),t.unsuspend)){var v=t.unsuspend;t.unsuspend=null,v()}},(t.imgBytes>Ef?50:800)+r);return t.unsuspend=o,function(){t.unsuspend=null,clearTimeout(f),clearTimeout(p)}}:null}function Qc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)$c(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Jc=null;function $c(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Jc=new Map,r.forEach(Mp,t),Jc=null,Qc.call(t))}function Mp(t,r){if(!(r.state.loading&4)){var o=Jc.get(t);if(o)var f=o.get(null);else{o=new Map,Jc.set(t,o);for(var p=t.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<p.length;v++){var A=p[v];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(o.set(A.dataset.precedence,A),f=A)}f&&o.set(null,f)}p=r.instance,A=p.getAttribute("data-precedence"),v=o.get(A)||f,v===f&&o.set(null,p),o.set(A,p),this.count++,f=Qc.bind(this),p.addEventListener("load",f),p.addEventListener("error",f),v?v.parentNode.insertBefore(p,v.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(p,t.firstChild)),r.state.loading|=4}}var mo={$$typeof:te,Provider:null,Consumer:null,_currentValue:ue,_currentValue2:ue,_threadCount:0};function Bp(t,r,o,f,p,v,A,O,z){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_r(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_r(0),this.hiddenUpdates=_r(null),this.identifierPrefix=f,this.onUncaughtError=p,this.onCaughtError=v,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function Fg(t,r,o,f,p,v,A,O,z,J,ce,ge){return t=new Bp(t,r,o,A,z,J,ce,ge,O),r=1,v===!0&&(r|=24),v=Os(3,null,null,r),t.current=v,v.stateNode=t,r=su(),r.refCount++,t.pooledCache=r,r.refCount++,v.memoizedState={element:f,isDehydrated:o,cache:r},lu(v),t}function Ug(t){return t?(t=qa,t):qa}function Vg(t,r,o,f,p,v){p=Ug(p),f.context===null?f.context=p:f.pendingContext=p,f=Nn(r),f.payload={element:o},v=v===void 0?null:v,v!==null&&(f.callback=v),o=Dn(t,f,r),o!==null&&(ws(o,t,r),jl(o,t,r))}function Wg(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var o=t.retryLane;t.retryLane=o!==0&&o<r?o:r}}function Af(t,r){Wg(t,r),(t=t.alternate)&&Wg(t,r)}function Gg(t){if(t.tag===13||t.tag===31){var r=fa(t,67108864);r!==null&&ws(r,t,67108864),Af(t,67108864)}}function Xg(t){if(t.tag===13||t.tag===31){var r=Ls();r=Pi(r);var o=fa(t,r);o!==null&&ws(o,t,r),Af(t,r)}}var eh=!0;function Ip(t,r,o,f){var p=W.T;W.T=null;var v=Z.p;try{Z.p=2,Tf(t,r,o,f)}finally{Z.p=v,W.T=p}}function kp(t,r,o,f){var p=W.T;W.T=null;var v=Z.p;try{Z.p=8,Tf(t,r,o,f)}finally{Z.p=v,W.T=p}}function Tf(t,r,o,f){if(eh){var p=Rf(f);if(p===null)df(t,r,f,th,o),jg(t,f);else if(Pp(p,t,r,o,f))f.stopPropagation();else if(jg(t,f),r&4&&-1<Lp.indexOf(t)){for(;p!==null;){var v=Ct(p);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var A=gr(v.pendingLanes);if(A!==0){var O=v;for(O.pendingLanes|=2,O.entangledLanes|=2;A;){var z=1<<31-tt(A);O.entanglements[1]|=z,A&=~z}Er(v),(At&6)===0&&(Pc=ti()+500,co(0))}}break;case 31:case 13:O=fa(v,2),O!==null&&ws(O,v,2),zc(),Af(v,2)}if(v=Rf(f),v===null&&df(t,r,f,th,o),v===p)break;p=v}p!==null&&f.stopPropagation()}else df(t,r,f,null,o)}}function Rf(t){return t=Ml(t),Nf(t)}var th=null;function Nf(t){if(th=null,t=ni(t),t!==null){var r=m(t);if(r===null)t=null;else{var o=r.tag;if(o===13){if(t=w(r),t!==null)return t;t=null}else if(o===31){if(t=b(r),t!==null)return t;t=null}else if(o===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return th=t,null}function Yg(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Al()){case ds:return 2;case Tl:return 8;case Cs:case Xi:return 32;case Rl:return 268435456;default:return 32}default:return 32}}var Df=!1,Un=null,Vn=null,Wn=null,po=new Map,xo=new Map,Gn=[],Lp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function jg(t,r){switch(t){case"focusin":case"focusout":Un=null;break;case"dragenter":case"dragleave":Vn=null;break;case"mouseover":case"mouseout":Wn=null;break;case"pointerover":case"pointerout":po.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":xo.delete(r.pointerId)}}function vo(t,r,o,f,p,v){return t===null||t.nativeEvent!==v?(t={blockedOn:r,domEventName:o,eventSystemFlags:f,nativeEvent:v,targetContainers:[p]},r!==null&&(r=Ct(r),r!==null&&Gg(r)),t):(t.eventSystemFlags|=f,r=t.targetContainers,p!==null&&r.indexOf(p)===-1&&r.push(p),t)}function Pp(t,r,o,f,p){switch(r){case"focusin":return Un=vo(Un,t,r,o,f,p),!0;case"dragenter":return Vn=vo(Vn,t,r,o,f,p),!0;case"mouseover":return Wn=vo(Wn,t,r,o,f,p),!0;case"pointerover":var v=p.pointerId;return po.set(v,vo(po.get(v)||null,t,r,o,f,p)),!0;case"gotpointercapture":return v=p.pointerId,xo.set(v,vo(xo.get(v)||null,t,r,o,f,p)),!0}return!1}function qg(t){var r=ni(t.target);if(r!==null){var o=m(r);if(o!==null){if(r=o.tag,r===13){if(r=w(o),r!==null){t.blockedOn=r,Ie(t.priority,function(){Xg(o)});return}}else if(r===31){if(r=b(o),r!==null){t.blockedOn=r,Ie(t.priority,function(){Xg(o)});return}}else if(r===3&&o.stateNode.current.memoizedState.isDehydrated){t.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ih(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var o=Rf(t.nativeEvent);if(o===null){o=t.nativeEvent;var f=new o.constructor(o.type,o);ra=f,o.target.dispatchEvent(f),ra=null}else return r=Ct(o),r!==null&&Gg(r),t.blockedOn=o,!1;r.shift()}return!0}function Kg(t,r,o){ih(t)&&o.delete(r)}function Hp(){Df=!1,Un!==null&&ih(Un)&&(Un=null),Vn!==null&&ih(Vn)&&(Vn=null),Wn!==null&&ih(Wn)&&(Wn=null),po.forEach(Kg),xo.forEach(Kg)}function sh(t,r){t.blockedOn===r&&(t.blockedOn=null,Df||(Df=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Hp)))}var rh=null;function Zg(t){rh!==t&&(rh=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){rh===t&&(rh=null);for(var r=0;r<t.length;r+=3){var o=t[r],f=t[r+1],p=t[r+2];if(typeof f!="function"){if(Nf(f||o)===null)continue;break}var v=Ct(o);v!==null&&(t.splice(r,3),r-=3,Tu(v,{pending:!0,data:p,method:o.method,action:f},f,p))}}))}function xl(t){function r(z){return sh(z,t)}Un!==null&&sh(Un,t),Vn!==null&&sh(Vn,t),Wn!==null&&sh(Wn,t),po.forEach(r),xo.forEach(r);for(var o=0;o<Gn.length;o++){var f=Gn[o];f.blockedOn===t&&(f.blockedOn=null)}for(;0<Gn.length&&(o=Gn[0],o.blockedOn===null);)qg(o),o.blockedOn===null&&Gn.shift();if(o=(t.ownerDocument||t).$$reactFormReplay,o!=null)for(f=0;f<o.length;f+=3){var p=o[f],v=o[f+1],A=p[Ot]||null;if(typeof v=="function")A||Zg(o);else if(A){var O=null;if(v&&v.hasAttribute("formAction")){if(p=v,A=v[Ot]||null)O=A.formAction;else if(Nf(p)!==null)continue}else O=A.action;typeof O=="function"?o[f+1]=O:(o.splice(f,3),f-=3),Zg(o)}}}function Qg(){function t(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(A){return p=A})},focusReset:"manual",scroll:"manual"})}function r(){p!==null&&(p(),p=null),f||setTimeout(o,20)}function o(){if(!f&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,p=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(o,100),function(){f=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),p!==null&&(p(),p=null)}}}function Of(t){this._internalRoot=t}nh.prototype.render=Of.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(h(409));var o=r.current,f=Ls();Vg(o,f,t,r,null,null)},nh.prototype.unmount=Of.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;Vg(t.current,2,null,t,null,null),zc(),r[Es]=null}};function nh(t){this._internalRoot=t}nh.prototype.unstable_scheduleHydration=function(t){if(t){var r=is();t={blockedOn:null,target:t,priority:r};for(var o=0;o<Gn.length&&r!==0&&r<Gn[o].priority;o++);Gn.splice(o,0,t),o===0&&qg(t)}};var Jg=s.version;if(Jg!=="19.2.4")throw Error(h(527,Jg,"19.2.4"));Z.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(h(188)):(t=Object.keys(t).join(","),Error(h(268,t)));return t=S(r),t=t!==null?M(t):null,t=t===null?null:t.stateNode,t};var zp={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{Wt=ah.inject(zp),Ae=ah}catch{}}return yo.createRoot=function(t,r){if(!g(t))throw Error(h(299));var o=!1,f="",p=n1,v=a1,A=l1;return r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(p=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(A=r.onRecoverableError)),r=Fg(t,1,!1,null,null,o,f,null,p,v,A,Qg),t[Es]=r.current,ff(t),new Of(r)},yo.hydrateRoot=function(t,r,o){if(!g(t))throw Error(h(299));var f=!1,p="",v=n1,A=a1,O=l1,z=null;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(A=o.onCaughtError),o.onRecoverableError!==void 0&&(O=o.onRecoverableError),o.formState!==void 0&&(z=o.formState)),r=Fg(t,1,!0,r,o??null,f,p,z,v,A,O,Qg),r.context=Ug(null),o=r.current,f=Ls(),f=Pi(f),p=Nn(f),p.callback=null,Dn(o,p,f),o=f,r.current.lanes=o,mr(r,o),Er(r),t[Es]=r.current,ff(t),new nh(r)},yo.version="19.2.4",yo}var o_;function Zp(){if(o_)return If.exports;o_=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(s){console.error(s)}}return e(),If.exports=Kp(),If.exports}var Qp=Zp();const Jp=b2(Qp);const C2=(...e)=>e.filter((s,l,h)=>!!s&&s.trim()!==""&&h.indexOf(s)===l).join(" ").trim();const $p=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const ex=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,l,h)=>h?h.toUpperCase():l.toLowerCase());const c_=e=>{const s=ex(e);return s.charAt(0).toUpperCase()+s.slice(1)};var tx={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ix=e=>{for(const s in e)if(s.startsWith("aria-")||s==="role"||s==="title")return!0;return!1};const sx=Te.forwardRef(({color:e="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:h,className:g="",children:m,iconNode:w,...b},C)=>Te.createElement("svg",{ref:C,...tx,width:s,height:s,stroke:e,strokeWidth:h?Number(l)*24/Number(s):l,className:C2("lucide",g),...!m&&!ix(b)&&{"aria-hidden":"true"},...b},[...w.map(([S,M])=>Te.createElement(S,M)),...Array.isArray(m)?m:[m]]));const rr=(e,s)=>{const l=Te.forwardRef(({className:h,...g},m)=>Te.createElement(sx,{ref:m,iconNode:s,className:C2(`lucide-${$p(c_(e))}`,`lucide-${e}`,h),...g}));return l.displayName=c_(e),l};const rx=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],nx=rr("chevron-down",rx);const ax=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],lx=rr("chevron-right",ax);const ox=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M9 10h6",key:"9gxzsh"}],["path",{d:"M12 13V7",key:"h0r20n"}],["path",{d:"M9 17h6",key:"r8uit2"}]],cx=rr("file-diff",ox);const hx=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],ux=rr("git-branch",hx);const fx=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ed=rr("message-square",fx);const dx=[["path",{d:"M5 12h14",key:"1ays0h"}]],E2=rr("minus",dx);const gx=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],_x=rr("pencil",gx);const mx=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],A2=rr("plus",mx);const px=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],xx=rr("refresh-cw",px);const vx=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Sx=rr("send",vx);const yx=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],wx=rr("terminal",yx);const bx=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Cx=rr("x",bx);function Ex(e){if(e.length===0)return"";const s=new Map;for(const h of e){const g=s.get(h.filePath);g?g.push(h):s.set(h.filePath,[h])}const l=["## Review Comments"];for(const[h,g]of s){const m=h.split("/").pop()??h;l.push(`### ${m}`);const w=[...g].sort((b,C)=>b.lineNumber-C.lineNumber);for(const b of w){const C=b.endLine!=null?`L${b.lineNumber}-${b.endLine}`:`L${b.lineNumber}`;l.push(`- ${C}: ${b.content}`)}}return l.join(`
`)}var ke;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ke||(ke={}));var h_=new Map([[ke.QR_CODE,"QR_CODE"],[ke.AZTEC,"AZTEC"],[ke.CODABAR,"CODABAR"],[ke.CODE_39,"CODE_39"],[ke.CODE_93,"CODE_93"],[ke.CODE_128,"CODE_128"],[ke.DATA_MATRIX,"DATA_MATRIX"],[ke.MAXICODE,"MAXICODE"],[ke.ITF,"ITF"],[ke.EAN_13,"EAN_13"],[ke.EAN_8,"EAN_8"],[ke.PDF_417,"PDF_417"],[ke.RSS_14,"RSS_14"],[ke.RSS_EXPANDED,"RSS_EXPANDED"],[ke.UPC_A,"UPC_A"],[ke.UPC_E,"UPC_E"],[ke.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),u_;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(u_||(u_={}));function Ax(e){return Object.values(ke).includes(e)}var yh;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(yh||(yh={}));var Tx=(function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[yh.SCAN_TYPE_CAMERA,yh.SCAN_TYPE_FILE],e})(),T2=(function(){function e(s,l){this.format=s,this.formatName=l}return e.prototype.toString=function(){return this.formatName},e.create=function(s){if(!h_.has(s))throw"".concat(s," not in html5QrcodeSupportedFormatsTextMap");return new e(s,h_.get(s))},e})(),f_=(function(){function e(){}return e.createFromText=function(s){var l={text:s};return{decodedText:s,result:l}},e.createFromQrcodeResult=function(s){return{decodedText:s.text,result:s}},e})(),td;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(td||(td={}));var Rx=(function(){function e(){}return e.createFrom=function(s){return{errorMessage:s,type:td.UNKWOWN_ERROR}},e})(),Nx=(function(){function e(s){this.verbose=s}return e.prototype.log=function(s){this.verbose&&console.log(s)},e.prototype.warn=function(s){this.verbose&&console.warn(s)},e.prototype.logError=function(s,l){(this.verbose||l===!0)&&console.error(s)},e.prototype.logErrors=function(s){if(s.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(s)},e})();function rn(e){return typeof e>"u"||e===null}var yl=(function(){function e(){}return e.codeParseError=function(s){return"QR code parse error, error = ".concat(s)},e.errorGettingUserMedia=function(s){return"Error getting userMedia, error = ".concat(s)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e})(),R2=(function(){function e(){}return e.isMediaStreamConstraintsValid=function(s,l){if(typeof s!="object"){var h=typeof s;return l.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(h,"."),!0),!1}for(var g=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],m=new Set(g),w=Object.keys(s),b=0,C=w;b<C.length;b++){var S=C[b];if(m.has(S))return l.logError("".concat(S," is not supported videoConstaints."),!0),!1}return!0},e})(),Ro={exports:{}},Dx=Ro.exports,d_;function Ox(){return d_||(d_=1,(function(e,s){(function(l,h){h(s)})(Dx,(function(l){function h(T){return T==null}var g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,i){T.__proto__=i}||function(T,i){for(var n in i)i.hasOwnProperty(n)&&(T[n]=i[n])};function m(T,i){g(T,i);function n(){this.constructor=T}T.prototype=i===null?Object.create(i):(n.prototype=i.prototype,new n)}function w(T,i){var n=Object.setPrototypeOf;n?n(T,i):T.__proto__=i}function b(T,i){i===void 0&&(i=T.constructor);var n=Error.captureStackTrace;n&&n(T,i)}var C=(function(T){m(i,T);function i(n){var a=this.constructor,c=T.call(this,n)||this;return Object.defineProperty(c,"name",{value:a.name,enumerable:!1}),w(c,a.prototype),b(c),c}return i})(Error);class S extends C{constructor(i=void 0){super(i),this.message=i}getKind(){return this.constructor.kind}}S.kind="Exception";class M extends S{}M.kind="ArgumentException";class N extends S{}N.kind="IllegalArgumentException";class k{constructor(i){if(this.binarizer=i,i===null)throw new N("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(i,n){return this.binarizer.getBlackRow(i,n)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(i,n,a,c){const u=this.binarizer.getLuminanceSource().crop(i,n,a,c);return new k(this.binarizer.createBinarizer(u))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const i=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new k(this.binarizer.createBinarizer(i))}rotateCounterClockwise45(){const i=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new k(this.binarizer.createBinarizer(i))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class P extends S{static getChecksumInstance(){return new P}}P.kind="ChecksumException";class L{constructor(i){this.source=i}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class X{static arraycopy(i,n,a,c,u){for(;u--;)a[c++]=i[n++]}static currentTimeMillis(){return Date.now()}}class pe extends S{}pe.kind="IndexOutOfBoundsException";class me extends pe{constructor(i=void 0,n=void 0){super(n),this.index=i,this.message=n}}me.kind="ArrayIndexOutOfBoundsException";class he{static fill(i,n){for(let a=0,c=i.length;a<c;a++)i[a]=n}static fillWithin(i,n,a,c){he.rangeCheck(i.length,n,a);for(let u=n;u<a;u++)i[u]=c}static rangeCheck(i,n,a){if(n>a)throw new N("fromIndex("+n+") > toIndex("+a+")");if(n<0)throw new me(n);if(a>i)throw new me(a)}static asList(...i){return i}static create(i,n,a){return Array.from({length:i}).map(u=>Array.from({length:n}).fill(a))}static createInt32Array(i,n,a){return Array.from({length:i}).map(u=>Int32Array.from({length:n}).fill(a))}static equals(i,n){if(!i||!n||!i.length||!n.length||i.length!==n.length)return!1;for(let a=0,c=i.length;a<c;a++)if(i[a]!==n[a])return!1;return!0}static hashCode(i){if(i===null)return 0;let n=1;for(const a of i)n=31*n+a;return n}static fillUint8Array(i,n){for(let a=0;a!==i.length;a++)i[a]=n}static copyOf(i,n){return i.slice(0,n)}static copyOfUint8Array(i,n){if(i.length<=n){const a=new Uint8Array(n);return a.set(i),a}return i.slice(0,n)}static copyOfRange(i,n,a){const c=a-n,u=new Int32Array(c);return X.arraycopy(i,n,u,0,c),u}static binarySearch(i,n,a){a===void 0&&(a=he.numberComparator);let c=0,u=i.length-1;for(;c<=u;){const d=u+c>>1,_=a(n,i[d]);if(_>0)c=d+1;else if(_<0)u=d-1;else return d}return-c-1}static numberComparator(i,n){return i-n}}class te{static numberOfTrailingZeros(i){let n;if(i===0)return 32;let a=31;return n=i<<16,n!==0&&(a-=16,i=n),n=i<<8,n!==0&&(a-=8,i=n),n=i<<4,n!==0&&(a-=4,i=n),n=i<<2,n!==0&&(a-=2,i=n),a-(i<<1>>>31)}static numberOfLeadingZeros(i){if(i===0)return 32;let n=1;return i>>>16||(n+=16,i<<=16),i>>>24||(n+=8,i<<=8),i>>>28||(n+=4,i<<=4),i>>>30||(n+=2,i<<=2),n-=i>>>31,n}static toHexString(i){return i.toString(16)}static toBinaryString(i){return String(parseInt(String(i),2))}static bitCount(i){return i=i-(i>>>1&1431655765),i=(i&858993459)+(i>>>2&858993459),i=i+(i>>>4)&252645135,i=i+(i>>>8),i=i+(i>>>16),i&63}static truncDivision(i,n){return Math.trunc(i/n)}static parseInt(i,n=void 0){return parseInt(i,n)}}te.MIN_VALUE_32_BITS=-2147483648,te.MAX_VALUE=Number.MAX_SAFE_INTEGER;class le{constructor(i,n){i===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=i,n==null?this.bits=le.makeArray(i):this.bits=n)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(i){if(i>this.bits.length*32){const n=le.makeArray(i);X.arraycopy(this.bits,0,n,0,this.bits.length),this.bits=n}}get(i){return(this.bits[Math.floor(i/32)]&1<<(i&31))!==0}set(i){this.bits[Math.floor(i/32)]|=1<<(i&31)}flip(i){this.bits[Math.floor(i/32)]^=1<<(i&31)}getNextSet(i){const n=this.size;if(i>=n)return n;const a=this.bits;let c=Math.floor(i/32),u=a[c];u&=~((1<<(i&31))-1);const d=a.length;for(;u===0;){if(++c===d)return n;u=a[c]}const _=c*32+te.numberOfTrailingZeros(u);return _>n?n:_}getNextUnset(i){const n=this.size;if(i>=n)return n;const a=this.bits;let c=Math.floor(i/32),u=~a[c];u&=~((1<<(i&31))-1);const d=a.length;for(;u===0;){if(++c===d)return n;u=~a[c]}const _=c*32+te.numberOfTrailingZeros(u);return _>n?n:_}setBulk(i,n){this.bits[Math.floor(i/32)]=n}setRange(i,n){if(n<i||i<0||n>this.size)throw new N;if(n===i)return;n--;const a=Math.floor(i/32),c=Math.floor(n/32),u=this.bits;for(let d=a;d<=c;d++){const _=d>a?0:i&31,y=(2<<(d<c?31:n&31))-(1<<_);u[d]|=y}}clear(){const i=this.bits.length,n=this.bits;for(let a=0;a<i;a++)n[a]=0}isRange(i,n,a){if(n<i||i<0||n>this.size)throw new N;if(n===i)return!0;n--;const c=Math.floor(i/32),u=Math.floor(n/32),d=this.bits;for(let _=c;_<=u;_++){const x=_>c?0:i&31,E=(2<<(_<u?31:n&31))-(1<<x)&4294967295;if((d[_]&E)!==(a?E:0))return!1}return!0}appendBit(i){this.ensureCapacity(this.size+1),i&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(i,n){if(n<0||n>32)throw new N("Num bits must be between 0 and 32");this.ensureCapacity(this.size+n);for(let a=n;a>0;a--)this.appendBit((i>>a-1&1)===1)}appendBitArray(i){const n=i.size;this.ensureCapacity(this.size+n);for(let a=0;a<n;a++)this.appendBit(i.get(a))}xor(i){if(this.size!==i.size)throw new N("Sizes don't match");const n=this.bits;for(let a=0,c=n.length;a<c;a++)n[a]^=i.bits[a]}toBytes(i,n,a,c){for(let u=0;u<c;u++){let d=0;for(let _=0;_<8;_++)this.get(i)&&(d|=1<<7-_),i++;n[a+u]=d}}getBitArray(){return this.bits}reverse(){const i=new Int32Array(this.bits.length),n=Math.floor((this.size-1)/32),a=n+1,c=this.bits;for(let u=0;u<a;u++){let d=c[u];d=d>>1&1431655765|(d&1431655765)<<1,d=d>>2&858993459|(d&858993459)<<2,d=d>>4&252645135|(d&252645135)<<4,d=d>>8&16711935|(d&16711935)<<8,d=d>>16&65535|(d&65535)<<16,i[n-u]=d}if(this.size!==a*32){const u=a*32-this.size;let d=i[0]>>>u;for(let _=1;_<a;_++){const x=i[_];d|=x<<32-u,i[_-1]=d,d=x>>>u}i[a-1]=d}this.bits=i}static makeArray(i){return new Int32Array(Math.floor((i+31)/32))}equals(i){if(!(i instanceof le))return!1;const n=i;return this.size===n.size&&he.equals(this.bits,n.bits)}hashCode(){return 31*this.size+he.hashCode(this.bits)}toString(){let i="";for(let n=0,a=this.size;n<a;n++)(n&7)===0&&(i+=" "),i+=this.get(n)?"X":".";return i}clone(){return new le(this.size,this.bits.slice())}}var Oe;(function(T){T[T.OTHER=0]="OTHER",T[T.PURE_BARCODE=1]="PURE_BARCODE",T[T.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",T[T.TRY_HARDER=3]="TRY_HARDER",T[T.CHARACTER_SET=4]="CHARACTER_SET",T[T.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",T[T.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",T[T.ASSUME_GS1=7]="ASSUME_GS1",T[T.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",T[T.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",T[T.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Oe||(Oe={}));var Re=Oe;class Y extends S{static getFormatInstance(){return new Y}}Y.kind="FormatException";var Ne;(function(T){T[T.Cp437=0]="Cp437",T[T.ISO8859_1=1]="ISO8859_1",T[T.ISO8859_2=2]="ISO8859_2",T[T.ISO8859_3=3]="ISO8859_3",T[T.ISO8859_4=4]="ISO8859_4",T[T.ISO8859_5=5]="ISO8859_5",T[T.ISO8859_6=6]="ISO8859_6",T[T.ISO8859_7=7]="ISO8859_7",T[T.ISO8859_8=8]="ISO8859_8",T[T.ISO8859_9=9]="ISO8859_9",T[T.ISO8859_10=10]="ISO8859_10",T[T.ISO8859_11=11]="ISO8859_11",T[T.ISO8859_13=12]="ISO8859_13",T[T.ISO8859_14=13]="ISO8859_14",T[T.ISO8859_15=14]="ISO8859_15",T[T.ISO8859_16=15]="ISO8859_16",T[T.SJIS=16]="SJIS",T[T.Cp1250=17]="Cp1250",T[T.Cp1251=18]="Cp1251",T[T.Cp1252=19]="Cp1252",T[T.Cp1256=20]="Cp1256",T[T.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",T[T.UTF8=22]="UTF8",T[T.ASCII=23]="ASCII",T[T.Big5=24]="Big5",T[T.GB18030=25]="GB18030",T[T.EUC_KR=26]="EUC_KR"})(Ne||(Ne={}));class de{constructor(i,n,a,...c){this.valueIdentifier=i,this.name=a,typeof n=="number"?this.values=Int32Array.from([n]):this.values=n,this.otherEncodingNames=c,de.VALUE_IDENTIFIER_TO_ECI.set(i,this),de.NAME_TO_ECI.set(a,this);const u=this.values;for(let d=0,_=u.length;d!==_;d++){const x=u[d];de.VALUES_TO_ECI.set(x,this)}for(const d of c)de.NAME_TO_ECI.set(d,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(i){if(i<0||i>=900)throw new Y("incorect value");const n=de.VALUES_TO_ECI.get(i);if(n===void 0)throw new Y("incorect value");return n}static getCharacterSetECIByName(i){const n=de.NAME_TO_ECI.get(i);if(n===void 0)throw new Y("incorect value");return n}equals(i){if(!(i instanceof de))return!1;const n=i;return this.getName()===n.getName()}}de.VALUE_IDENTIFIER_TO_ECI=new Map,de.VALUES_TO_ECI=new Map,de.NAME_TO_ECI=new Map,de.Cp437=new de(Ne.Cp437,Int32Array.from([0,2]),"Cp437"),de.ISO8859_1=new de(Ne.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),de.ISO8859_2=new de(Ne.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),de.ISO8859_3=new de(Ne.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),de.ISO8859_4=new de(Ne.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),de.ISO8859_5=new de(Ne.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),de.ISO8859_6=new de(Ne.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),de.ISO8859_7=new de(Ne.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),de.ISO8859_8=new de(Ne.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),de.ISO8859_9=new de(Ne.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),de.ISO8859_10=new de(Ne.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),de.ISO8859_11=new de(Ne.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),de.ISO8859_13=new de(Ne.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),de.ISO8859_14=new de(Ne.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),de.ISO8859_15=new de(Ne.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),de.ISO8859_16=new de(Ne.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),de.SJIS=new de(Ne.SJIS,20,"SJIS","Shift_JIS"),de.Cp1250=new de(Ne.Cp1250,21,"Cp1250","windows-1250"),de.Cp1251=new de(Ne.Cp1251,22,"Cp1251","windows-1251"),de.Cp1252=new de(Ne.Cp1252,23,"Cp1252","windows-1252"),de.Cp1256=new de(Ne.Cp1256,24,"Cp1256","windows-1256"),de.UnicodeBigUnmarked=new de(Ne.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),de.UTF8=new de(Ne.UTF8,26,"UTF8","UTF-8"),de.ASCII=new de(Ne.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),de.Big5=new de(Ne.Big5,28,"Big5"),de.GB18030=new de(Ne.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),de.EUC_KR=new de(Ne.EUC_KR,30,"EUC_KR","EUC-KR");class Gt extends S{}Gt.kind="UnsupportedOperationException";class je{static decode(i,n){const a=this.encodingName(n);return this.customDecoder?this.customDecoder(i,a):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(a)?this.decodeFallback(i,a):new TextDecoder(a).decode(i)}static shouldDecodeOnFallback(i){return!je.isBrowser()&&i==="ISO-8859-1"}static encode(i,n){const a=this.encodingName(n);return this.customEncoder?this.customEncoder(i,a):typeof TextEncoder>"u"?this.encodeFallback(i):new TextEncoder().encode(i)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(i){return typeof i=="string"?i:i.getName()}static encodingCharacterSet(i){return i instanceof de?i:de.getCharacterSetECIByName(i)}static decodeFallback(i,n){const a=this.encodingCharacterSet(n);if(je.isDecodeFallbackSupported(a)){let c="";for(let u=0,d=i.length;u<d;u++){let _=i[u].toString(16);_.length<2&&(_="0"+_),c+="%"+_}return decodeURIComponent(c)}if(a.equals(de.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(i.buffer));throw new Gt(`Encoding ${this.encodingName(n)} not supported by fallback.`)}static isDecodeFallbackSupported(i){return i.equals(de.UTF8)||i.equals(de.ISO8859_1)||i.equals(de.ASCII)}static encodeFallback(i){const a=btoa(unescape(encodeURIComponent(i))).split(""),c=[];for(let u=0;u<a.length;u++)c.push(a[u].charCodeAt(0));return new Uint8Array(c)}}class oe{static castAsNonUtf8Char(i,n=null){const a=n?n.getName():this.ISO88591;return je.decode(new Uint8Array([i]),a)}static guessEncoding(i,n){if(n!=null&&n.get(Re.CHARACTER_SET)!==void 0)return n.get(Re.CHARACTER_SET).toString();const a=i.length;let c=!0,u=!0,d=!0,_=0,x=0,y=0,E=0,R=0,D=0,I=0,F=0,V=0,q=0,ie=0;const Ce=i.length>3&&i[0]===239&&i[1]===187&&i[2]===191;for(let we=0;we<a&&(c||u||d);we++){const ve=i[we]&255;d&&(_>0?(ve&128)===0?d=!1:_--:(ve&128)!==0&&((ve&64)===0?d=!1:(_++,(ve&32)===0?x++:(_++,(ve&16)===0?y++:(_++,(ve&8)===0?E++:d=!1))))),c&&(ve>127&&ve<160?c=!1:ve>159&&(ve<192||ve===215||ve===247)&&ie++),u&&(R>0?ve<64||ve===127||ve>252?u=!1:R--:ve===128||ve===160||ve>239?u=!1:ve>160&&ve<224?(D++,F=0,I++,I>V&&(V=I)):ve>127?(R++,I=0,F++,F>q&&(q=F)):(I=0,F=0))}return d&&_>0&&(d=!1),u&&R>0&&(u=!1),d&&(Ce||x+y+E>0)?oe.UTF8:u&&(oe.ASSUME_SHIFT_JIS||V>=3||q>=3)?oe.SHIFT_JIS:c&&u?V===2&&D===2||ie*10>=a?oe.SHIFT_JIS:oe.ISO88591:c?oe.ISO88591:u?oe.SHIFT_JIS:d?oe.UTF8:oe.PLATFORM_DEFAULT_ENCODING}static format(i,...n){let a=-1;function c(d,_,x,y,E,R){if(d==="%%")return"%";if(n[++a]===void 0)return;d=y?parseInt(y.substr(1)):void 0;let D=E?parseInt(E.substr(1)):void 0,I;switch(R){case"s":I=n[a];break;case"c":I=n[a][0];break;case"f":I=parseFloat(n[a]).toFixed(d);break;case"p":I=parseFloat(n[a]).toPrecision(d);break;case"e":I=parseFloat(n[a]).toExponential(d);break;case"x":I=parseInt(n[a]).toString(D||16);break;case"d":I=parseFloat(parseInt(n[a],D||10).toPrecision(d)).toFixed(0);break}I=typeof I=="object"?JSON.stringify(I):(+I).toString(D);let F=parseInt(x),V=x&&x[0]+""=="0"?"0":" ";for(;I.length<F;)I=_!==void 0?I+V:V+I;return I}let u=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return i.replace(u,c)}static getBytes(i,n){return je.encode(i,n)}static getCharCode(i,n=0){return i.charCodeAt(n)}static getCharAt(i){return String.fromCharCode(i)}}oe.SHIFT_JIS=de.SJIS.getName(),oe.GB2312="GB2312",oe.ISO88591=de.ISO8859_1.getName(),oe.EUC_JP="EUC_JP",oe.UTF8=de.UTF8.getName(),oe.PLATFORM_DEFAULT_ENCODING=oe.UTF8,oe.ASSUME_SHIFT_JIS=!1;class ae{constructor(i=""){this.value=i}enableDecoding(i){return this.encoding=i,this}append(i){return typeof i=="string"?this.value+=i.toString():this.encoding?this.value+=oe.castAsNonUtf8Char(i,this.encoding):this.value+=String.fromCharCode(i),this}appendChars(i,n,a){for(let c=n;n<n+a;c++)this.append(i[c]);return this}length(){return this.value.length}charAt(i){return this.value.charAt(i)}deleteCharAt(i){this.value=this.value.substr(0,i)+this.value.substring(i+1)}setCharAt(i,n){this.value=this.value.substr(0,i)+n+this.value.substr(i+1)}substring(i,n){return this.value.substring(i,n)}setLengthToZero(){this.value=""}toString(){return this.value}insert(i,n){this.value=this.value.substr(0,i)+n+this.value.substr(i+n.length)}}class Ee{constructor(i,n,a,c){if(this.width=i,this.height=n,this.rowSize=a,this.bits=c,n==null&&(n=i),this.height=n,i<1||n<1)throw new N("Both dimensions must be greater than 0");a==null&&(a=Math.floor((i+31)/32)),this.rowSize=a,c==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(i){const n=i.length,a=i[0].length,c=new Ee(a,n);for(let u=0;u<n;u++){const d=i[u];for(let _=0;_<a;_++)d[_]&&c.set(_,u)}return c}static parseFromString(i,n,a){if(i===null)throw new N("stringRepresentation cannot be null");const c=new Array(i.length);let u=0,d=0,_=-1,x=0,y=0;for(;y<i.length;)if(i.charAt(y)===`
`||i.charAt(y)==="\r"){if(u>d){if(_===-1)_=u-d;else if(u-d!==_)throw new N("row lengths do not match");d=u,x++}y++}else if(i.substring(y,y+n.length)===n)y+=n.length,c[u]=!0,u++;else if(i.substring(y,y+a.length)===a)y+=a.length,c[u]=!1,u++;else throw new N("illegal character encountered: "+i.substring(y));if(u>d){if(_===-1)_=u-d;else if(u-d!==_)throw new N("row lengths do not match");x++}const E=new Ee(_,x);for(let R=0;R<u;R++)c[R]&&E.set(Math.floor(R%_),Math.floor(R/_));return E}get(i,n){const a=n*this.rowSize+Math.floor(i/32);return(this.bits[a]>>>(i&31)&1)!==0}set(i,n){const a=n*this.rowSize+Math.floor(i/32);this.bits[a]|=1<<(i&31)&4294967295}unset(i,n){const a=n*this.rowSize+Math.floor(i/32);this.bits[a]&=~(1<<(i&31)&4294967295)}flip(i,n){const a=n*this.rowSize+Math.floor(i/32);this.bits[a]^=1<<(i&31)&4294967295}xor(i){if(this.width!==i.getWidth()||this.height!==i.getHeight()||this.rowSize!==i.getRowSize())throw new N("input matrix dimensions do not match");const n=new le(Math.floor(this.width/32)+1),a=this.rowSize,c=this.bits;for(let u=0,d=this.height;u<d;u++){const _=u*a,x=i.getRow(u,n).getBitArray();for(let y=0;y<a;y++)c[_+y]^=x[y]}}clear(){const i=this.bits,n=i.length;for(let a=0;a<n;a++)i[a]=0}setRegion(i,n,a,c){if(n<0||i<0)throw new N("Left and top must be nonnegative");if(c<1||a<1)throw new N("Height and width must be at least 1");const u=i+a,d=n+c;if(d>this.height||u>this.width)throw new N("The region must fit inside the matrix");const _=this.rowSize,x=this.bits;for(let y=n;y<d;y++){const E=y*_;for(let R=i;R<u;R++)x[E+Math.floor(R/32)]|=1<<(R&31)&4294967295}}getRow(i,n){n==null||n.getSize()<this.width?n=new le(this.width):n.clear();const a=this.rowSize,c=this.bits,u=i*a;for(let d=0;d<a;d++)n.setBulk(d*32,c[u+d]);return n}setRow(i,n){X.arraycopy(n.getBitArray(),0,this.bits,i*this.rowSize,this.rowSize)}rotate180(){const i=this.getWidth(),n=this.getHeight();let a=new le(i),c=new le(i);for(let u=0,d=Math.floor((n+1)/2);u<d;u++)a=this.getRow(u,a),c=this.getRow(n-1-u,c),a.reverse(),c.reverse(),this.setRow(u,c),this.setRow(n-1-u,a)}getEnclosingRectangle(){const i=this.width,n=this.height,a=this.rowSize,c=this.bits;let u=i,d=n,_=-1,x=-1;for(let y=0;y<n;y++)for(let E=0;E<a;E++){const R=c[y*a+E];if(R!==0){if(y<d&&(d=y),y>x&&(x=y),E*32<u){let D=0;for(;(R<<31-D&4294967295)===0;)D++;E*32+D<u&&(u=E*32+D)}if(E*32+31>_){let D=31;for(;!(R>>>D);)D--;E*32+D>_&&(_=E*32+D)}}}return _<u||x<d?null:Int32Array.from([u,d,_-u+1,x-d+1])}getTopLeftOnBit(){const i=this.rowSize,n=this.bits;let a=0;for(;a<n.length&&n[a]===0;)a++;if(a===n.length)return null;const c=a/i;let u=a%i*32;const d=n[a];let _=0;for(;(d<<31-_&4294967295)===0;)_++;return u+=_,Int32Array.from([u,c])}getBottomRightOnBit(){const i=this.rowSize,n=this.bits;let a=n.length-1;for(;a>=0&&n[a]===0;)a--;if(a<0)return null;const c=Math.floor(a/i);let u=Math.floor(a%i)*32;const d=n[a];let _=31;for(;!(d>>>_);)_--;return u+=_,Int32Array.from([u,c])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(i){if(!(i instanceof Ee))return!1;const n=i;return this.width===n.width&&this.height===n.height&&this.rowSize===n.rowSize&&he.equals(this.bits,n.bits)}hashCode(){let i=this.width;return i=31*i+this.width,i=31*i+this.height,i=31*i+this.rowSize,i=31*i+he.hashCode(this.bits),i}toString(i="X ",n="  ",a=`
`){return this.buildToString(i,n,a)}buildToString(i,n,a){let c=new ae;for(let u=0,d=this.height;u<d;u++){for(let _=0,x=this.width;_<x;_++)c.append(this.get(_,u)?i:n);c.append(a)}return c.toString()}clone(){return new Ee(this.width,this.height,this.rowSize,this.bits.slice())}}class U extends S{static getNotFoundInstance(){return new U}}U.kind="NotFoundException";class W extends L{constructor(i){super(i),this.luminances=W.EMPTY,this.buckets=new Int32Array(W.LUMINANCE_BUCKETS)}getBlackRow(i,n){const a=this.getLuminanceSource(),c=a.getWidth();n==null||n.getSize()<c?n=new le(c):n.clear(),this.initArrays(c);const u=a.getRow(i,this.luminances),d=this.buckets;for(let x=0;x<c;x++)d[(u[x]&255)>>W.LUMINANCE_SHIFT]++;const _=W.estimateBlackPoint(d);if(c<3)for(let x=0;x<c;x++)(u[x]&255)<_&&n.set(x);else{let x=u[0]&255,y=u[1]&255;for(let E=1;E<c-1;E++){const R=u[E+1]&255;(y*4-x-R)/2<_&&n.set(E),x=y,y=R}}return n}getBlackMatrix(){const i=this.getLuminanceSource(),n=i.getWidth(),a=i.getHeight(),c=new Ee(n,a);this.initArrays(n);const u=this.buckets;for(let x=1;x<5;x++){const y=Math.floor(a*x/5),E=i.getRow(y,this.luminances),R=Math.floor(n*4/5);for(let D=Math.floor(n/5);D<R;D++){const I=E[D]&255;u[I>>W.LUMINANCE_SHIFT]++}}const d=W.estimateBlackPoint(u),_=i.getMatrix();for(let x=0;x<a;x++){const y=x*n;for(let E=0;E<n;E++)(_[y+E]&255)<d&&c.set(E,x)}return c}createBinarizer(i){return new W(i)}initArrays(i){this.luminances.length<i&&(this.luminances=new Uint8ClampedArray(i));const n=this.buckets;for(let a=0;a<W.LUMINANCE_BUCKETS;a++)n[a]=0}static estimateBlackPoint(i){const n=i.length;let a=0,c=0,u=0;for(let E=0;E<n;E++)i[E]>u&&(c=E,u=i[E]),i[E]>a&&(a=i[E]);let d=0,_=0;for(let E=0;E<n;E++){const R=E-c,D=i[E]*R*R;D>_&&(d=E,_=D)}if(c>d){const E=c;c=d,d=E}if(d-c<=n/16)throw new U;let x=d-1,y=-1;for(let E=d-1;E>c;E--){const R=E-c,D=R*R*(d-E)*(a-i[E]);D>y&&(x=E,y=D)}return x<<W.LUMINANCE_SHIFT}}W.LUMINANCE_BITS=5,W.LUMINANCE_SHIFT=8-W.LUMINANCE_BITS,W.LUMINANCE_BUCKETS=1<<W.LUMINANCE_BITS,W.EMPTY=Uint8ClampedArray.from([0]);class Z extends W{constructor(i){super(i),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const i=this.getLuminanceSource(),n=i.getWidth(),a=i.getHeight();if(n>=Z.MINIMUM_DIMENSION&&a>=Z.MINIMUM_DIMENSION){const c=i.getMatrix();let u=n>>Z.BLOCK_SIZE_POWER;(n&Z.BLOCK_SIZE_MASK)!==0&&u++;let d=a>>Z.BLOCK_SIZE_POWER;(a&Z.BLOCK_SIZE_MASK)!==0&&d++;const _=Z.calculateBlackPoints(c,u,d,n,a),x=new Ee(n,a);Z.calculateThresholdForBlock(c,u,d,n,a,_,x),this.matrix=x}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(i){return new Z(i)}static calculateThresholdForBlock(i,n,a,c,u,d,_){const x=u-Z.BLOCK_SIZE,y=c-Z.BLOCK_SIZE;for(let E=0;E<a;E++){let R=E<<Z.BLOCK_SIZE_POWER;R>x&&(R=x);const D=Z.cap(E,2,a-3);for(let I=0;I<n;I++){let F=I<<Z.BLOCK_SIZE_POWER;F>y&&(F=y);const V=Z.cap(I,2,n-3);let q=0;for(let Ce=-2;Ce<=2;Ce++){const we=d[D+Ce];q+=we[V-2]+we[V-1]+we[V]+we[V+1]+we[V+2]}const ie=q/25;Z.thresholdBlock(i,F,R,ie,c,_)}}}static cap(i,n,a){return i<n?n:i>a?a:i}static thresholdBlock(i,n,a,c,u,d){for(let _=0,x=a*u+n;_<Z.BLOCK_SIZE;_++,x+=u)for(let y=0;y<Z.BLOCK_SIZE;y++)(i[x+y]&255)<=c&&d.set(n+y,a+_)}static calculateBlackPoints(i,n,a,c,u){const d=u-Z.BLOCK_SIZE,_=c-Z.BLOCK_SIZE,x=new Array(a);for(let y=0;y<a;y++){x[y]=new Int32Array(n);let E=y<<Z.BLOCK_SIZE_POWER;E>d&&(E=d);for(let R=0;R<n;R++){let D=R<<Z.BLOCK_SIZE_POWER;D>_&&(D=_);let I=0,F=255,V=0;for(let ie=0,Ce=E*c+D;ie<Z.BLOCK_SIZE;ie++,Ce+=c){for(let we=0;we<Z.BLOCK_SIZE;we++){const ve=i[Ce+we]&255;I+=ve,ve<F&&(F=ve),ve>V&&(V=ve)}if(V-F>Z.MIN_DYNAMIC_RANGE)for(ie++,Ce+=c;ie<Z.BLOCK_SIZE;ie++,Ce+=c)for(let we=0;we<Z.BLOCK_SIZE;we++)I+=i[Ce+we]&255}let q=I>>Z.BLOCK_SIZE_POWER*2;if(V-F<=Z.MIN_DYNAMIC_RANGE&&(q=F/2,y>0&&R>0)){const ie=(x[y-1][R]+2*x[y][R-1]+x[y-1][R-1])/4;F<ie&&(q=ie)}x[y][R]=q}}return x}}Z.BLOCK_SIZE_POWER=3,Z.BLOCK_SIZE=1<<Z.BLOCK_SIZE_POWER,Z.BLOCK_SIZE_MASK=Z.BLOCK_SIZE-1,Z.MINIMUM_DIMENSION=Z.BLOCK_SIZE*5,Z.MIN_DYNAMIC_RANGE=24;class ue{constructor(i,n){this.width=i,this.height=n}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(i,n,a,c){throw new Gt("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Gt("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Gt("This luminance source does not support rotation by 45 degrees.")}toString(){const i=new Uint8ClampedArray(this.width);let n=new ae;for(let a=0;a<this.height;a++){const c=this.getRow(a,i);for(let u=0;u<this.width;u++){const d=c[u]&255;let _;d<64?_="#":d<128?_="+":d<192?_=".":_=" ",n.append(_)}n.append(`
`)}return n.toString()}}class Le extends ue{constructor(i){super(i.getWidth(),i.getHeight()),this.delegate=i}getRow(i,n){const a=this.delegate.getRow(i,n),c=this.getWidth();for(let u=0;u<c;u++)a[u]=255-(a[u]&255);return a}getMatrix(){const i=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n);for(let c=0;c<n;c++)a[c]=255-(i[c]&255);return a}isCropSupported(){return this.delegate.isCropSupported()}crop(i,n,a,c){return new Le(this.delegate.crop(i,n,a,c))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Le(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Le(this.delegate.rotateCounterClockwise45())}}class Me extends ue{constructor(i){super(i.width,i.height),this.canvas=i,this.tempCanvasElement=null,this.buffer=Me.makeBufferFromCanvasImageData(i)}static makeBufferFromCanvasImageData(i){const n=i.getContext("2d").getImageData(0,0,i.width,i.height);return Me.toGrayscaleBuffer(n.data,i.width,i.height)}static toGrayscaleBuffer(i,n,a){const c=new Uint8ClampedArray(n*a);for(let u=0,d=0,_=i.length;u<_;u+=4,d++){let x;if(i[u+3]===0)x=255;else{const E=i[u],R=i[u+1],D=i[u+2];x=306*E+601*R+117*D+512>>10}c[d]=x}return c}getRow(i,n){if(i<0||i>=this.getHeight())throw new N("Requested row is outside the image: "+i);const a=this.getWidth(),c=i*a;return n===null?n=this.buffer.slice(c,c+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(c,c+a))),n}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(i,n,a,c){return super.crop(i,n,a,c),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const i=this.canvas.ownerDocument.createElement("canvas");i.width=this.canvas.width,i.height=this.canvas.height,this.tempCanvasElement=i}return this.tempCanvasElement}rotate(i){const n=this.getTempCanvasElement(),a=n.getContext("2d"),c=i*Me.DEGREE_TO_RADIANS,u=this.canvas.width,d=this.canvas.height,_=Math.ceil(Math.abs(Math.cos(c))*u+Math.abs(Math.sin(c))*d),x=Math.ceil(Math.abs(Math.sin(c))*u+Math.abs(Math.cos(c))*d);return n.width=_,n.height=x,a.translate(_/2,x/2),a.rotate(c),a.drawImage(this.canvas,u/-2,d/-2),this.buffer=Me.makeBufferFromCanvasImageData(n),this}invert(){return new Le(this)}}Me.DEGREE_TO_RADIANS=Math.PI/180;class H{constructor(i,n,a){this.deviceId=i,this.label=n,this.kind="videoinput",this.groupId=a||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var re=(globalThis||lh||self||window||void 0)&&(globalThis||lh||self||window||void 0).__awaiter||function(T,i,n,a){function c(u){return u instanceof n?u:new n(function(d){d(u)})}return new(n||(n=Promise))(function(u,d){function _(E){try{y(a.next(E))}catch(R){d(R)}}function x(E){try{y(a.throw(E))}catch(R){d(R)}}function y(E){E.done?u(E.value):c(E.value).then(_,x)}y((a=a.apply(T,i||[])).next())})};class ye{constructor(i,n=500,a){this.reader=i,this.timeBetweenScansMillis=n,this._hints=a,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(i){this._timeBetweenDecodingAttempts=i<0?0:i}set hints(i){this._hints=i||null}get hints(){return this._hints}listVideoInputDevices(){return re(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const i=yield navigator.mediaDevices.enumerateDevices(),n=[];for(const a of i){const c=a.kind==="video"?"videoinput":a.kind;if(c!=="videoinput")continue;const u=a.deviceId||a.id,d=a.label||`Video device ${n.length+1}`,_=a.groupId,x={deviceId:u,label:d,kind:c,groupId:_};n.push(x)}return n})}getVideoInputDevices(){return re(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(n=>new H(n.deviceId,n.label))})}findDeviceById(i){return re(this,void 0,void 0,function*(){const n=yield this.listVideoInputDevices();return n?n.find(a=>a.deviceId===i):null})}decodeFromInputVideoDevice(i,n){return re(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(i,n)})}decodeOnceFromVideoDevice(i,n){return re(this,void 0,void 0,function*(){this.reset();let a;i?a={deviceId:{exact:i}}:a={facingMode:"environment"};const c={video:a};return yield this.decodeOnceFromConstraints(c,n)})}decodeOnceFromConstraints(i,n){return re(this,void 0,void 0,function*(){const a=yield navigator.mediaDevices.getUserMedia(i);return yield this.decodeOnceFromStream(a,n)})}decodeOnceFromStream(i,n){return re(this,void 0,void 0,function*(){this.reset();const a=yield this.attachStreamToVideo(i,n);return yield this.decodeOnce(a)})}decodeFromInputVideoDeviceContinuously(i,n,a){return re(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(i,n,a)})}decodeFromVideoDevice(i,n,a){return re(this,void 0,void 0,function*(){let c;i?c={deviceId:{exact:i}}:c={facingMode:"environment"};const u={video:c};return yield this.decodeFromConstraints(u,n,a)})}decodeFromConstraints(i,n,a){return re(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(i);return yield this.decodeFromStream(c,n,a)})}decodeFromStream(i,n,a){return re(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(i,n);return yield this.decodeContinuously(c,a)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(i,n){return re(this,void 0,void 0,function*(){const a=this.prepareVideoElement(n);return this.addVideoSource(a,i),this.videoElement=a,this.stream=i,yield this.playVideoOnLoadAsync(a),a})}playVideoOnLoadAsync(i){return new Promise((n,a)=>this.playVideoOnLoad(i,()=>n()))}playVideoOnLoad(i,n){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(i),i.addEventListener("ended",this.videoEndedListener),i.addEventListener("canplay",this.videoCanPlayListener),i.addEventListener("playing",n),this.tryPlayVideo(i)}isVideoPlaying(i){return i.currentTime>0&&!i.paused&&!i.ended&&i.readyState>2}tryPlayVideo(i){return re(this,void 0,void 0,function*(){if(this.isVideoPlaying(i)){console.warn("Trying to play video that is already playing.");return}try{yield i.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(i,n){const a=document.getElementById(i);if(!a)throw new M(`element with id '${i}' not found`);if(a.nodeName.toLowerCase()!==n.toLowerCase())throw new M(`element with id '${i}' must be an ${n} element`);return a}decodeFromImage(i,n){if(!i&&!n)throw new M("either imageElement with a src set or an url must be provided");return n&&!i?this.decodeFromImageUrl(n):this.decodeFromImageElement(i)}decodeFromVideo(i,n){if(!i&&!n)throw new M("Either an element with a src set or an URL must be provided");return n&&!i?this.decodeFromVideoUrl(n):this.decodeFromVideoElement(i)}decodeFromVideoContinuously(i,n,a){if(i===void 0&&n===void 0)throw new M("Either an element with a src set or an URL must be provided");return n&&!i?this.decodeFromVideoUrlContinuously(n,a):this.decodeFromVideoElementContinuously(i,a)}decodeFromImageElement(i){if(!i)throw new M("An image element must be provided.");this.reset();const n=this.prepareImageElement(i);this.imageElement=n;let a;return this.isImageLoaded(n)?a=this.decodeOnce(n,!1,!0):a=this._decodeOnLoadImage(n),a}decodeFromVideoElement(i){const n=this._decodeFromVideoElementSetup(i);return this._decodeOnLoadVideo(n)}decodeFromVideoElementContinuously(i,n){const a=this._decodeFromVideoElementSetup(i);return this._decodeOnLoadVideoContinuously(a,n)}_decodeFromVideoElementSetup(i){if(!i)throw new M("A video element must be provided.");this.reset();const n=this.prepareVideoElement(i);return this.videoElement=n,n}decodeFromImageUrl(i){if(!i)throw new M("An URL must be provided.");this.reset();const n=this.prepareImageElement();this.imageElement=n;const a=this._decodeOnLoadImage(n);return n.src=i,a}decodeFromVideoUrl(i){if(!i)throw new M("An URL must be provided.");this.reset();const n=this.prepareVideoElement(),a=this.decodeFromVideoElement(n);return n.src=i,a}decodeFromVideoUrlContinuously(i,n){if(!i)throw new M("An URL must be provided.");this.reset();const a=this.prepareVideoElement(),c=this.decodeFromVideoElementContinuously(a,n);return a.src=i,c}_decodeOnLoadImage(i){return new Promise((n,a)=>{this.imageLoadedListener=()=>this.decodeOnce(i,!1,!0).then(n,a),i.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(i){return re(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(i),yield this.decodeOnce(i)})}_decodeOnLoadVideoContinuously(i,n){return re(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(i),this.decodeContinuously(i,n)})}isImageLoaded(i){return!(!i.complete||i.naturalWidth===0)}prepareImageElement(i){let n;return typeof i>"u"&&(n=document.createElement("img"),n.width=200,n.height=200),typeof i=="string"&&(n=this.getMediaElement(i,"img")),i instanceof HTMLImageElement&&(n=i),n}prepareVideoElement(i){let n;return!i&&typeof document<"u"&&(n=document.createElement("video"),n.width=200,n.height=200),typeof i=="string"&&(n=this.getMediaElement(i,"video")),i instanceof HTMLVideoElement&&(n=i),n.setAttribute("autoplay","true"),n.setAttribute("muted","true"),n.setAttribute("playsinline","true"),n}decodeOnce(i,n=!0,a=!0){this._stopAsyncDecode=!1;const c=(u,d)=>{if(this._stopAsyncDecode){d(new U("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const _=this.decode(i);u(_)}catch(_){const x=n&&_ instanceof U,E=(_ instanceof P||_ instanceof Y)&&a;if(x||E)return setTimeout(c,this._timeBetweenDecodingAttempts,u,d);d(_)}};return new Promise((u,d)=>c(u,d))}decodeContinuously(i,n){this._stopContinuousDecode=!1;const a=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const c=this.decode(i);n(c,null),setTimeout(a,this.timeBetweenScansMillis)}catch(c){n(null,c);const u=c instanceof P||c instanceof Y,d=c instanceof U;(u||d)&&setTimeout(a,this._timeBetweenDecodingAttempts)}};a()}decode(i){const n=this.createBinaryBitmap(i);return this.decodeBitmap(n)}_isHTMLVideoElement(i){return i.videoWidth!==0}drawFrameOnCanvas(i,n,a){n||(n={sx:0,sy:0,sWidth:i.videoWidth,sHeight:i.videoHeight,dx:0,dy:0,dWidth:i.videoWidth,dHeight:i.videoHeight}),a||(a=this.captureCanvasContext),a.drawImage(i,n.sx,n.sy,n.sWidth,n.sHeight,n.dx,n.dy,n.dWidth,n.dHeight)}drawImageOnCanvas(i,n,a=this.captureCanvasContext){n||(n={sx:0,sy:0,sWidth:i.naturalWidth,sHeight:i.naturalHeight,dx:0,dy:0,dWidth:i.naturalWidth,dHeight:i.naturalHeight}),a||(a=this.captureCanvasContext),a.drawImage(i,n.sx,n.sy,n.sWidth,n.sHeight,n.dx,n.dy,n.dWidth,n.dHeight)}createBinaryBitmap(i){this.getCaptureCanvasContext(i),this._isHTMLVideoElement(i)?this.drawFrameOnCanvas(i):this.drawImageOnCanvas(i);const n=this.getCaptureCanvas(i),a=new Me(n),c=new Z(a);return new k(c)}getCaptureCanvasContext(i){if(!this.captureCanvasContext){const a=this.getCaptureCanvas(i).getContext("2d");this.captureCanvasContext=a}return this.captureCanvasContext}getCaptureCanvas(i){if(!this.captureCanvas){const n=this.createCaptureCanvas(i);this.captureCanvas=n}return this.captureCanvas}decodeBitmap(i){return this.reader.decode(i,this._hints)}createCaptureCanvas(i){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const n=document.createElement("canvas");let a,c;return typeof i<"u"&&(i instanceof HTMLVideoElement?(a=i.videoWidth,c=i.videoHeight):i instanceof HTMLImageElement&&(a=i.naturalWidth||i.width,c=i.naturalHeight||i.height)),n.style.width=a+"px",n.style.height=c+"px",n.width=a,n.height=c,n}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(i=>i.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(i,n){try{i.srcObject=n}catch{i.src=URL.createObjectURL(n)}}cleanVideoSource(i){try{i.srcObject=null}catch{i.src=""}this.videoElement.removeAttribute("src")}}class be{constructor(i,n,a=n==null?0:8*n.length,c,u,d=X.currentTimeMillis()){this.text=i,this.rawBytes=n,this.numBits=a,this.resultPoints=c,this.format=u,this.timestamp=d,this.text=i,this.rawBytes=n,a==null?this.numBits=n==null?0:8*n.length:this.numBits=a,this.resultPoints=c,this.format=u,this.resultMetadata=null,d==null?this.timestamp=X.currentTimeMillis():this.timestamp=d}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(i,n){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(i,n)}putAllMetadata(i){i!==null&&(this.resultMetadata===null?this.resultMetadata=i:this.resultMetadata=new Map(i))}addResultPoints(i){const n=this.resultPoints;if(n===null)this.resultPoints=i;else if(i!==null&&i.length>0){const a=new Array(n.length+i.length);X.arraycopy(n,0,a,0,n.length),X.arraycopy(i,0,a,n.length,i.length),this.resultPoints=a}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Ve;(function(T){T[T.AZTEC=0]="AZTEC",T[T.CODABAR=1]="CODABAR",T[T.CODE_39=2]="CODE_39",T[T.CODE_93=3]="CODE_93",T[T.CODE_128=4]="CODE_128",T[T.DATA_MATRIX=5]="DATA_MATRIX",T[T.EAN_8=6]="EAN_8",T[T.EAN_13=7]="EAN_13",T[T.ITF=8]="ITF",T[T.MAXICODE=9]="MAXICODE",T[T.PDF_417=10]="PDF_417",T[T.QR_CODE=11]="QR_CODE",T[T.RSS_14=12]="RSS_14",T[T.RSS_EXPANDED=13]="RSS_EXPANDED",T[T.UPC_A=14]="UPC_A",T[T.UPC_E=15]="UPC_E",T[T.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ve||(Ve={}));var Se=Ve,$e;(function(T){T[T.OTHER=0]="OTHER",T[T.ORIENTATION=1]="ORIENTATION",T[T.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",T[T.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",T[T.ISSUE_NUMBER=4]="ISSUE_NUMBER",T[T.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",T[T.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",T[T.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",T[T.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",T[T.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",T[T.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})($e||($e={}));var ot=$e;class dt{constructor(i,n,a,c,u=-1,d=-1){this.rawBytes=i,this.text=n,this.byteSegments=a,this.ecLevel=c,this.structuredAppendSequenceNumber=u,this.structuredAppendParity=d,this.numBits=i==null?0:8*i.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(i){this.numBits=i}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(i){this.errorsCorrected=i}getErasures(){return this.erasures}setErasures(i){this.erasures=i}getOther(){return this.other}setOther(i){this.other=i}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class $i{exp(i){return this.expTable[i]}log(i){if(i===0)throw new N;return this.logTable[i]}static addOrSubtract(i,n){return i^n}}class Xt{constructor(i,n){if(n.length===0)throw new N;this.field=i;const a=n.length;if(a>1&&n[0]===0){let c=1;for(;c<a&&n[c]===0;)c++;c===a?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(a-c),X.arraycopy(n,c,this.coefficients,0,this.coefficients.length))}else this.coefficients=n}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(i){return this.coefficients[this.coefficients.length-1-i]}evaluateAt(i){if(i===0)return this.getCoefficient(0);const n=this.coefficients;let a;if(i===1){a=0;for(let d=0,_=n.length;d!==_;d++){const x=n[d];a=$i.addOrSubtract(a,x)}return a}a=n[0];const c=n.length,u=this.field;for(let d=1;d<c;d++)a=$i.addOrSubtract(u.multiply(i,a),n[d]);return a}addOrSubtract(i){if(!this.field.equals(i.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero())return i;if(i.isZero())return this;let n=this.coefficients,a=i.coefficients;if(n.length>a.length){const d=n;n=a,a=d}let c=new Int32Array(a.length);const u=a.length-n.length;X.arraycopy(a,0,c,0,u);for(let d=u;d<a.length;d++)c[d]=$i.addOrSubtract(n[d-u],a[d]);return new Xt(this.field,c)}multiply(i){if(!this.field.equals(i.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero()||i.isZero())return this.field.getZero();const n=this.coefficients,a=n.length,c=i.coefficients,u=c.length,d=new Int32Array(a+u-1),_=this.field;for(let x=0;x<a;x++){const y=n[x];for(let E=0;E<u;E++)d[x+E]=$i.addOrSubtract(d[x+E],_.multiply(y,c[E]))}return new Xt(_,d)}multiplyScalar(i){if(i===0)return this.field.getZero();if(i===1)return this;const n=this.coefficients.length,a=this.field,c=new Int32Array(n),u=this.coefficients;for(let d=0;d<n;d++)c[d]=a.multiply(u[d],i);return new Xt(a,c)}multiplyByMonomial(i,n){if(i<0)throw new N;if(n===0)return this.field.getZero();const a=this.coefficients,c=a.length,u=new Int32Array(c+i),d=this.field;for(let _=0;_<c;_++)u[_]=d.multiply(a[_],n);return new Xt(d,u)}divide(i){if(!this.field.equals(i.field))throw new N("GenericGFPolys do not have same GenericGF field");if(i.isZero())throw new N("Divide by 0");const n=this.field;let a=n.getZero(),c=this;const u=i.getCoefficient(i.getDegree()),d=n.inverse(u);for(;c.getDegree()>=i.getDegree()&&!c.isZero();){const _=c.getDegree()-i.getDegree(),x=n.multiply(c.getCoefficient(c.getDegree()),d),y=i.multiplyByMonomial(_,x),E=n.buildMonomial(_,x);a=a.addOrSubtract(E),c=c.addOrSubtract(y)}return[a,c]}toString(){let i="";for(let n=this.getDegree();n>=0;n--){let a=this.getCoefficient(n);if(a!==0){if(a<0?(i+=" - ",a=-a):i.length>0&&(i+=" + "),n===0||a!==1){const c=this.field.log(a);c===0?i+="1":c===1?i+="a":(i+="a^",i+=c)}n!==0&&(n===1?i+="x":(i+="x^",i+=n))}}return i}}class Gi extends S{}Gi.kind="ArithmeticException";class ze extends $i{constructor(i,n,a){super(),this.primitive=i,this.size=n,this.generatorBase=a;const c=new Int32Array(n);let u=1;for(let _=0;_<n;_++)c[_]=u,u*=2,u>=n&&(u^=i,u&=n-1);this.expTable=c;const d=new Int32Array(n);for(let _=0;_<n-1;_++)d[c[_]]=_;this.logTable=d,this.zero=new Xt(this,Int32Array.from([0])),this.one=new Xt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(i,n){if(i<0)throw new N;if(n===0)return this.zero;const a=new Int32Array(i+1);return a[0]=n,new Xt(this,a)}inverse(i){if(i===0)throw new Gi;return this.expTable[this.size-this.logTable[i]-1]}multiply(i,n){return i===0||n===0?0:this.expTable[(this.logTable[i]+this.logTable[n])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+te.toHexString(this.primitive)+","+this.size+")"}equals(i){return i===this}}ze.AZTEC_DATA_12=new ze(4201,4096,1),ze.AZTEC_DATA_10=new ze(1033,1024,1),ze.AZTEC_DATA_6=new ze(67,64,1),ze.AZTEC_PARAM=new ze(19,16,1),ze.QR_CODE_FIELD_256=new ze(285,256,0),ze.DATA_MATRIX_FIELD_256=new ze(301,256,1),ze.AZTEC_DATA_8=ze.DATA_MATRIX_FIELD_256,ze.MAXICODE_FIELD_64=ze.AZTEC_DATA_6;class Li extends S{}Li.kind="ReedSolomonException";class fs extends S{}fs.kind="IllegalStateException";class Br{constructor(i){this.field=i}decode(i,n){const a=this.field,c=new Xt(a,i),u=new Int32Array(n);let d=!0;for(let I=0;I<n;I++){const F=c.evaluateAt(a.exp(I+a.getGeneratorBase()));u[u.length-1-I]=F,F!==0&&(d=!1)}if(d)return;const _=new Xt(a,u),x=this.runEuclideanAlgorithm(a.buildMonomial(n,1),_,n),y=x[0],E=x[1],R=this.findErrorLocations(y),D=this.findErrorMagnitudes(E,R);for(let I=0;I<R.length;I++){const F=i.length-1-a.log(R[I]);if(F<0)throw new Li("Bad error location");i[F]=ze.addOrSubtract(i[F],D[I])}}runEuclideanAlgorithm(i,n,a){if(i.getDegree()<n.getDegree()){const I=i;i=n,n=I}const c=this.field;let u=i,d=n,_=c.getZero(),x=c.getOne();for(;d.getDegree()>=(a/2|0);){let I=u,F=_;if(u=d,_=x,u.isZero())throw new Li("r_{i-1} was zero");d=I;let V=c.getZero();const q=u.getCoefficient(u.getDegree()),ie=c.inverse(q);for(;d.getDegree()>=u.getDegree()&&!d.isZero();){const Ce=d.getDegree()-u.getDegree(),we=c.multiply(d.getCoefficient(d.getDegree()),ie);V=V.addOrSubtract(c.buildMonomial(Ce,we)),d=d.addOrSubtract(u.multiplyByMonomial(Ce,we))}if(x=V.multiply(_).addOrSubtract(F),d.getDegree()>=u.getDegree())throw new fs("Division algorithm failed to reduce polynomial?")}const y=x.getCoefficient(0);if(y===0)throw new Li("sigmaTilde(0) was zero");const E=c.inverse(y),R=x.multiplyScalar(E),D=d.multiplyScalar(E);return[R,D]}findErrorLocations(i){const n=i.getDegree();if(n===1)return Int32Array.from([i.getCoefficient(1)]);const a=new Int32Array(n);let c=0;const u=this.field;for(let d=1;d<u.getSize()&&c<n;d++)i.evaluateAt(d)===0&&(a[c]=u.inverse(d),c++);if(c!==n)throw new Li("Error locator degree does not match number of roots");return a}findErrorMagnitudes(i,n){const a=n.length,c=new Int32Array(a),u=this.field;for(let d=0;d<a;d++){const _=u.inverse(n[d]);let x=1;for(let y=0;y<a;y++)if(d!==y){const E=u.multiply(n[y],_),R=(E&1)===0?E|1:E&-2;x=u.multiply(x,R)}c[d]=u.multiply(i.evaluateAt(_),u.inverse(x)),u.getGeneratorBase()!==0&&(c[d]=u.multiply(c[d],_))}return c}}var Ti;(function(T){T[T.UPPER=0]="UPPER",T[T.LOWER=1]="LOWER",T[T.MIXED=2]="MIXED",T[T.DIGIT=3]="DIGIT",T[T.PUNCT=4]="PUNCT",T[T.BINARY=5]="BINARY"})(Ti||(Ti={}));class Dt{decode(i){this.ddata=i;let n=i.getBits(),a=this.extractBits(n),c=this.correctBits(a),u=Dt.convertBoolArrayToByteArray(c),d=Dt.getEncodedData(c),_=new dt(u,d,null,null);return _.setNumBits(c.length),_}static highLevelDecode(i){return this.getEncodedData(i)}static getEncodedData(i){let n=i.length,a=Ti.UPPER,c=Ti.UPPER,u="",d=0;for(;d<n;)if(c===Ti.BINARY){if(n-d<5)break;let _=Dt.readCode(i,d,5);if(d+=5,_===0){if(n-d<11)break;_=Dt.readCode(i,d,11)+31,d+=11}for(let x=0;x<_;x++){if(n-d<8){d=n;break}const y=Dt.readCode(i,d,8);u+=oe.castAsNonUtf8Char(y),d+=8}c=a}else{let _=c===Ti.DIGIT?4:5;if(n-d<_)break;let x=Dt.readCode(i,d,_);d+=_;let y=Dt.getCharacter(c,x);y.startsWith("CTRL_")?(a=c,c=Dt.getTable(y.charAt(5)),y.charAt(6)==="L"&&(a=c)):(u+=y,c=a)}return u}static getTable(i){switch(i){case"L":return Ti.LOWER;case"P":return Ti.PUNCT;case"M":return Ti.MIXED;case"D":return Ti.DIGIT;case"B":return Ti.BINARY;default:return Ti.UPPER}}static getCharacter(i,n){switch(i){case Ti.UPPER:return Dt.UPPER_TABLE[n];case Ti.LOWER:return Dt.LOWER_TABLE[n];case Ti.MIXED:return Dt.MIXED_TABLE[n];case Ti.PUNCT:return Dt.PUNCT_TABLE[n];case Ti.DIGIT:return Dt.DIGIT_TABLE[n];default:throw new fs("Bad table")}}correctBits(i){let n,a;this.ddata.getNbLayers()<=2?(a=6,n=ze.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(a=8,n=ze.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(a=10,n=ze.AZTEC_DATA_10):(a=12,n=ze.AZTEC_DATA_12);let c=this.ddata.getNbDatablocks(),u=i.length/a;if(u<c)throw new Y;let d=i.length%a,_=new Int32Array(u);for(let D=0;D<u;D++,d+=a)_[D]=Dt.readCode(i,d,a);try{new Br(n).decode(_,u-c)}catch(D){throw new Y(D)}let x=(1<<a)-1,y=0;for(let D=0;D<c;D++){let I=_[D];if(I===0||I===x)throw new Y;(I===1||I===x-1)&&y++}let E=new Array(c*a-y),R=0;for(let D=0;D<c;D++){let I=_[D];if(I===1||I===x-1)E.fill(I>1,R,R+a-1),R+=a-1;else for(let F=a-1;F>=0;--F)E[R++]=(I&1<<F)!==0}return E}extractBits(i){let n=this.ddata.isCompact(),a=this.ddata.getNbLayers(),c=(n?11:14)+a*4,u=new Int32Array(c),d=new Array(this.totalBitsInLayer(a,n));if(n)for(let _=0;_<u.length;_++)u[_]=_;else{let _=c+1+2*te.truncDivision(te.truncDivision(c,2)-1,15),x=c/2,y=te.truncDivision(_,2);for(let E=0;E<x;E++){let R=E+te.truncDivision(E,15);u[x-E-1]=y-R-1,u[x+E]=y+R+1}}for(let _=0,x=0;_<a;_++){let y=(a-_)*4+(n?9:12),E=_*2,R=c-1-E;for(let D=0;D<y;D++){let I=D*2;for(let F=0;F<2;F++)d[x+I+F]=i.get(u[E+F],u[E+D]),d[x+2*y+I+F]=i.get(u[E+D],u[R-F]),d[x+4*y+I+F]=i.get(u[R-F],u[R-D]),d[x+6*y+I+F]=i.get(u[R-D],u[E+F])}x+=y*8}return d}static readCode(i,n,a){let c=0;for(let u=n;u<n+a;u++)c<<=1,i[u]&&(c|=1);return c}static readByte(i,n){let a=i.length-n;return a>=8?Dt.readCode(i,n,8):Dt.readCode(i,n,a)<<8-a}static convertBoolArrayToByteArray(i){let n=new Uint8Array((i.length+7)/8);for(let a=0;a<n.length;a++)n[a]=Dt.readByte(i,8*a);return n}totalBitsInLayer(i,n){return((n?88:112)+16*i)*i}}Dt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Dt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Dt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Dt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Dt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class ct{constructor(){}static round(i){return i===NaN?0:i<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:i>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:i+(i<0?-.5:.5)|0}static distance(i,n,a,c){const u=i-a,d=n-c;return Math.sqrt(u*u+d*d)}static sum(i){let n=0;for(let a=0,c=i.length;a!==c;a++){const u=i[a];n+=u}return n}}class cn{static floatToIntBits(i){return i}}cn.MAX_VALUE=Number.MAX_SAFE_INTEGER;class Pe{constructor(i,n){this.x=i,this.y=n}getX(){return this.x}getY(){return this.y}equals(i){if(i instanceof Pe){const n=i;return this.x===n.x&&this.y===n.y}return!1}hashCode(){return 31*cn.floatToIntBits(this.x)+cn.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(i){const n=this.distance(i[0],i[1]),a=this.distance(i[1],i[2]),c=this.distance(i[0],i[2]);let u,d,_;if(a>=n&&a>=c?(d=i[0],u=i[1],_=i[2]):c>=a&&c>=n?(d=i[1],u=i[0],_=i[2]):(d=i[2],u=i[0],_=i[1]),this.crossProductZ(u,d,_)<0){const x=u;u=_,_=x}i[0]=u,i[1]=d,i[2]=_}static distance(i,n){return ct.distance(i.x,i.y,n.x,n.y)}static crossProductZ(i,n,a){const c=n.x,u=n.y;return(a.x-c)*(i.y-u)-(a.y-u)*(i.x-c)}}class Ia{constructor(i,n){this.bits=i,this.points=n}getBits(){return this.bits}getPoints(){return this.points}}class Wo extends Ia{constructor(i,n,a,c,u){super(i,n),this.compact=a,this.nbDatablocks=c,this.nbLayers=u}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class ti{constructor(i,n,a,c){this.image=i,this.height=i.getHeight(),this.width=i.getWidth(),n==null&&(n=ti.INIT_SIZE),a==null&&(a=i.getWidth()/2|0),c==null&&(c=i.getHeight()/2|0);const u=n/2|0;if(this.leftInit=a-u,this.rightInit=a+u,this.upInit=c-u,this.downInit=c+u,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new U}detect(){let i=this.leftInit,n=this.rightInit,a=this.upInit,c=this.downInit,u=!1,d=!0,_=!1,x=!1,y=!1,E=!1,R=!1;const D=this.width,I=this.height;for(;d;){d=!1;let F=!0;for(;(F||!x)&&n<D;)F=this.containsBlackPoint(a,c,n,!1),F?(n++,d=!0,x=!0):x||n++;if(n>=D){u=!0;break}let V=!0;for(;(V||!y)&&c<I;)V=this.containsBlackPoint(i,n,c,!0),V?(c++,d=!0,y=!0):y||c++;if(c>=I){u=!0;break}let q=!0;for(;(q||!E)&&i>=0;)q=this.containsBlackPoint(a,c,i,!1),q?(i--,d=!0,E=!0):E||i--;if(i<0){u=!0;break}let ie=!0;for(;(ie||!R)&&a>=0;)ie=this.containsBlackPoint(i,n,a,!0),ie?(a--,d=!0,R=!0):R||a--;if(a<0){u=!0;break}d&&(_=!0)}if(!u&&_){const F=n-i;let V=null;for(let we=1;V===null&&we<F;we++)V=this.getBlackPointOnSegment(i,c-we,i+we,c);if(V==null)throw new U;let q=null;for(let we=1;q===null&&we<F;we++)q=this.getBlackPointOnSegment(i,a+we,i+we,a);if(q==null)throw new U;let ie=null;for(let we=1;ie===null&&we<F;we++)ie=this.getBlackPointOnSegment(n,a+we,n-we,a);if(ie==null)throw new U;let Ce=null;for(let we=1;Ce===null&&we<F;we++)Ce=this.getBlackPointOnSegment(n,c-we,n-we,c);if(Ce==null)throw new U;return this.centerEdges(Ce,V,ie,q)}else throw new U}getBlackPointOnSegment(i,n,a,c){const u=ct.round(ct.distance(i,n,a,c)),d=(a-i)/u,_=(c-n)/u,x=this.image;for(let y=0;y<u;y++){const E=ct.round(i+y*d),R=ct.round(n+y*_);if(x.get(E,R))return new Pe(E,R)}return null}centerEdges(i,n,a,c){const u=i.getX(),d=i.getY(),_=n.getX(),x=n.getY(),y=a.getX(),E=a.getY(),R=c.getX(),D=c.getY(),I=ti.CORR;return u<this.width/2?[new Pe(R-I,D+I),new Pe(_+I,x+I),new Pe(y-I,E-I),new Pe(u+I,d-I)]:[new Pe(R+I,D+I),new Pe(_+I,x-I),new Pe(y-I,E+I),new Pe(u-I,d-I)]}containsBlackPoint(i,n,a,c){const u=this.image;if(c){for(let d=i;d<=n;d++)if(u.get(d,a))return!0}else for(let d=i;d<=n;d++)if(u.get(a,d))return!0;return!1}}ti.INIT_SIZE=10,ti.CORR=1;class Al{static checkAndNudgePoints(i,n){const a=i.getWidth(),c=i.getHeight();let u=!0;for(let d=0;d<n.length&&u;d+=2){const _=Math.floor(n[d]),x=Math.floor(n[d+1]);if(_<-1||_>a||x<-1||x>c)throw new U;u=!1,_===-1?(n[d]=0,u=!0):_===a&&(n[d]=a-1,u=!0),x===-1?(n[d+1]=0,u=!0):x===c&&(n[d+1]=c-1,u=!0)}u=!0;for(let d=n.length-2;d>=0&&u;d-=2){const _=Math.floor(n[d]),x=Math.floor(n[d+1]);if(_<-1||_>a||x<-1||x>c)throw new U;u=!1,_===-1?(n[d]=0,u=!0):_===a&&(n[d]=a-1,u=!0),x===-1?(n[d+1]=0,u=!0):x===c&&(n[d+1]=c-1,u=!0)}}}class ds{constructor(i,n,a,c,u,d,_,x,y){this.a11=i,this.a21=n,this.a31=a,this.a12=c,this.a22=u,this.a32=d,this.a13=_,this.a23=x,this.a33=y}static quadrilateralToQuadrilateral(i,n,a,c,u,d,_,x,y,E,R,D,I,F,V,q){const ie=ds.quadrilateralToSquare(i,n,a,c,u,d,_,x);return ds.squareToQuadrilateral(y,E,R,D,I,F,V,q).times(ie)}transformPoints(i){const n=i.length,a=this.a11,c=this.a12,u=this.a13,d=this.a21,_=this.a22,x=this.a23,y=this.a31,E=this.a32,R=this.a33;for(let D=0;D<n;D+=2){const I=i[D],F=i[D+1],V=u*I+x*F+R;i[D]=(a*I+d*F+y)/V,i[D+1]=(c*I+_*F+E)/V}}transformPointsWithValues(i,n){const a=this.a11,c=this.a12,u=this.a13,d=this.a21,_=this.a22,x=this.a23,y=this.a31,E=this.a32,R=this.a33,D=i.length;for(let I=0;I<D;I++){const F=i[I],V=n[I],q=u*F+x*V+R;i[I]=(a*F+d*V+y)/q,n[I]=(c*F+_*V+E)/q}}static squareToQuadrilateral(i,n,a,c,u,d,_,x){const y=i-a+u-_,E=n-c+d-x;if(y===0&&E===0)return new ds(a-i,u-a,i,c-n,d-c,n,0,0,1);{const R=a-u,D=_-u,I=c-d,F=x-d,V=R*F-D*I,q=(y*F-D*E)/V,ie=(R*E-y*I)/V;return new ds(a-i+q*a,_-i+ie*_,i,c-n+q*c,x-n+ie*x,n,q,ie,1)}}static quadrilateralToSquare(i,n,a,c,u,d,_,x){return ds.squareToQuadrilateral(i,n,a,c,u,d,_,x).buildAdjoint()}buildAdjoint(){return new ds(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(i){return new ds(this.a11*i.a11+this.a21*i.a12+this.a31*i.a13,this.a11*i.a21+this.a21*i.a22+this.a31*i.a23,this.a11*i.a31+this.a21*i.a32+this.a31*i.a33,this.a12*i.a11+this.a22*i.a12+this.a32*i.a13,this.a12*i.a21+this.a22*i.a22+this.a32*i.a23,this.a12*i.a31+this.a22*i.a32+this.a32*i.a33,this.a13*i.a11+this.a23*i.a12+this.a33*i.a13,this.a13*i.a21+this.a23*i.a22+this.a33*i.a23,this.a13*i.a31+this.a23*i.a32+this.a33*i.a33)}}class Tl extends Al{sampleGrid(i,n,a,c,u,d,_,x,y,E,R,D,I,F,V,q,ie,Ce,we){const ve=ds.quadrilateralToQuadrilateral(c,u,d,_,x,y,E,R,D,I,F,V,q,ie,Ce,we);return this.sampleGridWithTransform(i,n,a,ve)}sampleGridWithTransform(i,n,a,c){if(n<=0||a<=0)throw new U;const u=new Ee(n,a),d=new Float32Array(2*n);for(let _=0;_<a;_++){const x=d.length,y=_+.5;for(let E=0;E<x;E+=2)d[E]=E/2+.5,d[E+1]=y;c.transformPoints(d),Al.checkAndNudgePoints(i,d);try{for(let E=0;E<x;E+=2)i.get(Math.floor(d[E]),Math.floor(d[E+1]))&&u.set(E/2,_)}catch{throw new U}}return u}}class Cs{static setGridSampler(i){Cs.gridSampler=i}static getInstance(){return Cs.gridSampler}}Cs.gridSampler=new Tl;class Xi{constructor(i,n){this.x=i,this.y=n}toResultPoint(){return new Pe(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Rl{constructor(i){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=i}detect(){return this.detectMirror(!1)}detectMirror(i){let n=this.getMatrixCenter(),a=this.getBullsEyeCorners(n);if(i){let d=a[0];a[0]=a[2],a[2]=d}this.extractParameters(a);let c=this.sampleGrid(this.image,a[this.shift%4],a[(this.shift+1)%4],a[(this.shift+2)%4],a[(this.shift+3)%4]),u=this.getMatrixCornerPoints(a);return new Wo(c,u,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(i){if(!this.isValidPoint(i[0])||!this.isValidPoint(i[1])||!this.isValidPoint(i[2])||!this.isValidPoint(i[3]))throw new U;let n=2*this.nbCenterLayers,a=new Int32Array([this.sampleLine(i[0],i[1],n),this.sampleLine(i[1],i[2],n),this.sampleLine(i[2],i[3],n),this.sampleLine(i[3],i[0],n)]);this.shift=this.getRotation(a,n);let c=0;for(let d=0;d<4;d++){let _=a[(this.shift+d)%4];this.compact?(c<<=7,c+=_>>1&127):(c<<=10,c+=(_>>2&992)+(_>>1&31))}let u=this.getCorrectedParameterData(c,this.compact);this.compact?(this.nbLayers=(u>>6)+1,this.nbDataBlocks=(u&63)+1):(this.nbLayers=(u>>11)+1,this.nbDataBlocks=(u&2047)+1)}getRotation(i,n){let a=0;i.forEach((c,u,d)=>{let _=(c>>n-2<<1)+(c&1);a=(a<<3)+_}),a=((a&1)<<11)+(a>>1);for(let c=0;c<4;c++)if(te.bitCount(a^this.EXPECTED_CORNER_BITS[c])<=2)return c;throw new U}getCorrectedParameterData(i,n){let a,c;n?(a=7,c=2):(a=10,c=4);let u=a-c,d=new Int32Array(a);for(let x=a-1;x>=0;--x)d[x]=i&15,i>>=4;try{new Br(ze.AZTEC_PARAM).decode(d,u)}catch{throw new U}let _=0;for(let x=0;x<c;x++)_=(_<<4)+d[x];return _}getBullsEyeCorners(i){let n=i,a=i,c=i,u=i,d=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let R=this.getFirstDifferent(n,d,1,-1),D=this.getFirstDifferent(a,d,1,1),I=this.getFirstDifferent(c,d,-1,1),F=this.getFirstDifferent(u,d,-1,-1);if(this.nbCenterLayers>2){let V=this.distancePoint(F,R)*this.nbCenterLayers/(this.distancePoint(u,n)*(this.nbCenterLayers+2));if(V<.75||V>1.25||!this.isWhiteOrBlackRectangle(R,D,I,F))break}n=R,a=D,c=I,u=F,d=!d}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new U;this.compact=this.nbCenterLayers===5;let _=new Pe(n.getX()+.5,n.getY()-.5),x=new Pe(a.getX()+.5,a.getY()+.5),y=new Pe(c.getX()-.5,c.getY()+.5),E=new Pe(u.getX()-.5,u.getY()-.5);return this.expandSquare([_,x,y,E],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let i,n,a,c;try{let _=new ti(this.image).detect();i=_[0],n=_[1],a=_[2],c=_[3]}catch{let x=this.image.getWidth()/2,y=this.image.getHeight()/2;i=this.getFirstDifferent(new Xi(x+7,y-7),!1,1,-1).toResultPoint(),n=this.getFirstDifferent(new Xi(x+7,y+7),!1,1,1).toResultPoint(),a=this.getFirstDifferent(new Xi(x-7,y+7),!1,-1,1).toResultPoint(),c=this.getFirstDifferent(new Xi(x-7,y-7),!1,-1,-1).toResultPoint()}let u=ct.round((i.getX()+c.getX()+n.getX()+a.getX())/4),d=ct.round((i.getY()+c.getY()+n.getY()+a.getY())/4);try{let _=new ti(this.image,15,u,d).detect();i=_[0],n=_[1],a=_[2],c=_[3]}catch{i=this.getFirstDifferent(new Xi(u+7,d-7),!1,1,-1).toResultPoint(),n=this.getFirstDifferent(new Xi(u+7,d+7),!1,1,1).toResultPoint(),a=this.getFirstDifferent(new Xi(u-7,d+7),!1,-1,1).toResultPoint(),c=this.getFirstDifferent(new Xi(u-7,d-7),!1,-1,-1).toResultPoint()}return u=ct.round((i.getX()+c.getX()+n.getX()+a.getX())/4),d=ct.round((i.getY()+c.getY()+n.getY()+a.getY())/4),new Xi(u,d)}getMatrixCornerPoints(i){return this.expandSquare(i,2*this.nbCenterLayers,this.getDimension())}sampleGrid(i,n,a,c,u){let d=Cs.getInstance(),_=this.getDimension(),x=_/2-this.nbCenterLayers,y=_/2+this.nbCenterLayers;return d.sampleGrid(i,_,_,x,x,y,x,y,y,x,y,n.getX(),n.getY(),a.getX(),a.getY(),c.getX(),c.getY(),u.getX(),u.getY())}sampleLine(i,n,a){let c=0,u=this.distanceResultPoint(i,n),d=u/a,_=i.getX(),x=i.getY(),y=d*(n.getX()-i.getX())/u,E=d*(n.getY()-i.getY())/u;for(let R=0;R<a;R++)this.image.get(ct.round(_+R*y),ct.round(x+R*E))&&(c|=1<<a-R-1);return c}isWhiteOrBlackRectangle(i,n,a,c){let u=3;i=new Xi(i.getX()-u,i.getY()+u),n=new Xi(n.getX()-u,n.getY()-u),a=new Xi(a.getX()+u,a.getY()-u),c=new Xi(c.getX()+u,c.getY()+u);let d=this.getColor(c,i);if(d===0)return!1;let _=this.getColor(i,n);return _!==d||(_=this.getColor(n,a),_!==d)?!1:(_=this.getColor(a,c),_===d)}getColor(i,n){let a=this.distancePoint(i,n),c=(n.getX()-i.getX())/a,u=(n.getY()-i.getY())/a,d=0,_=i.getX(),x=i.getY(),y=this.image.get(i.getX(),i.getY()),E=Math.ceil(a);for(let D=0;D<E;D++)_+=c,x+=u,this.image.get(ct.round(_),ct.round(x))!==y&&d++;let R=d/a;return R>.1&&R<.9?0:R<=.1===y?1:-1}getFirstDifferent(i,n,a,c){let u=i.getX()+a,d=i.getY()+c;for(;this.isValid(u,d)&&this.image.get(u,d)===n;)u+=a,d+=c;for(u-=a,d-=c;this.isValid(u,d)&&this.image.get(u,d)===n;)u+=a;for(u-=a;this.isValid(u,d)&&this.image.get(u,d)===n;)d+=c;return d-=c,new Xi(u,d)}expandSquare(i,n,a){let c=a/(2*n),u=i[0].getX()-i[2].getX(),d=i[0].getY()-i[2].getY(),_=(i[0].getX()+i[2].getX())/2,x=(i[0].getY()+i[2].getY())/2,y=new Pe(_+c*u,x+c*d),E=new Pe(_-c*u,x-c*d);u=i[1].getX()-i[3].getX(),d=i[1].getY()-i[3].getY(),_=(i[1].getX()+i[3].getX())/2,x=(i[1].getY()+i[3].getY())/2;let R=new Pe(_+c*u,x+c*d),D=new Pe(_-c*u,x-c*d);return[y,R,E,D]}isValid(i,n){return i>=0&&i<this.image.getWidth()&&n>0&&n<this.image.getHeight()}isValidPoint(i){let n=ct.round(i.getX()),a=ct.round(i.getY());return this.isValid(n,a)}distancePoint(i,n){return ct.distance(i.getX(),i.getY(),n.getX(),n.getY())}distanceResultPoint(i,n){return ct.distance(i.getX(),i.getY(),n.getX(),n.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(te.truncDivision(this.nbLayers-4,8)+1)+15}}class ka{decode(i,n=null){let a=null,c=new Rl(i.getBlackMatrix()),u=null,d=null;try{let E=c.detectMirror(!1);u=E.getPoints(),this.reportFoundResultPoints(n,u),d=new Dt().decode(E)}catch(E){a=E}if(d==null)try{let E=c.detectMirror(!0);u=E.getPoints(),this.reportFoundResultPoints(n,u),d=new Dt().decode(E)}catch(E){throw a??E}let _=new be(d.getText(),d.getRawBytes(),d.getNumBits(),u,Se.AZTEC,X.currentTimeMillis()),x=d.getByteSegments();x!=null&&_.putMetadata(ot.BYTE_SEGMENTS,x);let y=d.getECLevel();return y!=null&&_.putMetadata(ot.ERROR_CORRECTION_LEVEL,y),_}reportFoundResultPoints(i,n){if(i!=null){let a=i.get(Re.NEED_RESULT_POINT_CALLBACK);a!=null&&n.forEach((c,u,d)=>{a.foundPossibleResultPoint(c)})}}reset(){}}class Lh extends ye{constructor(i=500){super(new ka,i)}}class Wt{decode(i,n){try{return this.doDecode(i,n)}catch{if(n&&n.get(Re.TRY_HARDER)===!0&&i.isRotateSupported()){const u=i.rotateCounterClockwise(),d=this.doDecode(u,n),_=d.getResultMetadata();let x=270;_!==null&&_.get(ot.ORIENTATION)===!0&&(x=x+_.get(ot.ORIENTATION)%360),d.putMetadata(ot.ORIENTATION,x);const y=d.getResultPoints();if(y!==null){const E=u.getHeight();for(let R=0;R<y.length;R++)y[R]=new Pe(E-y[R].getY()-1,y[R].getX())}return d}else throw new U}}reset(){}doDecode(i,n){const a=i.getWidth(),c=i.getHeight();let u=new le(a);const d=n&&n.get(Re.TRY_HARDER)===!0,_=Math.max(1,c>>(d?8:5));let x;d?x=c:x=15;const y=Math.trunc(c/2);for(let E=0;E<x;E++){const R=Math.trunc((E+1)/2),D=(E&1)===0,I=y+_*(D?R:-R);if(I<0||I>=c)break;try{u=i.getBlackRow(I,u)}catch{continue}for(let F=0;F<2;F++){if(F===1&&(u.reverse(),n&&n.get(Re.NEED_RESULT_POINT_CALLBACK)===!0)){const V=new Map;n.forEach((q,ie)=>V.set(ie,q)),V.delete(Re.NEED_RESULT_POINT_CALLBACK),n=V}try{const V=this.decodeRow(I,u,n);if(F===1){V.putMetadata(ot.ORIENTATION,180);const q=V.getResultPoints();q!==null&&(q[0]=new Pe(a-q[0].getX()-1,q[0].getY()),q[1]=new Pe(a-q[1].getX()-1,q[1].getY()))}return V}catch{}}}throw new U}static recordPattern(i,n,a){const c=a.length;for(let y=0;y<c;y++)a[y]=0;const u=i.getSize();if(n>=u)throw new U;let d=!i.get(n),_=0,x=n;for(;x<u;){if(i.get(x)!==d)a[_]++;else{if(++_===c)break;a[_]=1,d=!d}x++}if(!(_===c||_===c-1&&x===u))throw new U}static recordPatternInReverse(i,n,a){let c=a.length,u=i.get(n);for(;n>0&&c>=0;)i.get(--n)!==u&&(c--,u=!u);if(c>=0)throw new U;Wt.recordPattern(i,n+1,a)}static patternMatchVariance(i,n,a){const c=i.length;let u=0,d=0;for(let y=0;y<c;y++)u+=i[y],d+=n[y];if(u<d)return Number.POSITIVE_INFINITY;const _=u/d;a*=_;let x=0;for(let y=0;y<c;y++){const E=i[y],R=n[y]*_,D=E>R?E-R:R-E;if(D>a)return Number.POSITIVE_INFINITY;x+=D}return x/u}}class Ae extends Wt{static findStartPattern(i){const n=i.getSize(),a=i.getNextSet(0);let c=0,u=Int32Array.from([0,0,0,0,0,0]),d=a,_=!1;const x=6;for(let y=a;y<n;y++)if(i.get(y)!==_)u[c]++;else{if(c===x-1){let E=Ae.MAX_AVG_VARIANCE,R=-1;for(let D=Ae.CODE_START_A;D<=Ae.CODE_START_C;D++){const I=Wt.patternMatchVariance(u,Ae.CODE_PATTERNS[D],Ae.MAX_INDIVIDUAL_VARIANCE);I<E&&(E=I,R=D)}if(R>=0&&i.isRange(Math.max(0,d-(y-d)/2),d,!1))return Int32Array.from([d,y,R]);d+=u[0]+u[1],u=u.slice(2,u.length-1),u[c-1]=0,u[c]=0,c--}else c++;u[c]=1,_=!_}throw new U}static decodeCode(i,n,a){Wt.recordPattern(i,a,n);let c=Ae.MAX_AVG_VARIANCE,u=-1;for(let d=0;d<Ae.CODE_PATTERNS.length;d++){const _=Ae.CODE_PATTERNS[d],x=this.patternMatchVariance(n,_,Ae.MAX_INDIVIDUAL_VARIANCE);x<c&&(c=x,u=d)}if(u>=0)return u;throw new U}decodeRow(i,n,a){const c=a&&a.get(Re.ASSUME_GS1)===!0,u=Ae.findStartPattern(n),d=u[2];let _=0;const x=new Uint8Array(20);x[_++]=d;let y;switch(d){case Ae.CODE_START_A:y=Ae.CODE_CODE_A;break;case Ae.CODE_START_B:y=Ae.CODE_CODE_B;break;case Ae.CODE_START_C:y=Ae.CODE_CODE_C;break;default:throw new Y}let E=!1,R=!1,D="",I=u[0],F=u[1];const V=Int32Array.from([0,0,0,0,0,0]);let q=0,ie=0,Ce=d,we=0,ve=!0,rt=!1,Qe=!1;for(;!E;){const Fr=R;switch(R=!1,q=ie,ie=Ae.decodeCode(n,V,F),x[_++]=ie,ie!==Ae.CODE_STOP&&(ve=!0),ie!==Ae.CODE_STOP&&(we++,Ce+=we*ie),I=F,F+=V.reduce((rc,Fl)=>rc+Fl,0),ie){case Ae.CODE_START_A:case Ae.CODE_START_B:case Ae.CODE_START_C:throw new Y}switch(y){case Ae.CODE_CODE_A:if(ie<64)Qe===rt?D+=String.fromCharCode(32+ie):D+=String.fromCharCode(32+ie+128),Qe=!1;else if(ie<96)Qe===rt?D+=String.fromCharCode(ie-64):D+=String.fromCharCode(ie+64),Qe=!1;else switch(ie!==Ae.CODE_STOP&&(ve=!1),ie){case Ae.CODE_FNC_1:c&&(D.length===0?D+="]C1":D+="");break;case Ae.CODE_FNC_2:case Ae.CODE_FNC_3:break;case Ae.CODE_FNC_4_A:!rt&&Qe?(rt=!0,Qe=!1):rt&&Qe?(rt=!1,Qe=!1):Qe=!0;break;case Ae.CODE_SHIFT:R=!0,y=Ae.CODE_CODE_B;break;case Ae.CODE_CODE_B:y=Ae.CODE_CODE_B;break;case Ae.CODE_CODE_C:y=Ae.CODE_CODE_C;break;case Ae.CODE_STOP:E=!0;break}break;case Ae.CODE_CODE_B:if(ie<96)Qe===rt?D+=String.fromCharCode(32+ie):D+=String.fromCharCode(32+ie+128),Qe=!1;else switch(ie!==Ae.CODE_STOP&&(ve=!1),ie){case Ae.CODE_FNC_1:c&&(D.length===0?D+="]C1":D+="");break;case Ae.CODE_FNC_2:case Ae.CODE_FNC_3:break;case Ae.CODE_FNC_4_B:!rt&&Qe?(rt=!0,Qe=!1):rt&&Qe?(rt=!1,Qe=!1):Qe=!0;break;case Ae.CODE_SHIFT:R=!0,y=Ae.CODE_CODE_A;break;case Ae.CODE_CODE_A:y=Ae.CODE_CODE_A;break;case Ae.CODE_CODE_C:y=Ae.CODE_CODE_C;break;case Ae.CODE_STOP:E=!0;break}break;case Ae.CODE_CODE_C:if(ie<100)ie<10&&(D+="0"),D+=ie;else switch(ie!==Ae.CODE_STOP&&(ve=!1),ie){case Ae.CODE_FNC_1:c&&(D.length===0?D+="]C1":D+="");break;case Ae.CODE_CODE_A:y=Ae.CODE_CODE_A;break;case Ae.CODE_CODE_B:y=Ae.CODE_CODE_B;break;case Ae.CODE_STOP:E=!0;break}break}Fr&&(y=y===Ae.CODE_CODE_A?Ae.CODE_CODE_B:Ae.CODE_CODE_A)}const li=F-I;if(F=n.getNextUnset(F),!n.isRange(F,Math.min(n.getSize(),F+(F-I)/2),!1))throw new U;if(Ce-=we*q,Ce%103!==q)throw new P;const ps=D.length;if(ps===0)throw new U;ps>0&&ve&&(y===Ae.CODE_CODE_C?D=D.substring(0,ps-2):D=D.substring(0,ps-1));const ji=(u[1]+u[0])/2,Nt=I+li/2,Oi=x.length,ls=new Uint8Array(Oi);for(let Fr=0;Fr<Oi;Fr++)ls[Fr]=x[Fr];const bn=[new Pe(ji,i),new Pe(Nt,i)];return new be(D,ls,0,bn,Se.CODE_128,new Date().getTime())}}Ae.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ae.MAX_AVG_VARIANCE=.25,Ae.MAX_INDIVIDUAL_VARIANCE=.7,Ae.CODE_SHIFT=98,Ae.CODE_CODE_C=99,Ae.CODE_CODE_B=100,Ae.CODE_CODE_A=101,Ae.CODE_FNC_1=102,Ae.CODE_FNC_2=97,Ae.CODE_FNC_3=96,Ae.CODE_FNC_4_A=101,Ae.CODE_FNC_4_B=100,Ae.CODE_START_A=103,Ae.CODE_START_B=104,Ae.CODE_START_C=105,Ae.CODE_STOP=106;class It extends Wt{constructor(i=!1,n=!1){super(),this.usingCheckDigit=i,this.extendedMode=n,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(i,n,a){let c=this.counters;c.fill(0),this.decodeRowResult="";let u=It.findAsteriskPattern(n,c),d=n.getNextSet(u[1]),_=n.getSize(),x,y;do{It.recordPattern(n,d,c);let V=It.toNarrowWidePattern(c);if(V<0)throw new U;x=It.patternToChar(V),this.decodeRowResult+=x,y=d;for(let q of c)d+=q;d=n.getNextSet(d)}while(x!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let E=0;for(let V of c)E+=V;let R=d-y-E;if(d!==_&&R*2<E)throw new U;if(this.usingCheckDigit){let V=this.decodeRowResult.length-1,q=0;for(let ie=0;ie<V;ie++)q+=It.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ie));if(this.decodeRowResult.charAt(V)!==It.ALPHABET_STRING.charAt(q%43))throw new P;this.decodeRowResult=this.decodeRowResult.substring(0,V)}if(this.decodeRowResult.length===0)throw new U;let D;this.extendedMode?D=It.decodeExtended(this.decodeRowResult):D=this.decodeRowResult;let I=(u[1]+u[0])/2,F=y+E/2;return new be(D,null,0,[new Pe(I,i),new Pe(F,i)],Se.CODE_39,new Date().getTime())}static findAsteriskPattern(i,n){let a=i.getSize(),c=i.getNextSet(0),u=0,d=c,_=!1,x=n.length;for(let y=c;y<a;y++)if(i.get(y)!==_)n[u]++;else{if(u===x-1){if(this.toNarrowWidePattern(n)===It.ASTERISK_ENCODING&&i.isRange(Math.max(0,d-Math.floor((y-d)/2)),d,!1))return[d,y];d+=n[0]+n[1],n.copyWithin(0,2,2+u-1),n[u-1]=0,n[u]=0,u--}else u++;n[u]=1,_=!_}throw new U}static toNarrowWidePattern(i){let n=i.length,a=0,c;do{let u=2147483647;for(let x of i)x<u&&x>a&&(u=x);a=u,c=0;let d=0,_=0;for(let x=0;x<n;x++){let y=i[x];y>a&&(_|=1<<n-1-x,c++,d+=y)}if(c===3){for(let x=0;x<n&&c>0;x++){let y=i[x];if(y>a&&(c--,y*2>=d))return-1}return _}}while(c>3);return-1}static patternToChar(i){for(let n=0;n<It.CHARACTER_ENCODINGS.length;n++)if(It.CHARACTER_ENCODINGS[n]===i)return It.ALPHABET_STRING.charAt(n);if(i===It.ASTERISK_ENCODING)return"*";throw new U}static decodeExtended(i){let n=i.length,a="";for(let c=0;c<n;c++){let u=i.charAt(c);if(u==="+"||u==="$"||u==="%"||u==="/"){let d=i.charAt(c+1),_="\0";switch(u){case"+":if(d>="A"&&d<="Z")_=String.fromCharCode(d.charCodeAt(0)+32);else throw new Y;break;case"$":if(d>="A"&&d<="Z")_=String.fromCharCode(d.charCodeAt(0)-64);else throw new Y;break;case"%":if(d>="A"&&d<="E")_=String.fromCharCode(d.charCodeAt(0)-38);else if(d>="F"&&d<="J")_=String.fromCharCode(d.charCodeAt(0)-11);else if(d>="K"&&d<="O")_=String.fromCharCode(d.charCodeAt(0)+16);else if(d>="P"&&d<="T")_=String.fromCharCode(d.charCodeAt(0)+43);else if(d==="U")_="\0";else if(d==="V")_="@";else if(d==="W")_="`";else if(d==="X"||d==="Y"||d==="Z")_="";else throw new Y;break;case"/":if(d>="A"&&d<="O")_=String.fromCharCode(d.charCodeAt(0)-32);else if(d==="Z")_=":";else throw new Y;break}a+=_,c++}else a+=u}return a}}It.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",It.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],It.ASTERISK_ENCODING=148;class tt extends Wt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(i,n,a){let c=this.decodeStart(n),u=this.decodeEnd(n),d=new ae;tt.decodeMiddle(n,c[1],u[0],d);let _=d.toString(),x=null;a!=null&&(x=a.get(Re.ALLOWED_LENGTHS)),x==null&&(x=tt.DEFAULT_ALLOWED_LENGTHS);let y=_.length,E=!1,R=0;for(let F of x){if(y===F){E=!0;break}F>R&&(R=F)}if(!E&&y>R&&(E=!0),!E)throw new Y;const D=[new Pe(c[1],i),new Pe(u[0],i)];return new be(_,null,0,D,Se.ITF,new Date().getTime())}static decodeMiddle(i,n,a,c){let u=new Int32Array(10),d=new Int32Array(5),_=new Int32Array(5);for(u.fill(0),d.fill(0),_.fill(0);n<a;){Wt.recordPattern(i,n,u);for(let y=0;y<5;y++){let E=2*y;d[y]=u[E],_[y]=u[E+1]}let x=tt.decodeDigit(d);c.append(x.toString()),x=this.decodeDigit(_),c.append(x.toString()),u.forEach(function(y){n+=y})}}decodeStart(i){let n=tt.skipWhiteSpace(i),a=tt.findGuardPattern(i,n,tt.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(i,a[0]),a}validateQuietZone(i,n){let a=this.narrowLineWidth*10;a=a<n?a:n;for(let c=n-1;a>0&&c>=0&&!i.get(c);c--)a--;if(a!==0)throw new U}static skipWhiteSpace(i){const n=i.getSize(),a=i.getNextSet(0);if(a===n)throw new U;return a}decodeEnd(i){i.reverse();try{let n=tt.skipWhiteSpace(i),a;try{a=tt.findGuardPattern(i,n,tt.END_PATTERN_REVERSED[0])}catch(u){u instanceof U&&(a=tt.findGuardPattern(i,n,tt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(i,a[0]);let c=a[0];return a[0]=i.getSize()-a[1],a[1]=i.getSize()-c,a}finally{i.reverse()}}static findGuardPattern(i,n,a){let c=a.length,u=new Int32Array(c),d=i.getSize(),_=!1,x=0,y=n;u.fill(0);for(let E=n;E<d;E++)if(i.get(E)!==_)u[x]++;else{if(x===c-1){if(Wt.patternMatchVariance(u,a,tt.MAX_INDIVIDUAL_VARIANCE)<tt.MAX_AVG_VARIANCE)return[y,E];y+=u[0]+u[1],X.arraycopy(u,2,u,0,x-1),u[x-1]=0,u[x]=0,x--}else x++;u[x]=1,_=!_}throw new U}static decodeDigit(i){let n=tt.MAX_AVG_VARIANCE,a=-1,c=tt.PATTERNS.length;for(let u=0;u<c;u++){let d=tt.PATTERNS[u],_=Wt.patternMatchVariance(i,d,tt.MAX_INDIVIDUAL_VARIANCE);_<n?(n=_,a=u):_===n&&(a=-1)}if(a>=0)return a%10;throw new U}}tt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],tt.MAX_AVG_VARIANCE=.38,tt.MAX_INDIVIDUAL_VARIANCE=.5,tt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],tt.START_PATTERN=Int32Array.from([1,1,1,1]),tt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Qt extends Wt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(i){let n=!1,a,c=0,u=Int32Array.from([0,0,0]);for(;!n;){u=Int32Array.from([0,0,0]),a=Qt.findGuardPattern(i,c,!1,this.START_END_PATTERN,u);let d=a[0];c=a[1];let _=d-(c-d);_>=0&&(n=i.isRange(_,d,!1))}return a}static checkChecksum(i){return Qt.checkStandardUPCEANChecksum(i)}static checkStandardUPCEANChecksum(i){let n=i.length;if(n===0)return!1;let a=parseInt(i.charAt(n-1),10);return Qt.getStandardUPCEANChecksum(i.substring(0,n-1))===a}static getStandardUPCEANChecksum(i){let n=i.length,a=0;for(let c=n-1;c>=0;c-=2){let u=i.charAt(c).charCodeAt(0)-48;if(u<0||u>9)throw new Y;a+=u}a*=3;for(let c=n-2;c>=0;c-=2){let u=i.charAt(c).charCodeAt(0)-48;if(u<0||u>9)throw new Y;a+=u}return(1e3-a)%10}static decodeEnd(i,n){return Qt.findGuardPattern(i,n,!1,Qt.START_END_PATTERN,new Int32Array(Qt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(i,n,a,c){return this.findGuardPattern(i,n,a,c,new Int32Array(c.length))}static findGuardPattern(i,n,a,c,u){let d=i.getSize();n=a?i.getNextUnset(n):i.getNextSet(n);let _=0,x=n,y=c.length,E=a;for(let R=n;R<d;R++)if(i.get(R)!==E)u[_]++;else{if(_===y-1){if(Wt.patternMatchVariance(u,c,Qt.MAX_INDIVIDUAL_VARIANCE)<Qt.MAX_AVG_VARIANCE)return Int32Array.from([x,R]);x+=u[0]+u[1];let D=u.slice(2,u.length-1);for(let I=0;I<_-1;I++)u[I]=D[I];u[_-1]=0,u[_]=0,_--}else _++;u[_]=1,E=!E}throw new U}static decodeDigit(i,n,a,c){this.recordPattern(i,a,n);let u=this.MAX_AVG_VARIANCE,d=-1,_=c.length;for(let x=0;x<_;x++){let y=c[x],E=Wt.patternMatchVariance(n,y,Qt.MAX_INDIVIDUAL_VARIANCE);E<u&&(u=E,d=x)}if(d>=0)return d;throw new U}}Qt.MAX_AVG_VARIANCE=.48,Qt.MAX_INDIVIDUAL_VARIANCE=.7,Qt.START_END_PATTERN=Int32Array.from([1,1,1]),Qt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Qt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Qt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class ea{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(i,n,a){let c=this.decodeRowStringBuffer,u=this.decodeMiddle(n,a,c),d=c.toString(),_=ea.parseExtensionString(d),x=[new Pe((a[0]+a[1])/2,i),new Pe(u,i)],y=new be(d,null,0,x,Se.UPC_EAN_EXTENSION,new Date().getTime());return _!=null&&y.putAllMetadata(_),y}decodeMiddle(i,n,a){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=i.getSize(),d=n[1],_=0;for(let y=0;y<5&&d<u;y++){let E=Qt.decodeDigit(i,c,d,Qt.L_AND_G_PATTERNS);a+=String.fromCharCode(48+E%10);for(let R of c)d+=R;E>=10&&(_|=1<<4-y),y!==4&&(d=i.getNextSet(d),d=i.getNextUnset(d))}if(a.length!==5)throw new U;let x=this.determineCheckDigit(_);if(ea.extensionChecksum(a.toString())!==x)throw new U;return d}static extensionChecksum(i){let n=i.length,a=0;for(let c=n-2;c>=0;c-=2)a+=i.charAt(c).charCodeAt(0)-48;a*=3;for(let c=n-1;c>=0;c-=2)a+=i.charAt(c).charCodeAt(0)-48;return a*=3,a%10}determineCheckDigit(i){for(let n=0;n<10;n++)if(i===this.CHECK_DIGIT_ENCODINGS[n])return n;throw new U}static parseExtensionString(i){if(i.length!==5)return null;let n=ea.parseExtension5String(i);return n==null?null:new Map([[ot.SUGGESTED_PRICE,n]])}static parseExtension5String(i){let n;switch(i.charAt(0)){case"0":n="";break;case"5":n="$";break;case"9":switch(i){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}n="";break;default:n="";break}let a=parseInt(i.substring(1)),c=(a/100).toString(),u=a%100,d=u<10?"0"+u:u.toString();return n+c+"."+d}}class Nl{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(i,n,a){let c=this.decodeRowStringBuffer,u=this.decodeMiddle(n,a,c),d=c.toString(),_=Nl.parseExtensionString(d),x=[new Pe((a[0]+a[1])/2,i),new Pe(u,i)],y=new be(d,null,0,x,Se.UPC_EAN_EXTENSION,new Date().getTime());return _!=null&&y.putAllMetadata(_),y}decodeMiddle(i,n,a){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=i.getSize(),d=n[1],_=0;for(let x=0;x<2&&d<u;x++){let y=Qt.decodeDigit(i,c,d,Qt.L_AND_G_PATTERNS);a+=String.fromCharCode(48+y%10);for(let E of c)d+=E;y>=10&&(_|=1<<1-x),x!==1&&(d=i.getNextSet(d),d=i.getNextUnset(d))}if(a.length!==2)throw new U;if(parseInt(a.toString())%4!==_)throw new U;return d}static parseExtensionString(i){return i.length!==2?null:new Map([[ot.ISSUE_NUMBER,parseInt(i)]])}}class ta{static decodeRow(i,n,a){let c=Qt.findGuardPattern(n,a,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new ea().decodeRow(i,n,c)}catch{return new Nl().decodeRow(i,n,c)}}}ta.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class gt extends Qt{constructor(){super(),this.decodeRowStringBuffer="",gt.L_AND_G_PATTERNS=gt.L_PATTERNS.map(i=>Int32Array.from(i));for(let i=10;i<20;i++){let n=gt.L_PATTERNS[i-10],a=new Int32Array(n.length);for(let c=0;c<n.length;c++)a[c]=n[n.length-c-1];gt.L_AND_G_PATTERNS[i]=a}}decodeRow(i,n,a){let c=gt.findStartGuardPattern(n),u=a==null?null:a.get(Re.NEED_RESULT_POINT_CALLBACK);if(u!=null){const ve=new Pe((c[0]+c[1])/2,i);u.foundPossibleResultPoint(ve)}let d=this.decodeMiddle(n,c,this.decodeRowStringBuffer),_=d.rowOffset,x=d.resultString;if(u!=null){const ve=new Pe(_,i);u.foundPossibleResultPoint(ve)}let y=this.decodeEnd(n,_);if(u!=null){const ve=new Pe((y[0]+y[1])/2,i);u.foundPossibleResultPoint(ve)}let E=y[1],R=E+(E-y[0]);if(R>=n.getSize()||!n.isRange(E,R,!1))throw new U;let D=x.toString();if(D.length<8)throw new Y;if(!gt.checkChecksum(D))throw new P;let I=(c[1]+c[0])/2,F=(y[1]+y[0])/2,V=this.getBarcodeFormat(),q=[new Pe(I,i),new Pe(F,i)],ie=new be(D,null,0,q,V,new Date().getTime()),Ce=0;try{let ve=ta.decodeRow(i,n,y[1]);ie.putMetadata(ot.UPC_EAN_EXTENSION,ve.getText()),ie.putAllMetadata(ve.getResultMetadata()),ie.addResultPoints(ve.getResultPoints()),Ce=ve.getText().length}catch{}let we=a==null?null:a.get(Re.ALLOWED_EAN_EXTENSIONS);if(we!=null){let ve=!1;for(let rt in we)if(Ce.toString()===rt){ve=!0;break}if(!ve)throw new U}return ie}decodeEnd(i,n){return gt.findGuardPattern(i,n,!1,gt.START_END_PATTERN,new Int32Array(gt.START_END_PATTERN.length).fill(0))}static checkChecksum(i){return gt.checkStandardUPCEANChecksum(i)}static checkStandardUPCEANChecksum(i){let n=i.length;if(n===0)return!1;let a=parseInt(i.charAt(n-1),10);return gt.getStandardUPCEANChecksum(i.substring(0,n-1))===a}static getStandardUPCEANChecksum(i){let n=i.length,a=0;for(let c=n-1;c>=0;c-=2){let u=i.charAt(c).charCodeAt(0)-48;if(u<0||u>9)throw new Y;a+=u}a*=3;for(let c=n-2;c>=0;c-=2){let u=i.charAt(c).charCodeAt(0)-48;if(u<0||u>9)throw new Y;a+=u}return(1e3-a)%10}}class Us extends gt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(i,n,a){let c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=i.getSize(),d=n[1],_=0;for(let y=0;y<6&&d<u;y++){let E=gt.decodeDigit(i,c,d,gt.L_AND_G_PATTERNS);a+=String.fromCharCode(48+E%10);for(let R of c)d+=R;E>=10&&(_|=1<<5-y)}a=Us.determineFirstDigit(a,_),d=gt.findGuardPattern(i,d,!0,gt.MIDDLE_PATTERN,new Int32Array(gt.MIDDLE_PATTERN.length).fill(0))[1];for(let y=0;y<6&&d<u;y++){let E=gt.decodeDigit(i,c,d,gt.L_PATTERNS);a+=String.fromCharCode(48+E);for(let R of c)d+=R}return{rowOffset:d,resultString:a}}getBarcodeFormat(){return Se.EAN_13}static determineFirstDigit(i,n){for(let a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return i=String.fromCharCode(48+a)+i,i;throw new U}}Us.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class gr extends gt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(i,n,a){const c=this.decodeMiddleCounters;c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=i.getSize(),d=n[1];for(let x=0;x<4&&d<u;x++){let y=gt.decodeDigit(i,c,d,gt.L_PATTERNS);a+=String.fromCharCode(48+y);for(let E of c)d+=E}d=gt.findGuardPattern(i,d,!0,gt.MIDDLE_PATTERN,new Int32Array(gt.MIDDLE_PATTERN.length).fill(0))[1];for(let x=0;x<4&&d<u;x++){let y=gt.decodeDigit(i,c,d,gt.L_PATTERNS);a+=String.fromCharCode(48+y);for(let E of c)d+=E}return{rowOffset:d,resultString:a}}getBarcodeFormat(){return Se.EAN_8}}class ia extends gt{constructor(){super(...arguments),this.ean13Reader=new Us}getBarcodeFormat(){return Se.UPC_A}decode(i,n){return this.maybeReturnResult(this.ean13Reader.decode(i))}decodeRow(i,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(i,n,a))}decodeMiddle(i,n,a){return this.ean13Reader.decodeMiddle(i,n,a)}maybeReturnResult(i){let n=i.getText();if(n.charAt(0)==="0"){let a=new be(n.substring(1),null,null,i.getResultPoints(),Se.UPC_A);return i.getResultMetadata()!=null&&a.putAllMetadata(i.getResultMetadata()),a}else throw new U}reset(){this.ean13Reader.reset()}}class Yi extends gt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(i,n,a){const c=this.decodeMiddleCounters.map(y=>y);c[0]=0,c[1]=0,c[2]=0,c[3]=0;const u=i.getSize();let d=n[1],_=0;for(let y=0;y<6&&d<u;y++){const E=Yi.decodeDigit(i,c,d,Yi.L_AND_G_PATTERNS);a+=String.fromCharCode(48+E%10);for(let R of c)d+=R;E>=10&&(_|=1<<5-y)}let x=Yi.determineNumSysAndCheckDigit(a,_);return{rowOffset:d,resultString:x}}decodeEnd(i,n){return Yi.findGuardPatternWithoutCounters(i,n,!0,Yi.MIDDLE_END_PATTERN)}checkChecksum(i){return gt.checkChecksum(Yi.convertUPCEtoUPCA(i))}static determineNumSysAndCheckDigit(i,n){for(let a=0;a<=1;a++)for(let c=0;c<10;c++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][c]){let u=String.fromCharCode(48+a),d=String.fromCharCode(48+c);return u+i+d}throw U.getNotFoundInstance()}getBarcodeFormat(){return Se.UPC_E}static convertUPCEtoUPCA(i){const n=i.slice(1,7).split("").map(u=>u.charCodeAt(0)),a=new ae;a.append(i.charAt(0));let c=n[5];switch(c){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(c),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(c);break}return i.length>=8&&a.append(i.charAt(7)),a.toString()}}Yi.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Yi.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Dl extends Wt{constructor(i){super();let n=i==null?null:i.get(Re.POSSIBLE_FORMATS),a=[];h(n)?(a.push(new Us),a.push(new ia),a.push(new gr),a.push(new Yi)):(n.indexOf(Se.EAN_13)>-1&&a.push(new Us),n.indexOf(Se.UPC_A)>-1&&a.push(new ia),n.indexOf(Se.EAN_8)>-1&&a.push(new gr),n.indexOf(Se.UPC_E)>-1&&a.push(new Yi)),this.readers=a}decodeRow(i,n,a){for(let c of this.readers)try{const u=c.decodeRow(i,n,a),d=u.getBarcodeFormat()===Se.EAN_13&&u.getText().charAt(0)==="0",_=a==null?null:a.get(Re.POSSIBLE_FORMATS),x=_==null||_.includes(Se.UPC_A);if(d&&x){const y=u.getRawBytes(),E=new be(u.getText().substring(1),y,y?y.length:null,u.getResultPoints(),Se.UPC_A);return E.putAllMetadata(u.getResultMetadata()),E}return u}catch{}throw new U}reset(){for(let i of this.readers)i.reset()}}class Ri extends Wt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(i,n){for(let a=0;a<n.length;a++)if(Wt.patternMatchVariance(i,n[a],Ri.MAX_INDIVIDUAL_VARIANCE)<Ri.MAX_AVG_VARIANCE)return a;throw new U}static count(i){return ct.sum(new Int32Array(i))}static increment(i,n){let a=0,c=n[0];for(let u=1;u<i.length;u++)n[u]>c&&(c=n[u],a=u);i[a]++}static decrement(i,n){let a=0,c=n[0];for(let u=1;u<i.length;u++)n[u]<c&&(c=n[u],a=u);i[a]--}static isFinderPattern(i){let n=i[0]+i[1],a=n+i[2]+i[3],c=n/a;if(c>=Ri.MIN_FINDER_PATTERN_RATIO&&c<=Ri.MAX_FINDER_PATTERN_RATIO){let u=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;for(let _ of i)_>d&&(d=_),_<u&&(u=_);return d<10*u}return!1}}Ri.MAX_AVG_VARIANCE=.2,Ri.MAX_INDIVIDUAL_VARIANCE=.45,Ri.MIN_FINDER_PATTERN_RATIO=9.5/12,Ri.MAX_FINDER_PATTERN_RATIO=12.5/14;class _r{constructor(i,n){this.value=i,this.checksumPortion=n}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(i){if(!(i instanceof _r))return!1;const n=i;return this.value===n.value&&this.checksumPortion===n.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class mr{constructor(i,n,a,c,u){this.value=i,this.startEnd=n,this.value=i,this.startEnd=n,this.resultPoints=new Array,this.resultPoints.push(new Pe(a,u)),this.resultPoints.push(new Pe(c,u))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(i){if(!(i instanceof mr))return!1;const n=i;return this.value===n.value}hashCode(){return this.value}}class Vs{constructor(){}static getRSSvalue(i,n,a){let c=0;for(let x of i)c+=x;let u=0,d=0,_=i.length;for(let x=0;x<_-1;x++){let y;for(y=1,d|=1<<x;y<i[x];y++,d&=~(1<<x)){let E=Vs.combins(c-y-1,_-x-2);if(a&&d===0&&c-y-(_-x-1)>=_-x-1&&(E-=Vs.combins(c-y-(_-x),_-x-2)),_-x-1>1){let R=0;for(let D=c-y-(_-x-2);D>n;D--)R+=Vs.combins(c-y-D-1,_-x-3);E-=R*(_-1-x)}else c-y>n&&E--;u+=E}c-=y}return u}static combins(i,n){let a,c;i-n>n?(c=n,a=i-n):(c=i-n,a=n);let u=1,d=1;for(let _=i;_>a;_--)u*=_,d<=c&&(u/=d,d++);for(;d<=c;)u/=d,d++;return u}}class Go{static buildBitArray(i){let n=i.length*2-1;i[i.length-1].getRightChar()==null&&(n-=1);let a=12*n,c=new le(a),u=0,_=i[0].getRightChar().getValue();for(let x=11;x>=0;--x)(_&1<<x)!=0&&c.set(u),u++;for(let x=1;x<i.length;++x){let y=i[x],E=y.getLeftChar().getValue();for(let R=11;R>=0;--R)(E&1<<R)!=0&&c.set(u),u++;if(y.getRightChar()!=null){let R=y.getRightChar().getValue();for(let D=11;D>=0;--D)(R&1<<D)!=0&&c.set(u),u++}}return c}}class pr{constructor(i,n){n?this.decodedInformation=null:(this.finished=i,this.decodedInformation=n)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class La{constructor(i){this.newPosition=i}getNewPosition(){return this.newPosition}}class Pi extends La{constructor(i,n){super(i),this.value=n}getValue(){return this.value}isFNC1(){return this.value===Pi.FNC1}}Pi.FNC1="$";class nr extends La{constructor(i,n,a){super(i),a?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=n}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class is extends La{constructor(i,n,a){if(super(i),n<0||n>10||a<0||a>10)throw new Y;this.firstDigit=n,this.secondDigit=a}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===is.FNC1}isSecondDigitFNC1(){return this.secondDigit===is.FNC1}isAnyFNC1(){return this.firstDigit===is.FNC1||this.secondDigit===is.FNC1}}is.FNC1=10;class Ie{constructor(){}static parseFieldsInGeneralPurpose(i){if(!i)return null;if(i.length<2)throw new U;let n=i.substring(0,2);for(let u of Ie.TWO_DIGIT_DATA_LENGTH)if(u[0]===n)return u[1]===Ie.VARIABLE_LENGTH?Ie.processVariableAI(2,u[2],i):Ie.processFixedAI(2,u[1],i);if(i.length<3)throw new U;let a=i.substring(0,3);for(let u of Ie.THREE_DIGIT_DATA_LENGTH)if(u[0]===a)return u[1]===Ie.VARIABLE_LENGTH?Ie.processVariableAI(3,u[2],i):Ie.processFixedAI(3,u[1],i);for(let u of Ie.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(u[0]===a)return u[1]===Ie.VARIABLE_LENGTH?Ie.processVariableAI(4,u[2],i):Ie.processFixedAI(4,u[1],i);if(i.length<4)throw new U;let c=i.substring(0,4);for(let u of Ie.FOUR_DIGIT_DATA_LENGTH)if(u[0]===c)return u[1]===Ie.VARIABLE_LENGTH?Ie.processVariableAI(4,u[2],i):Ie.processFixedAI(4,u[1],i);throw new U}static processFixedAI(i,n,a){if(a.length<i)throw new U;let c=a.substring(0,i);if(a.length<i+n)throw new U;let u=a.substring(i,i+n),d=a.substring(i+n),_="("+c+")"+u,x=Ie.parseFieldsInGeneralPurpose(d);return x==null?_:_+x}static processVariableAI(i,n,a){let c=a.substring(0,i),u;a.length<i+n?u=a.length:u=i+n;let d=a.substring(i,u),_=a.substring(u),x="("+c+")"+d,y=Ie.parseFieldsInGeneralPurpose(_);return y==null?x:x+y}}Ie.VARIABLE_LENGTH=[],Ie.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Ie.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Ie.VARIABLE_LENGTH,20],["22",Ie.VARIABLE_LENGTH,29],["30",Ie.VARIABLE_LENGTH,8],["37",Ie.VARIABLE_LENGTH,8],["90",Ie.VARIABLE_LENGTH,30],["91",Ie.VARIABLE_LENGTH,30],["92",Ie.VARIABLE_LENGTH,30],["93",Ie.VARIABLE_LENGTH,30],["94",Ie.VARIABLE_LENGTH,30],["95",Ie.VARIABLE_LENGTH,30],["96",Ie.VARIABLE_LENGTH,30],["97",Ie.VARIABLE_LENGTH,3],["98",Ie.VARIABLE_LENGTH,30],["99",Ie.VARIABLE_LENGTH,30]],Ie.THREE_DIGIT_DATA_LENGTH=[["240",Ie.VARIABLE_LENGTH,30],["241",Ie.VARIABLE_LENGTH,30],["242",Ie.VARIABLE_LENGTH,6],["250",Ie.VARIABLE_LENGTH,30],["251",Ie.VARIABLE_LENGTH,30],["253",Ie.VARIABLE_LENGTH,17],["254",Ie.VARIABLE_LENGTH,20],["400",Ie.VARIABLE_LENGTH,30],["401",Ie.VARIABLE_LENGTH,30],["402",17],["403",Ie.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Ie.VARIABLE_LENGTH,20],["421",Ie.VARIABLE_LENGTH,15],["422",3],["423",Ie.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Ie.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Ie.VARIABLE_LENGTH,15],["391",Ie.VARIABLE_LENGTH,18],["392",Ie.VARIABLE_LENGTH,15],["393",Ie.VARIABLE_LENGTH,18],["703",Ie.VARIABLE_LENGTH,30]],Ie.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Ie.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Ie.VARIABLE_LENGTH,20],["8003",Ie.VARIABLE_LENGTH,30],["8004",Ie.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Ie.VARIABLE_LENGTH,30],["8008",Ie.VARIABLE_LENGTH,12],["8018",18],["8020",Ie.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Ie.VARIABLE_LENGTH,70],["8200",Ie.VARIABLE_LENGTH,70]];class ss{constructor(i){this.buffer=new ae,this.information=i}decodeAllCodes(i,n){let a=n,c=null;do{let u=this.decodeGeneralPurposeField(a,c),d=Ie.parseFieldsInGeneralPurpose(u.getNewString());if(d!=null&&i.append(d),u.isRemaining()?c=""+u.getRemainingValue():c=null,a===u.getNewPosition())break;a=u.getNewPosition()}while(!0);return i.toString()}isStillNumeric(i){if(i+7>this.information.getSize())return i+4<=this.information.getSize();for(let n=i;n<i+3;++n)if(this.information.get(n))return!0;return this.information.get(i+3)}decodeNumeric(i){if(i+7>this.information.getSize()){let u=this.extractNumericValueFromBitArray(i,4);return u===0?new is(this.information.getSize(),is.FNC1,is.FNC1):new is(this.information.getSize(),u-1,is.FNC1)}let n=this.extractNumericValueFromBitArray(i,7),a=(n-8)/11,c=(n-8)%11;return new is(i+7,a,c)}extractNumericValueFromBitArray(i,n){return ss.extractNumericValueFromBitArray(this.information,i,n)}static extractNumericValueFromBitArray(i,n,a){let c=0;for(let u=0;u<a;++u)i.get(n+u)&&(c|=1<<a-u-1);return c}decodeGeneralPurposeField(i,n){this.buffer.setLengthToZero(),n!=null&&this.buffer.append(n),this.current.setPosition(i);let a=this.parseBlocks();return a!=null&&a.isRemaining()?new nr(this.current.getPosition(),this.buffer.toString(),a.getRemainingValue()):new nr(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let i,n;do{let a=this.current.getPosition();if(this.current.isAlpha()?(n=this.parseAlphaBlock(),i=n.isFinished()):this.current.isIsoIec646()?(n=this.parseIsoIec646Block(),i=n.isFinished()):(n=this.parseNumericBlock(),i=n.isFinished()),!(a!==this.current.getPosition())&&!i)break}while(!i);return n.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let i=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(i.getNewPosition()),i.isFirstDigitFNC1()){let n;return i.isSecondDigitFNC1()?n=new nr(this.current.getPosition(),this.buffer.toString()):n=new nr(this.current.getPosition(),this.buffer.toString(),i.getSecondDigit()),new pr(!0,n)}if(this.buffer.append(i.getFirstDigit()),i.isSecondDigitFNC1()){let n=new nr(this.current.getPosition(),this.buffer.toString());return new pr(!0,n)}this.buffer.append(i.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new pr(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let i=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(i.getNewPosition()),i.isFNC1()){let n=new nr(this.current.getPosition(),this.buffer.toString());return new pr(!0,n)}this.buffer.append(i.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new pr(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let i=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(i.getNewPosition()),i.isFNC1()){let n=new nr(this.current.getPosition(),this.buffer.toString());return new pr(!0,n)}this.buffer.append(i.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new pr(!1)}isStillIsoIec646(i){if(i+5>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(i,5);if(n>=5&&n<16)return!0;if(i+7>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(i,7);if(a>=64&&a<116)return!0;if(i+8>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(i,8);return c>=232&&c<253}decodeIsoIec646(i){let n=this.extractNumericValueFromBitArray(i,5);if(n===15)return new Pi(i+5,Pi.FNC1);if(n>=5&&n<15)return new Pi(i+5,"0"+(n-5));let a=this.extractNumericValueFromBitArray(i,7);if(a>=64&&a<90)return new Pi(i+7,""+(a+1));if(a>=90&&a<116)return new Pi(i+7,""+(a+7));let c=this.extractNumericValueFromBitArray(i,8),u;switch(c){case 232:u="!";break;case 233:u='"';break;case 234:u="%";break;case 235:u="&";break;case 236:u="'";break;case 237:u="(";break;case 238:u=")";break;case 239:u="*";break;case 240:u="+";break;case 241:u=",";break;case 242:u="-";break;case 243:u=".";break;case 244:u="/";break;case 245:u=":";break;case 246:u=";";break;case 247:u="<";break;case 248:u="=";break;case 249:u=">";break;case 250:u="?";break;case 251:u="_";break;case 252:u=" ";break;default:throw new Y}return new Pi(i+8,u)}isStillAlpha(i){if(i+5>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(i,5);if(n>=5&&n<16)return!0;if(i+6>this.information.getSize())return!1;let a=this.extractNumericValueFromBitArray(i,6);return a>=16&&a<63}decodeAlphanumeric(i){let n=this.extractNumericValueFromBitArray(i,5);if(n===15)return new Pi(i+5,Pi.FNC1);if(n>=5&&n<15)return new Pi(i+5,"0"+(n-5));let a=this.extractNumericValueFromBitArray(i,6);if(a>=32&&a<58)return new Pi(i+6,""+(a+33));let c;switch(a){case 58:c="*";break;case 59:c=",";break;case 60:c="-";break;case 61:c=".";break;case 62:c="/";break;default:throw new fs("Decoding invalid alphanumeric value: "+a)}return new Pi(i+6,c)}isAlphaTo646ToAlphaLatch(i){if(i+1>this.information.getSize())return!1;for(let n=0;n<5&&n+i<this.information.getSize();++n)if(n===2){if(!this.information.get(i+2))return!1}else if(this.information.get(i+n))return!1;return!0}isAlphaOr646ToNumericLatch(i){if(i+3>this.information.getSize())return!1;for(let n=i;n<i+3;++n)if(this.information.get(n))return!1;return!0}isNumericToAlphaNumericLatch(i){if(i+1>this.information.getSize())return!1;for(let n=0;n<4&&n+i<this.information.getSize();++n)if(this.information.get(i+n))return!1;return!0}}class di{constructor(i){this.information=i,this.generalDecoder=new ss(i)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Ot extends di{constructor(i){super(i)}encodeCompressedGtin(i,n){i.append("(01)");let a=i.length();i.append("9"),this.encodeCompressedGtinWithoutAI(i,n,a)}encodeCompressedGtinWithoutAI(i,n,a){for(let c=0;c<4;++c){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*c,10);u/100===0&&i.append("0"),u/10===0&&i.append("0"),i.append(u)}Ot.appendCheckDigit(i,a)}static appendCheckDigit(i,n){let a=0;for(let c=0;c<13;c++){let u=i.charAt(c+n).charCodeAt(0)-48;a+=(c&1)===0?3*u:u}a=10-a%10,a===10&&(a=0),i.append(a)}}Ot.GTIN_SIZE=40;class Es extends Ot{constructor(i){super(i)}parseInformation(){let i=new ae;i.append("(01)");let n=i.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(Es.HEADER_SIZE,4);return i.append(a),this.encodeCompressedGtinWithoutAI(i,Es.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(i,Es.HEADER_SIZE+44)}}Es.HEADER_SIZE=4;class hn extends di{constructor(i){super(i)}parseInformation(){let i=new ae;return this.getGeneralDecoder().decodeAllCodes(i,hn.HEADER_SIZE)}}hn.HEADER_SIZE=5;class Pa extends Ot{constructor(i){super(i)}encodeCompressedWeight(i,n,a){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(i,c);let u=this.checkWeight(c),d=1e5;for(let _=0;_<5;++_)u/d===0&&i.append("0"),d/=10;i.append(u)}}class Ws extends Pa{constructor(i){super(i)}parseInformation(){if(this.getInformation().getSize()!=Ws.HEADER_SIZE+Pa.GTIN_SIZE+Ws.WEIGHT_SIZE)throw new U;let i=new ae;return this.encodeCompressedGtin(i,Ws.HEADER_SIZE),this.encodeCompressedWeight(i,Ws.HEADER_SIZE+Pa.GTIN_SIZE,Ws.WEIGHT_SIZE),i.toString()}}Ws.HEADER_SIZE=5,Ws.WEIGHT_SIZE=15;class Xo extends Ws{constructor(i){super(i)}addWeightCode(i,n){i.append("(3103)")}checkWeight(i){return i}}class sa extends Ws{constructor(i){super(i)}addWeightCode(i,n){n<1e4?i.append("(3202)"):i.append("(3203)")}checkWeight(i){return i<1e4?i:i-1e4}}class gs extends Ot{constructor(i){super(i)}parseInformation(){if(this.getInformation().getSize()<gs.HEADER_SIZE+Ot.GTIN_SIZE)throw new U;let i=new ae;this.encodeCompressedGtin(i,gs.HEADER_SIZE);let n=this.getGeneralDecoder().extractNumericValueFromBitArray(gs.HEADER_SIZE+Ot.GTIN_SIZE,gs.LAST_DIGIT_SIZE);i.append("(392"),i.append(n),i.append(")");let a=this.getGeneralDecoder().decodeGeneralPurposeField(gs.HEADER_SIZE+Ot.GTIN_SIZE+gs.LAST_DIGIT_SIZE,null);return i.append(a.getNewString()),i.toString()}}gs.HEADER_SIZE=8,gs.LAST_DIGIT_SIZE=2;class ni extends Ot{constructor(i){super(i)}parseInformation(){if(this.getInformation().getSize()<ni.HEADER_SIZE+Ot.GTIN_SIZE)throw new U;let i=new ae;this.encodeCompressedGtin(i,ni.HEADER_SIZE);let n=this.getGeneralDecoder().extractNumericValueFromBitArray(ni.HEADER_SIZE+Ot.GTIN_SIZE,ni.LAST_DIGIT_SIZE);i.append("(393"),i.append(n),i.append(")");let a=this.getGeneralDecoder().extractNumericValueFromBitArray(ni.HEADER_SIZE+Ot.GTIN_SIZE+ni.LAST_DIGIT_SIZE,ni.FIRST_THREE_DIGITS_SIZE);a/100==0&&i.append("0"),a/10==0&&i.append("0"),i.append(a);let c=this.getGeneralDecoder().decodeGeneralPurposeField(ni.HEADER_SIZE+Ot.GTIN_SIZE+ni.LAST_DIGIT_SIZE+ni.FIRST_THREE_DIGITS_SIZE,null);return i.append(c.getNewString()),i.toString()}}ni.HEADER_SIZE=8,ni.LAST_DIGIT_SIZE=2,ni.FIRST_THREE_DIGITS_SIZE=10;class Ct extends Pa{constructor(i,n,a){super(i),this.dateCode=a,this.firstAIdigits=n}parseInformation(){if(this.getInformation().getSize()!=Ct.HEADER_SIZE+Ct.GTIN_SIZE+Ct.WEIGHT_SIZE+Ct.DATE_SIZE)throw new U;let i=new ae;return this.encodeCompressedGtin(i,Ct.HEADER_SIZE),this.encodeCompressedWeight(i,Ct.HEADER_SIZE+Ct.GTIN_SIZE,Ct.WEIGHT_SIZE),this.encodeCompressedDate(i,Ct.HEADER_SIZE+Ct.GTIN_SIZE+Ct.WEIGHT_SIZE),i.toString()}encodeCompressedDate(i,n){let a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,Ct.DATE_SIZE);if(a==38400)return;i.append("("),i.append(this.dateCode),i.append(")");let c=a%32;a/=32;let u=a%12+1;a/=12;let d=a;d/10==0&&i.append("0"),i.append(d),u/10==0&&i.append("0"),i.append(u),c/10==0&&i.append("0"),i.append(c)}addWeightCode(i,n){i.append("("),i.append(this.firstAIdigits),i.append(n/1e5),i.append(")")}checkWeight(i){return i%1e5}}Ct.HEADER_SIZE=8,Ct.WEIGHT_SIZE=20,Ct.DATE_SIZE=16;function un(T){try{if(T.get(1))return new Es(T);if(!T.get(2))return new hn(T);switch(ss.extractNumericValueFromBitArray(T,1,4)){case 4:return new Xo(T);case 5:return new sa(T)}switch(ss.extractNumericValueFromBitArray(T,1,5)){case 12:return new gs(T);case 13:return new ni(T)}switch(ss.extractNumericValueFromBitArray(T,1,7)){case 56:return new Ct(T,"310","11");case 57:return new Ct(T,"320","11");case 58:return new Ct(T,"310","13");case 59:return new Ct(T,"320","13");case 60:return new Ct(T,"310","15");case 61:return new Ct(T,"320","15");case 62:return new Ct(T,"310","17");case 63:return new Ct(T,"320","17")}}catch(i){throw console.log(i),new fs("unknown decoder: "+T)}}class rs{constructor(i,n,a,c){this.leftchar=i,this.rightchar=n,this.finderpattern=a,this.maybeLast=c}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(i,n){return i instanceof rs?rs.equalsOrNull(i.leftchar,n.leftchar)&&rs.equalsOrNull(i.rightchar,n.rightchar)&&rs.equalsOrNull(i.finderpattern,n.finderpattern):!1}static equalsOrNull(i,n){return i===null?n===null:rs.equals(i,n)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ai{constructor(i,n,a){this.pairs=i,this.rowNumber=n,this.wasReversed=a}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(i){return this.checkEqualitity(this,i)}toString(){return"{ "+this.pairs+" }"}equals(i,n){return i instanceof ai?this.checkEqualitity(i,n)&&i.wasReversed===n.wasReversed:!1}checkEqualitity(i,n){if(!i||!n)return;let a;return i.forEach((c,u)=>{n.forEach(d=>{c.getLeftChar().getValue()===d.getLeftChar().getValue()&&c.getRightChar().getValue()===d.getRightChar().getValue()&&c.getFinderPatter().getValue()===d.getFinderPatter().getValue()&&(a=!0)})}),a}}class xe extends Ri{constructor(i){super(...arguments),this.pairs=new Array(xe.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=i===!0}decodeRow(i,n,a){this.pairs.length=0,this.startFromEven=!1;try{return xe.constructResult(this.decodeRow2pairs(i,n))}catch(c){this.verbose&&console.log(c)}return this.pairs.length=0,this.startFromEven=!0,xe.constructResult(this.decodeRow2pairs(i,n))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(i,n){let a=!1;for(;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,i))}catch(u){if(u instanceof U){if(!this.pairs.length)throw new U;a=!0}}if(this.checkChecksum())return this.pairs;let c;if(this.rows.length?c=!0:c=!1,this.storeRow(i,!1),c){let u=this.checkRowsBoolean(!1);if(u!=null||(u=this.checkRowsBoolean(!0),u!=null))return u}throw new U}checkRowsBoolean(i){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,i&&(this.rows=this.rows.reverse());let n=null;try{n=this.checkRows(new Array,0)}catch(a){this.verbose&&console.log(a)}return i&&(this.rows=this.rows.reverse()),n}checkRows(i,n){for(let a=n;a<this.rows.length;a++){let c=this.rows[a];this.pairs.length=0;for(let d of i)this.pairs.push(d.getPairs());if(this.pairs.push(c.getPairs()),!xe.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let u=new Array(i);u.push(c);try{return this.checkRows(u,a+1)}catch(d){this.verbose&&console.log(d)}}throw new U}static isValidSequence(i){for(let n of xe.FINDER_PATTERN_SEQUENCES){if(i.length>n.length)continue;let a=!0;for(let c=0;c<i.length;c++)if(i[c].getFinderPattern().getValue()!=n[c]){a=!1;break}if(a)return!0}return!1}storeRow(i,n){let a=0,c=!1,u=!1;for(;a<this.rows.length;){let d=this.rows[a];if(d.getRowNumber()>i){u=d.isEquivalent(this.pairs);break}c=d.isEquivalent(this.pairs),a++}u||c||xe.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new ai(this.pairs,i,n)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(i,n){for(let a of n)if(a.getPairs().length!==i.length){for(let c of a.getPairs())for(let u of i)if(rs.equals(c,u))break}}static isPartialRow(i,n){for(let a of n){let c=!0;for(let u of i){let d=!1;for(let _ of a.getPairs())if(u.equals(_)){d=!0;break}if(!d){c=!1;break}}if(c)return!0}return!1}getRows(){return this.rows}static constructResult(i){let n=Go.buildBitArray(i),c=un(n).parseInformation(),u=i[0].getFinderPattern().getResultPoints(),d=i[i.length-1].getFinderPattern().getResultPoints(),_=[u[0],u[1],d[0],d[1]];return new be(c,null,null,_,Se.RSS_EXPANDED,null)}checkChecksum(){let i=this.pairs.get(0),n=i.getLeftChar(),a=i.getRightChar();if(a==null)return!1;let c=a.getChecksumPortion(),u=2;for(let _=1;_<this.pairs.size();++_){let x=this.pairs.get(_);c+=x.getLeftChar().getChecksumPortion(),u++;let y=x.getRightChar();y!=null&&(c+=y.getChecksumPortion(),u++)}return c%=211,211*(u-4)+c==n.getValue()}static getNextSecondBar(i,n){let a;return i.get(n)?(a=i.getNextUnset(n),a=i.getNextSet(a)):(a=i.getNextSet(n),a=i.getNextUnset(a)),a}retrieveNextPair(i,n,a){let c=n.length%2==0;this.startFromEven&&(c=!c);let u,d=!0,_=-1;do this.findNextPair(i,n,_),u=this.parseFoundFinderPattern(i,a,c),u==null?_=xe.getNextSecondBar(i,this.startEnd[0]):d=!1;while(d);let x=this.decodeDataCharacter(i,u,c,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new U;let y;try{y=this.decodeDataCharacter(i,u,c,!1)}catch(E){y=null,this.verbose&&console.log(E)}return new rs(x,y,u,!0)}isEmptyPair(i){return i.length===0}findNextPair(i,n,a){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=i.getSize(),d;a>=0?d=a:this.isEmptyPair(n)?d=0:d=n[n.length-1].getFinderPattern().getStartEnd()[1];let _=n.length%2!=0;this.startFromEven&&(_=!_);let x=!1;for(;d<u&&(x=!i.get(d),!!x);)d++;let y=0,E=d;for(let R=d;R<u;R++)if(i.get(R)!=x)c[y]++;else{if(y==3){if(_&&xe.reverseCounters(c),xe.isFinderPattern(c)){this.startEnd[0]=E,this.startEnd[1]=R;return}_&&xe.reverseCounters(c),E+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,y--}else y++;c[y]=1,x=!x}throw new U}static reverseCounters(i){let n=i.length;for(let a=0;a<n/2;++a){let c=i[a];i[a]=i[n-a-1],i[n-a-1]=c}}parseFoundFinderPattern(i,n,a){let c,u,d;if(a){let y=this.startEnd[0]-1;for(;y>=0&&!i.get(y);)y--;y++,c=this.startEnd[0]-y,u=y,d=this.startEnd[1]}else u=this.startEnd[0],d=i.getNextUnset(this.startEnd[1]+1),c=d-this.startEnd[1];let _=this.getDecodeFinderCounters();X.arraycopy(_,0,_,1,_.length-1),_[0]=c;let x;try{x=this.parseFinderValue(_,xe.FINDER_PATTERNS)}catch{return null}return new mr(x,[u,d],u,d,n)}decodeDataCharacter(i,n,a,c){let u=this.getDataCharacterCounters();for(let Nt=0;Nt<u.length;Nt++)u[Nt]=0;if(c)xe.recordPatternInReverse(i,n.getStartEnd()[0],u);else{xe.recordPattern(i,n.getStartEnd()[1],u);for(let Nt=0,Oi=u.length-1;Nt<Oi;Nt++,Oi--){let ls=u[Nt];u[Nt]=u[Oi],u[Oi]=ls}}let d=17,_=ct.sum(new Int32Array(u))/d,x=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(_-x)/x>.3)throw new U;let y=this.getOddCounts(),E=this.getEvenCounts(),R=this.getOddRoundingErrors(),D=this.getEvenRoundingErrors();for(let Nt=0;Nt<u.length;Nt++){let Oi=1*u[Nt]/_,ls=Oi+.5;if(ls<1){if(Oi<.3)throw new U;ls=1}else if(ls>8){if(Oi>8.7)throw new U;ls=8}let bn=Nt/2;(Nt&1)==0?(y[bn]=ls,R[bn]=Oi-ls):(E[bn]=ls,D[bn]=Oi-ls)}this.adjustOddEvenCounts(d);let I=4*n.getValue()+(a?0:2)+(c?0:1)-1,F=0,V=0;for(let Nt=y.length-1;Nt>=0;Nt--){if(xe.isNotA1left(n,a,c)){let Oi=xe.WEIGHTS[I][2*Nt];V+=y[Nt]*Oi}F+=y[Nt]}let q=0;for(let Nt=E.length-1;Nt>=0;Nt--)if(xe.isNotA1left(n,a,c)){let Oi=xe.WEIGHTS[I][2*Nt+1];q+=E[Nt]*Oi}let ie=V+q;if((F&1)!=0||F>13||F<4)throw new U;let Ce=(13-F)/2,we=xe.SYMBOL_WIDEST[Ce],ve=9-we,rt=Vs.getRSSvalue(y,we,!0),Qe=Vs.getRSSvalue(E,ve,!1),li=xe.EVEN_TOTAL_SUBSET[Ce],ps=xe.GSUM[Ce],ji=rt*li+Qe+ps;return new _r(ji,ie)}static isNotA1left(i,n,a){return!(i.getValue()==0&&n&&a)}adjustOddEvenCounts(i){let n=ct.sum(new Int32Array(this.getOddCounts())),a=ct.sum(new Int32Array(this.getEvenCounts())),c=!1,u=!1;n>13?u=!0:n<4&&(c=!0);let d=!1,_=!1;a>13?_=!0:a<4&&(d=!0);let x=n+a-i,y=(n&1)==1,E=(a&1)==0;if(x==1)if(y){if(E)throw new U;u=!0}else{if(!E)throw new U;_=!0}else if(x==-1)if(y){if(E)throw new U;c=!0}else{if(!E)throw new U;d=!0}else if(x==0){if(y){if(!E)throw new U;n<a?(c=!0,_=!0):(u=!0,d=!0)}else if(E)throw new U}else throw new U;if(c){if(u)throw new U;xe.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(u&&xe.decrement(this.getOddCounts(),this.getOddRoundingErrors()),d){if(_)throw new U;xe.increment(this.getEvenCounts(),this.getOddRoundingErrors())}_&&xe.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}xe.SYMBOL_WIDEST=[7,5,4,3,1],xe.EVEN_TOTAL_SUBSET=[4,20,52,104,204],xe.GSUM=[0,348,1388,2948,3988],xe.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],xe.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],xe.FINDER_PAT_A=0,xe.FINDER_PAT_B=1,xe.FINDER_PAT_C=2,xe.FINDER_PAT_D=3,xe.FINDER_PAT_E=4,xe.FINDER_PAT_F=5,xe.FINDER_PATTERN_SEQUENCES=[[xe.FINDER_PAT_A,xe.FINDER_PAT_A],[xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B],[xe.FINDER_PAT_A,xe.FINDER_PAT_C,xe.FINDER_PAT_B,xe.FINDER_PAT_D],[xe.FINDER_PAT_A,xe.FINDER_PAT_E,xe.FINDER_PAT_B,xe.FINDER_PAT_D,xe.FINDER_PAT_C],[xe.FINDER_PAT_A,xe.FINDER_PAT_E,xe.FINDER_PAT_B,xe.FINDER_PAT_D,xe.FINDER_PAT_D,xe.FINDER_PAT_F],[xe.FINDER_PAT_A,xe.FINDER_PAT_E,xe.FINDER_PAT_B,xe.FINDER_PAT_D,xe.FINDER_PAT_E,xe.FINDER_PAT_F,xe.FINDER_PAT_F],[xe.FINDER_PAT_A,xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B,xe.FINDER_PAT_C,xe.FINDER_PAT_C,xe.FINDER_PAT_D,xe.FINDER_PAT_D],[xe.FINDER_PAT_A,xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B,xe.FINDER_PAT_C,xe.FINDER_PAT_C,xe.FINDER_PAT_D,xe.FINDER_PAT_E,xe.FINDER_PAT_E],[xe.FINDER_PAT_A,xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B,xe.FINDER_PAT_C,xe.FINDER_PAT_C,xe.FINDER_PAT_D,xe.FINDER_PAT_E,xe.FINDER_PAT_F,xe.FINDER_PAT_F],[xe.FINDER_PAT_A,xe.FINDER_PAT_A,xe.FINDER_PAT_B,xe.FINDER_PAT_B,xe.FINDER_PAT_C,xe.FINDER_PAT_D,xe.FINDER_PAT_D,xe.FINDER_PAT_E,xe.FINDER_PAT_E,xe.FINDER_PAT_F,xe.FINDER_PAT_F]],xe.MAX_PAIRS=11;class Yo extends _r{constructor(i,n,a){super(i,n),this.count=0,this.finderPattern=a}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Tt extends Ri{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(i,n,a){const c=this.decodePair(n,!1,i,a);Tt.addOrTally(this.possibleLeftPairs,c),n.reverse();let u=this.decodePair(n,!0,i,a);Tt.addOrTally(this.possibleRightPairs,u),n.reverse();for(let d of this.possibleLeftPairs)if(d.getCount()>1){for(let _ of this.possibleRightPairs)if(_.getCount()>1&&Tt.checkChecksum(d,_))return Tt.constructResult(d,_)}throw new U}static addOrTally(i,n){if(n==null)return;let a=!1;for(let c of i)if(c.getValue()===n.getValue()){c.incrementCount(),a=!0;break}a||i.push(n)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(i,n){let a=4537077*i.getValue()+n.getValue(),c=new String(a).toString(),u=new ae;for(let y=13-c.length;y>0;y--)u.append("0");u.append(c);let d=0;for(let y=0;y<13;y++){let E=u.charAt(y).charCodeAt(0)-48;d+=(y&1)===0?3*E:E}d=10-d%10,d===10&&(d=0),u.append(d.toString());let _=i.getFinderPattern().getResultPoints(),x=n.getFinderPattern().getResultPoints();return new be(u.toString(),null,0,[_[0],_[1],x[0],x[1]],Se.RSS_14,new Date().getTime())}static checkChecksum(i,n){let a=(i.getChecksumPortion()+16*n.getChecksumPortion())%79,c=9*i.getFinderPattern().getValue()+n.getFinderPattern().getValue();return c>72&&c--,c>8&&c--,a===c}decodePair(i,n,a,c){try{let u=this.findFinderPattern(i,n),d=this.parseFoundFinderPattern(i,a,n,u),_=c==null?null:c.get(Re.NEED_RESULT_POINT_CALLBACK);if(_!=null){let E=(u[0]+u[1])/2;n&&(E=i.getSize()-1-E),_.foundPossibleResultPoint(new Pe(E,a))}let x=this.decodeDataCharacter(i,d,!0),y=this.decodeDataCharacter(i,d,!1);return new Yo(1597*x.getValue()+y.getValue(),x.getChecksumPortion()+4*y.getChecksumPortion(),d)}catch{return null}}decodeDataCharacter(i,n,a){let c=this.getDataCharacterCounters();for(let q=0;q<c.length;q++)c[q]=0;if(a)Wt.recordPatternInReverse(i,n.getStartEnd()[0],c);else{Wt.recordPattern(i,n.getStartEnd()[1]+1,c);for(let q=0,ie=c.length-1;q<ie;q++,ie--){let Ce=c[q];c[q]=c[ie],c[ie]=Ce}}let u=a?16:15,d=ct.sum(new Int32Array(c))/u,_=this.getOddCounts(),x=this.getEvenCounts(),y=this.getOddRoundingErrors(),E=this.getEvenRoundingErrors();for(let q=0;q<c.length;q++){let ie=c[q]/d,Ce=Math.floor(ie+.5);Ce<1?Ce=1:Ce>8&&(Ce=8);let we=Math.floor(q/2);(q&1)===0?(_[we]=Ce,y[we]=ie-Ce):(x[we]=Ce,E[we]=ie-Ce)}this.adjustOddEvenCounts(a,u);let R=0,D=0;for(let q=_.length-1;q>=0;q--)D*=9,D+=_[q],R+=_[q];let I=0,F=0;for(let q=x.length-1;q>=0;q--)I*=9,I+=x[q],F+=x[q];let V=D+3*I;if(a){if((R&1)!==0||R>12||R<4)throw new U;let q=(12-R)/2,ie=Tt.OUTSIDE_ODD_WIDEST[q],Ce=9-ie,we=Vs.getRSSvalue(_,ie,!1),ve=Vs.getRSSvalue(x,Ce,!0),rt=Tt.OUTSIDE_EVEN_TOTAL_SUBSET[q],Qe=Tt.OUTSIDE_GSUM[q];return new _r(we*rt+ve+Qe,V)}else{if((F&1)!==0||F>10||F<4)throw new U;let q=(10-F)/2,ie=Tt.INSIDE_ODD_WIDEST[q],Ce=9-ie,we=Vs.getRSSvalue(_,ie,!0),ve=Vs.getRSSvalue(x,Ce,!1),rt=Tt.INSIDE_ODD_TOTAL_SUBSET[q],Qe=Tt.INSIDE_GSUM[q];return new _r(ve*rt+we+Qe,V)}}findFinderPattern(i,n){let a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;let c=i.getSize(),u=!1,d=0;for(;d<c&&(u=!i.get(d),n!==u);)d++;let _=0,x=d;for(let y=d;y<c;y++)if(i.get(y)!==u)a[_]++;else{if(_===3){if(Ri.isFinderPattern(a))return[x,y];x+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,_--}else _++;a[_]=1,u=!u}throw new U}parseFoundFinderPattern(i,n,a,c){let u=i.get(c[0]),d=c[0]-1;for(;d>=0&&u!==i.get(d);)d--;d++;const _=c[0]-d,x=this.getDecodeFinderCounters(),y=new Int32Array(x.length);X.arraycopy(x,0,y,1,x.length-1),y[0]=_;const E=this.parseFinderValue(y,Tt.FINDER_PATTERNS);let R=d,D=c[1];return a&&(R=i.getSize()-1-R,D=i.getSize()-1-D),new mr(E,[d,c[1]],R,D,n)}adjustOddEvenCounts(i,n){let a=ct.sum(new Int32Array(this.getOddCounts())),c=ct.sum(new Int32Array(this.getEvenCounts())),u=!1,d=!1,_=!1,x=!1;i?(a>12?d=!0:a<4&&(u=!0),c>12?x=!0:c<4&&(_=!0)):(a>11?d=!0:a<5&&(u=!0),c>10?x=!0:c<4&&(_=!0));let y=a+c-n,E=(a&1)===(i?1:0),R=(c&1)===1;if(y===1)if(E){if(R)throw new U;d=!0}else{if(!R)throw new U;x=!0}else if(y===-1)if(E){if(R)throw new U;u=!0}else{if(!R)throw new U;_=!0}else if(y===0){if(E){if(!R)throw new U;a<c?(u=!0,x=!0):(d=!0,_=!0)}else if(R)throw new U}else throw new U;if(u){if(d)throw new U;Ri.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&Ri.decrement(this.getOddCounts(),this.getOddRoundingErrors()),_){if(x)throw new U;Ri.increment(this.getEvenCounts(),this.getOddRoundingErrors())}x&&Ri.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Tt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Tt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Tt.OUTSIDE_GSUM=[0,161,961,2015,2715],Tt.INSIDE_GSUM=[0,336,1036,1516],Tt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Tt.INSIDE_ODD_WIDEST=[2,4,6,8],Tt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class As extends Wt{constructor(i,n){super(),this.readers=[],this.verbose=n===!0;const a=i?i.get(Re.POSSIBLE_FORMATS):null,c=i&&i.get(Re.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;a?((a.includes(Se.EAN_13)||a.includes(Se.UPC_A)||a.includes(Se.EAN_8)||a.includes(Se.UPC_E))&&this.readers.push(new Dl(i)),a.includes(Se.CODE_39)&&this.readers.push(new It(c)),a.includes(Se.CODE_128)&&this.readers.push(new Ae),a.includes(Se.ITF)&&this.readers.push(new tt),a.includes(Se.RSS_14)&&this.readers.push(new Tt),a.includes(Se.RSS_EXPANDED)&&this.readers.push(new xe(this.verbose))):(this.readers.push(new Dl(i)),this.readers.push(new It),this.readers.push(new Dl(i)),this.readers.push(new Ae),this.readers.push(new tt),this.readers.push(new Tt),this.readers.push(new xe(this.verbose)))}decodeRow(i,n,a){for(let c=0;c<this.readers.length;c++)try{return this.readers[c].decodeRow(i,n,a)}catch{}throw new U}reset(){this.readers.forEach(i=>i.reset())}}class Ph extends ye{constructor(i=500,n){super(new As(n),i,n)}}class St{constructor(i,n,a){this.ecCodewords=i,this.ecBlocks=[n],a&&this.ecBlocks.push(a)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class vt{constructor(i,n){this.count=i,this.dataCodewords=n}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ht{constructor(i,n,a,c,u,d){this.versionNumber=i,this.symbolSizeRows=n,this.symbolSizeColumns=a,this.dataRegionSizeRows=c,this.dataRegionSizeColumns=u,this.ecBlocks=d;let _=0;const x=d.getECCodewords(),y=d.getECBlocks();for(let E of y)_+=E.getCount()*(E.getDataCodewords()+x);this.totalCodewords=_}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(i,n){if((i&1)!==0||(n&1)!==0)throw new Y;for(let a of ht.VERSIONS)if(a.symbolSizeRows===i&&a.symbolSizeColumns===n)return a;throw new Y}toString(){return""+this.versionNumber}static buildVersions(){return[new ht(1,10,10,8,8,new St(5,new vt(1,3))),new ht(2,12,12,10,10,new St(7,new vt(1,5))),new ht(3,14,14,12,12,new St(10,new vt(1,8))),new ht(4,16,16,14,14,new St(12,new vt(1,12))),new ht(5,18,18,16,16,new St(14,new vt(1,18))),new ht(6,20,20,18,18,new St(18,new vt(1,22))),new ht(7,22,22,20,20,new St(20,new vt(1,30))),new ht(8,24,24,22,22,new St(24,new vt(1,36))),new ht(9,26,26,24,24,new St(28,new vt(1,44))),new ht(10,32,32,14,14,new St(36,new vt(1,62))),new ht(11,36,36,16,16,new St(42,new vt(1,86))),new ht(12,40,40,18,18,new St(48,new vt(1,114))),new ht(13,44,44,20,20,new St(56,new vt(1,144))),new ht(14,48,48,22,22,new St(68,new vt(1,174))),new ht(15,52,52,24,24,new St(42,new vt(2,102))),new ht(16,64,64,14,14,new St(56,new vt(2,140))),new ht(17,72,72,16,16,new St(36,new vt(4,92))),new ht(18,80,80,18,18,new St(48,new vt(4,114))),new ht(19,88,88,20,20,new St(56,new vt(4,144))),new ht(20,96,96,22,22,new St(68,new vt(4,174))),new ht(21,104,104,24,24,new St(56,new vt(6,136))),new ht(22,120,120,18,18,new St(68,new vt(6,175))),new ht(23,132,132,20,20,new St(62,new vt(8,163))),new ht(24,144,144,22,22,new St(62,new vt(8,156),new vt(2,155))),new ht(25,8,18,6,16,new St(7,new vt(1,5))),new ht(26,8,32,6,14,new St(11,new vt(1,10))),new ht(27,12,26,10,24,new St(14,new vt(1,16))),new ht(28,12,36,10,16,new St(18,new vt(1,22))),new ht(29,16,36,14,16,new St(24,new vt(1,32))),new ht(30,16,48,14,22,new St(28,new vt(1,49)))]}}ht.VERSIONS=ht.buildVersions();class fn{constructor(i){const n=i.getHeight();if(n<8||n>144||(n&1)!==0)throw new Y;this.version=fn.readVersion(i),this.mappingBitMatrix=this.extractDataRegion(i),this.readMappingMatrix=new Ee(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(i){const n=i.getHeight(),a=i.getWidth();return ht.getVersionForDimensions(n,a)}readCodewords(){const i=new Int8Array(this.version.getTotalCodewords());let n=0,a=4,c=0;const u=this.mappingBitMatrix.getHeight(),d=this.mappingBitMatrix.getWidth();let _=!1,x=!1,y=!1,E=!1;do if(a===u&&c===0&&!_)i[n++]=this.readCorner1(u,d)&255,a-=2,c+=2,_=!0;else if(a===u-2&&c===0&&(d&3)!==0&&!x)i[n++]=this.readCorner2(u,d)&255,a-=2,c+=2,x=!0;else if(a===u+4&&c===2&&(d&7)===0&&!y)i[n++]=this.readCorner3(u,d)&255,a-=2,c+=2,y=!0;else if(a===u-2&&c===0&&(d&7)===4&&!E)i[n++]=this.readCorner4(u,d)&255,a-=2,c+=2,E=!0;else{do a<u&&c>=0&&!this.readMappingMatrix.get(c,a)&&(i[n++]=this.readUtah(a,c,u,d)&255),a-=2,c+=2;while(a>=0&&c<d);a+=1,c+=3;do a>=0&&c<d&&!this.readMappingMatrix.get(c,a)&&(i[n++]=this.readUtah(a,c,u,d)&255),a+=2,c-=2;while(a<u&&c>=0);a+=3,c+=1}while(a<u||c<d);if(n!==this.version.getTotalCodewords())throw new Y;return i}readModule(i,n,a,c){return i<0&&(i+=a,n+=4-(a+4&7)),n<0&&(n+=c,i+=4-(c+4&7)),this.readMappingMatrix.set(n,i),this.mappingBitMatrix.get(n,i)}readUtah(i,n,a,c){let u=0;return this.readModule(i-2,n-2,a,c)&&(u|=1),u<<=1,this.readModule(i-2,n-1,a,c)&&(u|=1),u<<=1,this.readModule(i-1,n-2,a,c)&&(u|=1),u<<=1,this.readModule(i-1,n-1,a,c)&&(u|=1),u<<=1,this.readModule(i-1,n,a,c)&&(u|=1),u<<=1,this.readModule(i,n-2,a,c)&&(u|=1),u<<=1,this.readModule(i,n-1,a,c)&&(u|=1),u<<=1,this.readModule(i,n,a,c)&&(u|=1),u}readCorner1(i,n){let a=0;return this.readModule(i-1,0,i,n)&&(a|=1),a<<=1,this.readModule(i-1,1,i,n)&&(a|=1),a<<=1,this.readModule(i-1,2,i,n)&&(a|=1),a<<=1,this.readModule(0,n-2,i,n)&&(a|=1),a<<=1,this.readModule(0,n-1,i,n)&&(a|=1),a<<=1,this.readModule(1,n-1,i,n)&&(a|=1),a<<=1,this.readModule(2,n-1,i,n)&&(a|=1),a<<=1,this.readModule(3,n-1,i,n)&&(a|=1),a}readCorner2(i,n){let a=0;return this.readModule(i-3,0,i,n)&&(a|=1),a<<=1,this.readModule(i-2,0,i,n)&&(a|=1),a<<=1,this.readModule(i-1,0,i,n)&&(a|=1),a<<=1,this.readModule(0,n-4,i,n)&&(a|=1),a<<=1,this.readModule(0,n-3,i,n)&&(a|=1),a<<=1,this.readModule(0,n-2,i,n)&&(a|=1),a<<=1,this.readModule(0,n-1,i,n)&&(a|=1),a<<=1,this.readModule(1,n-1,i,n)&&(a|=1),a}readCorner3(i,n){let a=0;return this.readModule(i-1,0,i,n)&&(a|=1),a<<=1,this.readModule(i-1,n-1,i,n)&&(a|=1),a<<=1,this.readModule(0,n-3,i,n)&&(a|=1),a<<=1,this.readModule(0,n-2,i,n)&&(a|=1),a<<=1,this.readModule(0,n-1,i,n)&&(a|=1),a<<=1,this.readModule(1,n-3,i,n)&&(a|=1),a<<=1,this.readModule(1,n-2,i,n)&&(a|=1),a<<=1,this.readModule(1,n-1,i,n)&&(a|=1),a}readCorner4(i,n){let a=0;return this.readModule(i-3,0,i,n)&&(a|=1),a<<=1,this.readModule(i-2,0,i,n)&&(a|=1),a<<=1,this.readModule(i-1,0,i,n)&&(a|=1),a<<=1,this.readModule(0,n-2,i,n)&&(a|=1),a<<=1,this.readModule(0,n-1,i,n)&&(a|=1),a<<=1,this.readModule(1,n-1,i,n)&&(a|=1),a<<=1,this.readModule(2,n-1,i,n)&&(a|=1),a<<=1,this.readModule(3,n-1,i,n)&&(a|=1),a}extractDataRegion(i){const n=this.version.getSymbolSizeRows(),a=this.version.getSymbolSizeColumns();if(i.getHeight()!==n)throw new N("Dimension of bitMatrix must match the version size");const c=this.version.getDataRegionSizeRows(),u=this.version.getDataRegionSizeColumns(),d=n/c|0,_=a/u|0,x=d*c,y=_*u,E=new Ee(y,x);for(let R=0;R<d;++R){const D=R*c;for(let I=0;I<_;++I){const F=I*u;for(let V=0;V<c;++V){const q=R*(c+2)+1+V,ie=D+V;for(let Ce=0;Ce<u;++Ce){const we=I*(u+2)+1+Ce;if(i.get(we,q)){const ve=F+Ce;E.set(ve,ie)}}}}}return E}}class dn{constructor(i,n){this.numDataCodewords=i,this.codewords=n}static getDataBlocks(i,n){const a=n.getECBlocks();let c=0;const u=a.getECBlocks();for(let V of u)c+=V.getCount();const d=new Array(c);let _=0;for(let V of u)for(let q=0;q<V.getCount();q++){const ie=V.getDataCodewords(),Ce=a.getECCodewords()+ie;d[_++]=new dn(ie,new Uint8Array(Ce))}const y=d[0].codewords.length-a.getECCodewords(),E=y-1;let R=0;for(let V=0;V<E;V++)for(let q=0;q<_;q++)d[q].codewords[V]=i[R++];const D=n.getVersionNumber()===24,I=D?8:_;for(let V=0;V<I;V++)d[V].codewords[y-1]=i[R++];const F=d[0].codewords.length;for(let V=y;V<F;V++)for(let q=0;q<_;q++){const ie=D?(q+8)%_:q,Ce=D&&ie>7?V-1:V;d[ie].codewords[Ce]=i[R++]}if(R!==i.length)throw new N;return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Ts{constructor(i){this.bytes=i,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(i){if(i<1||i>32||i>this.available())throw new N(""+i);let n=0,a=this.bitOffset,c=this.byteOffset;const u=this.bytes;if(a>0){const d=8-a,_=i<d?i:d,x=d-_,y=255>>8-_<<x;n=(u[c]&y)>>x,i-=_,a+=_,a===8&&(a=0,c++)}if(i>0){for(;i>=8;)n=n<<8|u[c]&255,c++,i-=8;if(i>0){const d=8-i,_=255>>d<<d;n=n<<i|(u[c]&_)>>d,a+=i}}return this.bitOffset=a,this.byteOffset=c,n}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var yt;(function(T){T[T.PAD_ENCODE=0]="PAD_ENCODE",T[T.ASCII_ENCODE=1]="ASCII_ENCODE",T[T.C40_ENCODE=2]="C40_ENCODE",T[T.TEXT_ENCODE=3]="TEXT_ENCODE",T[T.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",T[T.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",T[T.BASE256_ENCODE=6]="BASE256_ENCODE"})(yt||(yt={}));class ar{static decode(i){const n=new Ts(i),a=new ae,c=new ae,u=new Array;let d=yt.ASCII_ENCODE;do if(d===yt.ASCII_ENCODE)d=this.decodeAsciiSegment(n,a,c);else{switch(d){case yt.C40_ENCODE:this.decodeC40Segment(n,a);break;case yt.TEXT_ENCODE:this.decodeTextSegment(n,a);break;case yt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(n,a);break;case yt.EDIFACT_ENCODE:this.decodeEdifactSegment(n,a);break;case yt.BASE256_ENCODE:this.decodeBase256Segment(n,a,u);break;default:throw new Y}d=yt.ASCII_ENCODE}while(d!==yt.PAD_ENCODE&&n.available()>0);return c.length()>0&&a.append(c.toString()),new dt(i,a.toString(),u.length===0?null:u,null)}static decodeAsciiSegment(i,n,a){let c=!1;do{let u=i.readBits(8);if(u===0)throw new Y;if(u<=128)return c&&(u+=128),n.append(String.fromCharCode(u-1)),yt.ASCII_ENCODE;if(u===129)return yt.PAD_ENCODE;if(u<=229){const d=u-130;d<10&&n.append("0"),n.append(""+d)}else switch(u){case 230:return yt.C40_ENCODE;case 231:return yt.BASE256_ENCODE;case 232:n.append("");break;case 233:case 234:break;case 235:c=!0;break;case 236:n.append("[)>05"),a.insert(0,"");break;case 237:n.append("[)>06"),a.insert(0,"");break;case 238:return yt.ANSIX12_ENCODE;case 239:return yt.TEXT_ENCODE;case 240:return yt.EDIFACT_ENCODE;case 241:break;default:if(u!==254||i.available()!==0)throw new Y;break}}while(i.available()>0);return yt.ASCII_ENCODE}static decodeC40Segment(i,n){let a=!1;const c=[];let u=0;do{if(i.available()===8)return;const d=i.readBits(8);if(d===254)return;this.parseTwoBytes(d,i.readBits(8),c);for(let _=0;_<3;_++){const x=c[_];switch(u){case 0:if(x<3)u=x+1;else if(x<this.C40_BASIC_SET_CHARS.length){const y=this.C40_BASIC_SET_CHARS[x];a?(n.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):n.append(y)}else throw new Y;break;case 1:a?(n.append(String.fromCharCode(x+128)),a=!1):n.append(String.fromCharCode(x)),u=0;break;case 2:if(x<this.C40_SHIFT2_SET_CHARS.length){const y=this.C40_SHIFT2_SET_CHARS[x];a?(n.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):n.append(y)}else switch(x){case 27:n.append("");break;case 30:a=!0;break;default:throw new Y}u=0;break;case 3:a?(n.append(String.fromCharCode(x+224)),a=!1):n.append(String.fromCharCode(x+96)),u=0;break;default:throw new Y}}}while(i.available()>0)}static decodeTextSegment(i,n){let a=!1,c=[],u=0;do{if(i.available()===8)return;const d=i.readBits(8);if(d===254)return;this.parseTwoBytes(d,i.readBits(8),c);for(let _=0;_<3;_++){const x=c[_];switch(u){case 0:if(x<3)u=x+1;else if(x<this.TEXT_BASIC_SET_CHARS.length){const y=this.TEXT_BASIC_SET_CHARS[x];a?(n.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):n.append(y)}else throw new Y;break;case 1:a?(n.append(String.fromCharCode(x+128)),a=!1):n.append(String.fromCharCode(x)),u=0;break;case 2:if(x<this.TEXT_SHIFT2_SET_CHARS.length){const y=this.TEXT_SHIFT2_SET_CHARS[x];a?(n.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):n.append(y)}else switch(x){case 27:n.append("");break;case 30:a=!0;break;default:throw new Y}u=0;break;case 3:if(x<this.TEXT_SHIFT3_SET_CHARS.length){const y=this.TEXT_SHIFT3_SET_CHARS[x];a?(n.append(String.fromCharCode(y.charCodeAt(0)+128)),a=!1):n.append(y),u=0}else throw new Y;break;default:throw new Y}}}while(i.available()>0)}static decodeAnsiX12Segment(i,n){const a=[];do{if(i.available()===8)return;const c=i.readBits(8);if(c===254)return;this.parseTwoBytes(c,i.readBits(8),a);for(let u=0;u<3;u++){const d=a[u];switch(d){case 0:n.append("\r");break;case 1:n.append("*");break;case 2:n.append(">");break;case 3:n.append(" ");break;default:if(d<14)n.append(String.fromCharCode(d+44));else if(d<40)n.append(String.fromCharCode(d+51));else throw new Y;break}}}while(i.available()>0)}static parseTwoBytes(i,n,a){let c=(i<<8)+n-1,u=Math.floor(c/1600);a[0]=u,c-=u*1600,u=Math.floor(c/40),a[1]=u,a[2]=c-u*40}static decodeEdifactSegment(i,n){do{if(i.available()<=16)return;for(let a=0;a<4;a++){let c=i.readBits(6);if(c===31){const u=8-i.getBitOffset();u!==8&&i.readBits(u);return}(c&32)===0&&(c|=64),n.append(String.fromCharCode(c))}}while(i.available()>0)}static decodeBase256Segment(i,n,a){let c=1+i.getByteOffset();const u=this.unrandomize255State(i.readBits(8),c++);let d;if(u===0?d=i.available()/8|0:u<250?d=u:d=250*(u-249)+this.unrandomize255State(i.readBits(8),c++),d<0)throw new Y;const _=new Uint8Array(d);for(let x=0;x<d;x++){if(i.available()<8)throw new Y;_[x]=this.unrandomize255State(i.readBits(8),c++)}a.push(_);try{n.append(je.decode(_,oe.ISO88591))}catch(x){throw new fs("Platform does not support required encoding: "+x.message)}}static unrandomize255State(i,n){const a=149*n%255+1,c=i-a;return c>=0?c:c+256}}ar.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],ar.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],ar.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ar.TEXT_SHIFT2_SET_CHARS=ar.C40_SHIFT2_SET_CHARS,ar.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Hh{constructor(){this.rsDecoder=new Br(ze.DATA_MATRIX_FIELD_256)}decode(i){const n=new fn(i),a=n.getVersion(),c=n.readCodewords(),u=dn.getDataBlocks(c,a);let d=0;for(let y of u)d+=y.getNumDataCodewords();const _=new Uint8Array(d),x=u.length;for(let y=0;y<x;y++){const E=u[y],R=E.getCodewords(),D=E.getNumDataCodewords();this.correctErrors(R,D);for(let I=0;I<D;I++)_[I*x+y]=R[I]}return ar.decode(_)}correctErrors(i,n){const a=new Int32Array(i);try{this.rsDecoder.decode(a,i.length-n)}catch{throw new P}for(let c=0;c<n;c++)i[c]=a[c]}}class Yt{constructor(i){this.image=i,this.rectangleDetector=new ti(this.image)}detect(){const i=this.rectangleDetector.detect();let n=this.detectSolid1(i);if(n=this.detectSolid2(n),n[3]=this.correctTopRight(n),!n[3])throw new U;n=this.shiftToModuleCenter(n);const a=n[0],c=n[1],u=n[2],d=n[3];let _=this.transitionsBetween(a,d)+1,x=this.transitionsBetween(u,d)+1;(_&1)===1&&(_+=1),(x&1)===1&&(x+=1),4*_<7*x&&4*x<7*_&&(_=x=Math.max(_,x));let y=Yt.sampleGrid(this.image,a,c,u,d,_,x);return new Ia(y,[a,c,u,d])}static shiftPoint(i,n,a){let c=(n.getX()-i.getX())/(a+1),u=(n.getY()-i.getY())/(a+1);return new Pe(i.getX()+c,i.getY()+u)}static moveAway(i,n,a){let c=i.getX(),u=i.getY();return c<n?c-=1:c+=1,u<a?u-=1:u+=1,new Pe(c,u)}detectSolid1(i){let n=i[0],a=i[1],c=i[3],u=i[2],d=this.transitionsBetween(n,a),_=this.transitionsBetween(a,c),x=this.transitionsBetween(c,u),y=this.transitionsBetween(u,n),E=d,R=[u,n,a,c];return E>_&&(E=_,R[0]=n,R[1]=a,R[2]=c,R[3]=u),E>x&&(E=x,R[0]=a,R[1]=c,R[2]=u,R[3]=n),E>y&&(R[0]=c,R[1]=u,R[2]=n,R[3]=a),R}detectSolid2(i){let n=i[0],a=i[1],c=i[2],u=i[3],d=this.transitionsBetween(n,u),_=Yt.shiftPoint(a,c,(d+1)*4),x=Yt.shiftPoint(c,a,(d+1)*4),y=this.transitionsBetween(_,n),E=this.transitionsBetween(x,u);return y<E?(i[0]=n,i[1]=a,i[2]=c,i[3]=u):(i[0]=a,i[1]=c,i[2]=u,i[3]=n),i}correctTopRight(i){let n=i[0],a=i[1],c=i[2],u=i[3],d=this.transitionsBetween(n,u),_=this.transitionsBetween(a,u),x=Yt.shiftPoint(n,a,(_+1)*4),y=Yt.shiftPoint(c,a,(d+1)*4);d=this.transitionsBetween(x,u),_=this.transitionsBetween(y,u);let E=new Pe(u.getX()+(c.getX()-a.getX())/(d+1),u.getY()+(c.getY()-a.getY())/(d+1)),R=new Pe(u.getX()+(n.getX()-a.getX())/(_+1),u.getY()+(n.getY()-a.getY())/(_+1));if(!this.isValid(E))return this.isValid(R)?R:null;if(!this.isValid(R))return E;let D=this.transitionsBetween(x,E)+this.transitionsBetween(y,E),I=this.transitionsBetween(x,R)+this.transitionsBetween(y,R);return D>I?E:R}shiftToModuleCenter(i){let n=i[0],a=i[1],c=i[2],u=i[3],d=this.transitionsBetween(n,u)+1,_=this.transitionsBetween(c,u)+1,x=Yt.shiftPoint(n,a,_*4),y=Yt.shiftPoint(c,a,d*4);d=this.transitionsBetween(x,u)+1,_=this.transitionsBetween(y,u)+1,(d&1)===1&&(d+=1),(_&1)===1&&(_+=1);let E=(n.getX()+a.getX()+c.getX()+u.getX())/4,R=(n.getY()+a.getY()+c.getY()+u.getY())/4;n=Yt.moveAway(n,E,R),a=Yt.moveAway(a,E,R),c=Yt.moveAway(c,E,R),u=Yt.moveAway(u,E,R);let D,I;return x=Yt.shiftPoint(n,a,_*4),x=Yt.shiftPoint(x,u,d*4),D=Yt.shiftPoint(a,n,_*4),D=Yt.shiftPoint(D,c,d*4),y=Yt.shiftPoint(c,u,_*4),y=Yt.shiftPoint(y,a,d*4),I=Yt.shiftPoint(u,c,_*4),I=Yt.shiftPoint(I,n,d*4),[x,D,y,I]}isValid(i){return i.getX()>=0&&i.getX()<this.image.getWidth()&&i.getY()>0&&i.getY()<this.image.getHeight()}static sampleGrid(i,n,a,c,u,d,_){return Cs.getInstance().sampleGrid(i,d,_,.5,.5,d-.5,.5,d-.5,_-.5,.5,_-.5,n.getX(),n.getY(),u.getX(),u.getY(),c.getX(),c.getY(),a.getX(),a.getY())}transitionsBetween(i,n){let a=Math.trunc(i.getX()),c=Math.trunc(i.getY()),u=Math.trunc(n.getX()),d=Math.trunc(n.getY()),_=Math.abs(d-c)>Math.abs(u-a);if(_){let V=a;a=c,c=V,V=u,u=d,d=V}let x=Math.abs(u-a),y=Math.abs(d-c),E=-x/2,R=c<d?1:-1,D=a<u?1:-1,I=0,F=this.image.get(_?c:a,_?a:c);for(let V=a,q=c;V!==u;V+=D){let ie=this.image.get(_?q:V,_?V:q);if(ie!==F&&(I++,F=ie),E+=y,E>0){if(q===d)break;q+=R,E-=x}}return I}}class lr{constructor(){this.decoder=new Hh}decode(i,n=null){let a,c;if(n!=null&&n.has(Re.PURE_BARCODE)){const y=lr.extractPureBits(i.getBlackMatrix());a=this.decoder.decode(y),c=lr.NO_POINTS}else{const y=new Yt(i.getBlackMatrix()).detect();a=this.decoder.decode(y.getBits()),c=y.getPoints()}const u=a.getRawBytes(),d=new be(a.getText(),u,8*u.length,c,Se.DATA_MATRIX,X.currentTimeMillis()),_=a.getByteSegments();_!=null&&d.putMetadata(ot.BYTE_SEGMENTS,_);const x=a.getECLevel();return x!=null&&d.putMetadata(ot.ERROR_CORRECTION_LEVEL,x),d}reset(){}static extractPureBits(i){const n=i.getTopLeftOnBit(),a=i.getBottomRightOnBit();if(n==null||a==null)throw new U;const c=this.moduleSize(n,i);let u=n[1];const d=a[1];let _=n[0];const y=(a[0]-_+1)/c,E=(d-u+1)/c;if(y<=0||E<=0)throw new U;const R=c/2;u+=R,_+=R;const D=new Ee(y,E);for(let I=0;I<E;I++){const F=u+I*c;for(let V=0;V<y;V++)i.get(_+V*c,F)&&D.set(V,I)}return D}static moduleSize(i,n){const a=n.getWidth();let c=i[0];const u=i[1];for(;c<a&&n.get(c,u);)c++;if(c===a)throw new U;const d=c-i[0];if(d===0)throw new U;return d}}lr.NO_POINTS=[];class Ha extends ye{constructor(i=500){super(new lr,i)}}var gn;(function(T){T[T.L=0]="L",T[T.M=1]="M",T[T.Q=2]="Q",T[T.H=3]="H"})(gn||(gn={}));class nt{constructor(i,n,a){this.value=i,this.stringValue=n,this.bits=a,nt.FOR_BITS.set(a,this),nt.FOR_VALUE.set(i,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(i){switch(i){case"L":return nt.L;case"M":return nt.M;case"Q":return nt.Q;case"H":return nt.H;default:throw new M(i+"not available")}}toString(){return this.stringValue}equals(i){if(!(i instanceof nt))return!1;const n=i;return this.value===n.value}static forBits(i){if(i<0||i>=nt.FOR_BITS.size)throw new N;return nt.FOR_BITS.get(i)}}nt.FOR_BITS=new Map,nt.FOR_VALUE=new Map,nt.L=new nt(gn.L,"L",1),nt.M=new nt(gn.M,"M",0),nt.Q=new nt(gn.Q,"Q",3),nt.H=new nt(gn.H,"H",2);class vi{constructor(i){this.errorCorrectionLevel=nt.forBits(i>>3&3),this.dataMask=i&7}static numBitsDiffering(i,n){return te.bitCount(i^n)}static decodeFormatInformation(i,n){const a=vi.doDecodeFormatInformation(i,n);return a!==null?a:vi.doDecodeFormatInformation(i^vi.FORMAT_INFO_MASK_QR,n^vi.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(i,n){let a=Number.MAX_SAFE_INTEGER,c=0;for(const u of vi.FORMAT_INFO_DECODE_LOOKUP){const d=u[0];if(d===i||d===n)return new vi(u[1]);let _=vi.numBitsDiffering(i,d);_<a&&(c=u[1],a=_),i!==n&&(_=vi.numBitsDiffering(n,d),_<a&&(c=u[1],a=_))}return a<=3?new vi(c):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(i){if(!(i instanceof vi))return!1;const n=i;return this.errorCorrectionLevel===n.errorCorrectionLevel&&this.dataMask===n.dataMask}}vi.FORMAT_INFO_MASK_QR=21522,vi.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class K{constructor(i,...n){this.ecCodewordsPerBlock=i,this.ecBlocks=n}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let i=0;const n=this.ecBlocks;for(const a of n)i+=a.getCount();return i}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class B{constructor(i,n){this.count=i,this.dataCodewords=n}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Fe{constructor(i,n,...a){this.versionNumber=i,this.alignmentPatternCenters=n,this.ecBlocks=a;let c=0;const u=a[0].getECCodewordsPerBlock(),d=a[0].getECBlocks();for(const _ of d)c+=_.getCount()*(_.getDataCodewords()+u);this.totalCodewords=c}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(i){return this.ecBlocks[i.getValue()]}static getProvisionalVersionForDimension(i){if(i%4!==1)throw new Y;try{return this.getVersionForNumber((i-17)/4)}catch{throw new Y}}static getVersionForNumber(i){if(i<1||i>40)throw new N;return Fe.VERSIONS[i-1]}static decodeVersionInformation(i){let n=Number.MAX_SAFE_INTEGER,a=0;for(let c=0;c<Fe.VERSION_DECODE_INFO.length;c++){const u=Fe.VERSION_DECODE_INFO[c];if(u===i)return Fe.getVersionForNumber(c+7);const d=vi.numBitsDiffering(i,u);d<n&&(a=c+7,n=d)}return n<=3?Fe.getVersionForNumber(a):null}buildFunctionPattern(){const i=this.getDimensionForVersion(),n=new Ee(i);n.setRegion(0,0,9,9),n.setRegion(i-8,0,8,9),n.setRegion(0,i-8,9,8);const a=this.alignmentPatternCenters.length;for(let c=0;c<a;c++){const u=this.alignmentPatternCenters[c]-2;for(let d=0;d<a;d++)c===0&&(d===0||d===a-1)||c===a-1&&d===0||n.setRegion(this.alignmentPatternCenters[d]-2,u,5,5)}return n.setRegion(6,9,1,i-17),n.setRegion(9,6,i-17,1),this.versionNumber>6&&(n.setRegion(i-11,0,3,6),n.setRegion(0,i-11,6,3)),n}toString(){return""+this.versionNumber}}Fe.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Fe.VERSIONS=[new Fe(1,new Int32Array(0),new K(7,new B(1,19)),new K(10,new B(1,16)),new K(13,new B(1,13)),new K(17,new B(1,9))),new Fe(2,Int32Array.from([6,18]),new K(10,new B(1,34)),new K(16,new B(1,28)),new K(22,new B(1,22)),new K(28,new B(1,16))),new Fe(3,Int32Array.from([6,22]),new K(15,new B(1,55)),new K(26,new B(1,44)),new K(18,new B(2,17)),new K(22,new B(2,13))),new Fe(4,Int32Array.from([6,26]),new K(20,new B(1,80)),new K(18,new B(2,32)),new K(26,new B(2,24)),new K(16,new B(4,9))),new Fe(5,Int32Array.from([6,30]),new K(26,new B(1,108)),new K(24,new B(2,43)),new K(18,new B(2,15),new B(2,16)),new K(22,new B(2,11),new B(2,12))),new Fe(6,Int32Array.from([6,34]),new K(18,new B(2,68)),new K(16,new B(4,27)),new K(24,new B(4,19)),new K(28,new B(4,15))),new Fe(7,Int32Array.from([6,22,38]),new K(20,new B(2,78)),new K(18,new B(4,31)),new K(18,new B(2,14),new B(4,15)),new K(26,new B(4,13),new B(1,14))),new Fe(8,Int32Array.from([6,24,42]),new K(24,new B(2,97)),new K(22,new B(2,38),new B(2,39)),new K(22,new B(4,18),new B(2,19)),new K(26,new B(4,14),new B(2,15))),new Fe(9,Int32Array.from([6,26,46]),new K(30,new B(2,116)),new K(22,new B(3,36),new B(2,37)),new K(20,new B(4,16),new B(4,17)),new K(24,new B(4,12),new B(4,13))),new Fe(10,Int32Array.from([6,28,50]),new K(18,new B(2,68),new B(2,69)),new K(26,new B(4,43),new B(1,44)),new K(24,new B(6,19),new B(2,20)),new K(28,new B(6,15),new B(2,16))),new Fe(11,Int32Array.from([6,30,54]),new K(20,new B(4,81)),new K(30,new B(1,50),new B(4,51)),new K(28,new B(4,22),new B(4,23)),new K(24,new B(3,12),new B(8,13))),new Fe(12,Int32Array.from([6,32,58]),new K(24,new B(2,92),new B(2,93)),new K(22,new B(6,36),new B(2,37)),new K(26,new B(4,20),new B(6,21)),new K(28,new B(7,14),new B(4,15))),new Fe(13,Int32Array.from([6,34,62]),new K(26,new B(4,107)),new K(22,new B(8,37),new B(1,38)),new K(24,new B(8,20),new B(4,21)),new K(22,new B(12,11),new B(4,12))),new Fe(14,Int32Array.from([6,26,46,66]),new K(30,new B(3,115),new B(1,116)),new K(24,new B(4,40),new B(5,41)),new K(20,new B(11,16),new B(5,17)),new K(24,new B(11,12),new B(5,13))),new Fe(15,Int32Array.from([6,26,48,70]),new K(22,new B(5,87),new B(1,88)),new K(24,new B(5,41),new B(5,42)),new K(30,new B(5,24),new B(7,25)),new K(24,new B(11,12),new B(7,13))),new Fe(16,Int32Array.from([6,26,50,74]),new K(24,new B(5,98),new B(1,99)),new K(28,new B(7,45),new B(3,46)),new K(24,new B(15,19),new B(2,20)),new K(30,new B(3,15),new B(13,16))),new Fe(17,Int32Array.from([6,30,54,78]),new K(28,new B(1,107),new B(5,108)),new K(28,new B(10,46),new B(1,47)),new K(28,new B(1,22),new B(15,23)),new K(28,new B(2,14),new B(17,15))),new Fe(18,Int32Array.from([6,30,56,82]),new K(30,new B(5,120),new B(1,121)),new K(26,new B(9,43),new B(4,44)),new K(28,new B(17,22),new B(1,23)),new K(28,new B(2,14),new B(19,15))),new Fe(19,Int32Array.from([6,30,58,86]),new K(28,new B(3,113),new B(4,114)),new K(26,new B(3,44),new B(11,45)),new K(26,new B(17,21),new B(4,22)),new K(26,new B(9,13),new B(16,14))),new Fe(20,Int32Array.from([6,34,62,90]),new K(28,new B(3,107),new B(5,108)),new K(26,new B(3,41),new B(13,42)),new K(30,new B(15,24),new B(5,25)),new K(28,new B(15,15),new B(10,16))),new Fe(21,Int32Array.from([6,28,50,72,94]),new K(28,new B(4,116),new B(4,117)),new K(26,new B(17,42)),new K(28,new B(17,22),new B(6,23)),new K(30,new B(19,16),new B(6,17))),new Fe(22,Int32Array.from([6,26,50,74,98]),new K(28,new B(2,111),new B(7,112)),new K(28,new B(17,46)),new K(30,new B(7,24),new B(16,25)),new K(24,new B(34,13))),new Fe(23,Int32Array.from([6,30,54,78,102]),new K(30,new B(4,121),new B(5,122)),new K(28,new B(4,47),new B(14,48)),new K(30,new B(11,24),new B(14,25)),new K(30,new B(16,15),new B(14,16))),new Fe(24,Int32Array.from([6,28,54,80,106]),new K(30,new B(6,117),new B(4,118)),new K(28,new B(6,45),new B(14,46)),new K(30,new B(11,24),new B(16,25)),new K(30,new B(30,16),new B(2,17))),new Fe(25,Int32Array.from([6,32,58,84,110]),new K(26,new B(8,106),new B(4,107)),new K(28,new B(8,47),new B(13,48)),new K(30,new B(7,24),new B(22,25)),new K(30,new B(22,15),new B(13,16))),new Fe(26,Int32Array.from([6,30,58,86,114]),new K(28,new B(10,114),new B(2,115)),new K(28,new B(19,46),new B(4,47)),new K(28,new B(28,22),new B(6,23)),new K(30,new B(33,16),new B(4,17))),new Fe(27,Int32Array.from([6,34,62,90,118]),new K(30,new B(8,122),new B(4,123)),new K(28,new B(22,45),new B(3,46)),new K(30,new B(8,23),new B(26,24)),new K(30,new B(12,15),new B(28,16))),new Fe(28,Int32Array.from([6,26,50,74,98,122]),new K(30,new B(3,117),new B(10,118)),new K(28,new B(3,45),new B(23,46)),new K(30,new B(4,24),new B(31,25)),new K(30,new B(11,15),new B(31,16))),new Fe(29,Int32Array.from([6,30,54,78,102,126]),new K(30,new B(7,116),new B(7,117)),new K(28,new B(21,45),new B(7,46)),new K(30,new B(1,23),new B(37,24)),new K(30,new B(19,15),new B(26,16))),new Fe(30,Int32Array.from([6,26,52,78,104,130]),new K(30,new B(5,115),new B(10,116)),new K(28,new B(19,47),new B(10,48)),new K(30,new B(15,24),new B(25,25)),new K(30,new B(23,15),new B(25,16))),new Fe(31,Int32Array.from([6,30,56,82,108,134]),new K(30,new B(13,115),new B(3,116)),new K(28,new B(2,46),new B(29,47)),new K(30,new B(42,24),new B(1,25)),new K(30,new B(23,15),new B(28,16))),new Fe(32,Int32Array.from([6,34,60,86,112,138]),new K(30,new B(17,115)),new K(28,new B(10,46),new B(23,47)),new K(30,new B(10,24),new B(35,25)),new K(30,new B(19,15),new B(35,16))),new Fe(33,Int32Array.from([6,30,58,86,114,142]),new K(30,new B(17,115),new B(1,116)),new K(28,new B(14,46),new B(21,47)),new K(30,new B(29,24),new B(19,25)),new K(30,new B(11,15),new B(46,16))),new Fe(34,Int32Array.from([6,34,62,90,118,146]),new K(30,new B(13,115),new B(6,116)),new K(28,new B(14,46),new B(23,47)),new K(30,new B(44,24),new B(7,25)),new K(30,new B(59,16),new B(1,17))),new Fe(35,Int32Array.from([6,30,54,78,102,126,150]),new K(30,new B(12,121),new B(7,122)),new K(28,new B(12,47),new B(26,48)),new K(30,new B(39,24),new B(14,25)),new K(30,new B(22,15),new B(41,16))),new Fe(36,Int32Array.from([6,24,50,76,102,128,154]),new K(30,new B(6,121),new B(14,122)),new K(28,new B(6,47),new B(34,48)),new K(30,new B(46,24),new B(10,25)),new K(30,new B(2,15),new B(64,16))),new Fe(37,Int32Array.from([6,28,54,80,106,132,158]),new K(30,new B(17,122),new B(4,123)),new K(28,new B(29,46),new B(14,47)),new K(30,new B(49,24),new B(10,25)),new K(30,new B(24,15),new B(46,16))),new Fe(38,Int32Array.from([6,32,58,84,110,136,162]),new K(30,new B(4,122),new B(18,123)),new K(28,new B(13,46),new B(32,47)),new K(30,new B(48,24),new B(14,25)),new K(30,new B(42,15),new B(32,16))),new Fe(39,Int32Array.from([6,26,54,82,110,138,166]),new K(30,new B(20,117),new B(4,118)),new K(28,new B(40,47),new B(7,48)),new K(30,new B(43,24),new B(22,25)),new K(30,new B(10,15),new B(67,16))),new Fe(40,Int32Array.from([6,30,58,86,114,142,170]),new K(30,new B(19,118),new B(6,119)),new K(28,new B(18,47),new B(31,48)),new K(30,new B(34,24),new B(34,25)),new K(30,new B(20,15),new B(61,16)))];var gi;(function(T){T[T.DATA_MASK_000=0]="DATA_MASK_000",T[T.DATA_MASK_001=1]="DATA_MASK_001",T[T.DATA_MASK_010=2]="DATA_MASK_010",T[T.DATA_MASK_011=3]="DATA_MASK_011",T[T.DATA_MASK_100=4]="DATA_MASK_100",T[T.DATA_MASK_101=5]="DATA_MASK_101",T[T.DATA_MASK_110=6]="DATA_MASK_110",T[T.DATA_MASK_111=7]="DATA_MASK_111"})(gi||(gi={}));class ns{constructor(i,n){this.value=i,this.isMasked=n}unmaskBitMatrix(i,n){for(let a=0;a<n;a++)for(let c=0;c<n;c++)this.isMasked(a,c)&&i.flip(c,a)}}ns.values=new Map([[gi.DATA_MASK_000,new ns(gi.DATA_MASK_000,(T,i)=>(T+i&1)===0)],[gi.DATA_MASK_001,new ns(gi.DATA_MASK_001,(T,i)=>(T&1)===0)],[gi.DATA_MASK_010,new ns(gi.DATA_MASK_010,(T,i)=>i%3===0)],[gi.DATA_MASK_011,new ns(gi.DATA_MASK_011,(T,i)=>(T+i)%3===0)],[gi.DATA_MASK_100,new ns(gi.DATA_MASK_100,(T,i)=>(Math.floor(T/2)+Math.floor(i/3)&1)===0)],[gi.DATA_MASK_101,new ns(gi.DATA_MASK_101,(T,i)=>T*i%6===0)],[gi.DATA_MASK_110,new ns(gi.DATA_MASK_110,(T,i)=>T*i%6<3)],[gi.DATA_MASK_111,new ns(gi.DATA_MASK_111,(T,i)=>(T+i+T*i%3&1)===0)]]);class _n{constructor(i){const n=i.getHeight();if(n<21||(n&3)!==1)throw new Y;this.bitMatrix=i}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let i=0;for(let u=0;u<6;u++)i=this.copyBit(u,8,i);i=this.copyBit(7,8,i),i=this.copyBit(8,8,i),i=this.copyBit(8,7,i);for(let u=5;u>=0;u--)i=this.copyBit(8,u,i);const n=this.bitMatrix.getHeight();let a=0;const c=n-7;for(let u=n-1;u>=c;u--)a=this.copyBit(8,u,a);for(let u=n-8;u<n;u++)a=this.copyBit(u,8,a);if(this.parsedFormatInfo=vi.decodeFormatInformation(i,a),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Y}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const i=this.bitMatrix.getHeight(),n=Math.floor((i-17)/4);if(n<=6)return Fe.getVersionForNumber(n);let a=0;const c=i-11;for(let d=5;d>=0;d--)for(let _=i-9;_>=c;_--)a=this.copyBit(_,d,a);let u=Fe.decodeVersionInformation(a);if(u!==null&&u.getDimensionForVersion()===i)return this.parsedVersion=u,u;a=0;for(let d=5;d>=0;d--)for(let _=i-9;_>=c;_--)a=this.copyBit(d,_,a);if(u=Fe.decodeVersionInformation(a),u!==null&&u.getDimensionForVersion()===i)return this.parsedVersion=u,u;throw new Y}copyBit(i,n,a){return(this.isMirror?this.bitMatrix.get(n,i):this.bitMatrix.get(i,n))?a<<1|1:a<<1}readCodewords(){const i=this.readFormatInformation(),n=this.readVersion(),a=ns.values.get(i.getDataMask()),c=this.bitMatrix.getHeight();a.unmaskBitMatrix(this.bitMatrix,c);const u=n.buildFunctionPattern();let d=!0;const _=new Uint8Array(n.getTotalCodewords());let x=0,y=0,E=0;for(let R=c-1;R>0;R-=2){R===6&&R--;for(let D=0;D<c;D++){const I=d?c-1-D:D;for(let F=0;F<2;F++)u.get(R-F,I)||(E++,y<<=1,this.bitMatrix.get(R-F,I)&&(y|=1),E===8&&(_[x++]=y,E=0,y=0))}d=!d}if(x!==n.getTotalCodewords())throw new Y;return _}remask(){if(this.parsedFormatInfo===null)return;const i=ns.values[this.parsedFormatInfo.getDataMask()],n=this.bitMatrix.getHeight();i.unmaskBitMatrix(this.bitMatrix,n)}setMirror(i){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=i}mirror(){const i=this.bitMatrix;for(let n=0,a=i.getWidth();n<a;n++)for(let c=n+1,u=i.getHeight();c<u;c++)i.get(n,c)!==i.get(c,n)&&(i.flip(c,n),i.flip(n,c))}}class Ol{constructor(i,n){this.numDataCodewords=i,this.codewords=n}static getDataBlocks(i,n,a){if(i.length!==n.getTotalCodewords())throw new N;const c=n.getECBlocksForLevel(a);let u=0;const d=c.getECBlocks();for(const F of d)u+=F.getCount();const _=new Array(u);let x=0;for(const F of d)for(let V=0;V<F.getCount();V++){const q=F.getDataCodewords(),ie=c.getECCodewordsPerBlock()+q;_[x++]=new Ol(q,new Uint8Array(ie))}const y=_[0].codewords.length;let E=_.length-1;for(;E>=0&&_[E].codewords.length!==y;)E--;E++;const R=y-c.getECCodewordsPerBlock();let D=0;for(let F=0;F<R;F++)for(let V=0;V<x;V++)_[V].codewords[F]=i[D++];for(let F=E;F<x;F++)_[F].codewords[R]=i[D++];const I=_[0].codewords.length;for(let F=R;F<I;F++)for(let V=0;V<x;V++){const q=V<E?F:F+1;_[V].codewords[q]=i[D++]}return _}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var as;(function(T){T[T.TERMINATOR=0]="TERMINATOR",T[T.NUMERIC=1]="NUMERIC",T[T.ALPHANUMERIC=2]="ALPHANUMERIC",T[T.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",T[T.BYTE=4]="BYTE",T[T.ECI=5]="ECI",T[T.KANJI=6]="KANJI",T[T.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",T[T.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",T[T.HANZI=9]="HANZI"})(as||(as={}));class We{constructor(i,n,a,c){this.value=i,this.stringValue=n,this.characterCountBitsForVersions=a,this.bits=c,We.FOR_BITS.set(c,this),We.FOR_VALUE.set(i,this)}static forBits(i){const n=We.FOR_BITS.get(i);if(n===void 0)throw new N;return n}getCharacterCountBits(i){const n=i.getVersionNumber();let a;return n<=9?a=0:n<=26?a=1:a=2,this.characterCountBitsForVersions[a]}getValue(){return this.value}getBits(){return this.bits}equals(i){if(!(i instanceof We))return!1;const n=i;return this.value===n.value}toString(){return this.stringValue}}We.FOR_BITS=new Map,We.FOR_VALUE=new Map,We.TERMINATOR=new We(as.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),We.NUMERIC=new We(as.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),We.ALPHANUMERIC=new We(as.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),We.STRUCTURED_APPEND=new We(as.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),We.BYTE=new We(as.BYTE,"BYTE",Int32Array.from([8,16,16]),4),We.ECI=new We(as.ECI,"ECI",Int32Array.from([0,0,0]),7),We.KANJI=new We(as.KANJI,"KANJI",Int32Array.from([8,10,12]),8),We.FNC1_FIRST_POSITION=new We(as.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),We.FNC1_SECOND_POSITION=new We(as.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),We.HANZI=new We(as.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class zt{static decode(i,n,a,c){const u=new Ts(i);let d=new ae;const _=new Array;let x=-1,y=-1;try{let E=null,R=!1,D;do{if(u.available()<4)D=We.TERMINATOR;else{const I=u.readBits(4);D=We.forBits(I)}switch(D){case We.TERMINATOR:break;case We.FNC1_FIRST_POSITION:case We.FNC1_SECOND_POSITION:R=!0;break;case We.STRUCTURED_APPEND:if(u.available()<16)throw new Y;x=u.readBits(8),y=u.readBits(8);break;case We.ECI:const I=zt.parseECIValue(u);if(E=de.getCharacterSetECIByValue(I),E===null)throw new Y;break;case We.HANZI:const F=u.readBits(4),V=u.readBits(D.getCharacterCountBits(n));F===zt.GB2312_SUBSET&&zt.decodeHanziSegment(u,d,V);break;default:const q=u.readBits(D.getCharacterCountBits(n));switch(D){case We.NUMERIC:zt.decodeNumericSegment(u,d,q);break;case We.ALPHANUMERIC:zt.decodeAlphanumericSegment(u,d,q,R);break;case We.BYTE:zt.decodeByteSegment(u,d,q,E,_,c);break;case We.KANJI:zt.decodeKanjiSegment(u,d,q);break;default:throw new Y}break}}while(D!==We.TERMINATOR)}catch{throw new Y}return new dt(i,d.toString(),_.length===0?null:_,a===null?null:a.toString(),x,y)}static decodeHanziSegment(i,n,a){if(a*13>i.available())throw new Y;const c=new Uint8Array(2*a);let u=0;for(;a>0;){const d=i.readBits(13);let _=d/96<<8&4294967295|d%96;_<959?_+=41377:_+=42657,c[u]=_>>8&255,c[u+1]=_&255,u+=2,a--}try{n.append(je.decode(c,oe.GB2312))}catch(d){throw new Y(d)}}static decodeKanjiSegment(i,n,a){if(a*13>i.available())throw new Y;const c=new Uint8Array(2*a);let u=0;for(;a>0;){const d=i.readBits(13);let _=d/192<<8&4294967295|d%192;_<7936?_+=33088:_+=49472,c[u]=_>>8,c[u+1]=_,u+=2,a--}try{n.append(je.decode(c,oe.SHIFT_JIS))}catch(d){throw new Y(d)}}static decodeByteSegment(i,n,a,c,u,d){if(8*a>i.available())throw new Y;const _=new Uint8Array(a);for(let y=0;y<a;y++)_[y]=i.readBits(8);let x;c===null?x=oe.guessEncoding(_,d):x=c.getName();try{n.append(je.decode(_,x))}catch(y){throw new Y(y)}u.push(_)}static toAlphaNumericChar(i){if(i>=zt.ALPHANUMERIC_CHARS.length)throw new Y;return zt.ALPHANUMERIC_CHARS[i]}static decodeAlphanumericSegment(i,n,a,c){const u=n.length();for(;a>1;){if(i.available()<11)throw new Y;const d=i.readBits(11);n.append(zt.toAlphaNumericChar(Math.floor(d/45))),n.append(zt.toAlphaNumericChar(d%45)),a-=2}if(a===1){if(i.available()<6)throw new Y;n.append(zt.toAlphaNumericChar(i.readBits(6)))}if(c)for(let d=u;d<n.length();d++)n.charAt(d)==="%"&&(d<n.length()-1&&n.charAt(d+1)==="%"?n.deleteCharAt(d+1):n.setCharAt(d,""))}static decodeNumericSegment(i,n,a){for(;a>=3;){if(i.available()<10)throw new Y;const c=i.readBits(10);if(c>=1e3)throw new Y;n.append(zt.toAlphaNumericChar(Math.floor(c/100))),n.append(zt.toAlphaNumericChar(Math.floor(c/10)%10)),n.append(zt.toAlphaNumericChar(c%10)),a-=3}if(a===2){if(i.available()<7)throw new Y;const c=i.readBits(7);if(c>=100)throw new Y;n.append(zt.toAlphaNumericChar(Math.floor(c/10))),n.append(zt.toAlphaNumericChar(c%10))}else if(a===1){if(i.available()<4)throw new Y;const c=i.readBits(4);if(c>=10)throw new Y;n.append(zt.toAlphaNumericChar(c))}}static parseECIValue(i){const n=i.readBits(8);if((n&128)===0)return n&127;if((n&192)===128){const a=i.readBits(8);return(n&63)<<8&4294967295|a}if((n&224)===192){const a=i.readBits(16);return(n&31)<<16&4294967295|a}throw new Y}}zt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",zt.GB2312_SUBSET=1;class jo{constructor(i){this.mirrored=i}isMirrored(){return this.mirrored}applyMirroredCorrection(i){if(!this.mirrored||i===null||i.length<3)return;const n=i[0];i[0]=i[2],i[2]=n}}class zh{constructor(){this.rsDecoder=new Br(ze.QR_CODE_FIELD_256)}decodeBooleanArray(i,n){return this.decodeBitMatrix(Ee.parseFromBooleanArray(i),n)}decodeBitMatrix(i,n){const a=new _n(i);let c=null;try{return this.decodeBitMatrixParser(a,n)}catch(u){c=u}try{a.remask(),a.setMirror(!0),a.readVersion(),a.readFormatInformation(),a.mirror();const u=this.decodeBitMatrixParser(a,n);return u.setOther(new jo(!0)),u}catch(u){throw c!==null?c:u}}decodeBitMatrixParser(i,n){const a=i.readVersion(),c=i.readFormatInformation().getErrorCorrectionLevel(),u=i.readCodewords(),d=Ol.getDataBlocks(u,a,c);let _=0;for(const E of d)_+=E.getNumDataCodewords();const x=new Uint8Array(_);let y=0;for(const E of d){const R=E.getCodewords(),D=E.getNumDataCodewords();this.correctErrors(R,D);for(let I=0;I<D;I++)x[y++]=R[I]}return zt.decode(x,a,c,n)}correctErrors(i,n){const a=new Int32Array(i);try{this.rsDecoder.decode(a,i.length-n)}catch{throw new P}for(let c=0;c<n;c++)i[c]=a[c]}}class mn extends Pe{constructor(i,n,a){super(i,n),this.estimatedModuleSize=a}aboutEquals(i,n,a){if(Math.abs(n-this.getY())<=i&&Math.abs(a-this.getX())<=i){const c=Math.abs(i-this.estimatedModuleSize);return c<=1||c<=this.estimatedModuleSize}return!1}combineEstimate(i,n,a){const c=(this.getX()+n)/2,u=(this.getY()+i)/2,d=(this.estimatedModuleSize+a)/2;return new mn(c,u,d)}}class _s{constructor(i,n,a,c,u,d,_){this.image=i,this.startX=n,this.startY=a,this.width=c,this.height=u,this.moduleSize=d,this.resultPointCallback=_,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const i=this.startX,n=this.height,a=this.width,c=i+a,u=this.startY+n/2,d=new Int32Array(3),_=this.image;for(let x=0;x<n;x++){const y=u+((x&1)===0?Math.floor((x+1)/2):-Math.floor((x+1)/2));d[0]=0,d[1]=0,d[2]=0;let E=i;for(;E<c&&!_.get(E,y);)E++;let R=0;for(;E<c;){if(_.get(E,y))if(R===1)d[1]++;else if(R===2){if(this.foundPatternCross(d)){const D=this.handlePossibleCenter(d,y,E);if(D!==null)return D}d[0]=d[2],d[1]=1,d[2]=0,R=1}else d[++R]++;else R===1&&R++,d[R]++;E++}if(this.foundPatternCross(d)){const D=this.handlePossibleCenter(d,y,c);if(D!==null)return D}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new U}static centerFromEnd(i,n){return n-i[2]-i[1]/2}foundPatternCross(i){const n=this.moduleSize,a=n/2;for(let c=0;c<3;c++)if(Math.abs(n-i[c])>=a)return!1;return!0}crossCheckVertical(i,n,a,c){const u=this.image,d=u.getHeight(),_=this.crossCheckStateCount;_[0]=0,_[1]=0,_[2]=0;let x=i;for(;x>=0&&u.get(n,x)&&_[1]<=a;)_[1]++,x--;if(x<0||_[1]>a)return NaN;for(;x>=0&&!u.get(n,x)&&_[0]<=a;)_[0]++,x--;if(_[0]>a)return NaN;for(x=i+1;x<d&&u.get(n,x)&&_[1]<=a;)_[1]++,x++;if(x===d||_[1]>a)return NaN;for(;x<d&&!u.get(n,x)&&_[2]<=a;)_[2]++,x++;if(_[2]>a)return NaN;const y=_[0]+_[1]+_[2];return 5*Math.abs(y-c)>=2*c?NaN:this.foundPatternCross(_)?_s.centerFromEnd(_,x):NaN}handlePossibleCenter(i,n,a){const c=i[0]+i[1]+i[2],u=_s.centerFromEnd(i,a),d=this.crossCheckVertical(n,u,2*i[1],c);if(!isNaN(d)){const _=(i[0]+i[1]+i[2])/3;for(const y of this.possibleCenters)if(y.aboutEquals(_,d,u))return y.combineEstimate(d,u,_);const x=new mn(u,d,_);this.possibleCenters.push(x),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(x)}return null}}class ra extends Pe{constructor(i,n,a,c){super(i,n),this.estimatedModuleSize=a,this.count=c,c===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(i,n,a){if(Math.abs(n-this.getY())<=i&&Math.abs(a-this.getX())<=i){const c=Math.abs(i-this.estimatedModuleSize);return c<=1||c<=this.estimatedModuleSize}return!1}combineEstimate(i,n,a){const c=this.count+1,u=(this.count*this.getX()+n)/c,d=(this.count*this.getY()+i)/c,_=(this.count*this.estimatedModuleSize+a)/c;return new ra(u,d,_,c)}}class Ml{constructor(i){this.bottomLeft=i[0],this.topLeft=i[1],this.topRight=i[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class jt{constructor(i,n){this.image=i,this.resultPointCallback=n,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=n}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(i){const n=i!=null&&i.get(Re.TRY_HARDER)!==void 0,a=i!=null&&i.get(Re.PURE_BARCODE)!==void 0,c=this.image,u=c.getHeight(),d=c.getWidth();let _=Math.floor(3*u/(4*jt.MAX_MODULES));(_<jt.MIN_SKIP||n)&&(_=jt.MIN_SKIP);let x=!1;const y=new Int32Array(5);for(let R=_-1;R<u&&!x;R+=_){y[0]=0,y[1]=0,y[2]=0,y[3]=0,y[4]=0;let D=0;for(let I=0;I<d;I++)if(c.get(I,R))(D&1)===1&&D++,y[D]++;else if((D&1)===0)if(D===4)if(jt.foundPatternCross(y)){if(this.handlePossibleCenter(y,R,I,a)===!0)if(_=2,this.hasSkipped===!0)x=this.haveMultiplyConfirmedCenters();else{const V=this.findRowSkip();V>y[2]&&(R+=V-y[2]-_,I=d-1)}else{y[0]=y[2],y[1]=y[3],y[2]=y[4],y[3]=1,y[4]=0,D=3;continue}D=0,y[0]=0,y[1]=0,y[2]=0,y[3]=0,y[4]=0}else y[0]=y[2],y[1]=y[3],y[2]=y[4],y[3]=1,y[4]=0,D=3;else y[++D]++;else y[D]++;jt.foundPatternCross(y)&&this.handlePossibleCenter(y,R,d,a)===!0&&(_=y[0],this.hasSkipped&&(x=this.haveMultiplyConfirmedCenters()))}const E=this.selectBestPatterns();return Pe.orderBestPatterns(E),new Ml(E)}static centerFromEnd(i,n){return n-i[4]-i[3]-i[2]/2}static foundPatternCross(i){let n=0;for(let u=0;u<5;u++){const d=i[u];if(d===0)return!1;n+=d}if(n<7)return!1;const a=n/7,c=a/2;return Math.abs(a-i[0])<c&&Math.abs(a-i[1])<c&&Math.abs(3*a-i[2])<3*c&&Math.abs(a-i[3])<c&&Math.abs(a-i[4])<c}getCrossCheckStateCount(){const i=this.crossCheckStateCount;return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i}crossCheckDiagonal(i,n,a,c){const u=this.getCrossCheckStateCount();let d=0;const _=this.image;for(;i>=d&&n>=d&&_.get(n-d,i-d);)u[2]++,d++;if(i<d||n<d)return!1;for(;i>=d&&n>=d&&!_.get(n-d,i-d)&&u[1]<=a;)u[1]++,d++;if(i<d||n<d||u[1]>a)return!1;for(;i>=d&&n>=d&&_.get(n-d,i-d)&&u[0]<=a;)u[0]++,d++;if(u[0]>a)return!1;const x=_.getHeight(),y=_.getWidth();for(d=1;i+d<x&&n+d<y&&_.get(n+d,i+d);)u[2]++,d++;if(i+d>=x||n+d>=y)return!1;for(;i+d<x&&n+d<y&&!_.get(n+d,i+d)&&u[3]<a;)u[3]++,d++;if(i+d>=x||n+d>=y||u[3]>=a)return!1;for(;i+d<x&&n+d<y&&_.get(n+d,i+d)&&u[4]<a;)u[4]++,d++;if(u[4]>=a)return!1;const E=u[0]+u[1]+u[2]+u[3]+u[4];return Math.abs(E-c)<2*c&&jt.foundPatternCross(u)}crossCheckVertical(i,n,a,c){const u=this.image,d=u.getHeight(),_=this.getCrossCheckStateCount();let x=i;for(;x>=0&&u.get(n,x);)_[2]++,x--;if(x<0)return NaN;for(;x>=0&&!u.get(n,x)&&_[1]<=a;)_[1]++,x--;if(x<0||_[1]>a)return NaN;for(;x>=0&&u.get(n,x)&&_[0]<=a;)_[0]++,x--;if(_[0]>a)return NaN;for(x=i+1;x<d&&u.get(n,x);)_[2]++,x++;if(x===d)return NaN;for(;x<d&&!u.get(n,x)&&_[3]<a;)_[3]++,x++;if(x===d||_[3]>=a)return NaN;for(;x<d&&u.get(n,x)&&_[4]<a;)_[4]++,x++;if(_[4]>=a)return NaN;const y=_[0]+_[1]+_[2]+_[3]+_[4];return 5*Math.abs(y-c)>=2*c?NaN:jt.foundPatternCross(_)?jt.centerFromEnd(_,x):NaN}crossCheckHorizontal(i,n,a,c){const u=this.image,d=u.getWidth(),_=this.getCrossCheckStateCount();let x=i;for(;x>=0&&u.get(x,n);)_[2]++,x--;if(x<0)return NaN;for(;x>=0&&!u.get(x,n)&&_[1]<=a;)_[1]++,x--;if(x<0||_[1]>a)return NaN;for(;x>=0&&u.get(x,n)&&_[0]<=a;)_[0]++,x--;if(_[0]>a)return NaN;for(x=i+1;x<d&&u.get(x,n);)_[2]++,x++;if(x===d)return NaN;for(;x<d&&!u.get(x,n)&&_[3]<a;)_[3]++,x++;if(x===d||_[3]>=a)return NaN;for(;x<d&&u.get(x,n)&&_[4]<a;)_[4]++,x++;if(_[4]>=a)return NaN;const y=_[0]+_[1]+_[2]+_[3]+_[4];return 5*Math.abs(y-c)>=c?NaN:jt.foundPatternCross(_)?jt.centerFromEnd(_,x):NaN}handlePossibleCenter(i,n,a,c){const u=i[0]+i[1]+i[2]+i[3]+i[4];let d=jt.centerFromEnd(i,a),_=this.crossCheckVertical(n,Math.floor(d),i[2],u);if(!isNaN(_)&&(d=this.crossCheckHorizontal(Math.floor(d),Math.floor(_),i[2],u),!isNaN(d)&&(!c||this.crossCheckDiagonal(Math.floor(_),Math.floor(d),i[2],u)))){const x=u/7;let y=!1;const E=this.possibleCenters;for(let R=0,D=E.length;R<D;R++){const I=E[R];if(I.aboutEquals(x,_,d)){E[R]=I.combineEstimate(_,d,x),y=!0;break}}if(!y){const R=new ra(d,_,x);E.push(R),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(R)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let n=null;for(const a of this.possibleCenters)if(a.getCount()>=jt.CENTER_QUORUM)if(n==null)n=a;else return this.hasSkipped=!0,Math.floor((Math.abs(n.getX()-a.getX())-Math.abs(n.getY()-a.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let i=0,n=0;const a=this.possibleCenters.length;for(const d of this.possibleCenters)d.getCount()>=jt.CENTER_QUORUM&&(i++,n+=d.getEstimatedModuleSize());if(i<3)return!1;const c=n/a;let u=0;for(const d of this.possibleCenters)u+=Math.abs(d.getEstimatedModuleSize()-c);return u<=.05*n}selectBestPatterns(){const i=this.possibleCenters.length;if(i<3)throw new U;const n=this.possibleCenters;let a;if(i>3){let c=0,u=0;for(const x of this.possibleCenters){const y=x.getEstimatedModuleSize();c+=y,u+=y*y}a=c/i;let d=Math.sqrt(u/i-a*a);n.sort((x,y)=>{const E=Math.abs(y.getEstimatedModuleSize()-a),R=Math.abs(x.getEstimatedModuleSize()-a);return E<R?-1:E>R?1:0});const _=Math.max(.2*a,d);for(let x=0;x<n.length&&n.length>3;x++){const y=n[x];Math.abs(y.getEstimatedModuleSize()-a)>_&&(n.splice(x,1),x--)}}if(n.length>3){let c=0;for(const u of n)c+=u.getEstimatedModuleSize();a=c/n.length,n.sort((u,d)=>{if(d.getCount()===u.getCount()){const _=Math.abs(d.getEstimatedModuleSize()-a),x=Math.abs(u.getEstimatedModuleSize()-a);return _<x?1:_>x?-1:0}else return d.getCount()-u.getCount()}),n.splice(3)}return[n[0],n[1],n[2]]}}jt.CENTER_QUORUM=2,jt.MIN_SKIP=3,jt.MAX_MODULES=57;class Gs{constructor(i){this.image=i}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(i){this.resultPointCallback=i==null?null:i.get(Re.NEED_RESULT_POINT_CALLBACK);const a=new jt(this.image,this.resultPointCallback).find(i);return this.processFinderPatternInfo(a)}processFinderPatternInfo(i){const n=i.getTopLeft(),a=i.getTopRight(),c=i.getBottomLeft(),u=this.calculateModuleSize(n,a,c);if(u<1)throw new U("No pattern found in proccess finder.");const d=Gs.computeDimension(n,a,c,u),_=Fe.getProvisionalVersionForDimension(d),x=_.getDimensionForVersion()-7;let y=null;if(_.getAlignmentPatternCenters().length>0){const I=a.getX()-n.getX()+c.getX(),F=a.getY()-n.getY()+c.getY(),V=1-3/x,q=Math.floor(n.getX()+V*(I-n.getX())),ie=Math.floor(n.getY()+V*(F-n.getY()));for(let Ce=4;Ce<=16;Ce<<=1)try{y=this.findAlignmentInRegion(u,q,ie,Ce);break}catch(we){if(!(we instanceof U))throw we}}const E=Gs.createTransform(n,a,c,y,d),R=Gs.sampleGrid(this.image,E,d);let D;return y===null?D=[c,n,a]:D=[c,n,a,y],new Ia(R,D)}static createTransform(i,n,a,c,u){const d=u-3.5;let _,x,y,E;return c!==null?(_=c.getX(),x=c.getY(),y=d-3,E=y):(_=n.getX()-i.getX()+a.getX(),x=n.getY()-i.getY()+a.getY(),y=d,E=d),ds.quadrilateralToQuadrilateral(3.5,3.5,d,3.5,y,E,3.5,d,i.getX(),i.getY(),n.getX(),n.getY(),_,x,a.getX(),a.getY())}static sampleGrid(i,n,a){return Cs.getInstance().sampleGridWithTransform(i,a,a,n)}static computeDimension(i,n,a,c){const u=ct.round(Pe.distance(i,n)/c),d=ct.round(Pe.distance(i,a)/c);let _=Math.floor((u+d)/2)+7;switch(_&3){case 0:_++;break;case 2:_--;break;case 3:throw new U("Dimensions could be not found.")}return _}calculateModuleSize(i,n,a){return(this.calculateModuleSizeOneWay(i,n)+this.calculateModuleSizeOneWay(i,a))/2}calculateModuleSizeOneWay(i,n){const a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(i.getX()),Math.floor(i.getY()),Math.floor(n.getX()),Math.floor(n.getY())),c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(n.getX()),Math.floor(n.getY()),Math.floor(i.getX()),Math.floor(i.getY()));return isNaN(a)?c/7:isNaN(c)?a/7:(a+c)/14}sizeOfBlackWhiteBlackRunBothWays(i,n,a,c){let u=this.sizeOfBlackWhiteBlackRun(i,n,a,c),d=1,_=i-(a-i);_<0?(d=i/(i-_),_=0):_>=this.image.getWidth()&&(d=(this.image.getWidth()-1-i)/(_-i),_=this.image.getWidth()-1);let x=Math.floor(n-(c-n)*d);return d=1,x<0?(d=n/(n-x),x=0):x>=this.image.getHeight()&&(d=(this.image.getHeight()-1-n)/(x-n),x=this.image.getHeight()-1),_=Math.floor(i+(_-i)*d),u+=this.sizeOfBlackWhiteBlackRun(i,n,_,x),u-1}sizeOfBlackWhiteBlackRun(i,n,a,c){const u=Math.abs(c-n)>Math.abs(a-i);if(u){let I=i;i=n,n=I,I=a,a=c,c=I}const d=Math.abs(a-i),_=Math.abs(c-n);let x=-d/2;const y=i<a?1:-1,E=n<c?1:-1;let R=0;const D=a+y;for(let I=i,F=n;I!==D;I+=y){const V=u?F:I,q=u?I:F;if(R===1===this.image.get(V,q)){if(R===2)return ct.distance(I,F,i,n);R++}if(x+=_,x>0){if(F===c)break;F+=E,x-=d}}return R===2?ct.distance(a+y,c,i,n):NaN}findAlignmentInRegion(i,n,a,c){const u=Math.floor(c*i),d=Math.max(0,n-u),_=Math.min(this.image.getWidth()-1,n+u);if(_-d<i*3)throw new U("Alignment top exceeds estimated module size.");const x=Math.max(0,a-u),y=Math.min(this.image.getHeight()-1,a+u);if(y-x<i*3)throw new U("Alignment bottom exceeds estimated module size.");return new _s(this.image,d,x,_-d,y-x,i,this.resultPointCallback).find()}}class or{constructor(){this.decoder=new zh}getDecoder(){return this.decoder}decode(i,n){let a,c;if(n!=null&&n.get(Re.PURE_BARCODE)!==void 0){const x=or.extractPureBits(i.getBlackMatrix());a=this.decoder.decodeBitMatrix(x,n),c=or.NO_POINTS}else{const x=new Gs(i.getBlackMatrix()).detect(n);a=this.decoder.decodeBitMatrix(x.getBits(),n),c=x.getPoints()}a.getOther()instanceof jo&&a.getOther().applyMirroredCorrection(c);const u=new be(a.getText(),a.getRawBytes(),void 0,c,Se.QR_CODE,void 0),d=a.getByteSegments();d!==null&&u.putMetadata(ot.BYTE_SEGMENTS,d);const _=a.getECLevel();return _!==null&&u.putMetadata(ot.ERROR_CORRECTION_LEVEL,_),a.hasStructuredAppend()&&(u.putMetadata(ot.STRUCTURED_APPEND_SEQUENCE,a.getStructuredAppendSequenceNumber()),u.putMetadata(ot.STRUCTURED_APPEND_PARITY,a.getStructuredAppendParity())),u}reset(){}static extractPureBits(i){const n=i.getTopLeftOnBit(),a=i.getBottomRightOnBit();if(n===null||a===null)throw new U;const c=this.moduleSize(n,i);let u=n[1],d=a[1],_=n[0],x=a[0];if(_>=x||u>=d)throw new U;if(d-u!==x-_&&(x=_+(d-u),x>=i.getWidth()))throw new U;const y=Math.round((x-_+1)/c),E=Math.round((d-u+1)/c);if(y<=0||E<=0)throw new U;if(E!==y)throw new U;const R=Math.floor(c/2);u+=R,_+=R;const D=_+Math.floor((y-1)*c)-x;if(D>0){if(D>R)throw new U;_-=D}const I=u+Math.floor((E-1)*c)-d;if(I>0){if(I>R)throw new U;u-=I}const F=new Ee(y,E);for(let V=0;V<E;V++){const q=u+Math.floor(V*c);for(let ie=0;ie<y;ie++)i.get(_+Math.floor(ie*c),q)&&F.set(ie,V)}return F}static moduleSize(i,n){const a=n.getHeight(),c=n.getWidth();let u=i[0],d=i[1],_=!0,x=0;for(;u<c&&d<a;){if(_!==n.get(u,d)){if(++x===5)break;_=!_}u++,d++}if(u===c||d===a)throw new U;return(u-i[0])/7}}or.NO_POINTS=new Array;class Xe{PDF417Common(){}static getBitCountSum(i){return ct.sum(i)}static toIntArray(i){if(i==null||!i.length)return Xe.EMPTY_INT_ARRAY;const n=new Int32Array(i.length);let a=0;for(const c of i)n[a++]=c;return n}static getCodeword(i){const n=he.binarySearch(Xe.SYMBOL_TABLE,i&262143);return n<0?-1:(Xe.CODEWORD_TABLE[n]-1)%Xe.NUMBER_OF_CODEWORDS}}Xe.NUMBER_OF_CODEWORDS=929,Xe.MAX_CODEWORDS_IN_BARCODE=Xe.NUMBER_OF_CODEWORDS-1,Xe.MIN_ROWS_IN_BARCODE=3,Xe.MAX_ROWS_IN_BARCODE=90,Xe.MODULES_IN_CODEWORD=17,Xe.MODULES_IN_STOP_PATTERN=18,Xe.BARS_IN_MODULE=8,Xe.EMPTY_INT_ARRAY=new Int32Array([]),Xe.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Xe.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class qo{constructor(i,n){this.bits=i,this.points=n}getBits(){return this.bits}getPoints(){return this.points}}class Ze{static detectMultiple(i,n,a){let c=i.getBlackMatrix(),u=Ze.detect(a,c);return u.length||(c=c.clone(),c.rotate180(),u=Ze.detect(a,c)),new qo(c,u)}static detect(i,n){const a=new Array;let c=0,u=0,d=!1;for(;c<n.getHeight();){const _=Ze.findVertices(n,c,u);if(_[0]==null&&_[3]==null){if(!d)break;d=!1,u=0;for(const x of a)x[1]!=null&&(c=Math.trunc(Math.max(c,x[1].getY()))),x[3]!=null&&(c=Math.max(c,Math.trunc(x[3].getY())));c+=Ze.ROW_STEP;continue}if(d=!0,a.push(_),!i)break;_[2]!=null?(u=Math.trunc(_[2].getX()),c=Math.trunc(_[2].getY())):(u=Math.trunc(_[4].getX()),c=Math.trunc(_[4].getY()))}return a}static findVertices(i,n,a){const c=i.getHeight(),u=i.getWidth(),d=new Array(8);return Ze.copyToResult(d,Ze.findRowsWithPattern(i,c,u,n,a,Ze.START_PATTERN),Ze.INDEXES_START_PATTERN),d[4]!=null&&(a=Math.trunc(d[4].getX()),n=Math.trunc(d[4].getY())),Ze.copyToResult(d,Ze.findRowsWithPattern(i,c,u,n,a,Ze.STOP_PATTERN),Ze.INDEXES_STOP_PATTERN),d}static copyToResult(i,n,a){for(let c=0;c<a.length;c++)i[a[c]]=n[c]}static findRowsWithPattern(i,n,a,c,u,d){const _=new Array(4);let x=!1;const y=new Int32Array(d.length);for(;c<n;c+=Ze.ROW_STEP){let R=Ze.findGuardPattern(i,u,c,a,!1,d,y);if(R!=null){for(;c>0;){const D=Ze.findGuardPattern(i,u,--c,a,!1,d,y);if(D!=null)R=D;else{c++;break}}_[0]=new Pe(R[0],c),_[1]=new Pe(R[1],c),x=!0;break}}let E=c+1;if(x){let R=0,D=Int32Array.from([Math.trunc(_[0].getX()),Math.trunc(_[1].getX())]);for(;E<n;E++){const I=Ze.findGuardPattern(i,D[0],E,a,!1,d,y);if(I!=null&&Math.abs(D[0]-I[0])<Ze.MAX_PATTERN_DRIFT&&Math.abs(D[1]-I[1])<Ze.MAX_PATTERN_DRIFT)D=I,R=0;else{if(R>Ze.SKIPPED_ROW_COUNT_MAX)break;R++}}E-=R+1,_[2]=new Pe(D[0],E),_[3]=new Pe(D[1],E)}return E-c<Ze.BARCODE_MIN_HEIGHT&&he.fill(_,null),_}static findGuardPattern(i,n,a,c,u,d,_){he.fillWithin(_,0,_.length,0);let x=n,y=0;for(;i.get(x,a)&&x>0&&y++<Ze.MAX_PIXEL_DRIFT;)x--;let E=x,R=0,D=d.length;for(let I=u;E<c;E++)if(i.get(E,a)!==I)_[R]++;else{if(R===D-1){if(Ze.patternMatchVariance(_,d,Ze.MAX_INDIVIDUAL_VARIANCE)<Ze.MAX_AVG_VARIANCE)return new Int32Array([x,E]);x+=_[0]+_[1],X.arraycopy(_,2,_,0,R-1),_[R-1]=0,_[R]=0,R--}else R++;_[R]=1,I=!I}return R===D-1&&Ze.patternMatchVariance(_,d,Ze.MAX_INDIVIDUAL_VARIANCE)<Ze.MAX_AVG_VARIANCE?new Int32Array([x,E-1]):null}static patternMatchVariance(i,n,a){let c=i.length,u=0,d=0;for(let y=0;y<c;y++)u+=i[y],d+=n[y];if(u<d)return 1/0;let _=u/d;a*=_;let x=0;for(let y=0;y<c;y++){let E=i[y],R=n[y]*_,D=E>R?E-R:R-E;if(D>a)return 1/0;x+=D}return x/u}}Ze.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ze.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ze.MAX_AVG_VARIANCE=.42,Ze.MAX_INDIVIDUAL_VARIANCE=.8,Ze.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ze.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ze.MAX_PIXEL_DRIFT=3,Ze.MAX_PATTERN_DRIFT=5,Ze.SKIPPED_ROW_COUNT_MAX=25,Ze.ROW_STEP=5,Ze.BARCODE_MIN_HEIGHT=10;class Ft{constructor(i,n){if(n.length===0)throw new N;this.field=i;let a=n.length;if(a>1&&n[0]===0){let c=1;for(;c<a&&n[c]===0;)c++;c===a?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(a-c),X.arraycopy(n,c,this.coefficients,0,this.coefficients.length))}else this.coefficients=n}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(i){return this.coefficients[this.coefficients.length-1-i]}evaluateAt(i){if(i===0)return this.getCoefficient(0);if(i===1){let c=0;for(let u of this.coefficients)c=this.field.add(c,u);return c}let n=this.coefficients[0],a=this.coefficients.length;for(let c=1;c<a;c++)n=this.field.add(this.field.multiply(i,n),this.coefficients[c]);return n}add(i){if(!this.field.equals(i.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero())return i;if(i.isZero())return this;let n=this.coefficients,a=i.coefficients;if(n.length>a.length){let d=n;n=a,a=d}let c=new Int32Array(a.length),u=a.length-n.length;X.arraycopy(a,0,c,0,u);for(let d=u;d<a.length;d++)c[d]=this.field.add(n[d-u],a[d]);return new Ft(this.field,c)}subtract(i){if(!this.field.equals(i.field))throw new N("ModulusPolys do not have same ModulusGF field");return i.isZero()?this:this.add(i.negative())}multiply(i){return i instanceof Ft?this.multiplyOther(i):this.multiplyScalar(i)}multiplyOther(i){if(!this.field.equals(i.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero()||i.isZero())return new Ft(this.field,new Int32Array([0]));let n=this.coefficients,a=n.length,c=i.coefficients,u=c.length,d=new Int32Array(a+u-1);for(let _=0;_<a;_++){let x=n[_];for(let y=0;y<u;y++)d[_+y]=this.field.add(d[_+y],this.field.multiply(x,c[y]))}return new Ft(this.field,d)}negative(){let i=this.coefficients.length,n=new Int32Array(i);for(let a=0;a<i;a++)n[a]=this.field.subtract(0,this.coefficients[a]);return new Ft(this.field,n)}multiplyScalar(i){if(i===0)return new Ft(this.field,new Int32Array([0]));if(i===1)return this;let n=this.coefficients.length,a=new Int32Array(n);for(let c=0;c<n;c++)a[c]=this.field.multiply(this.coefficients[c],i);return new Ft(this.field,a)}multiplyByMonomial(i,n){if(i<0)throw new N;if(n===0)return new Ft(this.field,new Int32Array([0]));let a=this.coefficients.length,c=new Int32Array(a+i);for(let u=0;u<a;u++)c[u]=this.field.multiply(this.coefficients[u],n);return new Ft(this.field,c)}toString(){let i=new ae;for(let n=this.getDegree();n>=0;n--){let a=this.getCoefficient(n);a!==0&&(a<0?(i.append(" - "),a=-a):i.length()>0&&i.append(" + "),(n===0||a!==1)&&i.append(a),n!==0&&(n===1?i.append("x"):(i.append("x^"),i.append(n))))}return i.toString()}}class Bl{add(i,n){return(i+n)%this.modulus}subtract(i,n){return(this.modulus+i-n)%this.modulus}exp(i){return this.expTable[i]}log(i){if(i===0)throw new N;return this.logTable[i]}inverse(i){if(i===0)throw new Gi;return this.expTable[this.modulus-this.logTable[i]-1]}multiply(i,n){return i===0||n===0?0:this.expTable[(this.logTable[i]+this.logTable[n])%(this.modulus-1)]}getSize(){return this.modulus}equals(i){return i===this}}class Ir extends Bl{constructor(i,n){super(),this.modulus=i,this.expTable=new Int32Array(i),this.logTable=new Int32Array(i);let a=1;for(let c=0;c<i;c++)this.expTable[c]=a,a=a*n%i;for(let c=0;c<i-1;c++)this.logTable[this.expTable[c]]=c;this.zero=new Ft(this,new Int32Array([0])),this.one=new Ft(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(i,n){if(i<0)throw new N;if(n===0)return this.zero;let a=new Int32Array(i+1);return a[0]=n,new Ft(this,a)}}Ir.PDF417_GF=new Ir(Xe.NUMBER_OF_CODEWORDS,3);class cr{constructor(){this.field=Ir.PDF417_GF}decode(i,n,a){let c=new Ft(this.field,i),u=new Int32Array(n),d=!1;for(let F=n;F>0;F--){let V=c.evaluateAt(this.field.exp(F));u[n-F]=V,V!==0&&(d=!0)}if(!d)return 0;let _=this.field.getOne();if(a!=null)for(const F of a){let V=this.field.exp(i.length-1-F),q=new Ft(this.field,new Int32Array([this.field.subtract(0,V),1]));_=_.multiply(q)}let x=new Ft(this.field,u),y=this.runEuclideanAlgorithm(this.field.buildMonomial(n,1),x,n),E=y[0],R=y[1],D=this.findErrorLocations(E),I=this.findErrorMagnitudes(R,E,D);for(let F=0;F<D.length;F++){let V=i.length-1-this.field.log(D[F]);if(V<0)throw P.getChecksumInstance();i[V]=this.field.subtract(i[V],I[F])}return D.length}runEuclideanAlgorithm(i,n,a){if(i.getDegree()<n.getDegree()){let D=i;i=n,n=D}let c=i,u=n,d=this.field.getZero(),_=this.field.getOne();for(;u.getDegree()>=Math.round(a/2);){let D=c,I=d;if(c=u,d=_,c.isZero())throw P.getChecksumInstance();u=D;let F=this.field.getZero(),V=c.getCoefficient(c.getDegree()),q=this.field.inverse(V);for(;u.getDegree()>=c.getDegree()&&!u.isZero();){let ie=u.getDegree()-c.getDegree(),Ce=this.field.multiply(u.getCoefficient(u.getDegree()),q);F=F.add(this.field.buildMonomial(ie,Ce)),u=u.subtract(c.multiplyByMonomial(ie,Ce))}_=F.multiply(d).subtract(I).negative()}let x=_.getCoefficient(0);if(x===0)throw P.getChecksumInstance();let y=this.field.inverse(x),E=_.multiply(y),R=u.multiply(y);return[E,R]}findErrorLocations(i){let n=i.getDegree(),a=new Int32Array(n),c=0;for(let u=1;u<this.field.getSize()&&c<n;u++)i.evaluateAt(u)===0&&(a[c]=this.field.inverse(u),c++);if(c!==n)throw P.getChecksumInstance();return a}findErrorMagnitudes(i,n,a){let c=n.getDegree(),u=new Int32Array(c);for(let y=1;y<=c;y++)u[c-y]=this.field.multiply(y,n.getCoefficient(y));let d=new Ft(this.field,u),_=a.length,x=new Int32Array(_);for(let y=0;y<_;y++){let E=this.field.inverse(a[y]),R=this.field.subtract(0,i.evaluateAt(E)),D=this.field.inverse(d.evaluateAt(E));x[y]=this.field.multiply(R,D)}return x}}class hr{constructor(i,n,a,c,u){i instanceof hr?this.constructor_2(i):this.constructor_1(i,n,a,c,u)}constructor_1(i,n,a,c,u){const d=n==null||a==null,_=c==null||u==null;if(d&&_)throw new U;d?(n=new Pe(0,c.getY()),a=new Pe(0,u.getY())):_&&(c=new Pe(i.getWidth()-1,n.getY()),u=new Pe(i.getWidth()-1,a.getY())),this.image=i,this.topLeft=n,this.bottomLeft=a,this.topRight=c,this.bottomRight=u,this.minX=Math.trunc(Math.min(n.getX(),a.getX())),this.maxX=Math.trunc(Math.max(c.getX(),u.getX())),this.minY=Math.trunc(Math.min(n.getY(),c.getY())),this.maxY=Math.trunc(Math.max(a.getY(),u.getY()))}constructor_2(i){this.image=i.image,this.topLeft=i.getTopLeft(),this.bottomLeft=i.getBottomLeft(),this.topRight=i.getTopRight(),this.bottomRight=i.getBottomRight(),this.minX=i.getMinX(),this.maxX=i.getMaxX(),this.minY=i.getMinY(),this.maxY=i.getMaxY()}static merge(i,n){return i==null?n:n==null?i:new hr(i.image,i.topLeft,i.bottomLeft,n.topRight,n.bottomRight)}addMissingRows(i,n,a){let c=this.topLeft,u=this.bottomLeft,d=this.topRight,_=this.bottomRight;if(i>0){let x=a?this.topLeft:this.topRight,y=Math.trunc(x.getY()-i);y<0&&(y=0);let E=new Pe(x.getX(),y);a?c=E:d=E}if(n>0){let x=a?this.bottomLeft:this.bottomRight,y=Math.trunc(x.getY()+n);y>=this.image.getHeight()&&(y=this.image.getHeight()-1);let E=new Pe(x.getX(),y);a?u=E:_=E}return new hr(this.image,c,u,d,_)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class za{constructor(i,n,a,c){this.columnCount=i,this.errorCorrectionLevel=c,this.rowCountUpperPart=n,this.rowCountLowerPart=a,this.rowCount=n+a}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class pn{constructor(){this.buffer=""}static form(i,n){let a=-1;function c(d,_,x,y,E,R){if(d==="%%")return"%";if(n[++a]===void 0)return;d=y?parseInt(y.substr(1)):void 0;let D=E?parseInt(E.substr(1)):void 0,I;switch(R){case"s":I=n[a];break;case"c":I=n[a][0];break;case"f":I=parseFloat(n[a]).toFixed(d);break;case"p":I=parseFloat(n[a]).toPrecision(d);break;case"e":I=parseFloat(n[a]).toExponential(d);break;case"x":I=parseInt(n[a]).toString(D||16);break;case"d":I=parseFloat(parseInt(n[a],D||10).toPrecision(d)).toFixed(0);break}I=typeof I=="object"?JSON.stringify(I):(+I).toString(D);let F=parseInt(x),V=x&&x[0]+""=="0"?"0":" ";for(;I.length<F;)I=_!==void 0?I+V:V+I;return I}let u=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return i.replace(u,c)}format(i,...n){this.buffer+=pn.form(i,n)}toString(){return this.buffer}}class xr{constructor(i){this.boundingBox=new hr(i),this.codewords=new Array(i.getMaxY()-i.getMinY()+1)}getCodewordNearby(i){let n=this.getCodeword(i);if(n!=null)return n;for(let a=1;a<xr.MAX_NEARBY_DISTANCE;a++){let c=this.imageRowToCodewordIndex(i)-a;if(c>=0&&(n=this.codewords[c],n!=null)||(c=this.imageRowToCodewordIndex(i)+a,c<this.codewords.length&&(n=this.codewords[c],n!=null)))return n}return null}imageRowToCodewordIndex(i){return i-this.boundingBox.getMinY()}setCodeword(i,n){this.codewords[this.imageRowToCodewordIndex(i)]=n}getCodeword(i){return this.codewords[this.imageRowToCodewordIndex(i)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const i=new pn;let n=0;for(const a of this.codewords){if(a==null){i.format("%3d:    |   %n",n++);continue}i.format("%3d: %3d|%3d%n",n++,a.getRowNumber(),a.getValue())}return i.toString()}}xr.MAX_NEARBY_DISTANCE=5;class vr{constructor(){this.values=new Map}setValue(i){i=Math.trunc(i);let n=this.values.get(i);n==null&&(n=0),n++,this.values.set(i,n)}getValue(){let i=-1,n=new Array;for(const[a,c]of this.values.entries()){const u={getKey:()=>a,getValue:()=>c};u.getValue()>i?(i=u.getValue(),n=[],n.push(u.getKey())):u.getValue()===i&&n.push(u.getKey())}return Xe.toIntArray(n)}getConfidence(i){return this.values.get(i)}}class Il extends xr{constructor(i,n){super(i),this._isLeft=n}setRowNumbers(){for(let i of this.getCodewords())i?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(i){let n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,i);let a=this.getBoundingBox(),c=this._isLeft?a.getTopLeft():a.getTopRight(),u=this._isLeft?a.getBottomLeft():a.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),_=this.imageRowToCodewordIndex(Math.trunc(u.getY())),x=-1,y=1,E=0;for(let R=d;R<_;R++){if(n[R]==null)continue;let D=n[R],I=D.getRowNumber()-x;if(I===0)E++;else if(I===1)y=Math.max(y,E),E=1,x=D.getRowNumber();else if(I<0||D.getRowNumber()>=i.getRowCount()||I>R)n[R]=null;else{let F;y>2?F=(y-2)*I:F=I;let V=F>=R;for(let q=1;q<=F&&!V;q++)V=n[R-q]!=null;V?n[R]=null:(x=D.getRowNumber(),E=1)}}}getRowHeights(){let i=this.getBarcodeMetadata();if(i==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(i);let n=new Int32Array(i.getRowCount());for(let a of this.getCodewords())if(a!=null){let c=a.getRowNumber();if(c>=n.length)continue;n[c]++}return n}adjustIncompleteIndicatorColumnRowNumbers(i){let n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),c=this._isLeft?n.getBottomLeft():n.getBottomRight(),u=this.imageRowToCodewordIndex(Math.trunc(a.getY())),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),_=this.getCodewords(),x=-1;for(let y=u;y<d;y++){if(_[y]==null)continue;let E=_[y];E.setRowNumberAsRowIndicatorColumn();let R=E.getRowNumber()-x;R===0||(R===1?x=E.getRowNumber():E.getRowNumber()>=i.getRowCount()?_[y]=null:x=E.getRowNumber())}}getBarcodeMetadata(){let i=this.getCodewords(),n=new vr,a=new vr,c=new vr,u=new vr;for(let _ of i){if(_==null)continue;_.setRowNumberAsRowIndicatorColumn();let x=_.getValue()%30,y=_.getRowNumber();switch(this._isLeft||(y+=2),y%3){case 0:a.setValue(x*3+1);break;case 1:u.setValue(x/3),c.setValue(x%3);break;case 2:n.setValue(x+1);break}}if(n.getValue().length===0||a.getValue().length===0||c.getValue().length===0||u.getValue().length===0||n.getValue()[0]<1||a.getValue()[0]+c.getValue()[0]<Xe.MIN_ROWS_IN_BARCODE||a.getValue()[0]+c.getValue()[0]>Xe.MAX_ROWS_IN_BARCODE)return null;let d=new za(n.getValue()[0],a.getValue()[0],c.getValue()[0],u.getValue()[0]);return this.removeIncorrectCodewords(i,d),d}removeIncorrectCodewords(i,n){for(let a=0;a<i.length;a++){let c=i[a];if(i[a]==null)continue;let u=c.getValue()%30,d=c.getRowNumber();if(d>n.getRowCount()){i[a]=null;continue}switch(this._isLeft||(d+=2),d%3){case 0:u*3+1!==n.getRowCountUpperPart()&&(i[a]=null);break;case 1:(Math.trunc(u/3)!==n.getErrorCorrectionLevel()||u%3!==n.getRowCountLowerPart())&&(i[a]=null);break;case 2:u+1!==n.getColumnCount()&&(i[a]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Si{constructor(i,n){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=i,this.barcodeColumnCount=i.getColumnCount(),this.boundingBox=n,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let i=Xe.MAX_CODEWORDS_IN_BARCODE,n;do n=i,i=this.adjustRowNumbersAndGetCount();while(i>0&&i<n);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(i){i?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let i=this.adjustRowNumbersByRow();if(i===0)return 0;for(let n=1;n<this.barcodeColumnCount+1;n++){let a=this.detectionResultColumns[n].getCodewords();for(let c=0;c<a.length;c++)a[c]!=null&&(a[c].hasValidRowNumber()||this.adjustRowNumbers(n,c,a))}return i}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let i=this.detectionResultColumns[0].getCodewords(),n=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let a=0;a<i.length;a++)if(i[a]!=null&&n[a]!=null&&i[a].getRowNumber()===n[a].getRowNumber())for(let c=1;c<=this.barcodeColumnCount;c++){let u=this.detectionResultColumns[c].getCodewords()[a];u!=null&&(u.setRowNumber(i[a].getRowNumber()),u.hasValidRowNumber()||(this.detectionResultColumns[c].getCodewords()[a]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let i=0,n=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let a=0;a<n.length;a++){if(n[a]==null)continue;let c=n[a].getRowNumber(),u=0;for(let d=this.barcodeColumnCount+1;d>0&&u<this.ADJUST_ROW_NUMBER_SKIP;d--){let _=this.detectionResultColumns[d].getCodewords()[a];_!=null&&(u=Si.adjustRowNumberIfValid(c,u,_),_.hasValidRowNumber()||i++)}}return i}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let i=0,n=this.detectionResultColumns[0].getCodewords();for(let a=0;a<n.length;a++){if(n[a]==null)continue;let c=n[a].getRowNumber(),u=0;for(let d=1;d<this.barcodeColumnCount+1&&u<this.ADJUST_ROW_NUMBER_SKIP;d++){let _=this.detectionResultColumns[d].getCodewords()[a];_!=null&&(u=Si.adjustRowNumberIfValid(c,u,_),_.hasValidRowNumber()||i++)}}return i}static adjustRowNumberIfValid(i,n,a){return a==null||a.hasValidRowNumber()||(a.isValidRowNumber(i)?(a.setRowNumber(i),n=0):++n),n}adjustRowNumbers(i,n,a){if(!this.detectionResultColumns[i-1])return;let c=a[n],u=this.detectionResultColumns[i-1].getCodewords(),d=u;this.detectionResultColumns[i+1]!=null&&(d=this.detectionResultColumns[i+1].getCodewords());let _=new Array(14);_[2]=u[n],_[3]=d[n],n>0&&(_[0]=a[n-1],_[4]=u[n-1],_[5]=d[n-1]),n>1&&(_[8]=a[n-2],_[10]=u[n-2],_[11]=d[n-2]),n<a.length-1&&(_[1]=a[n+1],_[6]=u[n+1],_[7]=d[n+1]),n<a.length-2&&(_[9]=a[n+2],_[12]=u[n+2],_[13]=d[n+2]);for(let x of _)if(Si.adjustRowNumber(c,x))return}static adjustRowNumber(i,n){return n==null?!1:n.hasValidRowNumber()&&n.getBucket()===i.getBucket()?(i.setRowNumber(n.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(i){this.boundingBox=i}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(i,n){this.detectionResultColumns[i]=n}getDetectionResultColumn(i){return this.detectionResultColumns[i]}toString(){let i=this.detectionResultColumns[0];i==null&&(i=this.detectionResultColumns[this.barcodeColumnCount+1]);let n=new pn;for(let a=0;a<i.getCodewords().length;a++){n.format("CW %3d:",a);for(let c=0;c<this.barcodeColumnCount+2;c++){if(this.detectionResultColumns[c]==null){n.format("    |   ");continue}let u=this.detectionResultColumns[c].getCodewords()[a];if(u==null){n.format("    |   ");continue}n.format(" %3d|%3d",u.getRowNumber(),u.getValue())}n.format("%n")}return n.toString()}}class Rs{constructor(i,n,a,c){this.rowNumber=Rs.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(i),this.endX=Math.trunc(n),this.bucket=Math.trunc(a),this.value=Math.trunc(c)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(i){return i!==Rs.BARCODE_ROW_UNKNOWN&&this.bucket===i%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(i){this.rowNumber=i}toString(){return this.rowNumber+"|"+this.value}}Rs.BARCODE_ROW_UNKNOWN=-1;class Ni{static initialize(){for(let i=0;i<Xe.SYMBOL_TABLE.length;i++){let n=Xe.SYMBOL_TABLE[i],a=n&1;for(let c=0;c<Xe.BARS_IN_MODULE;c++){let u=0;for(;(n&1)===a;)u+=1,n>>=1;a=n&1,Ni.RATIOS_TABLE[i]||(Ni.RATIOS_TABLE[i]=new Array(Xe.BARS_IN_MODULE)),Ni.RATIOS_TABLE[i][Xe.BARS_IN_MODULE-c-1]=Math.fround(u/Xe.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(i){let n=Ni.getDecodedCodewordValue(Ni.sampleBitCounts(i));return n!==-1?n:Ni.getClosestDecodedValue(i)}static sampleBitCounts(i){let n=ct.sum(i),a=new Int32Array(Xe.BARS_IN_MODULE),c=0,u=0;for(let d=0;d<Xe.MODULES_IN_CODEWORD;d++){let _=n/(2*Xe.MODULES_IN_CODEWORD)+d*n/Xe.MODULES_IN_CODEWORD;u+i[c]<=_&&(u+=i[c],c++),a[c]++}return a}static getDecodedCodewordValue(i){let n=Ni.getBitValue(i);return Xe.getCodeword(n)===-1?-1:n}static getBitValue(i){let n=0;for(let a=0;a<i.length;a++)for(let c=0;c<i[a];c++)n=n<<1|(a%2===0?1:0);return Math.trunc(n)}static getClosestDecodedValue(i){let n=ct.sum(i),a=new Array(Xe.BARS_IN_MODULE);if(n>1)for(let d=0;d<a.length;d++)a[d]=Math.fround(i[d]/n);let c=cn.MAX_VALUE,u=-1;this.bSymbolTableReady||Ni.initialize();for(let d=0;d<Ni.RATIOS_TABLE.length;d++){let _=0,x=Ni.RATIOS_TABLE[d];for(let y=0;y<Xe.BARS_IN_MODULE;y++){let E=Math.fround(x[y]-a[y]);if(_+=Math.fround(E*E),_>=c)break}_<c&&(c=_,u=Xe.SYMBOL_TABLE[d])}return u}}Ni.bSymbolTableReady=!1,Ni.RATIOS_TABLE=new Array(Xe.SYMBOL_TABLE.length).map(T=>new Array(Xe.BARS_IN_MODULE));class xn{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(i){this.segmentIndex=i}getFileId(){return this.fileId}setFileId(i){this.fileId=i}getOptionalData(){return this.optionalData}setOptionalData(i){this.optionalData=i}isLastSegment(){return this.lastSegment}setLastSegment(i){this.lastSegment=i}getSegmentCount(){return this.segmentCount}setSegmentCount(i){this.segmentCount=i}getSender(){return this.sender||null}setSender(i){this.sender=i}getAddressee(){return this.addressee||null}setAddressee(i){this.addressee=i}getFileName(){return this.fileName}setFileName(i){this.fileName=i}getFileSize(){return this.fileSize}setFileSize(i){this.fileSize=i}getChecksum(){return this.checksum}setChecksum(i){this.checksum=i}getTimestamp(){return this.timestamp}setTimestamp(i){this.timestamp=i}}class Ko{static parseLong(i,n=void 0){return parseInt(i,n)}}class Fa extends S{}Fa.kind="NullPointerException";class kl{writeBytes(i){this.writeBytesOffset(i,0,i.length)}writeBytesOffset(i,n,a){if(i==null)throw new Fa;if(n<0||n>i.length||a<0||n+a>i.length||n+a<0)throw new pe;if(a===0)return;for(let c=0;c<a;c++)this.write(i[n+c])}flush(){}close(){}}class na extends S{}class Ua extends kl{constructor(i=32){if(super(),this.count=0,i<0)throw new N("Negative initial size: "+i);this.buf=new Uint8Array(i)}ensureCapacity(i){i-this.buf.length>0&&this.grow(i)}grow(i){let a=this.buf.length<<1;if(a-i<0&&(a=i),a<0){if(i<0)throw new na;a=te.MAX_VALUE}this.buf=he.copyOfUint8Array(this.buf,a)}write(i){this.ensureCapacity(this.count+1),this.buf[this.count]=i,this.count+=1}writeBytesOffset(i,n,a){if(n<0||n>i.length||a<0||n+a-i.length>0)throw new pe;this.ensureCapacity(this.count+a),X.arraycopy(i,n,this.buf,this.count,a),this.count+=a}writeTo(i){i.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return he.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(i){return i?typeof i=="string"?this.toString_string(i):this.toString_number(i):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(i){return new String(this.buf).toString()}toString_number(i){return new String(this.buf).toString()}close(){}}var Et;(function(T){T[T.ALPHA=0]="ALPHA",T[T.LOWER=1]="LOWER",T[T.MIXED=2]="MIXED",T[T.PUNCT=3]="PUNCT",T[T.ALPHA_SHIFT=4]="ALPHA_SHIFT",T[T.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Et||(Et={}));function Zo(){if(typeof window<"u")return window.BigInt||null;if(typeof lh<"u")return lh.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Va;function Sr(T){if(typeof Va>"u"&&(Va=Zo()),Va===null)throw new Error("BigInt is not supported!");return Va(T)}function Ll(){let T=[];T[0]=Sr(1);let i=Sr(900);T[1]=i;for(let n=2;n<16;n++)T[n]=T[n-1]*i;return T}class se{static decode(i,n){let a=new ae(""),c=de.ISO8859_1;a.enableDecoding(c);let u=1,d=i[u++],_=new xn;for(;u<i[0];){switch(d){case se.TEXT_COMPACTION_MODE_LATCH:u=se.textCompaction(i,u,a);break;case se.BYTE_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:u=se.byteCompaction(d,i,c,u,a);break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(i[u++]);break;case se.NUMERIC_COMPACTION_MODE_LATCH:u=se.numericCompaction(i,u,a);break;case se.ECI_CHARSET:de.getCharacterSetECIByValue(i[u++]);break;case se.ECI_GENERAL_PURPOSE:u+=2;break;case se.ECI_USER_DEFINED:u++;break;case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:u=se.decodeMacroBlock(i,u,_);break;case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:throw new Y;default:u--,u=se.textCompaction(i,u,a);break}if(u<i.length)d=i[u++];else throw Y.getFormatInstance()}if(a.length()===0)throw Y.getFormatInstance();let x=new dt(null,a.toString(),null,n);return x.setOther(_),x}static decodeMacroBlock(i,n,a){if(n+se.NUMBER_OF_SEQUENCE_CODEWORDS>i[0])throw Y.getFormatInstance();let c=new Int32Array(se.NUMBER_OF_SEQUENCE_CODEWORDS);for(let _=0;_<se.NUMBER_OF_SEQUENCE_CODEWORDS;_++,n++)c[_]=i[n];a.setSegmentIndex(te.parseInt(se.decodeBase900toBase10(c,se.NUMBER_OF_SEQUENCE_CODEWORDS)));let u=new ae;n=se.textCompaction(i,n,u),a.setFileId(u.toString());let d=-1;for(i[n]===se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(d=n+1);n<i[0];)switch(i[n]){case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(n++,i[n]){case se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let _=new ae;n=se.textCompaction(i,n+1,_),a.setFileName(_.toString());break;case se.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let x=new ae;n=se.textCompaction(i,n+1,x),a.setSender(x.toString());break;case se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let y=new ae;n=se.textCompaction(i,n+1,y),a.setAddressee(y.toString());break;case se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let E=new ae;n=se.numericCompaction(i,n+1,E),a.setSegmentCount(te.parseInt(E.toString()));break;case se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let R=new ae;n=se.numericCompaction(i,n+1,R),a.setTimestamp(Ko.parseLong(R.toString()));break;case se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let D=new ae;n=se.numericCompaction(i,n+1,D),a.setChecksum(te.parseInt(D.toString()));break;case se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let I=new ae;n=se.numericCompaction(i,n+1,I),a.setFileSize(Ko.parseLong(I.toString()));break;default:throw Y.getFormatInstance()}break;case se.MACRO_PDF417_TERMINATOR:n++,a.setLastSegment(!0);break;default:throw Y.getFormatInstance()}if(d!==-1){let _=n-d;a.isLastSegment()&&_--,a.setOptionalData(he.copyOfRange(i,d,d+_))}return n}static textCompaction(i,n,a){let c=new Int32Array((i[0]-n)*2),u=new Int32Array((i[0]-n)*2),d=0,_=!1;for(;n<i[0]&&!_;){let x=i[n++];if(x<se.TEXT_COMPACTION_MODE_LATCH)c[d]=x/30,c[d+1]=x%30,d+=2;else switch(x){case se.TEXT_COMPACTION_MODE_LATCH:c[d++]=se.TEXT_COMPACTION_MODE_LATCH;break;case se.BYTE_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.NUMERIC_COMPACTION_MODE_LATCH:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:n--,_=!0;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c[d]=se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,x=i[n++],u[d]=x,d++;break}}return se.decodeTextCompaction(c,u,d,a),n}static decodeTextCompaction(i,n,a,c){let u=Et.ALPHA,d=Et.ALPHA,_=0;for(;_<a;){let x=i[_],y="";switch(u){case Et.ALPHA:if(x<26)y=String.fromCharCode(65+x);else switch(x){case 26:y=" ";break;case se.LL:u=Et.LOWER;break;case se.ML:u=Et.MIXED;break;case se.PS:d=u,u=Et.PUNCT_SHIFT;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(n[_]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.LOWER:if(x<26)y=String.fromCharCode(97+x);else switch(x){case 26:y=" ";break;case se.AS:d=u,u=Et.ALPHA_SHIFT;break;case se.ML:u=Et.MIXED;break;case se.PS:d=u,u=Et.PUNCT_SHIFT;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(n[_]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.MIXED:if(x<se.PL)y=se.MIXED_CHARS[x];else switch(x){case se.PL:u=Et.PUNCT;break;case 26:y=" ";break;case se.LL:u=Et.LOWER;break;case se.AL:u=Et.ALPHA;break;case se.PS:d=u,u=Et.PUNCT_SHIFT;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(n[_]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.PUNCT:if(x<se.PAL)y=se.PUNCT_CHARS[x];else switch(x){case se.PAL:u=Et.ALPHA;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(n[_]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.ALPHA_SHIFT:if(u=d,x<26)y=String.fromCharCode(65+x);else switch(x){case 26:y=" ";break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break;case Et.PUNCT_SHIFT:if(u=d,x<se.PAL)y=se.PUNCT_CHARS[x];else switch(x){case se.PAL:u=Et.ALPHA;break;case se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(n[_]);break;case se.TEXT_COMPACTION_MODE_LATCH:u=Et.ALPHA;break}break}y!==""&&c.append(y),_++}}static byteCompaction(i,n,a,c,u){let d=new Ua,_=0,x=0,y=!1;switch(i){case se.BYTE_COMPACTION_MODE_LATCH:let E=new Int32Array(6),R=n[c++];for(;c<n[0]&&!y;)switch(E[_++]=R,x=900*x+R,R=n[c++],R){case se.TEXT_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH:case se.NUMERIC_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:c--,y=!0;break;default:if(_%5===0&&_>0){for(let D=0;D<6;++D)d.write(Number(Sr(x)>>Sr(8*(5-D))));x=0,_=0}break}c===n[0]&&R<se.TEXT_COMPACTION_MODE_LATCH&&(E[_++]=R);for(let D=0;D<_;D++)d.write(E[D]);break;case se.BYTE_COMPACTION_MODE_LATCH_6:for(;c<n[0]&&!y;){let D=n[c++];if(D<se.TEXT_COMPACTION_MODE_LATCH)_++,x=900*x+D;else switch(D){case se.TEXT_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH:case se.NUMERIC_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:c--,y=!0;break}if(_%5===0&&_>0){for(let I=0;I<6;++I)d.write(Number(Sr(x)>>Sr(8*(5-I))));x=0,_=0}}break}return u.append(je.decode(d.toByteArray(),a)),c}static numericCompaction(i,n,a){let c=0,u=!1,d=new Int32Array(se.MAX_NUMERIC_CODEWORDS);for(;n<i[0]&&!u;){let _=i[n++];if(n===i[0]&&(u=!0),_<se.TEXT_COMPACTION_MODE_LATCH)d[c]=_,c++;else switch(_){case se.TEXT_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH:case se.BYTE_COMPACTION_MODE_LATCH_6:case se.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case se.MACRO_PDF417_TERMINATOR:n--,u=!0;break}(c%se.MAX_NUMERIC_CODEWORDS===0||_===se.NUMERIC_COMPACTION_MODE_LATCH||u)&&c>0&&(a.append(se.decodeBase900toBase10(d,c)),c=0)}return n}static decodeBase900toBase10(i,n){let a=Sr(0);for(let u=0;u<n;u++)a+=se.EXP900[n-u-1]*Sr(i[u]);let c=a.toString();if(c.charAt(0)!=="1")throw new Y;return c.substring(1)}}se.TEXT_COMPACTION_MODE_LATCH=900,se.BYTE_COMPACTION_MODE_LATCH=901,se.NUMERIC_COMPACTION_MODE_LATCH=902,se.BYTE_COMPACTION_MODE_LATCH_6=924,se.ECI_USER_DEFINED=925,se.ECI_GENERAL_PURPOSE=926,se.ECI_CHARSET=927,se.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,se.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,se.MACRO_PDF417_TERMINATOR=922,se.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,se.MAX_NUMERIC_CODEWORDS=15,se.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,se.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,se.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,se.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,se.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,se.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,se.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,se.PL=25,se.LL=27,se.AS=27,se.ML=28,se.AL=28,se.PS=29,se.PAL=29,se.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,se.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",se.EXP900=Zo()?Ll():[],se.NUMBER_OF_SEQUENCE_CODEWORDS=2;class it{constructor(){}static decode(i,n,a,c,u,d,_){let x=new hr(i,n,a,c,u),y=null,E=null,R;for(let F=!0;;F=!1){if(n!=null&&(y=it.getRowIndicatorColumn(i,x,n,!0,d,_)),c!=null&&(E=it.getRowIndicatorColumn(i,x,c,!1,d,_)),R=it.merge(y,E),R==null)throw U.getNotFoundInstance();let V=R.getBoundingBox();if(F&&V!=null&&(V.getMinY()<x.getMinY()||V.getMaxY()>x.getMaxY()))x=V;else break}R.setBoundingBox(x);let D=R.getBarcodeColumnCount()+1;R.setDetectionResultColumn(0,y),R.setDetectionResultColumn(D,E);let I=y!=null;for(let F=1;F<=D;F++){let V=I?F:D-F;if(R.getDetectionResultColumn(V)!==void 0)continue;let q;V===0||V===D?q=new Il(x,V===0):q=new xr(x),R.setDetectionResultColumn(V,q);let ie=-1,Ce=ie;for(let we=x.getMinY();we<=x.getMaxY();we++){if(ie=it.getStartColumn(R,V,we,I),ie<0||ie>x.getMaxX()){if(Ce===-1)continue;ie=Ce}let ve=it.detectCodeword(i,x.getMinX(),x.getMaxX(),I,ie,we,d,_);ve!=null&&(q.setCodeword(we,ve),Ce=ie,d=Math.min(d,ve.getWidth()),_=Math.max(_,ve.getWidth()))}}return it.createDecoderResult(R)}static merge(i,n){if(i==null&&n==null)return null;let a=it.getBarcodeMetadata(i,n);if(a==null)return null;let c=hr.merge(it.adjustBoundingBox(i),it.adjustBoundingBox(n));return new Si(a,c)}static adjustBoundingBox(i){if(i==null)return null;let n=i.getRowHeights();if(n==null)return null;let a=it.getMax(n),c=0;for(let _ of n)if(c+=a-_,_>0)break;let u=i.getCodewords();for(let _=0;c>0&&u[_]==null;_++)c--;let d=0;for(let _=n.length-1;_>=0&&(d+=a-n[_],!(n[_]>0));_--);for(let _=u.length-1;d>0&&u[_]==null;_--)d--;return i.getBoundingBox().addMissingRows(c,d,i.isLeft())}static getMax(i){let n=-1;for(let a of i)n=Math.max(n,a);return n}static getBarcodeMetadata(i,n){let a;if(i==null||(a=i.getBarcodeMetadata())==null)return n==null?null:n.getBarcodeMetadata();let c;return n==null||(c=n.getBarcodeMetadata())==null?a:a.getColumnCount()!==c.getColumnCount()&&a.getErrorCorrectionLevel()!==c.getErrorCorrectionLevel()&&a.getRowCount()!==c.getRowCount()?null:a}static getRowIndicatorColumn(i,n,a,c,u,d){let _=new Il(n,c);for(let x=0;x<2;x++){let y=x===0?1:-1,E=Math.trunc(Math.trunc(a.getX()));for(let R=Math.trunc(Math.trunc(a.getY()));R<=n.getMaxY()&&R>=n.getMinY();R+=y){let D=it.detectCodeword(i,0,i.getWidth(),c,E,R,u,d);D!=null&&(_.setCodeword(R,D),c?E=D.getStartX():E=D.getEndX())}}return _}static adjustCodewordCount(i,n){let a=n[0][1],c=a.getValue(),u=i.getBarcodeColumnCount()*i.getBarcodeRowCount()-it.getNumberOfECCodeWords(i.getBarcodeECLevel());if(c.length===0){if(u<1||u>Xe.MAX_CODEWORDS_IN_BARCODE)throw U.getNotFoundInstance();a.setValue(u)}else c[0]!==u&&a.setValue(u)}static createDecoderResult(i){let n=it.createBarcodeMatrix(i);it.adjustCodewordCount(i,n);let a=new Array,c=new Int32Array(i.getBarcodeRowCount()*i.getBarcodeColumnCount()),u=[],d=new Array;for(let x=0;x<i.getBarcodeRowCount();x++)for(let y=0;y<i.getBarcodeColumnCount();y++){let E=n[x][y+1].getValue(),R=x*i.getBarcodeColumnCount()+y;E.length===0?a.push(R):E.length===1?c[R]=E[0]:(d.push(R),u.push(E))}let _=new Array(u.length);for(let x=0;x<_.length;x++)_[x]=u[x];return it.createDecoderResultFromAmbiguousValues(i.getBarcodeECLevel(),c,Xe.toIntArray(a),Xe.toIntArray(d),_)}static createDecoderResultFromAmbiguousValues(i,n,a,c,u){let d=new Int32Array(c.length),_=100;for(;_-- >0;){for(let x=0;x<d.length;x++)n[c[x]]=u[x][d[x]];try{return it.decodeCodewords(n,i,a)}catch(x){if(!(x instanceof P))throw x}if(d.length===0)throw P.getChecksumInstance();for(let x=0;x<d.length;x++)if(d[x]<u[x].length-1){d[x]++;break}else if(d[x]=0,x===d.length-1)throw P.getChecksumInstance()}throw P.getChecksumInstance()}static createBarcodeMatrix(i){let n=Array.from({length:i.getBarcodeRowCount()},()=>new Array(i.getBarcodeColumnCount()+2));for(let c=0;c<n.length;c++)for(let u=0;u<n[c].length;u++)n[c][u]=new vr;let a=0;for(let c of i.getDetectionResultColumns()){if(c!=null){for(let u of c.getCodewords())if(u!=null){let d=u.getRowNumber();if(d>=0){if(d>=n.length)continue;n[d][a].setValue(u.getValue())}}}a++}return n}static isValidBarcodeColumn(i,n){return n>=0&&n<=i.getBarcodeColumnCount()+1}static getStartColumn(i,n,a,c){let u=c?1:-1,d=null;if(it.isValidBarcodeColumn(i,n-u)&&(d=i.getDetectionResultColumn(n-u).getCodeword(a)),d!=null)return c?d.getEndX():d.getStartX();if(d=i.getDetectionResultColumn(n).getCodewordNearby(a),d!=null)return c?d.getStartX():d.getEndX();if(it.isValidBarcodeColumn(i,n-u)&&(d=i.getDetectionResultColumn(n-u).getCodewordNearby(a)),d!=null)return c?d.getEndX():d.getStartX();let _=0;for(;it.isValidBarcodeColumn(i,n-u);){n-=u;for(let x of i.getDetectionResultColumn(n).getCodewords())if(x!=null)return(c?x.getEndX():x.getStartX())+u*_*(x.getEndX()-x.getStartX());_++}return c?i.getBoundingBox().getMinX():i.getBoundingBox().getMaxX()}static detectCodeword(i,n,a,c,u,d,_,x){u=it.adjustCodewordStartColumn(i,n,a,c,u,d);let y=it.getModuleBitCount(i,n,a,c,u,d);if(y==null)return null;let E,R=ct.sum(y);if(c)E=u+R;else{for(let F=0;F<y.length/2;F++){let V=y[F];y[F]=y[y.length-1-F],y[y.length-1-F]=V}E=u,u=E-R}if(!it.checkCodewordSkew(R,_,x))return null;let D=Ni.getDecodedValue(y),I=Xe.getCodeword(D);return I===-1?null:new Rs(u,E,it.getCodewordBucketNumber(D),I)}static getModuleBitCount(i,n,a,c,u,d){let _=u,x=new Int32Array(8),y=0,E=c?1:-1,R=c;for(;(c?_<a:_>=n)&&y<x.length;)i.get(_,d)===R?(x[y]++,_+=E):(y++,R=!R);return y===x.length||_===(c?a:n)&&y===x.length-1?x:null}static getNumberOfECCodeWords(i){return 2<<i}static adjustCodewordStartColumn(i,n,a,c,u,d){let _=u,x=c?-1:1;for(let y=0;y<2;y++){for(;(c?_>=n:_<a)&&c===i.get(_,d);){if(Math.abs(u-_)>it.CODEWORD_SKEW_SIZE)return u;_+=x}x=-x,c=!c}return _}static checkCodewordSkew(i,n,a){return n-it.CODEWORD_SKEW_SIZE<=i&&i<=a+it.CODEWORD_SKEW_SIZE}static decodeCodewords(i,n,a){if(i.length===0)throw Y.getFormatInstance();let c=1<<n+1,u=it.correctErrors(i,a,c);it.verifyCodewordCount(i,c);let d=se.decode(i,""+n);return d.setErrorsCorrected(u),d.setErasures(a.length),d}static correctErrors(i,n,a){if(n!=null&&n.length>a/2+it.MAX_ERRORS||a<0||a>it.MAX_EC_CODEWORDS)throw P.getChecksumInstance();return it.errorCorrection.decode(i,a,n)}static verifyCodewordCount(i,n){if(i.length<4)throw Y.getFormatInstance();let a=i[0];if(a>i.length)throw Y.getFormatInstance();if(a===0)if(n<i.length)i[0]=i.length-n;else throw Y.getFormatInstance()}static getBitCountForCodeword(i){let n=new Int32Array(8),a=0,c=n.length-1;for(;!((i&1)!==a&&(a=i&1,c--,c<0));)n[c]++,i>>=1;return n}static getCodewordBucketNumber(i){return i instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(i):this.getCodewordBucketNumber_number(i)}static getCodewordBucketNumber_number(i){return it.getCodewordBucketNumber(it.getBitCountForCodeword(i))}static getCodewordBucketNumber_Int32Array(i){return(i[0]-i[2]+i[4]-i[6]+9)%9}static toString(i){let n=new pn;for(let a=0;a<i.length;a++){n.format("Row %2d: ",a);for(let c=0;c<i[a].length;c++){let u=i[a][c];u.getValue().length===0?n.format("        ",null):n.format("%4d(%2d)",u.getValue()[0],u.getConfidence(u.getValue()[0]))}n.format("%n")}return n.toString()}}it.CODEWORD_SKEW_SIZE=2,it.MAX_ERRORS=3,it.MAX_EC_CODEWORDS=512,it.errorCorrection=new cr;class Di{decode(i,n=null){let a=Di.decode(i,n,!1);if(a==null||a.length===0||a[0]==null)throw U.getNotFoundInstance();return a[0]}decodeMultiple(i,n=null){try{return Di.decode(i,n,!0)}catch(a){throw a instanceof Y||a instanceof P?U.getNotFoundInstance():a}}static decode(i,n,a){const c=new Array,u=Ze.detectMultiple(i,n,a);for(const d of u.getPoints()){const _=it.decode(u.getBits(),d[4],d[5],d[6],d[7],Di.getMinCodewordWidth(d),Di.getMaxCodewordWidth(d)),x=new be(_.getText(),_.getRawBytes(),void 0,d,Se.PDF_417);x.putMetadata(ot.ERROR_CORRECTION_LEVEL,_.getECLevel());const y=_.getOther();y!=null&&x.putMetadata(ot.PDF417_EXTRA_METADATA,y),c.push(x)}return c.map(d=>d)}static getMaxWidth(i,n){return i==null||n==null?0:Math.trunc(Math.abs(i.getX()-n.getX()))}static getMinWidth(i,n){return i==null||n==null?te.MAX_VALUE:Math.trunc(Math.abs(i.getX()-n.getX()))}static getMaxCodewordWidth(i){return Math.floor(Math.max(Math.max(Di.getMaxWidth(i[0],i[4]),Di.getMaxWidth(i[6],i[2])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN),Math.max(Di.getMaxWidth(i[1],i[5]),Di.getMaxWidth(i[7],i[3])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(i){return Math.floor(Math.min(Math.min(Di.getMinWidth(i[0],i[4]),Di.getMinWidth(i[6],i[2])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN),Math.min(Di.getMinWidth(i[1],i[5]),Di.getMinWidth(i[7],i[3])*Xe.MODULES_IN_CODEWORD/Xe.MODULES_IN_STOP_PATTERN)))}reset(){}}class Wa extends S{}Wa.kind="ReaderException";class Qo{constructor(i,n){this.verbose=i===!0,n&&this.setHints(n)}decode(i,n){return n&&this.setHints(n),this.decodeInternal(i)}decodeWithState(i){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(i)}setHints(i){this.hints=i;const n=!h(i)&&i.get(Re.TRY_HARDER)===!0,a=h(i)?null:i.get(Re.POSSIBLE_FORMATS),c=new Array;if(!h(a)){const u=a.some(d=>d===Se.UPC_A||d===Se.UPC_E||d===Se.EAN_13||d===Se.EAN_8||d===Se.CODABAR||d===Se.CODE_39||d===Se.CODE_93||d===Se.CODE_128||d===Se.ITF||d===Se.RSS_14||d===Se.RSS_EXPANDED);u&&!n&&c.push(new As(i,this.verbose)),a.includes(Se.QR_CODE)&&c.push(new or),a.includes(Se.DATA_MATRIX)&&c.push(new lr),a.includes(Se.AZTEC)&&c.push(new ka),a.includes(Se.PDF_417)&&c.push(new Di),u&&n&&c.push(new As(i,this.verbose))}c.length===0&&(n||c.push(new As(i,this.verbose)),c.push(new or),c.push(new lr),c.push(new ka),c.push(new Di),n&&c.push(new As(i,this.verbose))),this.readers=c}reset(){if(this.readers!==null)for(const i of this.readers)i.reset()}decodeInternal(i){if(this.readers===null)throw new Wa("No readers where selected, nothing can be read.");for(const n of this.readers)try{return n.decode(i,this.hints)}catch(a){if(a instanceof Wa)continue}throw new U("No MultiFormat Readers were able to detect the code.")}}class Jo extends ye{constructor(i=null,n=500){const a=new Qo;a.setHints(i),super(a,n)}decodeBitmap(i){return this.reader.decodeWithState(i)}}class Fh extends ye{constructor(i=500){super(new Di,i)}}class Uh extends ye{constructor(i=500){super(new or,i)}}var Pl;(function(T){T[T.ERROR_CORRECTION=0]="ERROR_CORRECTION",T[T.CHARACTER_SET=1]="CHARACTER_SET",T[T.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",T[T.MIN_SIZE=3]="MIN_SIZE",T[T.MAX_SIZE=4]="MAX_SIZE",T[T.MARGIN=5]="MARGIN",T[T.PDF417_COMPACT=6]="PDF417_COMPACT",T[T.PDF417_COMPACTION=7]="PDF417_COMPACTION",T[T.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",T[T.AZTEC_LAYERS=9]="AZTEC_LAYERS",T[T.QR_VERSION=10]="QR_VERSION"})(Pl||(Pl={}));var _i=Pl;class aa{constructor(i){this.field=i,this.cachedGenerators=[],this.cachedGenerators.push(new Xt(i,Int32Array.from([1])))}buildGenerator(i){const n=this.cachedGenerators;if(i>=n.length){let a=n[n.length-1];const c=this.field;for(let u=n.length;u<=i;u++){const d=a.multiply(new Xt(c,Int32Array.from([1,c.exp(u-1+c.getGeneratorBase())])));n.push(d),a=d}}return n[i]}encode(i,n){if(n===0)throw new N("No error correction bytes");const a=i.length-n;if(a<=0)throw new N("No data bytes provided");const c=this.buildGenerator(n),u=new Int32Array(a);X.arraycopy(i,0,u,0,a);let d=new Xt(this.field,u);d=d.multiplyByMonomial(n,1);const x=d.divide(c)[1].getCoefficients(),y=n-x.length;for(let E=0;E<y;E++)i[a+E]=0;X.arraycopy(x,0,i,a+y,x.length)}}class Jt{constructor(){}static applyMaskPenaltyRule1(i){return Jt.applyMaskPenaltyRule1Internal(i,!0)+Jt.applyMaskPenaltyRule1Internal(i,!1)}static applyMaskPenaltyRule2(i){let n=0;const a=i.getArray(),c=i.getWidth(),u=i.getHeight();for(let d=0;d<u-1;d++){const _=a[d];for(let x=0;x<c-1;x++){const y=_[x];y===_[x+1]&&y===a[d+1][x]&&y===a[d+1][x+1]&&n++}}return Jt.N2*n}static applyMaskPenaltyRule3(i){let n=0;const a=i.getArray(),c=i.getWidth(),u=i.getHeight();for(let d=0;d<u;d++)for(let _=0;_<c;_++){const x=a[d];_+6<c&&x[_]===1&&x[_+1]===0&&x[_+2]===1&&x[_+3]===1&&x[_+4]===1&&x[_+5]===0&&x[_+6]===1&&(Jt.isWhiteHorizontal(x,_-4,_)||Jt.isWhiteHorizontal(x,_+7,_+11))&&n++,d+6<u&&a[d][_]===1&&a[d+1][_]===0&&a[d+2][_]===1&&a[d+3][_]===1&&a[d+4][_]===1&&a[d+5][_]===0&&a[d+6][_]===1&&(Jt.isWhiteVertical(a,_,d-4,d)||Jt.isWhiteVertical(a,_,d+7,d+11))&&n++}return n*Jt.N3}static isWhiteHorizontal(i,n,a){n=Math.max(n,0),a=Math.min(a,i.length);for(let c=n;c<a;c++)if(i[c]===1)return!1;return!0}static isWhiteVertical(i,n,a,c){a=Math.max(a,0),c=Math.min(c,i.length);for(let u=a;u<c;u++)if(i[u][n]===1)return!1;return!0}static applyMaskPenaltyRule4(i){let n=0;const a=i.getArray(),c=i.getWidth(),u=i.getHeight();for(let x=0;x<u;x++){const y=a[x];for(let E=0;E<c;E++)y[E]===1&&n++}const d=i.getHeight()*i.getWidth();return Math.floor(Math.abs(n*2-d)*10/d)*Jt.N4}static getDataMaskBit(i,n,a){let c,u;switch(i){case 0:c=a+n&1;break;case 1:c=a&1;break;case 2:c=n%3;break;case 3:c=(a+n)%3;break;case 4:c=Math.floor(a/2)+Math.floor(n/3)&1;break;case 5:u=a*n,c=(u&1)+u%3;break;case 6:u=a*n,c=(u&1)+u%3&1;break;case 7:u=a*n,c=u%3+(a+n&1)&1;break;default:throw new N("Invalid mask pattern: "+i)}return c===0}static applyMaskPenaltyRule1Internal(i,n){let a=0;const c=n?i.getHeight():i.getWidth(),u=n?i.getWidth():i.getHeight(),d=i.getArray();for(let _=0;_<c;_++){let x=0,y=-1;for(let E=0;E<u;E++){const R=n?d[_][E]:d[E][_];R===y?x++:(x>=5&&(a+=Jt.N1+(x-5)),x=1,y=R)}x>=5&&(a+=Jt.N1+(x-5))}return a}}Jt.N1=3,Jt.N2=3,Jt.N3=40,Jt.N4=10;class Ga{constructor(i,n){this.width=i,this.height=n;const a=new Array(n);for(let c=0;c!==n;c++)a[c]=new Uint8Array(i);this.bytes=a}getHeight(){return this.height}getWidth(){return this.width}get(i,n){return this.bytes[n][i]}getArray(){return this.bytes}setNumber(i,n,a){this.bytes[n][i]=a}setBoolean(i,n,a){this.bytes[n][i]=a?1:0}clear(i){for(const n of this.bytes)he.fill(n,i)}equals(i){if(!(i instanceof Ga))return!1;const n=i;if(this.width!==n.width||this.height!==n.height)return!1;for(let a=0,c=this.height;a<c;++a){const u=this.bytes[a],d=n.bytes[a];for(let _=0,x=this.width;_<x;++_)if(u[_]!==d[_])return!1}return!0}toString(){const i=new ae;for(let n=0,a=this.height;n<a;++n){const c=this.bytes[n];for(let u=0,d=this.width;u<d;++u)switch(c[u]){case 0:i.append(" 0");break;case 1:i.append(" 1");break;default:i.append("  ");break}i.append(`
`)}return i.toString()}}class kr{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const i=new ae;return i.append(`<<
`),i.append(" mode: "),i.append(this.mode?this.mode.toString():"null"),i.append(`
 ecLevel: `),i.append(this.ecLevel?this.ecLevel.toString():"null"),i.append(`
 version: `),i.append(this.version?this.version.toString():"null"),i.append(`
 maskPattern: `),i.append(this.maskPattern.toString()),this.matrix?(i.append(`
 matrix:
`),i.append(this.matrix.toString())):i.append(`
 matrix: null
`),i.append(`>>
`),i.toString()}setMode(i){this.mode=i}setECLevel(i){this.ecLevel=i}setVersion(i){this.version=i}setMaskPattern(i){this.maskPattern=i}setMatrix(i){this.matrix=i}static isValidMaskPattern(i){return i>=0&&i<kr.NUM_MASK_PATTERNS}}kr.NUM_MASK_PATTERNS=8;class Rt extends S{}Rt.kind="WriterException";class Ye{constructor(){}static clearMatrix(i){i.clear(255)}static buildMatrix(i,n,a,c,u){Ye.clearMatrix(u),Ye.embedBasicPatterns(a,u),Ye.embedTypeInfo(n,c,u),Ye.maybeEmbedVersionInfo(a,u),Ye.embedDataBits(i,c,u)}static embedBasicPatterns(i,n){Ye.embedPositionDetectionPatternsAndSeparators(n),Ye.embedDarkDotAtLeftBottomCorner(n),Ye.maybeEmbedPositionAdjustmentPatterns(i,n),Ye.embedTimingPatterns(n)}static embedTypeInfo(i,n,a){const c=new le;Ye.makeTypeInfoBits(i,n,c);for(let u=0,d=c.getSize();u<d;++u){const _=c.get(c.getSize()-1-u),x=Ye.TYPE_INFO_COORDINATES[u],y=x[0],E=x[1];if(a.setBoolean(y,E,_),u<8){const R=a.getWidth()-u-1;a.setBoolean(R,8,_)}else{const D=a.getHeight()-7+(u-8);a.setBoolean(8,D,_)}}}static maybeEmbedVersionInfo(i,n){if(i.getVersionNumber()<7)return;const a=new le;Ye.makeVersionInfoBits(i,a);let c=17;for(let u=0;u<6;++u)for(let d=0;d<3;++d){const _=a.get(c);c--,n.setBoolean(u,n.getHeight()-11+d,_),n.setBoolean(n.getHeight()-11+d,u,_)}}static embedDataBits(i,n,a){let c=0,u=-1,d=a.getWidth()-1,_=a.getHeight()-1;for(;d>0;){for(d===6&&(d-=1);_>=0&&_<a.getHeight();){for(let x=0;x<2;++x){const y=d-x;if(!Ye.isEmpty(a.get(y,_)))continue;let E;c<i.getSize()?(E=i.get(c),++c):E=!1,n!==255&&Jt.getDataMaskBit(n,y,_)&&(E=!E),a.setBoolean(y,_,E)}_+=u}u=-u,_+=u,d-=2}if(c!==i.getSize())throw new Rt("Not all bits consumed: "+c+"/"+i.getSize())}static findMSBSet(i){return 32-te.numberOfLeadingZeros(i)}static calculateBCHCode(i,n){if(n===0)throw new N("0 polynomial");const a=Ye.findMSBSet(n);for(i<<=a-1;Ye.findMSBSet(i)>=a;)i^=n<<Ye.findMSBSet(i)-a;return i}static makeTypeInfoBits(i,n,a){if(!kr.isValidMaskPattern(n))throw new Rt("Invalid mask pattern");const c=i.getBits()<<3|n;a.appendBits(c,5);const u=Ye.calculateBCHCode(c,Ye.TYPE_INFO_POLY);a.appendBits(u,10);const d=new le;if(d.appendBits(Ye.TYPE_INFO_MASK_PATTERN,15),a.xor(d),a.getSize()!==15)throw new Rt("should not happen but we got: "+a.getSize())}static makeVersionInfoBits(i,n){n.appendBits(i.getVersionNumber(),6);const a=Ye.calculateBCHCode(i.getVersionNumber(),Ye.VERSION_INFO_POLY);if(n.appendBits(a,12),n.getSize()!==18)throw new Rt("should not happen but we got: "+n.getSize())}static isEmpty(i){return i===255}static embedTimingPatterns(i){for(let n=8;n<i.getWidth()-8;++n){const a=(n+1)%2;Ye.isEmpty(i.get(n,6))&&i.setNumber(n,6,a),Ye.isEmpty(i.get(6,n))&&i.setNumber(6,n,a)}}static embedDarkDotAtLeftBottomCorner(i){if(i.get(8,i.getHeight()-8)===0)throw new Rt;i.setNumber(8,i.getHeight()-8,1)}static embedHorizontalSeparationPattern(i,n,a){for(let c=0;c<8;++c){if(!Ye.isEmpty(a.get(i+c,n)))throw new Rt;a.setNumber(i+c,n,0)}}static embedVerticalSeparationPattern(i,n,a){for(let c=0;c<7;++c){if(!Ye.isEmpty(a.get(i,n+c)))throw new Rt;a.setNumber(i,n+c,0)}}static embedPositionAdjustmentPattern(i,n,a){for(let c=0;c<5;++c){const u=Ye.POSITION_ADJUSTMENT_PATTERN[c];for(let d=0;d<5;++d)a.setNumber(i+d,n+c,u[d])}}static embedPositionDetectionPattern(i,n,a){for(let c=0;c<7;++c){const u=Ye.POSITION_DETECTION_PATTERN[c];for(let d=0;d<7;++d)a.setNumber(i+d,n+c,u[d])}}static embedPositionDetectionPatternsAndSeparators(i){const n=Ye.POSITION_DETECTION_PATTERN[0].length;Ye.embedPositionDetectionPattern(0,0,i),Ye.embedPositionDetectionPattern(i.getWidth()-n,0,i),Ye.embedPositionDetectionPattern(0,i.getWidth()-n,i);const a=8;Ye.embedHorizontalSeparationPattern(0,a-1,i),Ye.embedHorizontalSeparationPattern(i.getWidth()-a,a-1,i),Ye.embedHorizontalSeparationPattern(0,i.getWidth()-a,i);const c=7;Ye.embedVerticalSeparationPattern(c,0,i),Ye.embedVerticalSeparationPattern(i.getHeight()-c-1,0,i),Ye.embedVerticalSeparationPattern(c,i.getHeight()-c,i)}static maybeEmbedPositionAdjustmentPatterns(i,n){if(i.getVersionNumber()<2)return;const a=i.getVersionNumber()-1,c=Ye.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[a];for(let u=0,d=c.length;u!==d;u++){const _=c[u];if(_>=0)for(let x=0;x!==d;x++){const y=c[x];y>=0&&Ye.isEmpty(n.get(y,_))&&Ye.embedPositionAdjustmentPattern(y-2,_-2,n)}}}}Ye.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Ye.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Ye.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Ye.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Ye.VERSION_INFO_POLY=7973,Ye.TYPE_INFO_POLY=1335,Ye.TYPE_INFO_MASK_PATTERN=21522;class Vh{constructor(i,n){this.dataBytes=i,this.errorCorrectionBytes=n}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Ut{constructor(){}static calculateMaskPenalty(i){return Jt.applyMaskPenaltyRule1(i)+Jt.applyMaskPenaltyRule2(i)+Jt.applyMaskPenaltyRule3(i)+Jt.applyMaskPenaltyRule4(i)}static encode(i,n,a=null){let c=Ut.DEFAULT_BYTE_MODE_ENCODING;const u=a!==null&&a.get(_i.CHARACTER_SET)!==void 0;u&&(c=a.get(_i.CHARACTER_SET).toString());const d=this.chooseMode(i,c),_=new le;if(d===We.BYTE&&(u||Ut.DEFAULT_BYTE_MODE_ENCODING!==c)){const we=de.getCharacterSetECIByName(c);we!==void 0&&this.appendECI(we,_)}this.appendModeInfo(d,_);const x=new le;this.appendBytes(i,d,x,c);let y;if(a!==null&&a.get(_i.QR_VERSION)!==void 0){const we=Number.parseInt(a.get(_i.QR_VERSION).toString(),10);y=Fe.getVersionForNumber(we);const ve=this.calculateBitsNeeded(d,_,x,y);if(!this.willFit(ve,y,n))throw new Rt("Data too big for requested version")}else y=this.recommendVersion(n,d,_,x);const E=new le;E.appendBitArray(_);const R=d===We.BYTE?x.getSizeInBytes():i.length;this.appendLengthInfo(R,y,d,E),E.appendBitArray(x);const D=y.getECBlocksForLevel(n),I=y.getTotalCodewords()-D.getTotalECCodewords();this.terminateBits(I,E);const F=this.interleaveWithECBytes(E,y.getTotalCodewords(),I,D.getNumBlocks()),V=new kr;V.setECLevel(n),V.setMode(d),V.setVersion(y);const q=y.getDimensionForVersion(),ie=new Ga(q,q),Ce=this.chooseMaskPattern(F,n,y,ie);return V.setMaskPattern(Ce),Ye.buildMatrix(F,n,y,Ce,ie),V.setMatrix(ie),V}static recommendVersion(i,n,a,c){const u=this.calculateBitsNeeded(n,a,c,Fe.getVersionForNumber(1)),d=this.chooseVersion(u,i),_=this.calculateBitsNeeded(n,a,c,d);return this.chooseVersion(_,i)}static calculateBitsNeeded(i,n,a,c){return n.getSize()+i.getCharacterCountBits(c)+a.getSize()}static getAlphanumericCode(i){return i<Ut.ALPHANUMERIC_TABLE.length?Ut.ALPHANUMERIC_TABLE[i]:-1}static chooseMode(i,n=null){if(de.SJIS.getName()===n&&this.isOnlyDoubleByteKanji(i))return We.KANJI;let a=!1,c=!1;for(let u=0,d=i.length;u<d;++u){const _=i.charAt(u);if(Ut.isDigit(_))a=!0;else if(this.getAlphanumericCode(_.charCodeAt(0))!==-1)c=!0;else return We.BYTE}return c?We.ALPHANUMERIC:a?We.NUMERIC:We.BYTE}static isOnlyDoubleByteKanji(i){let n;try{n=je.encode(i,de.SJIS)}catch{return!1}const a=n.length;if(a%2!==0)return!1;for(let c=0;c<a;c+=2){const u=n[c]&255;if((u<129||u>159)&&(u<224||u>235))return!1}return!0}static chooseMaskPattern(i,n,a,c){let u=Number.MAX_SAFE_INTEGER,d=-1;for(let _=0;_<kr.NUM_MASK_PATTERNS;_++){Ye.buildMatrix(i,n,a,_,c);let x=this.calculateMaskPenalty(c);x<u&&(u=x,d=_)}return d}static chooseVersion(i,n){for(let a=1;a<=40;a++){const c=Fe.getVersionForNumber(a);if(Ut.willFit(i,c,n))return c}throw new Rt("Data too big")}static willFit(i,n,a){const c=n.getTotalCodewords(),d=n.getECBlocksForLevel(a).getTotalECCodewords(),_=c-d,x=(i+7)/8;return _>=x}static terminateBits(i,n){const a=i*8;if(n.getSize()>a)throw new Rt("data bits cannot fit in the QR Code"+n.getSize()+" > "+a);for(let d=0;d<4&&n.getSize()<a;++d)n.appendBit(!1);const c=n.getSize()&7;if(c>0)for(let d=c;d<8;d++)n.appendBit(!1);const u=i-n.getSizeInBytes();for(let d=0;d<u;++d)n.appendBits((d&1)===0?236:17,8);if(n.getSize()!==a)throw new Rt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(i,n,a,c,u,d){if(c>=a)throw new Rt("Block ID too large");const _=i%a,x=a-_,y=Math.floor(i/a),E=y+1,R=Math.floor(n/a),D=R+1,I=y-R,F=E-D;if(I!==F)throw new Rt("EC bytes mismatch");if(a!==x+_)throw new Rt("RS blocks mismatch");if(i!==(R+I)*x+(D+F)*_)throw new Rt("Total bytes mismatch");c<x?(u[0]=R,d[0]=I):(u[0]=D,d[0]=F)}static interleaveWithECBytes(i,n,a,c){if(i.getSizeInBytes()!==a)throw new Rt("Number of bits and data bytes does not match");let u=0,d=0,_=0;const x=new Array;for(let E=0;E<c;++E){const R=new Int32Array(1),D=new Int32Array(1);Ut.getNumDataBytesAndNumECBytesForBlockID(n,a,c,E,R,D);const I=R[0],F=new Uint8Array(I);i.toBytes(8*u,F,0,I);const V=Ut.generateECBytes(F,D[0]);x.push(new Vh(F,V)),d=Math.max(d,I),_=Math.max(_,V.length),u+=R[0]}if(a!==u)throw new Rt("Data bytes does not match offset");const y=new le;for(let E=0;E<d;++E)for(const R of x){const D=R.getDataBytes();E<D.length&&y.appendBits(D[E],8)}for(let E=0;E<_;++E)for(const R of x){const D=R.getErrorCorrectionBytes();E<D.length&&y.appendBits(D[E],8)}if(n!==y.getSizeInBytes())throw new Rt("Interleaving error: "+n+" and "+y.getSizeInBytes()+" differ.");return y}static generateECBytes(i,n){const a=i.length,c=new Int32Array(a+n);for(let d=0;d<a;d++)c[d]=i[d]&255;new aa(ze.QR_CODE_FIELD_256).encode(c,n);const u=new Uint8Array(n);for(let d=0;d<n;d++)u[d]=c[a+d];return u}static appendModeInfo(i,n){n.appendBits(i.getBits(),4)}static appendLengthInfo(i,n,a,c){const u=a.getCharacterCountBits(n);if(i>=1<<u)throw new Rt(i+" is bigger than "+((1<<u)-1));c.appendBits(i,u)}static appendBytes(i,n,a,c){switch(n){case We.NUMERIC:Ut.appendNumericBytes(i,a);break;case We.ALPHANUMERIC:Ut.appendAlphanumericBytes(i,a);break;case We.BYTE:Ut.append8BitBytes(i,a,c);break;case We.KANJI:Ut.appendKanjiBytes(i,a);break;default:throw new Rt("Invalid mode: "+n)}}static getDigit(i){return i.charCodeAt(0)-48}static isDigit(i){const n=Ut.getDigit(i);return n>=0&&n<=9}static appendNumericBytes(i,n){const a=i.length;let c=0;for(;c<a;){const u=Ut.getDigit(i.charAt(c));if(c+2<a){const d=Ut.getDigit(i.charAt(c+1)),_=Ut.getDigit(i.charAt(c+2));n.appendBits(u*100+d*10+_,10),c+=3}else if(c+1<a){const d=Ut.getDigit(i.charAt(c+1));n.appendBits(u*10+d,7),c+=2}else n.appendBits(u,4),c++}}static appendAlphanumericBytes(i,n){const a=i.length;let c=0;for(;c<a;){const u=Ut.getAlphanumericCode(i.charCodeAt(c));if(u===-1)throw new Rt;if(c+1<a){const d=Ut.getAlphanumericCode(i.charCodeAt(c+1));if(d===-1)throw new Rt;n.appendBits(u*45+d,11),c+=2}else n.appendBits(u,6),c++}}static append8BitBytes(i,n,a){let c;try{c=je.encode(i,a)}catch(u){throw new Rt(u)}for(let u=0,d=c.length;u!==d;u++){const _=c[u];n.appendBits(_,8)}}static appendKanjiBytes(i,n){let a;try{a=je.encode(i,de.SJIS)}catch(u){throw new Rt(u)}const c=a.length;for(let u=0;u<c;u+=2){const d=a[u]&255,_=a[u+1]&255,x=d<<8&4294967295|_;let y=-1;if(x>=33088&&x<=40956?y=x-33088:x>=57408&&x<=60351&&(y=x-49472),y===-1)throw new Rt("Invalid byte sequence");const E=(y>>8)*192+(y&255);n.appendBits(E,13)}}static appendECI(i,n){n.appendBits(We.ECI.getBits(),4),n.appendBits(i.getValue(),8)}}Ut.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Ut.DEFAULT_BYTE_MODE_ENCODING=de.UTF8.getName();class Lr{write(i,n,a,c=null){if(i.length===0)throw new N("Found empty contents");if(n<0||a<0)throw new N("Requested dimensions are too small: "+n+"x"+a);let u=nt.L,d=Lr.QUIET_ZONE_SIZE;c!==null&&(c.get(_i.ERROR_CORRECTION)!==void 0&&(u=nt.fromString(c.get(_i.ERROR_CORRECTION).toString())),c.get(_i.MARGIN)!==void 0&&(d=Number.parseInt(c.get(_i.MARGIN).toString(),10)));const _=Ut.encode(i,u,c);return this.renderResult(_,n,a,d)}writeToDom(i,n,a,c,u=null){typeof i=="string"&&(i=document.querySelector(i));const d=this.write(n,a,c,u);i&&i.appendChild(d)}renderResult(i,n,a,c){const u=i.getMatrix();if(u===null)throw new fs;const d=u.getWidth(),_=u.getHeight(),x=d+c*2,y=_+c*2,E=Math.max(n,x),R=Math.max(a,y),D=Math.min(Math.floor(E/x),Math.floor(R/y)),I=Math.floor((E-d*D)/2),F=Math.floor((R-_*D)/2),V=this.createSVGElement(E,R);for(let q=0,ie=F;q<_;q++,ie+=D)for(let Ce=0,we=I;Ce<d;Ce++,we+=D)if(u.get(Ce,q)===1){const ve=this.createSvgRectElement(we,ie,D,D);V.appendChild(ve)}return V}createSVGElement(i,n){const a=document.createElementNS(Lr.SVG_NS,"svg");return a.setAttributeNS(null,"height",i.toString()),a.setAttributeNS(null,"width",n.toString()),a}createSvgRectElement(i,n,a,c){const u=document.createElementNS(Lr.SVG_NS,"rect");return u.setAttributeNS(null,"x",i.toString()),u.setAttributeNS(null,"y",n.toString()),u.setAttributeNS(null,"height",a.toString()),u.setAttributeNS(null,"width",c.toString()),u.setAttributeNS(null,"fill","#000000"),u}}Lr.QUIET_ZONE_SIZE=4,Lr.SVG_NS="http://www.w3.org/2000/svg";class vn{encode(i,n,a,c,u){if(i.length===0)throw new N("Found empty contents");if(n!==Se.QR_CODE)throw new N("Can only encode QR_CODE, but got "+n);if(a<0||c<0)throw new N(`Requested dimensions are too small: ${a}x${c}`);let d=nt.L,_=vn.QUIET_ZONE_SIZE;u!==null&&(u.get(_i.ERROR_CORRECTION)!==void 0&&(d=nt.fromString(u.get(_i.ERROR_CORRECTION).toString())),u.get(_i.MARGIN)!==void 0&&(_=Number.parseInt(u.get(_i.MARGIN).toString(),10)));const x=Ut.encode(i,d,u);return vn.renderResult(x,a,c,_)}static renderResult(i,n,a,c){const u=i.getMatrix();if(u===null)throw new fs;const d=u.getWidth(),_=u.getHeight(),x=d+c*2,y=_+c*2,E=Math.max(n,x),R=Math.max(a,y),D=Math.min(Math.floor(E/x),Math.floor(R/y)),I=Math.floor((E-d*D)/2),F=Math.floor((R-_*D)/2),V=new Ee(E,R);for(let q=0,ie=F;q<_;q++,ie+=D)for(let Ce=0,we=I;Ce<d;Ce++,we+=D)u.get(Ce,q)===1&&V.setRegion(we,ie,D,D);return V}}vn.QUIET_ZONE_SIZE=4;class Wh{encode(i,n,a,c,u){let d;if(n===Se.QR_CODE)d=new vn;else throw new N("No encoder available for format "+n);return d.encode(i,n,a,c,u)}}class Xs extends ue{constructor(i,n,a,c,u,d,_,x){if(super(d,_),this.yuvData=i,this.dataWidth=n,this.dataHeight=a,this.left=c,this.top=u,c+d>n||u+_>a)throw new N("Crop rectangle does not fit within image data.");x&&this.reverseHorizontal(d,_)}getRow(i,n){if(i<0||i>=this.getHeight())throw new N("Requested row is outside the image: "+i);const a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));const c=(i+this.top)*this.dataWidth+this.left;return X.arraycopy(this.yuvData,c,n,0,a),n}getMatrix(){const i=this.getWidth(),n=this.getHeight();if(i===this.dataWidth&&n===this.dataHeight)return this.yuvData;const a=i*n,c=new Uint8ClampedArray(a);let u=this.top*this.dataWidth+this.left;if(i===this.dataWidth)return X.arraycopy(this.yuvData,u,c,0,a),c;for(let d=0;d<n;d++){const _=d*i;X.arraycopy(this.yuvData,u,c,_,i),u+=this.dataWidth}return c}isCropSupported(){return!0}crop(i,n,a,c){return new Xs(this.yuvData,this.dataWidth,this.dataHeight,this.left+i,this.top+n,a,c,!1)}renderThumbnail(){const i=this.getWidth()/Xs.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/Xs.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(i*n),c=this.yuvData;let u=this.top*this.dataWidth+this.left;for(let d=0;d<n;d++){const _=d*i;for(let x=0;x<i;x++){const y=c[u+x*Xs.THUMBNAIL_SCALE_FACTOR]&255;a[_+x]=4278190080|y*65793}u+=this.dataWidth*Xs.THUMBNAIL_SCALE_FACTOR}return a}getThumbnailWidth(){return this.getWidth()/Xs.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Xs.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(i,n){const a=this.yuvData;for(let c=0,u=this.top*this.dataWidth+this.left;c<n;c++,u+=this.dataWidth){const d=u+i/2;for(let _=u,x=u+i-1;_<d;_++,x--){const y=a[_];a[_]=a[x],a[x]=y}}}invert(){return new Le(this)}}Xs.THUMBNAIL_SCALE_FACTOR=2;class Hl extends ue{constructor(i,n,a,c,u,d,_){if(super(n,a),this.dataWidth=c,this.dataHeight=u,this.left=d,this.top=_,i.BYTES_PER_ELEMENT===4){const x=n*a,y=new Uint8ClampedArray(x);for(let E=0;E<x;E++){const R=i[E],D=R>>16&255,I=R>>7&510,F=R&255;y[E]=(D+I+F)/4&255}this.luminances=y}else this.luminances=i;if(c===void 0&&(this.dataWidth=n),u===void 0&&(this.dataHeight=a),d===void 0&&(this.left=0),_===void 0&&(this.top=0),this.left+n>this.dataWidth||this.top+a>this.dataHeight)throw new N("Crop rectangle does not fit within image data.")}getRow(i,n){if(i<0||i>=this.getHeight())throw new N("Requested row is outside the image: "+i);const a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));const c=(i+this.top)*this.dataWidth+this.left;return X.arraycopy(this.luminances,c,n,0,a),n}getMatrix(){const i=this.getWidth(),n=this.getHeight();if(i===this.dataWidth&&n===this.dataHeight)return this.luminances;const a=i*n,c=new Uint8ClampedArray(a);let u=this.top*this.dataWidth+this.left;if(i===this.dataWidth)return X.arraycopy(this.luminances,u,c,0,a),c;for(let d=0;d<n;d++){const _=d*i;X.arraycopy(this.luminances,u,c,_,i),u+=this.dataWidth}return c}isCropSupported(){return!0}crop(i,n,a,c){return new Hl(this.luminances,a,c,this.dataWidth,this.dataHeight,this.left+i,this.top+n)}invert(){return new Le(this)}}class $o extends de{static forName(i){return this.getCharacterSetECIByName(i)}}class la{}la.ISO_8859_1=de.ISO8859_1;class Sn{isCompact(){return this.compact}setCompact(i){this.compact=i}getSize(){return this.size}setSize(i){this.size=i}getLayers(){return this.layers}setLayers(i){this.layers=i}getCodeWords(){return this.codeWords}setCodeWords(i){this.codeWords=i}getMatrix(){return this.matrix}setMatrix(i){this.matrix=i}}class ec{static singletonList(i){return[i]}static min(i,n){return i.sort(n)[0]}}class tc{constructor(i){this.previous=i}getPrevious(){return this.previous}}class Pr extends tc{constructor(i,n,a){super(i),this.value=n,this.bitCount=a}appendTo(i,n){i.appendBits(this.value,this.bitCount)}add(i,n){return new Pr(this,i,n)}addBinaryShift(i,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Pr(this,i,n)}toString(){let i=this.value&(1<<this.bitCount)-1;return i|=1<<this.bitCount,"<"+te.toBinaryString(i|1<<this.bitCount).substring(1)+">"}}class Xa extends Pr{constructor(i,n,a){super(i,0,0),this.binaryShiftStart=n,this.binaryShiftByteCount=a}appendTo(i,n){for(let a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(i.appendBits(31,5),this.binaryShiftByteCount>62?i.appendBits(this.binaryShiftByteCount-31,16):a===0?i.appendBits(Math.min(this.binaryShiftByteCount,31),5):i.appendBits(this.binaryShiftByteCount-31,5)),i.appendBits(n[this.binaryShiftStart+a],8)}addBinaryShift(i,n){return new Xa(this,i,n)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function ic(T,i,n){return new Xa(T,i,n)}function yn(T,i,n){return new Pr(T,i,n)}const wn=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],yr=0,Ya=1,ms=2,zl=3,Ns=4,oa=new Pr(null,0,0),Hr=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Gh(T){for(let i of T)he.fill(i,-1);return T[yr][Ns]=0,T[Ya][Ns]=0,T[Ya][yr]=28,T[zl][Ns]=0,T[ms][Ns]=0,T[ms][yr]=15,T}const ca=Gh(he.createInt32Array(6,6));class Ds{constructor(i,n,a,c){this.token=i,this.mode=n,this.binaryShiftByteCount=a,this.bitCount=c}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(i,n){let a=this.bitCount,c=this.token;if(i!==this.mode){let d=Hr[this.mode][i];c=yn(c,d&65535,d>>16),a+=d>>16}let u=i===ms?4:5;return c=yn(c,n,u),new Ds(c,i,0,a+u)}shiftAndAppend(i,n){let a=this.token,c=this.mode===ms?4:5;return a=yn(a,ca[this.mode][i],c),a=yn(a,n,5),new Ds(a,this.mode,0,this.bitCount+c+5)}addBinaryShiftChar(i){let n=this.token,a=this.mode,c=this.bitCount;if(this.mode===Ns||this.mode===ms){let _=Hr[a][yr];n=yn(n,_&65535,_>>16),c+=_>>16,a=yr}let u=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,d=new Ds(n,a,this.binaryShiftByteCount+1,c+u);return d.binaryShiftByteCount===2078&&(d=d.endBinaryShift(i+1)),d}endBinaryShift(i){if(this.binaryShiftByteCount===0)return this;let n=this.token;return n=ic(n,i-this.binaryShiftByteCount,this.binaryShiftByteCount),new Ds(n,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(i){let n=this.bitCount+(Hr[this.mode][i.mode]>>16);return this.binaryShiftByteCount<i.binaryShiftByteCount?n+=Ds.calculateBinaryShiftCost(i)-Ds.calculateBinaryShiftCost(this):this.binaryShiftByteCount>i.binaryShiftByteCount&&i.binaryShiftByteCount>0&&(n+=10),n<=i.bitCount}toBitArray(i){let n=[];for(let c=this.endBinaryShift(i.length).token;c!==null;c=c.getPrevious())n.unshift(c);let a=new le;for(const c of n)c.appendTo(a,i);return a}toString(){return oe.format("%s bits=%d bytes=%d",wn[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(i){return i.binaryShiftByteCount>62?21:i.binaryShiftByteCount>31?20:i.binaryShiftByteCount>0?10:0}}Ds.INITIAL_STATE=new Ds(oa,yr,0,0);function sc(T){const i=oe.getCharCode(" "),n=oe.getCharCode("."),a=oe.getCharCode(",");T[yr][i]=1;const c=oe.getCharCode("Z"),u=oe.getCharCode("A");for(let D=u;D<=c;D++)T[yr][D]=D-u+2;T[Ya][i]=1;const d=oe.getCharCode("z"),_=oe.getCharCode("a");for(let D=_;D<=d;D++)T[Ya][D]=D-_+2;T[ms][i]=1;const x=oe.getCharCode("9"),y=oe.getCharCode("0");for(let D=y;D<=x;D++)T[ms][D]=D-y+2;T[ms][a]=12,T[ms][n]=13;const E=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let D=0;D<E.length;D++)T[zl][oe.getCharCode(E[D])]=D;const R=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let D=0;D<R.length;D++)oe.getCharCode(R[D])>0&&(T[Ns][oe.getCharCode(R[D])]=D);return T}const ha=sc(he.createInt32Array(5,256));class zr{constructor(i){this.text=i}encode(){const i=oe.getCharCode(" "),n=oe.getCharCode(`
`);let a=ec.singletonList(Ds.INITIAL_STATE);for(let u=0;u<this.text.length;u++){let d,_=u+1<this.text.length?this.text[u+1]:0;switch(this.text[u]){case oe.getCharCode("\r"):d=_===n?2:0;break;case oe.getCharCode("."):d=_===i?3:0;break;case oe.getCharCode(","):d=_===i?4:0;break;case oe.getCharCode(":"):d=_===i?5:0;break;default:d=0}d>0?(a=zr.updateStateListForPair(a,u,d),u++):a=this.updateStateListForChar(a,u)}return ec.min(a,(u,d)=>u.getBitCount()-d.getBitCount()).toBitArray(this.text)}updateStateListForChar(i,n){const a=[];for(let c of i)this.updateStateForChar(c,n,a);return zr.simplifyStates(a)}updateStateForChar(i,n,a){let c=this.text[n]&255,u=ha[i.getMode()][c]>0,d=null;for(let _=0;_<=Ns;_++){let x=ha[_][c];if(x>0){if(d==null&&(d=i.endBinaryShift(n)),!u||_===i.getMode()||_===ms){const y=d.latchAndAppend(_,x);a.push(y)}if(!u&&ca[i.getMode()][_]>=0){const y=d.shiftAndAppend(_,x);a.push(y)}}}if(i.getBinaryShiftByteCount()>0||ha[i.getMode()][c]===0){let _=i.addBinaryShiftChar(n);a.push(_)}}static updateStateListForPair(i,n,a){const c=[];for(let u of i)this.updateStateForPair(u,n,a,c);return this.simplifyStates(c)}static updateStateForPair(i,n,a,c){let u=i.endBinaryShift(n);if(c.push(u.latchAndAppend(Ns,a)),i.getMode()!==Ns&&c.push(u.shiftAndAppend(Ns,a)),a===3||a===4){let d=u.latchAndAppend(ms,16-a).latchAndAppend(ms,1);c.push(d)}if(i.getBinaryShiftByteCount()>0){let d=i.addBinaryShiftChar(n).addBinaryShiftChar(n+1);c.push(d)}}static simplifyStates(i){let n=[];for(const a of i){let c=!0;for(const u of n){if(u.isBetterThanOrEqualTo(a)){c=!1;break}a.isBetterThanOrEqualTo(u)&&(n=n.filter(d=>d!==u))}c&&n.push(a)}return n}}class _t{constructor(){}static encodeBytes(i){return _t.encode(i,_t.DEFAULT_EC_PERCENT,_t.DEFAULT_AZTEC_LAYERS)}static encode(i,n,a){let c=new zr(i).encode(),u=te.truncDivision(c.getSize()*n,100)+11,d=c.getSize()+u,_,x,y,E,R;if(a!==_t.DEFAULT_AZTEC_LAYERS){if(_=a<0,x=Math.abs(a),x>(_?_t.MAX_NB_BITS_COMPACT:_t.MAX_NB_BITS))throw new N(oe.format("Illegal value %s for layers",a));y=_t.totalBitsInLayer(x,_),E=_t.WORD_SIZE[x];let ve=y-y%E;if(R=_t.stuffBits(c,E),R.getSize()+u>ve)throw new N("Data to large for user specified layer");if(_&&R.getSize()>E*64)throw new N("Data to large for user specified layer")}else{E=0,R=null;for(let ve=0;;ve++){if(ve>_t.MAX_NB_BITS)throw new N("Data too large for an Aztec code");if(_=ve<=3,x=_?ve+1:ve,y=_t.totalBitsInLayer(x,_),d>y)continue;(R==null||E!==_t.WORD_SIZE[x])&&(E=_t.WORD_SIZE[x],R=_t.stuffBits(c,E));let rt=y-y%E;if(!(_&&R.getSize()>E*64)&&R.getSize()+u<=rt)break}}let D=_t.generateCheckWords(R,y,E),I=R.getSize()/E,F=_t.generateModeMessage(_,x,I),V=(_?11:14)+x*4,q=new Int32Array(V),ie;if(_){ie=V;for(let ve=0;ve<q.length;ve++)q[ve]=ve}else{ie=V+1+2*te.truncDivision(te.truncDivision(V,2)-1,15);let ve=te.truncDivision(V,2),rt=te.truncDivision(ie,2);for(let Qe=0;Qe<ve;Qe++){let li=Qe+te.truncDivision(Qe,15);q[ve-Qe-1]=rt-li-1,q[ve+Qe]=rt+li+1}}let Ce=new Ee(ie);for(let ve=0,rt=0;ve<x;ve++){let Qe=(x-ve)*4+(_?9:12);for(let li=0;li<Qe;li++){let ps=li*2;for(let ji=0;ji<2;ji++)D.get(rt+ps+ji)&&Ce.set(q[ve*2+ji],q[ve*2+li]),D.get(rt+Qe*2+ps+ji)&&Ce.set(q[ve*2+li],q[V-1-ve*2-ji]),D.get(rt+Qe*4+ps+ji)&&Ce.set(q[V-1-ve*2-ji],q[V-1-ve*2-li]),D.get(rt+Qe*6+ps+ji)&&Ce.set(q[V-1-ve*2-li],q[ve*2+ji])}rt+=Qe*8}if(_t.drawModeMessage(Ce,_,ie,F),_)_t.drawBullsEye(Ce,te.truncDivision(ie,2),5);else{_t.drawBullsEye(Ce,te.truncDivision(ie,2),7);for(let ve=0,rt=0;ve<te.truncDivision(V,2)-1;ve+=15,rt+=16)for(let Qe=te.truncDivision(ie,2)&1;Qe<ie;Qe+=2)Ce.set(te.truncDivision(ie,2)-rt,Qe),Ce.set(te.truncDivision(ie,2)+rt,Qe),Ce.set(Qe,te.truncDivision(ie,2)-rt),Ce.set(Qe,te.truncDivision(ie,2)+rt)}let we=new Sn;return we.setCompact(_),we.setSize(ie),we.setLayers(x),we.setCodeWords(I),we.setMatrix(Ce),we}static drawBullsEye(i,n,a){for(let c=0;c<a;c+=2)for(let u=n-c;u<=n+c;u++)i.set(u,n-c),i.set(u,n+c),i.set(n-c,u),i.set(n+c,u);i.set(n-a,n-a),i.set(n-a+1,n-a),i.set(n-a,n-a+1),i.set(n+a,n-a),i.set(n+a,n-a+1),i.set(n+a,n+a-1)}static generateModeMessage(i,n,a){let c=new le;return i?(c.appendBits(n-1,2),c.appendBits(a-1,6),c=_t.generateCheckWords(c,28,4)):(c.appendBits(n-1,5),c.appendBits(a-1,11),c=_t.generateCheckWords(c,40,4)),c}static drawModeMessage(i,n,a,c){let u=te.truncDivision(a,2);if(n)for(let d=0;d<7;d++){let _=u-3+d;c.get(d)&&i.set(_,u-5),c.get(d+7)&&i.set(u+5,_),c.get(20-d)&&i.set(_,u+5),c.get(27-d)&&i.set(u-5,_)}else for(let d=0;d<10;d++){let _=u-5+d+te.truncDivision(d,5);c.get(d)&&i.set(_,u-7),c.get(d+10)&&i.set(u+7,_),c.get(29-d)&&i.set(_,u+7),c.get(39-d)&&i.set(u-7,_)}}static generateCheckWords(i,n,a){let c=i.getSize()/a,u=new aa(_t.getGF(a)),d=te.truncDivision(n,a),_=_t.bitsToWords(i,a,d);u.encode(_,d-c);let x=n%a,y=new le;y.appendBits(0,x);for(const E of Array.from(_))y.appendBits(E,a);return y}static bitsToWords(i,n,a){let c=new Int32Array(a),u,d;for(u=0,d=i.getSize()/n;u<d;u++){let _=0;for(let x=0;x<n;x++)_|=i.get(u*n+x)?1<<n-x-1:0;c[u]=_}return c}static getGF(i){switch(i){case 4:return ze.AZTEC_PARAM;case 6:return ze.AZTEC_DATA_6;case 8:return ze.AZTEC_DATA_8;case 10:return ze.AZTEC_DATA_10;case 12:return ze.AZTEC_DATA_12;default:throw new N("Unsupported word size "+i)}}static stuffBits(i,n){let a=new le,c=i.getSize(),u=(1<<n)-2;for(let d=0;d<c;d+=n){let _=0;for(let x=0;x<n;x++)(d+x>=c||i.get(d+x))&&(_|=1<<n-1-x);(_&u)===u?(a.appendBits(_&u,n),d--):(_&u)===0?(a.appendBits(_|1,n),d--):a.appendBits(_,n)}return a}static totalBitsInLayer(i,n){return((n?88:112)+16*i)*i}}_t.DEFAULT_EC_PERCENT=33,_t.DEFAULT_AZTEC_LAYERS=0,_t.MAX_NB_BITS=32,_t.MAX_NB_BITS_COMPACT=4,_t.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class ua{encode(i,n,a,c){return this.encodeWithHints(i,n,a,c,null)}encodeWithHints(i,n,a,c,u){let d=la.ISO_8859_1,_=_t.DEFAULT_EC_PERCENT,x=_t.DEFAULT_AZTEC_LAYERS;return u!=null&&(u.has(_i.CHARACTER_SET)&&(d=$o.forName(u.get(_i.CHARACTER_SET).toString())),u.has(_i.ERROR_CORRECTION)&&(_=te.parseInt(u.get(_i.ERROR_CORRECTION).toString())),u.has(_i.AZTEC_LAYERS)&&(x=te.parseInt(u.get(_i.AZTEC_LAYERS).toString()))),ua.encodeLayers(i,n,a,c,d,_,x)}static encodeLayers(i,n,a,c,u,d,_){if(n!==Se.AZTEC)throw new N("Can only encode AZTEC, but got "+n);let x=_t.encode(oe.getBytes(i,u),d,_);return ua.renderResult(x,a,c)}static renderResult(i,n,a){let c=i.getMatrix();if(c==null)throw new fs;let u=c.getWidth(),d=c.getHeight(),_=Math.max(n,u),x=Math.max(a,d),y=Math.min(_/u,x/d),E=(_-u*y)/2,R=(x-d*y)/2,D=new Ee(_,x);for(let I=0,F=R;I<d;I++,F+=y)for(let V=0,q=E;V<u;V++,q+=y)c.get(V,I)&&D.setRegion(q,F,y,y);return D}}l.AbstractExpandedDecoder=di,l.ArgumentException=M,l.ArithmeticException=Gi,l.AztecCode=Sn,l.AztecCodeReader=ka,l.AztecCodeWriter=ua,l.AztecDecoder=Dt,l.AztecDetector=Rl,l.AztecDetectorResult=Wo,l.AztecEncoder=_t,l.AztecHighLevelEncoder=zr,l.AztecPoint=Xi,l.BarcodeFormat=Se,l.Binarizer=L,l.BinaryBitmap=k,l.BitArray=le,l.BitMatrix=Ee,l.BitSource=Ts,l.BrowserAztecCodeReader=Lh,l.BrowserBarcodeReader=Ph,l.BrowserCodeReader=ye,l.BrowserDatamatrixCodeReader=Ha,l.BrowserMultiFormatReader=Jo,l.BrowserPDF417Reader=Fh,l.BrowserQRCodeReader=Uh,l.BrowserQRCodeSvgWriter=Lr,l.CharacterSetECI=de,l.ChecksumException=P,l.Code128Reader=Ae,l.Code39Reader=It,l.DataMatrixDecodedBitStreamParser=ar,l.DataMatrixReader=lr,l.DecodeHintType=Re,l.DecoderResult=dt,l.DefaultGridSampler=Tl,l.DetectorResult=Ia,l.EAN13Reader=Us,l.EncodeHintType=_i,l.Exception=S,l.FormatException=Y,l.GenericGF=ze,l.GenericGFPoly=Xt,l.GlobalHistogramBinarizer=W,l.GridSampler=Al,l.GridSamplerInstance=Cs,l.HTMLCanvasElementLuminanceSource=Me,l.HybridBinarizer=Z,l.ITFReader=tt,l.IllegalArgumentException=N,l.IllegalStateException=fs,l.InvertedLuminanceSource=Le,l.LuminanceSource=ue,l.MathUtils=ct,l.MultiFormatOneDReader=As,l.MultiFormatReader=Qo,l.MultiFormatWriter=Wh,l.NotFoundException=U,l.OneDReader=Wt,l.PDF417DecodedBitStreamParser=se,l.PDF417DecoderErrorCorrection=cr,l.PDF417Reader=Di,l.PDF417ResultMetadata=xn,l.PerspectiveTransform=ds,l.PlanarYUVLuminanceSource=Xs,l.QRCodeByteMatrix=Ga,l.QRCodeDataMask=ns,l.QRCodeDecodedBitStreamParser=zt,l.QRCodeDecoderErrorCorrectionLevel=nt,l.QRCodeDecoderFormatInformation=vi,l.QRCodeEncoder=Ut,l.QRCodeEncoderQRCode=kr,l.QRCodeMaskUtil=Jt,l.QRCodeMatrixUtil=Ye,l.QRCodeMode=We,l.QRCodeReader=or,l.QRCodeVersion=Fe,l.QRCodeWriter=vn,l.RGBLuminanceSource=Hl,l.RSS14Reader=Tt,l.RSSExpandedReader=xe,l.ReaderException=Wa,l.ReedSolomonDecoder=Br,l.ReedSolomonEncoder=aa,l.ReedSolomonException=Li,l.Result=be,l.ResultMetadataType=ot,l.ResultPoint=Pe,l.StringUtils=oe,l.UnsupportedOperationException=Gt,l.VideoInputDevice=H,l.WhiteRectangleDetector=ti,l.WriterException=Rt,l.ZXingArrays=he,l.ZXingCharset=$o,l.ZXingInteger=te,l.ZXingStandardCharsets=la,l.ZXingStringBuilder=ae,l.ZXingStringEncoding=je,l.ZXingSystem=X,l.createAbstractExpandedDecoder=un,Object.defineProperty(l,"__esModule",{value:!0})}))})(Ro,Ro.exports)),Ro.exports}var ii=Ox();const Mx=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var g_=(function(){function e(s,l,h){if(this.formatMap=new Map([[ke.QR_CODE,ii.BarcodeFormat.QR_CODE],[ke.AZTEC,ii.BarcodeFormat.AZTEC],[ke.CODABAR,ii.BarcodeFormat.CODABAR],[ke.CODE_39,ii.BarcodeFormat.CODE_39],[ke.CODE_93,ii.BarcodeFormat.CODE_93],[ke.CODE_128,ii.BarcodeFormat.CODE_128],[ke.DATA_MATRIX,ii.BarcodeFormat.DATA_MATRIX],[ke.MAXICODE,ii.BarcodeFormat.MAXICODE],[ke.ITF,ii.BarcodeFormat.ITF],[ke.EAN_13,ii.BarcodeFormat.EAN_13],[ke.EAN_8,ii.BarcodeFormat.EAN_8],[ke.PDF_417,ii.BarcodeFormat.PDF_417],[ke.RSS_14,ii.BarcodeFormat.RSS_14],[ke.RSS_EXPANDED,ii.BarcodeFormat.RSS_EXPANDED],[ke.UPC_A,ii.BarcodeFormat.UPC_A],[ke.UPC_E,ii.BarcodeFormat.UPC_E],[ke.UPC_EAN_EXTENSION,ii.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!Mx)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=l,this.logger=h;var g=this.createZXingFormats(s),m=new Map;m.set(ii.DecodeHintType.POSSIBLE_FORMATS,g),m.set(ii.DecodeHintType.TRY_HARDER,!1),this.hints=m}return e.prototype.decodeAsync=function(s){var l=this;return new Promise(function(h,g){try{h(l.decode(s))}catch(m){g(m)}})},e.prototype.decode=function(s){var l=new ii.MultiFormatReader(this.verbose,this.hints),h=new ii.HTMLCanvasElementLuminanceSource(s),g=new ii.BinaryBitmap(new ii.HybridBinarizer(h)),m=l.decode(g);return{text:m.text,format:T2.create(this.toHtml5QrcodeSupportedFormats(m.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(l,h,g){s.set(l,h)}),s},e.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have ".concat(s);return this.reverseFormatMap.get(s)},e.prototype.createZXingFormats=function(s){for(var l=[],h=0,g=s;h<g.length;h++){var m=g[h];this.formatMap.has(m)?l.push(this.formatMap.get(m)):this.logger.logError("".concat(m," is not supported by")+"ZXingHtml5QrcodeShim")}return l},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e})(),Bx=function(e,s,l,h){function g(m){return m instanceof l?m:new l(function(w){w(m)})}return new(l||(l=Promise))(function(m,w){function b(M){try{S(h.next(M))}catch(N){w(N)}}function C(M){try{S(h.throw(M))}catch(N){w(N)}}function S(M){M.done?m(M.value):g(M.value).then(b,C)}S((h=h.apply(e,s||[])).next())})},Ix=function(e,s){var l={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},h,g,m,w;return w={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function b(S){return function(M){return C([S,M])}}function C(S){if(h)throw new TypeError("Generator is already executing.");for(;w&&(w=0,S[0]&&(l=0)),l;)try{if(h=1,g&&(m=S[0]&2?g.return:S[0]?g.throw||((m=g.return)&&m.call(g),0):g.next)&&!(m=m.call(g,S[1])).done)return m;switch(g=0,m&&(S=[S[0]&2,m.value]),S[0]){case 0:case 1:m=S;break;case 4:return l.label++,{value:S[1],done:!1};case 5:l.label++,g=S[1],S=[0];continue;case 7:S=l.ops.pop(),l.trys.pop();continue;default:if(m=l.trys,!(m=m.length>0&&m[m.length-1])&&(S[0]===6||S[0]===2)){l=0;continue}if(S[0]===3&&(!m||S[1]>m[0]&&S[1]<m[3])){l.label=S[1];break}if(S[0]===6&&l.label<m[1]){l.label=m[1],m=S;break}if(m&&l.label<m[2]){l.label=m[2],l.ops.push(S);break}m[2]&&l.ops.pop(),l.trys.pop();continue}S=s.call(e,l)}catch(M){S=[6,M],g=0}finally{h=m=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},__=(function(){function e(s,l,h){if(this.formatMap=new Map([[ke.QR_CODE,"qr_code"],[ke.AZTEC,"aztec"],[ke.CODABAR,"codabar"],[ke.CODE_39,"code_39"],[ke.CODE_93,"code_93"],[ke.CODE_128,"code_128"],[ke.DATA_MATRIX,"data_matrix"],[ke.ITF,"itf"],[ke.EAN_13,"ean_13"],[ke.EAN_8,"ean_8"],[ke.PDF_417,"pdf417"],[ke.UPC_A,"upc_a"],[ke.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=l,this.logger=h;var g=this.createBarcodeDetectorFormats(s);if(this.detector=new BarcodeDetector(g),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var s=new BarcodeDetector({formats:["qr_code"]});return typeof s<"u"},e.prototype.decodeAsync=function(s){return Bx(this,void 0,void 0,function(){var l,h;return Ix(this,function(g){switch(g.label){case 0:return[4,this.detector.detect(s)];case 1:if(l=g.sent(),!l||l.length===0)throw"No barcode or QR code detected.";return h=this.selectLargestBarcode(l),[2,{text:h.rawValue,format:T2.create(this.toHtml5QrcodeSupportedFormats(h.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(s){for(var l=null,h=0,g=0,m=s;g<m.length;g++){var w=m[g],b=w.boundingBox.width*w.boundingBox.height;b>h&&(h=b,l=w)}if(!l)throw"No largest barcode found";return l},e.prototype.createBarcodeDetectorFormats=function(s){for(var l=[],h=0,g=s;h<g.length;h++){var m=g[h];this.formatMap.has(m)?l.push(this.formatMap.get(m)):this.logger.warn("".concat(m," is not supported by")+"BarcodeDetectorDelegate")}return{formats:l}},e.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have ".concat(s);return this.reverseFormatMap.get(s)},e.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(l,h,g){s.set(l,h)}),s},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e})(),m_=function(e,s,l,h){function g(m){return m instanceof l?m:new l(function(w){w(m)})}return new(l||(l=Promise))(function(m,w){function b(M){try{S(h.next(M))}catch(N){w(N)}}function C(M){try{S(h.throw(M))}catch(N){w(N)}}function S(M){M.done?m(M.value):g(M.value).then(b,C)}S((h=h.apply(e,s||[])).next())})},p_=function(e,s){var l={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},h,g,m,w;return w={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function b(S){return function(M){return C([S,M])}}function C(S){if(h)throw new TypeError("Generator is already executing.");for(;w&&(w=0,S[0]&&(l=0)),l;)try{if(h=1,g&&(m=S[0]&2?g.return:S[0]?g.throw||((m=g.return)&&m.call(g),0):g.next)&&!(m=m.call(g,S[1])).done)return m;switch(g=0,m&&(S=[S[0]&2,m.value]),S[0]){case 0:case 1:m=S;break;case 4:return l.label++,{value:S[1],done:!1};case 5:l.label++,g=S[1],S=[0];continue;case 7:S=l.ops.pop(),l.trys.pop();continue;default:if(m=l.trys,!(m=m.length>0&&m[m.length-1])&&(S[0]===6||S[0]===2)){l=0;continue}if(S[0]===3&&(!m||S[1]>m[0]&&S[1]<m[3])){l.label=S[1];break}if(S[0]===6&&l.label<m[1]){l.label=m[1],m=S;break}if(m&&l.label<m[2]){l.label=m[2],l.ops.push(S);break}m[2]&&l.ops.pop(),l.trys.pop();continue}S=s.call(e,l)}catch(M){S=[6,M],g=0}finally{h=m=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},kx=(function(){function e(s,l,h,g){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=h,l&&__.isSupported()?(this.primaryDecoder=new __(s,h,g),this.secondaryDecoder=new g_(s,h,g)):this.primaryDecoder=new g_(s,h,g)}return e.prototype.decodeAsync=function(s){return m_(this,void 0,void 0,function(){var l;return p_(this,function(h){switch(h.label){case 0:l=performance.now(),h.label=1;case 1:return h.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(s)];case 2:return[2,h.sent()];case 3:return this.possiblyLogPerformance(l),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(s){return m_(this,void 0,void 0,function(){var l,h;return p_(this,function(g){switch(g.label){case 0:l=performance.now(),g.label=1;case 1:return g.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(s)];case 2:return[2,g.sent()];case 3:if(h=g.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(s)];throw h;case 4:return this.possiblyLogPerformance(l),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(s){if(this.verbose){var l=performance.now()-s;this.executionResults.push(l),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var s=0,l=0,h=this.executionResults;l<h.length;l++){var g=h[l];s+=g}var m=s/this.executionResults.length;console.log("".concat(m," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e})(),Fd=(function(){var e=function(s,l){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,g){h.__proto__=g}||function(h,g){for(var m in g)Object.prototype.hasOwnProperty.call(g,m)&&(h[m]=g[m])},e(s,l)};return function(s,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");e(s,l);function h(){this.constructor=s}s.prototype=l===null?Object.create(l):(h.prototype=l.prototype,new h)}})(),wh=function(e,s,l,h){function g(m){return m instanceof l?m:new l(function(w){w(m)})}return new(l||(l=Promise))(function(m,w){function b(M){try{S(h.next(M))}catch(N){w(N)}}function C(M){try{S(h.throw(M))}catch(N){w(N)}}function S(M){M.done?m(M.value):g(M.value).then(b,C)}S((h=h.apply(e,s||[])).next())})},bh=function(e,s){var l={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},h,g,m,w;return w={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function b(S){return function(M){return C([S,M])}}function C(S){if(h)throw new TypeError("Generator is already executing.");for(;w&&(w=0,S[0]&&(l=0)),l;)try{if(h=1,g&&(m=S[0]&2?g.return:S[0]?g.throw||((m=g.return)&&m.call(g),0):g.next)&&!(m=m.call(g,S[1])).done)return m;switch(g=0,m&&(S=[S[0]&2,m.value]),S[0]){case 0:case 1:m=S;break;case 4:return l.label++,{value:S[1],done:!1};case 5:l.label++,g=S[1],S=[0];continue;case 7:S=l.ops.pop(),l.trys.pop();continue;default:if(m=l.trys,!(m=m.length>0&&m[m.length-1])&&(S[0]===6||S[0]===2)){l=0;continue}if(S[0]===3&&(!m||S[1]>m[0]&&S[1]<m[3])){l.label=S[1];break}if(S[0]===6&&l.label<m[1]){l.label=m[1],m=S;break}if(m&&l.label<m[2]){l.label=m[2],l.ops.push(S);break}m[2]&&l.ops.pop(),l.trys.pop();continue}S=s.call(e,l)}catch(M){S=[6,M],g=0}finally{h=m=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},N2=(function(){function e(s,l){this.name=s,this.track=l}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(s){var l={};l[this.name]=s;var h={advanced:[l]};return this.track.applyConstraints(h)},e.prototype.value=function(){var s=this.track.getSettings();if(this.name in s){var l=s[this.name];return l}return null},e})(),Lx=(function(e){Fd(s,e);function s(l,h){return e.call(this,l,h)||this}return s.prototype.min=function(){return this.getCapabilities().min},s.prototype.max=function(){return this.getCapabilities().max},s.prototype.step=function(){return this.getCapabilities().step},s.prototype.apply=function(l){var h={};h[this.name]=l;var g={advanced:[h]};return this.track.applyConstraints(g)},s.prototype.getCapabilities=function(){this.failIfNotSupported();var l=this.track.getCapabilities(),h=l[this.name];return{min:h.min,max:h.max,step:h.step}},s.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},s})(N2),Px=(function(e){Fd(s,e);function s(l){return e.call(this,"zoom",l)||this}return s})(Lx),Hx=(function(e){Fd(s,e);function s(l){return e.call(this,"torch",l)||this}return s})(N2),zx=(function(){function e(s){this.track=s}return e.prototype.zoomFeature=function(){return new Px(this.track)},e.prototype.torchFeature=function(){return new Hx(this.track)},e})(),Fx=(function(){function e(s,l,h){this.isClosed=!1,this.parentElement=s,this.mediaStream=l,this.callbacks=h,this.surface=this.createVideoElement(this.parentElement.clientWidth),s.append(this.surface)}return e.prototype.createVideoElement=function(s){var l=document.createElement("video");return l.style.width="".concat(s,"px"),l.style.display="block",l.muted=!0,l.setAttribute("muted","true"),l.playsInline=!0,l},e.prototype.setupSurface=function(){var s=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var l=function(){var h=s.surface.clientWidth,g=s.surface.clientHeight;s.callbacks.onRenderSurfaceReady(h,g),s.surface.removeEventListener("playing",l)};this.surface.addEventListener("playing",l),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(s,l,h,g){return wh(this,void 0,void 0,function(){var m,w;return bh(this,function(b){switch(b.label){case 0:return m=new e(s,l,g),h.aspectRatio?(w={aspectRatio:h.aspectRatio},[4,m.getFirstTrackOrFail().applyConstraints(w)]):[3,2];case 1:b.sent(),b.label=2;case 2:return m.setupSurface(),[2,m]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(s){this.failIfClosed();var l=this,h=function(){setTimeout(s,200),l.surface.removeEventListener("playing",h)};this.surface.addEventListener("playing",h),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(s){return wh(this,void 0,void 0,function(){return bh(this,function(l){if("aspectRatio"in s)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(s)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var s=this;return new Promise(function(l,h){var g=s.mediaStream.getVideoTracks(),m=g.length,w=0;s.mediaStream.getVideoTracks().forEach(function(b){s.mediaStream.removeTrack(b),b.stop(),++w,w>=m&&(s.isClosed=!0,s.parentElement.removeChild(s.surface),l())})})},e.prototype.getCapabilities=function(){return new zx(this.getFirstTrackOrFail())},e})(),Ux=(function(){function e(s){this.mediaStream=s}return e.prototype.render=function(s,l,h){return wh(this,void 0,void 0,function(){return bh(this,function(g){return[2,Fx.create(s,this.mediaStream,l,h)]})})},e.create=function(s){return wh(this,void 0,void 0,function(){var l,h;return bh(this,function(g){switch(g.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return l={audio:!1,video:s},[4,navigator.mediaDevices.getUserMedia(l)];case 1:return h=g.sent(),[2,new e(h)]}})})},e})(),x_=function(e,s,l,h){function g(m){return m instanceof l?m:new l(function(w){w(m)})}return new(l||(l=Promise))(function(m,w){function b(M){try{S(h.next(M))}catch(N){w(N)}}function C(M){try{S(h.throw(M))}catch(N){w(N)}}function S(M){M.done?m(M.value):g(M.value).then(b,C)}S((h=h.apply(e,s||[])).next())})},v_=function(e,s){var l={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},h,g,m,w;return w={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function b(S){return function(M){return C([S,M])}}function C(S){if(h)throw new TypeError("Generator is already executing.");for(;w&&(w=0,S[0]&&(l=0)),l;)try{if(h=1,g&&(m=S[0]&2?g.return:S[0]?g.throw||((m=g.return)&&m.call(g),0):g.next)&&!(m=m.call(g,S[1])).done)return m;switch(g=0,m&&(S=[S[0]&2,m.value]),S[0]){case 0:case 1:m=S;break;case 4:return l.label++,{value:S[1],done:!1};case 5:l.label++,g=S[1],S=[0];continue;case 7:S=l.ops.pop(),l.trys.pop();continue;default:if(m=l.trys,!(m=m.length>0&&m[m.length-1])&&(S[0]===6||S[0]===2)){l=0;continue}if(S[0]===3&&(!m||S[1]>m[0]&&S[1]<m[3])){l.label=S[1];break}if(S[0]===6&&l.label<m[1]){l.label=m[1],m=S;break}if(m&&l.label<m[2]){l.label=m[2],l.ops.push(S);break}m[2]&&l.ops.pop(),l.trys.pop();continue}S=s.call(e,l)}catch(M){S=[6,M],g=0}finally{h=m=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},Vx=(function(){function e(){}return e.failIfNotSupported=function(){return x_(this,void 0,void 0,function(){return v_(this,function(s){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(s){return x_(this,void 0,void 0,function(){return v_(this,function(l){return[2,Ux.create(s)]})})},e})(),Wx=function(e,s,l,h){function g(m){return m instanceof l?m:new l(function(w){w(m)})}return new(l||(l=Promise))(function(m,w){function b(M){try{S(h.next(M))}catch(N){w(N)}}function C(M){try{S(h.throw(M))}catch(N){w(N)}}function S(M){M.done?m(M.value):g(M.value).then(b,C)}S((h=h.apply(e,s||[])).next())})},Gx=function(e,s){var l={label:0,sent:function(){if(m[0]&1)throw m[1];return m[1]},trys:[],ops:[]},h,g,m,w;return w={next:b(0),throw:b(1),return:b(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function b(S){return function(M){return C([S,M])}}function C(S){if(h)throw new TypeError("Generator is already executing.");for(;w&&(w=0,S[0]&&(l=0)),l;)try{if(h=1,g&&(m=S[0]&2?g.return:S[0]?g.throw||((m=g.return)&&m.call(g),0):g.next)&&!(m=m.call(g,S[1])).done)return m;switch(g=0,m&&(S=[S[0]&2,m.value]),S[0]){case 0:case 1:m=S;break;case 4:return l.label++,{value:S[1],done:!1};case 5:l.label++,g=S[1],S=[0];continue;case 7:S=l.ops.pop(),l.trys.pop();continue;default:if(m=l.trys,!(m=m.length>0&&m[m.length-1])&&(S[0]===6||S[0]===2)){l=0;continue}if(S[0]===3&&(!m||S[1]>m[0]&&S[1]<m[3])){l.label=S[1];break}if(S[0]===6&&l.label<m[1]){l.label=m[1],m=S;break}if(m&&l.label<m[2]){l.label=m[2],l.ops.push(S);break}m[2]&&l.ops.pop(),l.trys.pop();continue}S=s.call(e,l)}catch(M){S=[6,M],g=0}finally{h=m=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}},Xx=(function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var s=MediaStreamTrack;return MediaStreamTrack&&s.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var s=yl.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(s=yl.insecureContextCameraQueryError()),Promise.reject(s)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var s=location.host.split(":")[0];return s==="127.0.0.1"||s==="localhost"},e.getCamerasFromMediaDevices=function(){return Wx(this,void 0,void 0,function(){var s,l,h,g,m,w,b;return Gx(this,function(C){switch(C.label){case 0:return s=function(S){for(var M=S.getVideoTracks(),N=0,k=M;N<k.length;N++){var P=k[N];P.enabled=!1,P.stop(),S.removeTrack(P)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return l=C.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(h=C.sent(),g=[],m=0,w=h;m<w.length;m++)b=w[m],b.kind==="videoinput"&&g.push({id:b.deviceId,label:b.label});return s(l),[2,g]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(s,l){var h=function(m){for(var w=[],b=0,C=m;b<C.length;b++){var S=C[b];S.kind==="video"&&w.push({id:S.id,label:S.label})}s(w)},g=MediaStreamTrack;g.getSources(h)})},e})(),hi;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(hi||(hi={}));var Yx=(function(){function e(){this.state=hi.NOT_STARTED,this.onGoingTransactionNewState=hi.UNKNOWN}return e.prototype.directTransition=function(s){this.failIfTransitionOngoing(),this.validateTransition(s),this.state=s},e.prototype.startTransition=function(s){return this.failIfTransitionOngoing(),this.validateTransition(s),this.onGoingTransactionNewState=s,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===hi.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var s=this.onGoingTransactionNewState;this.onGoingTransactionNewState=hi.UNKNOWN,this.directTransition(s)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===hi.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=hi.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==hi.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(s){switch(this.state){case hi.UNKNOWN:throw"Transition from unknown is not allowed";case hi.NOT_STARTED:this.failIfNewStateIs(s,[hi.PAUSED]);break;case hi.SCANNING:break;case hi.PAUSED:break}},e.prototype.failIfNewStateIs=function(s,l){for(var h=0,g=l;h<g.length;h++){var m=g[h];if(s===m)throw"Cannot transition from ".concat(this.state," to ").concat(s)}},e})(),jx=(function(){function e(s){this.stateManager=s}return e.prototype.startTransition=function(s){return this.stateManager.startTransition(s)},e.prototype.directTransition=function(s){this.stateManager.directTransition(s)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===hi.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==hi.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===hi.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===hi.PAUSED},e})(),qx=(function(){function e(){}return e.create=function(){return new jx(new Yx)},e})(),Kx=(function(){var e=function(s,l){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,g){h.__proto__=g}||function(h,g){for(var m in g)Object.prototype.hasOwnProperty.call(g,m)&&(h[m]=g[m])},e(s,l)};return function(s,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");e(s,l);function h(){this.constructor=s}s.prototype=l===null?Object.create(l):(h.prototype=l.prototype,new h)}})(),zs=(function(e){Kx(s,e);function s(){return e!==null&&e.apply(this,arguments)||this}return s.DEFAULT_WIDTH=300,s.DEFAULT_WIDTH_OFFSET=2,s.FILE_SCAN_MIN_HEIGHT=300,s.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,s.MIN_QR_BOX_SIZE=50,s.SHADED_LEFT=1,s.SHADED_RIGHT=2,s.SHADED_TOP=3,s.SHADED_BOTTOM=4,s.SHADED_REGION_ELEMENT_ID="qr-shaded-region",s.VERBOSE=!1,s.BORDER_SHADER_DEFAULT_COLOR="#ffffff",s.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",s})(Tx),Zx=(function(){function e(s,l){this.logger=l,this.fps=zs.SCAN_DEFAULT_FPS,s?(s.fps&&(this.fps=s.fps),this.disableFlip=s.disableFlip===!0,this.qrbox=s.qrbox,this.aspectRatio=s.aspectRatio,this.videoConstraints=s.videoConstraints):this.disableFlip=zs.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?R2.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!rn(this.qrbox)},e.create=function(s,l){return new e(s,l)},e})(),Qx=(function(){function e(s,l){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(s))throw"HTML Element with id=".concat(s," not found");this.elementId=s,this.verbose=!1;var h;typeof l=="boolean"?this.verbose=l===!0:l&&(h=l,this.verbose=h.verbose===!0,h.experimentalFeatures),this.logger=new Nx(this.verbose),this.qrcode=new kx(this.getSupportedFormats(l),this.getUseBarCodeDetectorIfSupported(h),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=qx.create()}return e.prototype.start=function(s,l,h,g){var m=this;if(!s)throw"cameraIdOrConfig is required";if(!h||typeof h!="function")throw"qrCodeSuccessCallback is required and should be a function.";var w;g?w=g:w=this.verbose?this.logger.log:function(){};var b=Zx.create(l,this.logger);this.clearElement();var C=!1;b.videoConstraints&&(b.isMediaStreamConstraintsValid()?C=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var S=C,M=document.getElementById(this.elementId);M.clientWidth?M.clientWidth:zs.DEFAULT_WIDTH,M.style.position="relative",this.shouldScan=!0,this.element=M;var N=this,k=this.stateManagerProxy.startTransition(hi.SCANNING);return new Promise(function(P,L){var X=S?b.videoConstraints:N.createVideoConstraints(s);if(!X){k.cancel(),L("videoConstraints should be defined");return}var pe={};(!S||b.aspectRatio)&&(pe.aspectRatio=b.aspectRatio);var me={onRenderSurfaceReady:function(he,te){N.setupUi(he,te,b),N.isScanning=!0,N.foreverScan(b,h,w)}};Vx.failIfNotSupported().then(function(he){he.create(X).then(function(te){return te.render(m.element,pe,me).then(function(le){N.renderedCamera=le,k.execute(),P(null)}).catch(function(le){k.cancel(),L(le)})}).catch(function(te){k.cancel(),L(yl.errorGettingUserMedia(te))})}).catch(function(he){k.cancel(),L(yl.cameraStreamingNotSupported())})})},e.prototype.pause=function(s){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(hi.PAUSED),this.showPausedState(),(rn(s)||s!==!0)&&(s=!1),s&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var s=this,l=function(){s.stateManagerProxy.directTransition(hi.SCANNING),s.hidePausedState()};if(!this.renderedCamera.isPaused()){l();return}this.renderedCamera.resume(function(){l()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var s=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var l=this.stateManagerProxy.startTransition(hi.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var h=function(){if(s.element){var m=document.getElementById(zs.SHADED_REGION_ELEMENT_ID);m&&s.element.removeChild(m)}},g=this;return this.renderedCamera.close().then(function(){return g.renderedCamera=null,g.element&&(g.element.removeChild(g.canvasElement),g.canvasElement=null),h(),g.qrRegion&&(g.qrRegion=null),g.context&&(g.context=null),l.execute(),g.hidePausedState(),g.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(s,l){return this.scanFileV2(s,l).then(function(h){return h.decodedText})},e.prototype.scanFileV2=function(s,l){var h=this;if(!s||!(s instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(rn(l)&&(l=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(g,m){h.possiblyCloseLastScanImageFile(),h.clearElement(),h.lastScanImageFile=URL.createObjectURL(s);var w=new Image;w.onload=function(){var b=w.width,C=w.height,S=document.getElementById(h.elementId),M=S.clientWidth?S.clientWidth:zs.DEFAULT_WIDTH,N=Math.max(S.clientHeight?S.clientHeight:C,zs.FILE_SCAN_MIN_HEIGHT),k=h.computeCanvasDrawConfig(b,C,M,N);if(l){var P=h.createCanvasElement(M,N,"qr-canvas-visible");P.style.display="inline-block",S.appendChild(P);var L=P.getContext("2d");if(!L)throw"Unable to get 2d context from canvas";L.canvas.width=M,L.canvas.height=N,L.drawImage(w,0,0,b,C,k.x,k.y,k.width,k.height)}var X=zs.FILE_SCAN_HIDDEN_CANVAS_PADDING,pe=Math.max(w.width,k.width),me=Math.max(w.height,k.height),he=pe+2*X,te=me+2*X,le=h.createCanvasElement(he,te);S.appendChild(le);var Oe=le.getContext("2d");if(!Oe)throw"Unable to get 2d context from canvas";Oe.canvas.width=he,Oe.canvas.height=te,Oe.drawImage(w,0,0,b,C,X,X,pe,me);try{h.qrcode.decodeRobustlyAsync(le).then(function(Re){g(f_.createFromQrcodeResult(Re))}).catch(m)}catch(Re){m("QR code parse error, error = ".concat(Re))}},w.onerror=m,w.onabort=m,w.onstalled=m,w.onsuspend=m,w.src=URL.createObjectURL(s)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return Xx.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(s){if(s){if(!R2.isMediaStreamConstraintsValid(s,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(s)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(s){var l=[ke.QR_CODE,ke.AZTEC,ke.CODABAR,ke.CODE_39,ke.CODE_93,ke.CODE_128,ke.DATA_MATRIX,ke.MAXICODE,ke.ITF,ke.EAN_13,ke.EAN_8,ke.PDF_417,ke.RSS_14,ke.RSS_EXPANDED,ke.UPC_A,ke.UPC_E,ke.UPC_EAN_EXTENSION];if(!s||typeof s=="boolean"||!s.formatsToSupport)return l;if(!Array.isArray(s.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(s.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var h=[],g=0,m=s.formatsToSupport;g<m.length;g++){var w=m[g];Ax(w)?h.push(w):this.logger.warn("Invalid format: ".concat(w," passed in config, ignoring."))}if(h.length===0)throw"None of formatsToSupport match supported values.";return h},e.prototype.getUseBarCodeDetectorIfSupported=function(s){if(rn(s))return!0;if(!rn(s.useBarCodeDetectorIfSupported))return s.useBarCodeDetectorIfSupported!==!1;if(rn(s.experimentalFeatures))return!0;var l=s.experimentalFeatures;return rn(l.useBarCodeDetectorIfSupported)?!0:l.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(s,l,h){var g=this,m=h.qrbox;this.validateQrboxConfig(m);var w=this.toQrdimensions(s,l,m),b=function(S){if(S<zs.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(zs.MIN_QR_BOX_SIZE,"px.")},C=function(S){return S>s&&(g.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),S=s),S};b(w.width),b(w.height),w.width=C(w.width)},e.prototype.validateQrboxConfig=function(s){if(typeof s!="number"&&typeof s!="function"&&(s.width===void 0||s.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(s,l,h){if(typeof h=="number")return{width:h,height:h};if(typeof h=="function")try{return h(s,l)}catch(g){throw new Error("qrbox config was passed as a function but it failed with unknown error"+g)}return h},e.prototype.setupUi=function(s,l,h){h.isShadedBoxEnabled()&&this.validateQrboxSize(s,l,h);var g=rn(h.qrbox)?{width:s,height:l}:h.qrbox;this.validateQrboxConfig(g);var m=this.toQrdimensions(s,l,g);m.height>l&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var w=h.isShadedBoxEnabled()&&m.height<=l,b={x:0,y:0,width:s,height:l},C=w?this.getShadedRegionBounds(s,l,m):b,S=this.createCanvasElement(C.width,C.height),M={willReadFrequently:!0},N=S.getContext("2d",M);N.canvas.width=C.width,N.canvas.height=C.height,this.element.append(S),w&&this.possiblyInsertShadingElement(this.element,s,l,m),this.createScannerPausedUiElement(this.element),this.qrRegion=C,this.context=N,this.canvasElement=S},e.prototype.createScannerPausedUiElement=function(s){var l=document.createElement("div");l.innerText=yl.scannerPaused(),l.style.display="none",l.style.position="absolute",l.style.top="0px",l.style.zIndex="1",l.style.background="rgba(9, 9, 9, 0.46)",l.style.color="#FFECEC",l.style.textAlign="center",l.style.width="100%",s.appendChild(l),this.scannerPausedUiElement=l},e.prototype.scanContext=function(s,l){var h=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(g){return s(g.text,f_.createFromQrcodeResult(g)),h.possiblyUpdateShaders(!0),!0}).catch(function(g){h.possiblyUpdateShaders(!1);var m=yl.codeParseError(g);return l(m,Rx.createFrom(m)),!1})},e.prototype.foreverScan=function(s,l,h){var g=this;if(this.shouldScan&&this.renderedCamera){var m=this.renderedCamera.getSurface(),w=m.videoWidth/m.clientWidth,b=m.videoHeight/m.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var C=this.qrRegion.width*w,S=this.qrRegion.height*b,M=this.qrRegion.x*w,N=this.qrRegion.y*b;this.context.drawImage(m,M,N,C,S,0,0,this.qrRegion.width,this.qrRegion.height);var k=function(){g.foreverScanTimeout=setTimeout(function(){g.foreverScan(s,l,h)},g.getTimeoutFps(s.fps))};this.scanContext(l,h).then(function(P){!P&&s.disableFlip!==!0?(g.context.translate(g.context.canvas.width,0),g.context.scale(-1,1),g.scanContext(l,h).finally(function(){k()})):k()}).catch(function(P){g.logger.logError("Error happend while scanning context",P),k()})}},e.prototype.createVideoConstraints=function(s){if(typeof s=="string")return{deviceId:{exact:s}};if(typeof s=="object"){var l="facingMode",h="deviceId",g={user:!0,environment:!0},m="exact",w=function(L){if(L in g)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(L,"'")},b=Object.keys(s);if(b.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(b.length," keys");var C=Object.keys(s)[0];if(C!==l&&C!==h)throw"Only '".concat(l,"' and '").concat(h,"' ")+" are supported for 'cameraIdOrConfig'";if(C===l){var S=s.facingMode;if(typeof S=="string"){if(w(S))return{facingMode:S}}else if(typeof S=="object")if(m in S){if(w(S["".concat(m)]))return{facingMode:{exact:S["".concat(m)]}}}else throw"'facingMode' should be string or object with"+" ".concat(m," as key.");else{var M=typeof S;throw"Invalid type of 'facingMode' = ".concat(M)}}else{var N=s.deviceId;if(typeof N=="string")return{deviceId:N};if(typeof N=="object"){if(m in N)return{deviceId:{exact:N["".concat(m)]}};throw"'deviceId' should be string or object with"+" ".concat(m," as key.")}else{var k=typeof N;throw"Invalid type of 'deviceId' = ".concat(k)}}}var P=typeof s;throw"Invalid type of 'cameraIdOrConfig' = ".concat(P)},e.prototype.computeCanvasDrawConfig=function(s,l,h,g){if(s<=h&&l<=g){var m=(h-s)/2,w=(g-l)/2;return{x:m,y:w,width:s,height:l}}else{var b=s,C=l;return s>h&&(l=h/s*l,s=h),l>g&&(s=g/l*s,l=g),this.logger.log("Image downsampled from "+"".concat(b,"X").concat(C)+" to ".concat(s,"X").concat(l,".")),this.computeCanvasDrawConfig(s,l,h,g)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var s=document.getElementById(this.elementId);s&&(s.innerHTML="")},e.prototype.possiblyUpdateShaders=function(s){this.qrMatch!==s&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(l){l.style.backgroundColor=s?zs.BORDER_SHADER_MATCH_COLOR:zs.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=s)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(s,l,h){var g=s,m=l,w=document.createElement("canvas");return w.style.width="".concat(g,"px"),w.style.height="".concat(m,"px"),w.style.display="none",w.id=rn(h)?"qr-canvas":h,w},e.prototype.getShadedRegionBounds=function(s,l,h){if(h.width>s||h.height>l)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(s-h.width)/2,y:(l-h.height)/2,width:h.width,height:h.height}},e.prototype.possiblyInsertShadingElement=function(s,l,h,g){if(!(l-g.width<1||h-g.height<1)){var m=document.createElement("div");m.style.position="absolute";var w=(l-g.width)/2,b=(h-g.height)/2;if(m.style.borderLeft="".concat(w,"px solid rgba(0, 0, 0, 0.48)"),m.style.borderRight="".concat(w,"px solid rgba(0, 0, 0, 0.48)"),m.style.borderTop="".concat(b,"px solid rgba(0, 0, 0, 0.48)"),m.style.borderBottom="".concat(b,"px solid rgba(0, 0, 0, 0.48)"),m.style.boxSizing="border-box",m.style.top="0px",m.style.bottom="0px",m.style.left="0px",m.style.right="0px",m.id="".concat(zs.SHADED_REGION_ELEMENT_ID),l-g.width<11||h-g.height<11)this.hasBorderShaders=!1;else{var C=5,S=40;this.insertShaderBorders(m,S,C,-C,null,0,!0),this.insertShaderBorders(m,S,C,-C,null,0,!1),this.insertShaderBorders(m,S,C,null,-C,0,!0),this.insertShaderBorders(m,S,C,null,-C,0,!1),this.insertShaderBorders(m,C,S+C,-C,null,-C,!0),this.insertShaderBorders(m,C,S+C,null,-C,-C,!0),this.insertShaderBorders(m,C,S+C,-C,null,-C,!1),this.insertShaderBorders(m,C,S+C,null,-C,-C,!1),this.hasBorderShaders=!0}s.append(m)}},e.prototype.insertShaderBorders=function(s,l,h,g,m,w,b){var C=document.createElement("div");C.style.position="absolute",C.style.backgroundColor=zs.BORDER_SHADER_DEFAULT_COLOR,C.style.width="".concat(l,"px"),C.style.height="".concat(h,"px"),g!==null&&(C.style.top="".concat(g,"px")),m!==null&&(C.style.bottom="".concat(m,"px")),b?C.style.left="".concat(w,"px"):C.style.right="".concat(w,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(C),s.appendChild(C)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(s){return 1e3/s},e})(),S_;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(S_||(S_={}));const y_="qr-token-reader";function Jx({onScan:e,onClose:s}){const l=Te.useRef(e);return l.current=e,Te.useEffect(()=>{let h=!1;const g=new Qx(y_);return g.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},m=>{h||(h=!0,g.stop().then(()=>l.current(m),()=>l.current(m)))},()=>{}).catch(()=>{}),()=>{h||(h=!0,g.stop().catch(()=>{}))}},[]),ee.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",children:ee.jsxs("div",{className:"w-full max-w-sm mx-4 bg-neutral-900 rounded-xl border border-neutral-700 overflow-hidden",children:[ee.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-neutral-700",children:[ee.jsx("span",{className:"text-sm font-medium text-neutral-100",children:"QR"}),ee.jsx("button",{type:"button",onClick:s,className:"text-neutral-400 hover:text-neutral-100 text-lg leading-none",children:""})]}),ee.jsx("div",{id:y_,className:"w-full"})]})})}const D2="releash-connection";function $x(){try{const e=localStorage.getItem(D2);if(e)return JSON.parse(e)}catch{}return{host:"",token:""}}function ev(e){localStorage.setItem(D2,JSON.stringify(e))}function tv({onConnect:e}){const[s,l]=Te.useState(""),[h,g]=Te.useState(""),[m,w]=Te.useState(!1);Te.useEffect(()=>{const S=$x();l(S.host||window.location.host),g(S.token||"")},[]);const b=S=>{if(S.preventDefault(),!s||!h)return;const M=`${window.location.protocol==="https:"?"wss":"ws"}://${s}/ws`;ev({host:s,token:h}),e(M,h)},C=S=>{g(S),w(!1)};return ee.jsxs("div",{className:"flex items-center justify-center min-h-dvh bg-neutral-950 text-neutral-100",children:[ee.jsxs("form",{onSubmit:b,className:"w-full max-w-md p-4 sm:p-8 space-y-6 bg-neutral-900 rounded-xl border border-neutral-800",children:[ee.jsx("h1",{className:"text-2xl font-bold text-center",children:"Releash Remote"}),ee.jsx("p",{className:"text-sm text-neutral-400 text-center",children:"MacReleash"}),ee.jsxs("div",{className:"space-y-2",children:[ee.jsx("label",{className:"block text-sm font-medium text-neutral-300",htmlFor:"host",children:" (IP:)"}),ee.jsx("input",{id:"host",type:"text",value:s,onChange:S=>l(S.target.value),placeholder:"192.168.1.100:9700",className:"w-full px-4 py-2 rounded-lg bg-neutral-800 border border-neutral-700 text-neutral-100 placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),ee.jsxs("div",{className:"space-y-2",children:[ee.jsx("label",{className:"block text-sm font-medium text-neutral-300",htmlFor:"token",children:""}),ee.jsxs("div",{className:"flex gap-2",children:[ee.jsx("input",{id:"token",type:"password",value:h,onChange:S=>g(S.target.value),placeholder:"",className:"flex-1 px-4 py-2 rounded-lg bg-neutral-800 border border-neutral-700 text-neutral-100 placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-blue-500"}),ee.jsx("button",{type:"button",onClick:()=>w(!0),className:"px-3 py-2 rounded-lg bg-neutral-700 hover:bg-neutral-600 text-sm font-medium transition-colors shrink-0",children:"QR"})]})]}),ee.jsx("button",{type:"submit",disabled:!s||!h,className:"w-full py-3 rounded-lg bg-blue-600 hover:bg-blue-500 disabled:opacity-40 disabled:cursor-not-allowed font-medium transition-colors",children:""})]}),m&&ee.jsx(Jx,{onScan:C,onClose:()=>w(!1)})]})}function iv({comments:e,onSendToTerminal:s}){const l=e.filter(g=>g.status==="unsent");if(e.length===0)return ee.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-3 text-neutral-500 px-6",children:[ee.jsx(ed,{className:"h-8 w-8"}),ee.jsx("span",{className:"text-sm font-medium",children:""}),ee.jsx("p",{className:"text-xs text-center leading-relaxed",children:"Diff"})]});const h=new Map;for(const g of e){const m=h.get(g.filePath);m?m.push(g):h.set(g.filePath,[g])}return ee.jsxs("div",{className:"flex flex-col h-full",children:[ee.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-neutral-800 bg-neutral-900 shrink-0",children:[ee.jsxs("span",{className:"text-xs text-neutral-400",children:["Comments",l.length>0&&ee.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 text-[10px] bg-blue-500/20 text-blue-400 rounded",children:l.length})]}),l.length>0&&s&&ee.jsxs("button",{type:"button",onClick:()=>s(l),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs bg-blue-500/20 text-blue-400 rounded hover:bg-blue-500/30 transition-colors min-h-[32px]",children:[ee.jsx(Sx,{className:"h-3.5 w-3.5"}),""]})]}),ee.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:[...h.entries()].map(([g,m])=>{const w=g.split("/").pop()??g;return ee.jsxs("div",{className:"mb-3",children:[ee.jsx("div",{className:"text-xs font-medium px-2 py-1 text-neutral-300 truncate",children:w}),m.sort((b,C)=>b.lineNumber-C.lineNumber).map(b=>ee.jsxs("div",{className:"flex items-start gap-2 px-2 py-2 text-sm rounded hover:bg-neutral-800/50 transition-colors",children:[ee.jsx(ed,{className:"h-4 w-4 shrink-0 mt-0.5 text-neutral-500"}),ee.jsxs("div",{className:"min-w-0 flex-1",children:[ee.jsxs("div",{className:"flex items-center gap-1.5",children:[ee.jsxs("span",{className:"text-neutral-500 font-mono text-xs",children:["L",b.lineNumber,b.endLine!=null?`-${b.endLine}`:""]}),ee.jsx("span",{className:`text-[10px] px-1 rounded ${b.status==="sent"?"bg-green-500/20 text-green-400":"bg-neutral-700 text-neutral-400"}`,children:b.status==="sent"?"sent":"unsent"})]}),ee.jsx("div",{className:"text-neutral-200 mt-0.5 break-words",children:b.content})]})]},b.id))]},g)})})]})}class sv{diff(s,l,h={}){let g;typeof h=="function"?(g=h,h={}):"callback"in h&&(g=h.callback);const m=this.castInput(s,h),w=this.castInput(l,h),b=this.removeEmpty(this.tokenize(m,h)),C=this.removeEmpty(this.tokenize(w,h));return this.diffWithOptionsObj(b,C,h,g)}diffWithOptionsObj(s,l,h,g){var m;const w=he=>{if(he=this.postProcess(he,h),g){setTimeout(function(){g(he)},0);return}else return he},b=l.length,C=s.length;let S=1,M=b+C;h.maxEditLength!=null&&(M=Math.min(M,h.maxEditLength));const N=(m=h.timeout)!==null&&m!==void 0?m:1/0,k=Date.now()+N,P=[{oldPos:-1,lastComponent:void 0}];let L=this.extractCommon(P[0],l,s,0,h);if(P[0].oldPos+1>=C&&L+1>=b)return w(this.buildValues(P[0].lastComponent,l,s));let X=-1/0,pe=1/0;const me=()=>{for(let he=Math.max(X,-S);he<=Math.min(pe,S);he+=2){let te;const le=P[he-1],Oe=P[he+1];le&&(P[he-1]=void 0);let Re=!1;if(Oe){const Ne=Oe.oldPos-he;Re=Oe&&0<=Ne&&Ne<b}const Y=le&&le.oldPos+1<C;if(!Re&&!Y){P[he]=void 0;continue}if(!Y||Re&&le.oldPos<Oe.oldPos?te=this.addToPath(Oe,!0,!1,0,h):te=this.addToPath(le,!1,!0,1,h),L=this.extractCommon(te,l,s,he,h),te.oldPos+1>=C&&L+1>=b)return w(this.buildValues(te.lastComponent,l,s))||!0;P[he]=te,te.oldPos+1>=C&&(pe=Math.min(pe,he-1)),L+1>=b&&(X=Math.max(X,he+1))}S++};if(g)(function he(){setTimeout(function(){if(S>M||Date.now()>k)return g(void 0);me()||he()},0)})();else for(;S<=M&&Date.now()<=k;){const he=me();if(he)return he}}addToPath(s,l,h,g,m){const w=s.lastComponent;return w&&!m.oneChangePerToken&&w.added===l&&w.removed===h?{oldPos:s.oldPos+g,lastComponent:{count:w.count+1,added:l,removed:h,previousComponent:w.previousComponent}}:{oldPos:s.oldPos+g,lastComponent:{count:1,added:l,removed:h,previousComponent:w}}}extractCommon(s,l,h,g,m){const w=l.length,b=h.length;let C=s.oldPos,S=C-g,M=0;for(;S+1<w&&C+1<b&&this.equals(h[C+1],l[S+1],m);)S++,C++,M++,m.oneChangePerToken&&(s.lastComponent={count:1,previousComponent:s.lastComponent,added:!1,removed:!1});return M&&!m.oneChangePerToken&&(s.lastComponent={count:M,previousComponent:s.lastComponent,added:!1,removed:!1}),s.oldPos=C,S}equals(s,l,h){return h.comparator?h.comparator(s,l):s===l||!!h.ignoreCase&&s.toLowerCase()===l.toLowerCase()}removeEmpty(s){const l=[];for(let h=0;h<s.length;h++)s[h]&&l.push(s[h]);return l}castInput(s,l){return s}tokenize(s,l){return Array.from(s)}join(s){return s.join("")}postProcess(s,l){return s}get useLongestToken(){return!1}buildValues(s,l,h){const g=[];let m;for(;s;)g.push(s),m=s.previousComponent,delete s.previousComponent,s=m;g.reverse();const w=g.length;let b=0,C=0,S=0;for(;b<w;b++){const M=g[b];if(M.removed)M.value=this.join(h.slice(S,S+M.count)),S+=M.count;else{if(!M.added&&this.useLongestToken){let N=l.slice(C,C+M.count);N=N.map(function(k,P){const L=h[S+P];return L.length>k.length?L:k}),M.value=this.join(N)}else M.value=this.join(l.slice(C,C+M.count));C+=M.count,M.added||(S+=M.count)}}return g}}class rv extends sv{constructor(){super(...arguments),this.tokenize=av}equals(s,l,h){return h.ignoreWhitespace?((!h.newlineIsToken||!s.includes(`
`))&&(s=s.trim()),(!h.newlineIsToken||!l.includes(`
`))&&(l=l.trim())):h.ignoreNewlineAtEof&&!h.newlineIsToken&&(s.endsWith(`
`)&&(s=s.slice(0,-1)),l.endsWith(`
`)&&(l=l.slice(0,-1))),super.equals(s,l,h)}}const nv=new rv;function w_(e,s,l){return nv.diff(e,s,l)}function av(e,s){s.stripTrailingCr&&(e=e.replace(/\r\n/g,`
`));const l=[],h=e.split(/(\n|\r\n)/);h[h.length-1]||h.pop();for(let g=0;g<h.length;g++){const m=h[g];g%2&&!s.newlineIsToken?l[l.length-1]+=m:l.push(m)}return l}function lv(e,s,l,h,g,m,w){let b;b={},typeof b.context>"u"&&(b.context=4);const C=b.context;if(b.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(b.callback){const{callback:M}=b;w_(l,h,Object.assign(Object.assign({},b),{callback:N=>{const k=S(N);M(k)}}))}else return S(w_(l,h,b));function S(M){if(!M)return;M.push({value:"",lines:[]});function N(he){return he.map(function(te){return" "+te})}const k=[];let P=0,L=0,X=[],pe=1,me=1;for(let he=0;he<M.length;he++){const te=M[he],le=te.lines||ov(te.value);if(te.lines=le,te.added||te.removed){if(!P){const Oe=M[he-1];P=pe,L=me,Oe&&(X=C>0?N(Oe.lines.slice(-C)):[],P-=X.length,L-=X.length)}for(const Oe of le)X.push((te.added?"+":"-")+Oe);te.added?me+=le.length:pe+=le.length}else{if(P)if(le.length<=C*2&&he<M.length-2)for(const Oe of N(le))X.push(Oe);else{const Oe=Math.min(le.length,C);for(const Y of N(le.slice(0,Oe)))X.push(Y);const Re={oldStart:P,oldLines:pe-P+Oe,newStart:L,newLines:me-L+Oe,lines:X};k.push(Re),P=0,L=0,X=[]}pe+=le.length,me+=le.length}}for(const he of k)for(let te=0;te<he.lines.length;te++)he.lines[te].endsWith(`
`)?he.lines[te]=he.lines[te].slice(0,-1):(he.lines.splice(te+1,0,"\\ No newline at end of file"),te++);return{oldFileName:e,newFileName:s,oldHeader:g,newHeader:m,hunks:k}}}function ov(e){const s=e.endsWith(`
`),l=e.split(`
`).map(h=>h+`
`);return s?l.pop():l.push(l.pop().slice(0,-1)),l}function cv(e,s,l="file"){return typeof e!="string"||typeof s!="string"?[]:lv(l,l,e,s).hunks.map((g,m)=>({index:m,oldStart:g.oldStart,oldLines:g.oldLines,newStart:g.newStart,newLines:g.newLines,lines:g.lines}))}function hv(e){const s=[];let l=e.oldStart,h=e.newStart;for(const g of e.lines){const m=g[0],w=g.slice(1);m!=="\\"&&(m==="-"?(s.push({prefix:m,content:w,oldLine:l,newLine:null}),l++):m==="+"?(s.push({prefix:m,content:w,oldLine:null,newLine:h}),h++):(s.push({prefix:m,content:w,oldLine:l,newLine:h}),l++,h++))}return s}function uv(e){return e==="+"?"bg-green-950/40 text-green-300":e==="-"?"bg-red-950/40 text-red-300":"bg-neutral-950 text-neutral-300"}const fv=500,b_="w-12 text-right px-2 text-neutral-600 select-none border-r border-neutral-800 font-mono text-xs";function dv(e,s){return s?e>=s.start&&e<=s.end:!1}function gv({original:e,modified:s,filePath:l,selectionStart:h,highlightRange:g,onLineTap:m,onLineLongPress:w}){const b=Te.useMemo(()=>cv(e,s,l),[e,s,l]),C=Te.useRef(null),S=Te.useRef(!1),M=Te.useCallback(P=>{S.current=!1,C.current=setTimeout(()=>{S.current=!0,w(P)},fv)},[w]),N=Te.useCallback(P=>{C.current&&(clearTimeout(C.current),C.current=null),S.current||m(P),S.current=!1},[m]),k=Te.useCallback(()=>{C.current&&(clearTimeout(C.current),C.current=null),S.current=!1},[]);return b.length===0?ee.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500 text-sm",children:"No changes"}):ee.jsx("div",{className:"overflow-x-auto overflow-y-auto h-full",children:ee.jsx("table",{className:"w-full border-collapse text-xs font-mono",children:ee.jsx("tbody",{children:b.map(P=>{const L=hv(P);return ee.jsx(_v,{hunk:P,diffLines:L,selectionStart:h,highlightRange:g,onPointerDown:M,onPointerUp:N,onPointerCancel:k},P.index)})})})})}function _v({hunk:e,diffLines:s,selectionStart:l,highlightRange:h,onPointerDown:g,onPointerUp:m,onPointerCancel:w}){return ee.jsxs(ee.Fragment,{children:[ee.jsx("tr",{className:"bg-neutral-900/80",children:ee.jsxs("td",{colSpan:3,className:"px-3 py-1 text-neutral-500 text-xs select-none",children:["@@ -",e.oldStart,",",e.oldLines," +",e.newStart,",",e.newLines," ","@@"]})}),s.map((b,C)=>{const S=b.newLine!=null,M=l!=null&&b.newLine===l,N=S&&dv(b.newLine,h);let k="";return N?k="ring-1 ring-blue-500 bg-blue-950/30":M&&(k="ring-1 ring-amber-500 bg-amber-950/30"),ee.jsxs("tr",{className:`${uv(b.prefix)} select-none ${S?"active:bg-neutral-700/50":""} ${k}`,onPointerDown:S?()=>g(b.newLine):void 0,onPointerUp:S?()=>m(b.newLine):void 0,onPointerLeave:S?w:void 0,onPointerCancel:S?w:void 0,children:[ee.jsx("td",{className:b_,children:b.oldLine??""}),ee.jsx("td",{className:b_,children:b.newLine??""}),ee.jsxs("td",{className:"px-3 py-0 whitespace-pre",children:[b.prefix,b.content]})]},`${e.index}-${C}`)})]})}function mv({lineNumber:e,endLine:s,onSave:l,onCancel:h}){const[g,m]=Te.useState(""),w=Te.useCallback(()=>{const b=g.trim();b&&l(b)},[g,l]);return ee.jsxs("div",{className:"border-t border-neutral-700 bg-neutral-900 p-3 animate-in slide-in-from-bottom-2",children:[ee.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[ee.jsxs("span",{className:"text-xs font-mono text-neutral-400 bg-neutral-800 px-1.5 py-0.5 rounded",children:["L",e,s!=null?`-${s}`:""]}),ee.jsx("span",{className:"text-xs text-neutral-500",children:""})]}),ee.jsx("textarea",{value:g,onChange:b=>m(b.target.value),placeholder:"...",className:"w-full bg-neutral-800 text-neutral-100 text-sm rounded px-3 py-2 resize-none border border-neutral-700 focus:border-blue-500 focus:outline-none",rows:3}),ee.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[ee.jsx("button",{type:"button",onClick:h,className:"text-xs px-3 py-1.5 rounded bg-neutral-800 text-neutral-300 hover:bg-neutral-700 transition-colors min-h-[32px]",children:""}),ee.jsx("button",{type:"button",onClick:w,disabled:!g.trim(),className:"text-xs px-3 py-1.5 rounded bg-blue-600 text-white hover:bg-blue-500 transition-colors disabled:opacity-40 disabled:cursor-not-allowed min-h-[32px]",children:""})]})]})}function pv({path:e,original:s,modified:l,loading:h,onAddComment:g}){const[m,w]=Te.useState(null),[b,C]=Te.useState(null),S=Te.useCallback(P=>{if(g)if(m!=null){const L=Math.min(m,P),X=Math.max(m,P);C({start:L,end:X}),w(null)}else C({start:P,end:P})},[g,m]),M=Te.useCallback(P=>{g&&(w(P),C(null))},[g]),N=Te.useCallback(P=>{if(e&&b){const L=b.start!==b.end?b.end:void 0;g?.(e,b.start,P,L)}C(null)},[e,b,g]),k=Te.useCallback(()=>{C(null),w(null)},[]);return e?h?ee.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500 text-sm",children:"Loading..."}):ee.jsxs("div",{className:"flex flex-col h-full",children:[m!=null&&ee.jsxs("div",{className:"flex items-center px-3 py-1 border-b border-amber-800/50 bg-amber-950/30 shrink-0",children:[ee.jsxs("span",{className:"text-xs text-amber-400",children:["L",m,"   "]}),ee.jsx("button",{type:"button",onClick:()=>w(null),className:"ml-auto text-xs px-2 py-0.5 rounded bg-neutral-800 text-neutral-300 hover:bg-neutral-700 transition-colors",children:""})]}),ee.jsx("div",{className:"flex-1",style:{minHeight:0},children:ee.jsx(gv,{original:s,modified:l,filePath:e,selectionStart:m,highlightRange:b,onLineTap:S,onLineLongPress:M},e)}),b!=null&&ee.jsx(mv,{lineNumber:b.start,endLine:b.start!==b.end?b.end:void 0,onSave:N,onCancel:k})]}):ee.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500 text-sm",children:"Select a file to view diff"})}function xv(e){switch(e){case"new":return"text-green-400";case"modified":return"text-yellow-400";case"deleted":return"text-red-400";case"renamed":return"text-yellow-400";default:return"text-neutral-500"}}function vv({status:e}){const l=`h-3.5 w-3.5 shrink-0 ${xv(e)}`;switch(e){case"modified":case"renamed":return ee.jsx(_x,{className:l});case"new":return ee.jsx(A2,{className:l});case"deleted":return ee.jsx(E2,{className:l});default:return null}}function Sv(e){const s=e.split("/"),l=s.pop()??e;return{dir:s.length>0?`${s.join("/")}/`:"",name:l}}function C_({entry:e,statusField:s,selectedPath:l,onSelect:h,actionLabel:g,onAction:m}){const w=e[s],{dir:b,name:C}=Sv(e.path),S=l===e.path;return ee.jsxs("div",{role:"button",tabIndex:0,className:`group flex w-full items-center gap-1.5 px-4 py-1 text-sm transition-colors cursor-pointer ${S?"bg-neutral-700":"hover:bg-neutral-800"}`,onClick:()=>h?.(e.path),onKeyDown:M=>{(M.key==="Enter"||M.key===" ")&&h?.(e.path)},children:[ee.jsx(vv,{status:w}),ee.jsxs("span",{className:"truncate flex-1 text-left",children:[ee.jsx("span",{className:"text-neutral-500",children:b}),ee.jsx("span",{className:"font-semibold",children:C})]}),ee.jsx("button",{type:"button",className:"hidden group-hover:inline-flex items-center justify-center h-5 w-5 rounded hover:bg-neutral-600 shrink-0",onClick:M=>{M.stopPropagation(),m()},title:g,children:s==="worktree_status"?ee.jsx(A2,{className:"h-3.5 w-3.5"}):ee.jsx(E2,{className:"h-3.5 w-3.5"})})]})}function E_({title:e,count:s,defaultOpen:l=!0,children:h}){const[g,m]=Te.useState(l);return ee.jsxs("div",{className:"overflow-hidden",children:[ee.jsxs("button",{type:"button",className:"flex w-full items-center gap-1 px-2 py-1 text-xs font-semibold uppercase tracking-wide hover:bg-neutral-800 transition-colors",onClick:()=>m(!g),children:[g?ee.jsx(nx,{className:"h-3.5 w-3.5 shrink-0"}):ee.jsx(lx,{className:"h-3.5 w-3.5 shrink-0"}),ee.jsxs("span",{className:"flex-1 text-left truncate",children:[e,s!=null?` (${s})`:""]})]}),g&&h]})}function yv({stagedFiles:e,changedFiles:s,selectedPath:l,onSelectFile:h,onStage:g,onUnstage:m,error:w,onClearError:b,onNavigateToDiff:C,onRefresh:S}){const M=e.length+s.length,N=Te.useCallback(L=>{h(L),C?.()},[h,C]),k=Te.useCallback(()=>g([]),[g]),P=Te.useCallback(()=>m([]),[m]);return ee.jsxs("div",{className:"h-full flex flex-col bg-neutral-900",children:[ee.jsxs("div",{className:"flex items-center gap-2 h-[30px] px-3 border-b border-neutral-800 shrink-0",children:[ee.jsxs("span",{className:"text-xs font-semibold uppercase tracking-wide truncate text-neutral-400 flex-1",children:[M," file changes"]}),S&&ee.jsx("button",{type:"button",className:"inline-flex items-center justify-center h-5 w-5 rounded text-neutral-400 hover:text-neutral-200 hover:bg-neutral-700 transition-colors shrink-0",onClick:S,title:"Refresh",children:ee.jsx(xx,{className:"h-3.5 w-3.5"})})]}),ee.jsxs("div",{className:"flex-1 overflow-y-auto",style:{minHeight:0},children:[ee.jsxs(E_,{title:"Unstaged",count:s.length,children:[s.length===0&&ee.jsx("div",{className:"px-4 py-1.5 text-xs text-neutral-500",children:"No unstaged changes"}),s.length>0&&ee.jsx("div",{className:"flex justify-end px-2 py-0.5",children:ee.jsx("button",{type:"button",className:"text-[10px] text-neutral-400 hover:text-neutral-200 transition-colors",onClick:k,children:"Stage All"})}),s.map(L=>ee.jsx(C_,{entry:L,statusField:"worktree_status",selectedPath:l,onSelect:N,actionLabel:"Stage",onAction:()=>g([L.path])},`changed-${L.path}`))]}),ee.jsxs(E_,{title:"Staged",count:e.length,children:[e.length===0&&ee.jsx("div",{className:"px-4 py-1.5 text-xs text-neutral-500",children:"No staged changes"}),e.length>0&&ee.jsx("div",{className:"flex justify-end px-2 py-0.5",children:ee.jsx("button",{type:"button",className:"text-[10px] text-neutral-400 hover:text-neutral-200 transition-colors",onClick:P,children:"Unstage All"})}),e.map(L=>ee.jsx(C_,{entry:L,statusField:"index_status",selectedPath:l,onSelect:N,actionLabel:"Unstage",onAction:()=>m([L.path])},`staged-${L.path}`))]}),M===0&&ee.jsx("div",{className:"px-3 py-4 text-sm text-neutral-500",children:"No changes"})]}),w&&ee.jsxs("div",{className:"flex items-start gap-1 px-3 py-2 text-red-400 text-xs border-t border-neutral-800",children:[ee.jsx("span",{className:"flex-1 break-all",children:w}),ee.jsx("button",{type:"button",className:"shrink-0",onClick:b,children:ee.jsx(Cx,{className:"h-3 w-3"})})]})]})}var O2=Object.defineProperty,wv=Object.getOwnPropertyDescriptor,bv=(e,s)=>{for(var l in s)O2(e,l,{get:s[l],enumerable:!0})},fi=(e,s,l,h)=>{for(var g=h>1?void 0:h?wv(s,l):s,m=e.length-1,w;m>=0;m--)(w=e[m])&&(g=(h?w(s,l,g):w(g))||g);return h&&g&&O2(s,l,g),g},Be=(e,s)=>(l,h)=>s(l,h,e),A_="Terminal input",id={get:()=>A_,set:e=>A_=e},T_="Too much output to announce, navigate to rows manually to read",sd={get:()=>T_,set:e=>T_=e};function Cv(e){return e.replace(/\r?\n/g,"\r")}function Ev(e,s){return s?"\x1B[200~"+e+"\x1B[201~":e}function Av(e,s){e.clipboardData&&e.clipboardData.setData("text/plain",s.selectionText),e.preventDefault()}function Tv(e,s,l,h){if(e.stopPropagation(),e.clipboardData){let g=e.clipboardData.getData("text/plain");M2(g,s,l,h)}}function M2(e,s,l,h){e=Cv(e),e=Ev(e,l.decPrivateModes.bracketedPasteMode&&h.rawOptions.ignoreBracketedPasteMode!==!0),l.triggerDataEvent(e,!0),s.value=""}function B2(e,s,l){let h=l.getBoundingClientRect(),g=e.clientX-h.left-10,m=e.clientY-h.top-10;s.style.width="20px",s.style.height="20px",s.style.left=`${g}px`,s.style.top=`${m}px`,s.style.zIndex="1000",s.focus()}function R_(e,s,l,h,g){B2(e,s,l),g&&h.rightClickSelect(e),s.value=h.selectionText,s.select()}function Qn(e){return e>65535?(e-=65536,String.fromCharCode((e>>10)+55296)+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)}function Mh(e,s=0,l=e.length){let h="";for(let g=s;g<l;++g){let m=e[g];m>65535?(m-=65536,h+=String.fromCharCode((m>>10)+55296)+String.fromCharCode(m%1024+56320)):h+=String.fromCharCode(m)}return h}var Rv=class{constructor(){this._interim=0}clear(){this._interim=0}decode(e,s){let l=e.length;if(!l)return 0;let h=0,g=0;if(this._interim){let m=e.charCodeAt(g++);56320<=m&&m<=57343?s[h++]=(this._interim-55296)*1024+m-56320+65536:(s[h++]=this._interim,s[h++]=m),this._interim=0}for(let m=g;m<l;++m){let w=e.charCodeAt(m);if(55296<=w&&w<=56319){if(++m>=l)return this._interim=w,h;let b=e.charCodeAt(m);56320<=b&&b<=57343?s[h++]=(w-55296)*1024+b-56320+65536:(s[h++]=w,s[h++]=b);continue}w!==65279&&(s[h++]=w)}return h}},Nv=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(e,s){let l=e.length;if(!l)return 0;let h=0,g,m,w,b,C=0,S=0;if(this.interim[0]){let k=!1,P=this.interim[0];P&=(P&224)===192?31:(P&240)===224?15:7;let L=0,X;for(;(X=this.interim[++L]&63)&&L<4;)P<<=6,P|=X;let pe=(this.interim[0]&224)===192?2:(this.interim[0]&240)===224?3:4,me=pe-L;for(;S<me;){if(S>=l)return 0;if(X=e[S++],(X&192)!==128){S--,k=!0;break}else this.interim[L++]=X,P<<=6,P|=X&63}k||(pe===2?P<128?S--:s[h++]=P:pe===3?P<2048||P>=55296&&P<=57343||P===65279||(s[h++]=P):P<65536||P>1114111||(s[h++]=P)),this.interim.fill(0)}let M=l-4,N=S;for(;N<l;){for(;N<M&&!((g=e[N])&128)&&!((m=e[N+1])&128)&&!((w=e[N+2])&128)&&!((b=e[N+3])&128);)s[h++]=g,s[h++]=m,s[h++]=w,s[h++]=b,N+=4;if(g=e[N++],g<128)s[h++]=g;else if((g&224)===192){if(N>=l)return this.interim[0]=g,h;if(m=e[N++],(m&192)!==128){N--;continue}if(C=(g&31)<<6|m&63,C<128){N--;continue}s[h++]=C}else if((g&240)===224){if(N>=l)return this.interim[0]=g,h;if(m=e[N++],(m&192)!==128){N--;continue}if(N>=l)return this.interim[0]=g,this.interim[1]=m,h;if(w=e[N++],(w&192)!==128){N--;continue}if(C=(g&15)<<12|(m&63)<<6|w&63,C<2048||C>=55296&&C<=57343||C===65279)continue;s[h++]=C}else if((g&248)===240){if(N>=l)return this.interim[0]=g,h;if(m=e[N++],(m&192)!==128){N--;continue}if(N>=l)return this.interim[0]=g,this.interim[1]=m,h;if(w=e[N++],(w&192)!==128){N--;continue}if(N>=l)return this.interim[0]=g,this.interim[1]=m,this.interim[2]=w,h;if(b=e[N++],(b&192)!==128){N--;continue}if(C=(g&7)<<18|(m&63)<<12|(w&63)<<6|b&63,C<65536||C>1114111)continue;s[h++]=C}}return h}},I2="",Jn=" ",zo=class k2{constructor(){this.fg=0,this.bg=0,this.extended=new Ch}static toColorRGB(s){return[s>>>16&255,s>>>8&255,s&255]}static fromColorRGB(s){return(s[0]&255)<<16|(s[1]&255)<<8|s[2]&255}clone(){let s=new k2;return s.fg=this.fg,s.bg=this.bg,s.extended=this.extended.clone(),s}isInverse(){return this.fg&67108864}isBold(){return this.fg&134217728}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:this.fg&268435456}isBlink(){return this.fg&536870912}isInvisible(){return this.fg&1073741824}isItalic(){return this.bg&67108864}isDim(){return this.bg&134217728}isStrikethrough(){return this.fg&2147483648}isProtected(){return this.bg&536870912}isOverline(){return this.bg&1073741824}getFgColorMode(){return this.fg&50331648}getBgColorMode(){return this.bg&50331648}isFgRGB(){return(this.fg&50331648)===50331648}isBgRGB(){return(this.bg&50331648)===50331648}isFgPalette(){return(this.fg&50331648)===16777216||(this.fg&50331648)===33554432}isBgPalette(){return(this.bg&50331648)===16777216||(this.bg&50331648)===33554432}isFgDefault(){return(this.fg&50331648)===0}isBgDefault(){return(this.bg&50331648)===0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(this.fg&50331648){case 16777216:case 33554432:return this.fg&255;case 50331648:return this.fg&16777215;default:return-1}}getBgColor(){switch(this.bg&50331648){case 16777216:case 33554432:return this.bg&255;case 50331648:return this.bg&16777215;default:return-1}}hasExtendedAttrs(){return this.bg&268435456}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(this.bg&268435456&&~this.extended.underlineColor)switch(this.extended.underlineColor&50331648){case 16777216:case 33554432:return this.extended.underlineColor&255;case 50331648:return this.extended.underlineColor&16777215;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return this.bg&268435456&&~this.extended.underlineColor?this.extended.underlineColor&50331648:this.getFgColorMode()}isUnderlineColorRGB(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===50331648:this.isFgRGB()}isUnderlineColorPalette(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===16777216||(this.extended.underlineColor&50331648)===33554432:this.isFgPalette()}isUnderlineColorDefault(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===0:this.isFgDefault()}getUnderlineStyle(){return this.fg&268435456?this.bg&268435456?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}},Ch=class L2{constructor(s=0,l=0){this._ext=0,this._urlId=0,this._ext=s,this._urlId=l}get ext(){return this._urlId?this._ext&-469762049|this.underlineStyle<<26:this._ext}set ext(s){this._ext=s}get underlineStyle(){return this._urlId?5:(this._ext&469762048)>>26}set underlineStyle(s){this._ext&=-469762049,this._ext|=s<<26&469762048}get underlineColor(){return this._ext&67108863}set underlineColor(s){this._ext&=-67108864,this._ext|=s&67108863}get urlId(){return this._urlId}set urlId(s){this._urlId=s}get underlineVariantOffset(){let s=(this._ext&3758096384)>>29;return s<0?s^4294967288:s}set underlineVariantOffset(s){this._ext&=536870911,this._ext|=s<<29&3758096384}clone(){return new L2(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}},sr=class P2 extends zo{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new Ch,this.combinedData=""}static fromCharData(s){let l=new P2;return l.setFromCharData(s),l}isCombined(){return this.content&2097152}getWidth(){return this.content>>22}getChars(){return this.content&2097152?this.combinedData:this.content&2097151?Qn(this.content&2097151):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):this.content&2097151}setFromCharData(s){this.fg=s[0],this.bg=0;let l=!1;if(s[1].length>2)l=!0;else if(s[1].length===2){let h=s[1].charCodeAt(0);if(55296<=h&&h<=56319){let g=s[1].charCodeAt(1);56320<=g&&g<=57343?this.content=(h-55296)*1024+g-56320+65536|s[2]<<22:l=!0}else l=!0}else this.content=s[1].charCodeAt(0)|s[2]<<22;l&&(this.combinedData=s[1],this.content=2097152|s[2]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},N_="di$target",rd="di$dependencies",Hf=new Map;function Dv(e){return e[rd]||[]}function Wi(e){if(Hf.has(e))return Hf.get(e);let s=function(l,h,g){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");Ov(s,l,g)};return s._id=e,Hf.set(e,s),s}function Ov(e,s,l){s[N_]===s?s[rd].push({id:e,index:l}):(s[rd]=[{id:e,index:l}],s[N_]=s)}var hs=Wi("BufferService"),H2=Wi("CoreMouseService"),Ba=Wi("CoreService"),Mv=Wi("CharsetService"),Ud=Wi("InstantiationService"),z2=Wi("LogService"),us=Wi("OptionsService"),F2=Wi("OscLinkService"),Bv=Wi("UnicodeService"),Fo=Wi("DecorationService"),nd=class{constructor(e,s,l){this._bufferService=e,this._optionsService=s,this._oscLinkService=l}provideLinks(e,s){let l=this._bufferService.buffer.lines.get(e-1);if(!l){s(void 0);return}let h=[],g=this._optionsService.rawOptions.linkHandler,m=new sr,w=l.getTrimmedLength(),b=-1,C=-1,S=!1;for(let M=0;M<w;M++)if(!(C===-1&&!l.hasContent(M))){if(l.loadCell(M,m),m.hasExtendedAttrs()&&m.extended.urlId)if(C===-1){C=M,b=m.extended.urlId;continue}else S=m.extended.urlId!==b;else C!==-1&&(S=!0);if(S||C!==-1&&M===w-1){let N=this._oscLinkService.getLinkData(b)?.uri;if(N){let k={start:{x:C+1,y:e},end:{x:M+(!S&&M===w-1?1:0),y:e}},P=!1;if(!g?.allowNonHttpProtocols)try{let L=new URL(N);["http:","https:"].includes(L.protocol)||(P=!0)}catch{P=!0}P||h.push({text:N,range:k,activate:(L,X)=>g?g.activate(L,X,k):Iv(L,X),hover:(L,X)=>g?.hover?.(L,X,k),leave:(L,X)=>g?.leave?.(L,X,k)})}S=!1,m.hasExtendedAttrs()&&m.extended.urlId?(C=M,b=m.extended.urlId):(C=-1,b=-1)}}s(h)}};nd=fi([Be(0,hs),Be(1,us),Be(2,F2)],nd);function Iv(e,s){if(confirm(`Do you want to navigate to ${s}?

WARNING: This link could potentially be dangerous`)){let l=window.open();if(l){try{l.opener=null}catch{}l.location.href=s}else console.warn("Opening link blocked as opener could not be cleared")}}var Bh=Wi("CharSizeService"),ln=Wi("CoreBrowserService"),Vd=Wi("MouseService"),on=Wi("RenderService"),kv=Wi("SelectionService"),U2=Wi("CharacterJoinerService"),Cl=Wi("ThemeService"),V2=Wi("LinkProviderService"),Lv=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?D_.isErrorNoTelemetry(e)?new D_(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(s=>{s(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},Pv=new Lv;function gh(e){Hv(e)||Pv.onUnexpectedError(e)}var ad="Canceled";function Hv(e){return e instanceof zv?!0:e instanceof Error&&e.name===ad&&e.message===ad}var zv=class extends Error{constructor(){super(ad),this.name=this.message}};function Fv(e){return new Error(`Illegal argument: ${e}`)}var D_=class ld extends Error{constructor(s){super(s),this.name="CodeExpectedError"}static fromError(s){if(s instanceof ld)return s;let l=new ld;return l.message=s.message,l.stack=s.stack,l}static isErrorNoTelemetry(s){return s.name==="CodeExpectedError"}},od=class W2 extends Error{constructor(s){super(s||"An unexpected bug occurred."),Object.setPrototypeOf(this,W2.prototype)}};function Ps(e,s=0){return e[e.length-(1+s)]}var Uv;(e=>{function s(m){return m<0}e.isLessThan=s;function l(m){return m<=0}e.isLessThanOrEqual=l;function h(m){return m>0}e.isGreaterThan=h;function g(m){return m===0}e.isNeitherLessOrGreaterThan=g,e.greaterThan=1,e.lessThan=-1,e.neitherLessOrGreaterThan=0})(Uv||={});function Vv(e,s){let l=this,h=!1,g;return function(){return h||(h=!0,s||(g=e.apply(l,arguments))),g}}var G2;(e=>{function s(le){return le&&typeof le=="object"&&typeof le[Symbol.iterator]=="function"}e.is=s;let l=Object.freeze([]);function h(){return l}e.empty=h;function*g(le){yield le}e.single=g;function m(le){return s(le)?le:g(le)}e.wrap=m;function w(le){return le||l}e.from=w;function*b(le){for(let Oe=le.length-1;Oe>=0;Oe--)yield le[Oe]}e.reverse=b;function C(le){return!le||le[Symbol.iterator]().next().done===!0}e.isEmpty=C;function S(le){return le[Symbol.iterator]().next().value}e.first=S;function M(le,Oe){let Re=0;for(let Y of le)if(Oe(Y,Re++))return!0;return!1}e.some=M;function N(le,Oe){for(let Re of le)if(Oe(Re))return Re}e.find=N;function*k(le,Oe){for(let Re of le)Oe(Re)&&(yield Re)}e.filter=k;function*P(le,Oe){let Re=0;for(let Y of le)yield Oe(Y,Re++)}e.map=P;function*L(le,Oe){let Re=0;for(let Y of le)yield*Oe(Y,Re++)}e.flatMap=L;function*X(...le){for(let Oe of le)yield*Oe}e.concat=X;function pe(le,Oe,Re){let Y=Re;for(let Ne of le)Y=Oe(Y,Ne);return Y}e.reduce=pe;function*me(le,Oe,Re=le.length){for(Oe<0&&(Oe+=le.length),Re<0?Re+=le.length:Re>le.length&&(Re=le.length);Oe<Re;Oe++)yield le[Oe]}e.slice=me;function he(le,Oe=Number.POSITIVE_INFINITY){let Re=[];if(Oe===0)return[Re,le];let Y=le[Symbol.iterator]();for(let Ne=0;Ne<Oe;Ne++){let de=Y.next();if(de.done)return[Re,e.empty()];Re.push(de.value)}return[Re,{[Symbol.iterator](){return Y}}]}e.consume=he;async function te(le){let Oe=[];for await(let Re of le)Oe.push(Re);return Promise.resolve(Oe)}e.asyncToArray=te})(G2||={});function Oa(e){if(G2.is(e)){let s=[];for(let l of e)if(l)try{l.dispose()}catch(h){s.push(h)}if(s.length===1)throw s[0];if(s.length>1)throw new AggregateError(s,"Encountered errors while disposing of store");return Array.isArray(e)?[]:e}else if(e)return e.dispose(),e}function Wv(...e){return ei(()=>Oa(e))}function ei(e){return{dispose:Vv(()=>{e()})}}var X2=class Y2{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Oa(this._toDispose)}finally{this._toDispose.clear()}}add(s){if(!s)return s;if(s===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?Y2.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(s),s}delete(s){if(s){if(s===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(s),s.dispose()}}deleteAndLeak(s){s&&this._toDispose.has(s)&&(this._toDispose.delete(s),void 0)}};X2.DISABLE_DISPOSED_WARNING=!1;var $n=X2,lt=class{constructor(){this._store=new $n,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};lt.None=Object.freeze({dispose(){}});var bl=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e}},an=typeof window=="object"?window:globalThis,cd=class hd{constructor(s){this.element=s,this.next=hd.Undefined,this.prev=hd.Undefined}};cd.Undefined=new cd(void 0);var si=cd,O_=class{constructor(){this._first=si.Undefined,this._last=si.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===si.Undefined}clear(){let e=this._first;for(;e!==si.Undefined;){let s=e.next;e.prev=si.Undefined,e.next=si.Undefined,e=s}this._first=si.Undefined,this._last=si.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,s){let l=new si(e);if(this._first===si.Undefined)this._first=l,this._last=l;else if(s){let g=this._last;this._last=l,l.prev=g,g.next=l}else{let g=this._first;this._first=l,l.next=g,g.prev=l}this._size+=1;let h=!1;return()=>{h||(h=!0,this._remove(l))}}shift(){if(this._first!==si.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==si.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==si.Undefined&&e.next!==si.Undefined){let s=e.prev;s.next=e.next,e.next.prev=s}else e.prev===si.Undefined&&e.next===si.Undefined?(this._first=si.Undefined,this._last=si.Undefined):e.next===si.Undefined?(this._last=this._last.prev,this._last.next=si.Undefined):e.prev===si.Undefined&&(this._first=this._first.next,this._first.prev=si.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==si.Undefined;)yield e.element,e=e.next}},Gv=globalThis.performance&&typeof globalThis.performance.now=="function",Xv=class j2{static create(s){return new j2(s)}constructor(s){this._now=Gv&&s===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}},Ji;(e=>{e.None=()=>lt.None;function s(oe,ae){return N(oe,()=>{},0,void 0,!0,void 0,ae)}e.defer=s;function l(oe){return(ae,Ee=null,U)=>{let W=!1,Z;return Z=oe(ue=>{if(!W)return Z?Z.dispose():W=!0,ae.call(Ee,ue)},null,U),W&&Z.dispose(),Z}}e.once=l;function h(oe,ae,Ee){return S((U,W=null,Z)=>oe(ue=>U.call(W,ae(ue)),null,Z),Ee)}e.map=h;function g(oe,ae,Ee){return S((U,W=null,Z)=>oe(ue=>{ae(ue),U.call(W,ue)},null,Z),Ee)}e.forEach=g;function m(oe,ae,Ee){return S((U,W=null,Z)=>oe(ue=>ae(ue)&&U.call(W,ue),null,Z),Ee)}e.filter=m;function w(oe){return oe}e.signal=w;function b(...oe){return(ae,Ee=null,U)=>{let W=Wv(...oe.map(Z=>Z(ue=>ae.call(Ee,ue))));return M(W,U)}}e.any=b;function C(oe,ae,Ee,U){let W=Ee;return h(oe,Z=>(W=ae(W,Z),W),U)}e.reduce=C;function S(oe,ae){let Ee,U={onWillAddFirstListener(){Ee=oe(W.fire,W)},onDidRemoveLastListener(){Ee?.dispose()}},W=new De(U);return ae?.add(W),W.event}function M(oe,ae){return ae instanceof Array?ae.push(oe):ae&&ae.add(oe),oe}function N(oe,ae,Ee=100,U=!1,W=!1,Z,ue){let Le,Me,H,re=0,ye,be={leakWarningThreshold:Z,onWillAddFirstListener(){Le=oe(Se=>{re++,Me=ae(Me,Se),U&&!H&&(Ve.fire(Me),Me=void 0),ye=()=>{let $e=Me;Me=void 0,H=void 0,(!U||re>1)&&Ve.fire($e),re=0},typeof Ee=="number"?(clearTimeout(H),H=setTimeout(ye,Ee)):H===void 0&&(H=0,queueMicrotask(ye))})},onWillRemoveListener(){W&&re>0&&ye?.()},onDidRemoveLastListener(){ye=void 0,Le.dispose()}},Ve=new De(be);return ue?.add(Ve),Ve.event}e.debounce=N;function k(oe,ae=0,Ee){return e.debounce(oe,(U,W)=>U?(U.push(W),U):[W],ae,void 0,!0,void 0,Ee)}e.accumulate=k;function P(oe,ae=(U,W)=>U===W,Ee){let U=!0,W;return m(oe,Z=>{let ue=U||!ae(Z,W);return U=!1,W=Z,ue},Ee)}e.latch=P;function L(oe,ae,Ee){return[e.filter(oe,ae,Ee),e.filter(oe,U=>!ae(U),Ee)]}e.split=L;function X(oe,ae=!1,Ee=[],U){let W=Ee.slice(),Z=oe(Me=>{W?W.push(Me):Le.fire(Me)});U&&U.add(Z);let ue=()=>{W?.forEach(Me=>Le.fire(Me)),W=null},Le=new De({onWillAddFirstListener(){Z||(Z=oe(Me=>Le.fire(Me)),U&&U.add(Z))},onDidAddFirstListener(){W&&(ae?setTimeout(ue):ue())},onDidRemoveLastListener(){Z&&Z.dispose(),Z=null}});return U&&U.add(Le),Le.event}e.buffer=X;function pe(oe,ae){return(Ee,U,W)=>{let Z=ae(new he);return oe(function(ue){let Le=Z.evaluate(ue);Le!==me&&Ee.call(U,Le)},void 0,W)}}e.chain=pe;let me=Symbol("HaltChainable");class he{constructor(){this.steps=[]}map(ae){return this.steps.push(ae),this}forEach(ae){return this.steps.push(Ee=>(ae(Ee),Ee)),this}filter(ae){return this.steps.push(Ee=>ae(Ee)?Ee:me),this}reduce(ae,Ee){let U=Ee;return this.steps.push(W=>(U=ae(U,W),U)),this}latch(ae=(Ee,U)=>Ee===U){let Ee=!0,U;return this.steps.push(W=>{let Z=Ee||!ae(W,U);return Ee=!1,U=W,Z?W:me}),this}evaluate(ae){for(let Ee of this.steps)if(ae=Ee(ae),ae===me)break;return ae}}function te(oe,ae,Ee=U=>U){let U=(...Le)=>ue.fire(Ee(...Le)),W=()=>oe.on(ae,U),Z=()=>oe.removeListener(ae,U),ue=new De({onWillAddFirstListener:W,onDidRemoveLastListener:Z});return ue.event}e.fromNodeEventEmitter=te;function le(oe,ae,Ee=U=>U){let U=(...Le)=>ue.fire(Ee(...Le)),W=()=>oe.addEventListener(ae,U),Z=()=>oe.removeEventListener(ae,U),ue=new De({onWillAddFirstListener:W,onDidRemoveLastListener:Z});return ue.event}e.fromDOMEventEmitter=le;function Oe(oe){return new Promise(ae=>l(oe)(ae))}e.toPromise=Oe;function Re(oe){let ae=new De;return oe.then(Ee=>{ae.fire(Ee)},()=>{ae.fire(void 0)}).finally(()=>{ae.dispose()}),ae.event}e.fromPromise=Re;function Y(oe,ae){return oe(Ee=>ae.fire(Ee))}e.forward=Y;function Ne(oe,ae,Ee){return ae(Ee),oe(U=>ae(U))}e.runAndSubscribe=Ne;class de{constructor(ae,Ee){this._observable=ae,this._counter=0,this._hasChanged=!1;let U={onWillAddFirstListener:()=>{ae.addObserver(this)},onDidRemoveLastListener:()=>{ae.removeObserver(this)}};this.emitter=new De(U),Ee&&Ee.add(this.emitter)}beginUpdate(ae){this._counter++}handlePossibleChange(ae){}handleChange(ae,Ee){this._hasChanged=!0}endUpdate(ae){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function Gt(oe,ae){return new de(oe,ae).emitter.event}e.fromObservable=Gt;function je(oe){return(ae,Ee,U)=>{let W=0,Z=!1,ue={beginUpdate(){W++},endUpdate(){W--,W===0&&(oe.reportChanges(),Z&&(Z=!1,ae.call(Ee)))},handlePossibleChange(){},handleChange(){Z=!0}};oe.addObserver(ue),oe.reportChanges();let Le={dispose(){oe.removeObserver(ue)}};return U instanceof $n?U.add(Le):Array.isArray(U)&&U.push(Le),Le}}e.fromObservableLight=je})(Ji||={});var ud=class fd{constructor(s){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${s}_${fd._idPool++}`,fd.all.add(this)}start(s){this._stopWatch=new Xv,this.listenerCount=s}stop(){if(this._stopWatch){let s=this._stopWatch.elapsed();this.durations.push(s),this.elapsedOverall+=s,this.invocationCount+=1,this._stopWatch=void 0}}};ud.all=new Set,ud._idPool=0;var Yv=ud,jv=-1,q2=class K2{constructor(s,l,h=(K2._idPool++).toString(16).padStart(3,"0")){this._errorHandler=s,this.threshold=l,this.name=h,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(s,l){let h=this.threshold;if(h<=0||l<h)return;this._stacks||(this._stacks=new Map);let g=this._stacks.get(s.value)||0;if(this._stacks.set(s.value,g+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=h*.5;let[m,w]=this.getMostFrequentStack(),b=`[${this.name}] potential listener LEAK detected, having ${l} listeners already. MOST frequent listener (${w}):`;console.warn(b),console.warn(m);let C=new Zv(b,m);this._errorHandler(C)}return()=>{let m=this._stacks.get(s.value)||0;this._stacks.set(s.value,m-1)}}getMostFrequentStack(){if(!this._stacks)return;let s,l=0;for(let[h,g]of this._stacks)(!s||l<g)&&(s=[h,g],l=g);return s}};q2._idPool=1;var qv=q2,Kv=class Z2{constructor(s){this.value=s}static create(){let s=new Error;return new Z2(s.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},Zv=class extends Error{constructor(e,s){super(e),this.name="ListenerLeakError",this.stack=s}},Qv=class extends Error{constructor(e,s){super(e),this.name="ListenerRefusalError",this.stack=s}},Jv=0,zf=class{constructor(e){this.value=e,this.id=Jv++}},$v=2,eS,De=class{constructor(e){this._size=0,this._options=e,this._leakageMon=this._options?.leakWarningThreshold?new qv(e?.onListenerError??gh,this._options?.leakWarningThreshold??jv):void 0,this._perfMon=this._options?._profName?new Yv(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??=(e,s,l)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let w=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(w);let b=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],C=new Qv(`${w}. HINT: Stack shows most frequent listener (${b[1]}-times)`,b[0]);return(this._options?.onListenerError||gh)(C),lt.None}if(this._disposed)return lt.None;s&&(e=e.bind(s));let h=new zf(e),g;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(h.stack=Kv.create(),g=this._leakageMon.check(h.stack,this._size+1)),this._listeners?this._listeners instanceof zf?(this._deliveryQueue??=new tS,this._listeners=[this._listeners,h]):this._listeners.push(h):(this._options?.onWillAddFirstListener?.(this),this._listeners=h,this._options?.onDidAddFirstListener?.(this)),this._size++;let m=ei(()=>{g?.(),this._removeListener(h)});return l instanceof $n?l.add(m):Array.isArray(l)&&l.push(m),m},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let s=this._listeners,l=s.indexOf(e);if(l===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,s[l]=void 0;let h=this._deliveryQueue.current===this;if(this._size*$v<=s.length){let g=0;for(let m=0;m<s.length;m++)s[m]?s[g++]=s[m]:h&&(this._deliveryQueue.end--,g<this._deliveryQueue.i&&this._deliveryQueue.i--);s.length=g}}_deliver(e,s){if(!e)return;let l=this._options?.onListenerError||gh;if(!l){e.value(s);return}try{e.value(s)}catch(h){l(h)}}_deliverQueue(e){let s=e.current._listeners;for(;e.i<e.end;)this._deliver(s[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof zf)this._deliver(this._listeners,e);else{let s=this._deliveryQueue;s.enqueue(this,e,this._listeners.length),this._deliverQueue(s)}this._perfMon?.stop()}hasListeners(){return this._size>0}},tS=class{constructor(){this.i=-1,this.end=0}enqueue(e,s,l){this.i=0,this.end=l,this.current=e,this.value=s}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},dd=class{constructor(){this.mapWindowIdToZoomLevel=new Map,this._onDidChangeZoomLevel=new De,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this.mapWindowIdToZoomFactor=new Map,this._onDidChangeFullscreen=new De,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event,this.mapWindowIdToFullScreen=new Map}getZoomLevel(s){return this.mapWindowIdToZoomLevel.get(this.getWindowId(s))??0}setZoomLevel(s,l){if(this.getZoomLevel(l)===s)return;let h=this.getWindowId(l);this.mapWindowIdToZoomLevel.set(h,s),this._onDidChangeZoomLevel.fire(h)}getZoomFactor(s){return this.mapWindowIdToZoomFactor.get(this.getWindowId(s))??1}setZoomFactor(s,l){this.mapWindowIdToZoomFactor.set(this.getWindowId(l),s)}setFullscreen(s,l){if(this.isFullscreen(l)===s)return;let h=this.getWindowId(l);this.mapWindowIdToFullScreen.set(h,s),this._onDidChangeFullscreen.fire(h)}isFullscreen(s){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(s))}getWindowId(s){return s.vscodeWindowId}};dd.INSTANCE=new dd;var Wd=dd;function iS(e,s,l){typeof s=="string"&&(s=e.matchMedia(s)),s.addEventListener("change",l)}Wd.INSTANCE.onDidChangeZoomLevel;function sS(e){return Wd.INSTANCE.getZoomFactor(e)}Wd.INSTANCE.onDidChangeFullscreen;var El=typeof navigator=="object"?navigator.userAgent:"",gd=El.indexOf("Firefox")>=0,rS=El.indexOf("AppleWebKit")>=0,Gd=El.indexOf("Chrome")>=0,nS=!Gd&&El.indexOf("Safari")>=0;El.indexOf("Electron/")>=0;El.indexOf("Android")>=0;var Ff=!1;if(typeof an.matchMedia=="function"){let e=an.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),s=an.matchMedia("(display-mode: fullscreen)");Ff=e.matches,iS(an,e,({matches:l})=>{Ff&&s.matches||(Ff=l)})}var wl="en",_d=!1,md=!1,_h=!1,Q2=!1,oh,mh=wl,M_=wl,aS,nn,Da=globalThis,Fs;typeof Da.vscode<"u"&&typeof Da.vscode.process<"u"?Fs=Da.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Fs=process);var lS=typeof Fs?.versions?.electron=="string",oS=lS&&Fs?.type==="renderer";if(typeof Fs=="object"){_d=Fs.platform==="win32",md=Fs.platform==="darwin",_h=Fs.platform==="linux",_h&&Fs.env.SNAP&&Fs.env.SNAP_REVISION,Fs.env.CI||Fs.env.BUILD_ARTIFACTSTAGINGDIRECTORY,oh=wl,mh=wl;let e=Fs.env.VSCODE_NLS_CONFIG;if(e)try{let s=JSON.parse(e);oh=s.userLocale,M_=s.osLocale,mh=s.resolvedLanguage||wl,aS=s.languagePack?.translationsConfigFile}catch{}Q2=!0}else typeof navigator=="object"&&!oS?(nn=navigator.userAgent,_d=nn.indexOf("Windows")>=0,md=nn.indexOf("Macintosh")>=0,(nn.indexOf("Macintosh")>=0||nn.indexOf("iPad")>=0||nn.indexOf("iPhone")>=0)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0,_h=nn.indexOf("Linux")>=0,nn?.indexOf("Mobi")>=0,mh=globalThis._VSCODE_NLS_LANGUAGE||wl,oh=navigator.language.toLowerCase(),M_=oh):console.error("Unable to resolve platform.");var J2=_d,Or=md,cS=_h,B_=Q2,Mr=nn,Yn=mh,hS;(e=>{function s(){return Yn}e.value=s;function l(){return Yn.length===2?Yn==="en":Yn.length>=3?Yn[0]==="e"&&Yn[1]==="n"&&Yn[2]==="-":!1}e.isDefaultVariant=l;function h(){return Yn==="en"}e.isDefault=h})(hS||={});var uS=typeof Da.postMessage=="function"&&!Da.importScripts;(()=>{if(uS){let e=[];Da.addEventListener("message",l=>{if(l.data&&l.data.vscodeScheduleAsyncWork)for(let h=0,g=e.length;h<g;h++){let m=e[h];if(m.id===l.data.vscodeScheduleAsyncWork){e.splice(h,1),m.callback();return}}});let s=0;return l=>{let h=++s;e.push({id:h,callback:l}),Da.postMessage({vscodeScheduleAsyncWork:h},"*")}}return e=>setTimeout(e)})();var fS=!!(Mr&&Mr.indexOf("Chrome")>=0);Mr&&Mr.indexOf("Firefox")>=0;!fS&&Mr&&Mr.indexOf("Safari")>=0;Mr&&Mr.indexOf("Edg/")>=0;Mr&&Mr.indexOf("Android")>=0;var vl=typeof navigator=="object"?navigator:{};B_||document.queryCommandSupported&&document.queryCommandSupported("copy")||vl&&vl.clipboard&&vl.clipboard.writeText,B_||vl&&vl.clipboard&&vl.clipboard.readText;var Xd=class{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,s){this._keyCodeToStr[e]=s,this._strToKeyCode[s.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},Uf=new Xd,I_=new Xd,k_=new Xd,dS=new Array(230),$2;(e=>{function s(b){return Uf.keyCodeToStr(b)}e.toString=s;function l(b){return Uf.strToKeyCode(b)}e.fromString=l;function h(b){return I_.keyCodeToStr(b)}e.toUserSettingsUS=h;function g(b){return k_.keyCodeToStr(b)}e.toUserSettingsGeneral=g;function m(b){return I_.strToKeyCode(b)||k_.strToKeyCode(b)}e.fromUserSettings=m;function w(b){if(b>=98&&b<=113)return null;switch(b){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return Uf.keyCodeToStr(b)}e.toElectronAccelerator=w})($2||={});var gS=class em{constructor(s,l,h,g,m){this.ctrlKey=s,this.shiftKey=l,this.altKey=h,this.metaKey=g,this.keyCode=m}equals(s){return s instanceof em&&this.ctrlKey===s.ctrlKey&&this.shiftKey===s.shiftKey&&this.altKey===s.altKey&&this.metaKey===s.metaKey&&this.keyCode===s.keyCode}getHashCode(){let s=this.ctrlKey?"1":"0",l=this.shiftKey?"1":"0",h=this.altKey?"1":"0",g=this.metaKey?"1":"0";return`K${s}${l}${h}${g}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new _S([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},_S=class{constructor(e){if(e.length===0)throw Fv("chords");this.chords=e}getHashCode(){let e="";for(let s=0,l=this.chords.length;s<l;s++)s!==0&&(e+=";"),e+=this.chords[s].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let s=0;s<this.chords.length;s++)if(!this.chords[s].equals(e.chords[s]))return!1;return!0}};function mS(e){if(e.charCode){let l=String.fromCharCode(e.charCode).toUpperCase();return $2.fromString(l)}let s=e.keyCode;if(s===3)return 7;if(gd)switch(s){case 59:return 85;case 60:if(cS)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Or)return 57;break}else if(rS&&(Or&&s===93||!Or&&s===92))return 57;return dS[s]||0}var pS=Or?256:2048,xS=512,vS=1024,SS=Or?2048:256,L_=class{constructor(e){this._standardKeyboardEventBrand=!0;let s=e;this.browserEvent=s,this.target=s.target,this.ctrlKey=s.ctrlKey,this.shiftKey=s.shiftKey,this.altKey=s.altKey,this.metaKey=s.metaKey,this.altGraphKey=s.getModifierState?.("AltGraph"),this.keyCode=mS(s),this.code=s.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let s=0;return this.ctrlKey&&(s|=pS),this.altKey&&(s|=xS),this.shiftKey&&(s|=vS),this.metaKey&&(s|=SS),s|=e,s}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new gS(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}},P_=new WeakMap;function yS(e){if(!e.parent||e.parent===e)return null;try{let s=e.location,l=e.parent.location;if(s.origin!=="null"&&l.origin!=="null"&&s.origin!==l.origin)return null}catch{return null}return e.parent}var wS=class{static getSameOriginWindowChain(e){let s=P_.get(e);if(!s){s=[],P_.set(e,s);let l=e,h;do h=yS(l),h?s.push({window:new WeakRef(l),iframeElement:l.frameElement||null}):s.push({window:new WeakRef(l),iframeElement:null}),l=h;while(l)}return s.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,s){if(!s||e===s)return{top:0,left:0};let l=0,h=0,g=this.getSameOriginWindowChain(e);for(let m of g){let w=m.window.deref();if(l+=w?.scrollY??0,h+=w?.scrollX??0,w===s||!m.iframeElement)break;let b=m.iframeElement.getBoundingClientRect();l+=b.top,h+=b.left}return{top:l,left:h}}},ch=class{constructor(e,s){this.timestamp=Date.now(),this.browserEvent=s,this.leftButton=s.button===0,this.middleButton=s.button===1,this.rightButton=s.button===2,this.buttons=s.buttons,this.target=s.target,this.detail=s.detail||1,s.type==="dblclick"&&(this.detail=2),this.ctrlKey=s.ctrlKey,this.shiftKey=s.shiftKey,this.altKey=s.altKey,this.metaKey=s.metaKey,typeof s.pageX=="number"?(this.posx=s.pageX,this.posy=s.pageY):(this.posx=s.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=s.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let l=wS.getPositionOfChildWindowRelativeToAncestorWindow(e,s.view);this.posx-=l.left,this.posy-=l.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}},H_=class{constructor(e,s=0,l=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=l,this.deltaX=s;let h=!1;if(Gd){let g=navigator.userAgent.match(/Chrome\/(\d+)/);h=(g?parseInt(g[1]):123)<=122}if(e){let g=e,m=e,w=e.view?.devicePixelRatio||1;if(typeof g.wheelDeltaY<"u")h?this.deltaY=g.wheelDeltaY/(120*w):this.deltaY=g.wheelDeltaY/120;else if(typeof m.VERTICAL_AXIS<"u"&&m.axis===m.VERTICAL_AXIS)this.deltaY=-m.detail/3;else if(e.type==="wheel"){let b=e;b.deltaMode===b.DOM_DELTA_LINE?gd&&!Or?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof g.wheelDeltaX<"u")nS&&J2?this.deltaX=-(g.wheelDeltaX/120):h?this.deltaX=g.wheelDeltaX/(120*w):this.deltaX=g.wheelDeltaX/120;else if(typeof m.HORIZONTAL_AXIS<"u"&&m.axis===m.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let b=e;b.deltaMode===b.DOM_DELTA_LINE?gd&&!Or?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(h?this.deltaY=e.wheelDelta/(120*w):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}},tm=Object.freeze(function(e,s){let l=setTimeout(e.bind(s),0);return{dispose(){clearTimeout(l)}}}),bS;(e=>{function s(l){return l===e.None||l===e.Cancelled||l instanceof CS?!0:!l||typeof l!="object"?!1:typeof l.isCancellationRequested=="boolean"&&typeof l.onCancellationRequested=="function"}e.isCancellationToken=s,e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Ji.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:tm})})(bS||={});var CS=class{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?tm:(this._emitter||(this._emitter=new De),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},Yd=class{constructor(e,s){this._isDisposed=!1,this._token=-1,typeof e=="function"&&typeof s=="number"&&this.setIfNotSet(e,s)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,s){if(this._isDisposed)throw new od("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},s)}setIfNotSet(e,s){if(this._isDisposed)throw new od("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},s))}},ES=class{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,s,l=globalThis){if(this.isDisposed)throw new od("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let h=l.setInterval(()=>{e()},s);this.disposable=ei(()=>{l.clearInterval(h),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},AS;(e=>{async function s(h){let g,m=await Promise.all(h.map(w=>w.then(b=>b,b=>{g||(g=b)})));if(typeof g<"u")throw g;return m}e.settled=s;function l(h){return new Promise(async(g,m)=>{try{await h(g,m)}catch(w){m(w)}})}e.withAsyncBody=l})(AS||={});var z_=class tr{static fromArray(s){return new tr(l=>{l.emitMany(s)})}static fromPromise(s){return new tr(async l=>{l.emitMany(await s)})}static fromPromises(s){return new tr(async l=>{await Promise.all(s.map(async h=>l.emitOne(await h)))})}static merge(s){return new tr(async l=>{await Promise.all(s.map(async h=>{for await(let g of h)l.emitOne(g)}))})}constructor(s,l){this._state=0,this._results=[],this._error=null,this._onReturn=l,this._onStateChanged=new De,queueMicrotask(async()=>{let h={emitOne:g=>this.emitOne(g),emitMany:g=>this.emitMany(g),reject:g=>this.reject(g)};try{await Promise.resolve(s(h)),this.resolve()}catch(g){this.reject(g)}finally{h.emitOne=void 0,h.emitMany=void 0,h.reject=void 0}})}[Symbol.asyncIterator](){let s=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(s<this._results.length)return{done:!1,value:this._results[s++]};if(this._state===1)return{done:!0,value:void 0};await Ji.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(s,l){return new tr(async h=>{for await(let g of s)h.emitOne(l(g))})}map(s){return tr.map(this,s)}static filter(s,l){return new tr(async h=>{for await(let g of s)l(g)&&h.emitOne(g)})}filter(s){return tr.filter(this,s)}static coalesce(s){return tr.filter(s,l=>!!l)}coalesce(){return tr.coalesce(this)}static async toPromise(s){let l=[];for await(let h of s)l.push(h);return l}toPromise(){return tr.toPromise(this)}emitOne(s){this._state===0&&(this._results.push(s),this._onStateChanged.fire())}emitMany(s){this._state===0&&(this._results=this._results.concat(s),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(s){this._state===0&&(this._state=2,this._error=s,this._onStateChanged.fire())}};z_.EMPTY=z_.fromArray([]);var{getWindow:Dr,getWindowId:TS,onDidRegisterWindow:RS}=(function(){let e=new Map,s={window:an,disposables:new $n};e.set(an.vscodeWindowId,s);let l=new De,h=new De,g=new De;function m(w,b){return(typeof w=="number"?e.get(w):void 0)??(b?s:void 0)}return{onDidRegisterWindow:l.event,onWillUnregisterWindow:g.event,onDidUnregisterWindow:h.event,registerWindow(w){if(e.has(w.vscodeWindowId))return lt.None;let b=new $n,C={window:w,disposables:b.add(new $n)};return e.set(w.vscodeWindowId,C),b.add(ei(()=>{e.delete(w.vscodeWindowId),h.fire(w)})),b.add(Ke(w,zi.BEFORE_UNLOAD,()=>{g.fire(w)})),l.fire(C),b},getWindows(){return e.values()},getWindowsCount(){return e.size},getWindowId(w){return w.vscodeWindowId},hasWindow(w){return e.has(w)},getWindowById:m,getWindow(w){let b=w;if(b?.ownerDocument?.defaultView)return b.ownerDocument.defaultView.window;let C=w;return C?.view?C.view.window:an},getDocument(w){return Dr(w).document}}})(),NS=class{constructor(e,s,l,h){this._node=e,this._type=s,this._handler=l,this._options=h||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function Ke(e,s,l,h){return new NS(e,s,l,h)}var F_=function(e,s,l,h){return Ke(e,s,l,h)},jd,DS=class extends ES{constructor(e){super(),this.defaultTarget=e&&Dr(e)}cancelAndSet(e,s,l){return super.cancelAndSet(e,s,l??this.defaultTarget)}},U_=class{constructor(e,s=0){this._runner=e,this.priority=s,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){gh(e)}}static sort(e,s){return s.priority-e.priority}};(function(){let e=new Map,s=new Map,l=new Map,h=new Map,g=m=>{l.set(m,!1);let w=e.get(m)??[];for(s.set(m,w),e.set(m,[]),h.set(m,!0);w.length>0;)w.sort(U_.sort),w.shift().execute();h.set(m,!1)};jd=(m,w,b=0)=>{let C=TS(m),S=new U_(w,b),M=e.get(C);return M||(M=[],e.set(C,M)),M.push(S),l.get(C)||(l.set(C,!0),m.requestAnimationFrame(()=>g(C))),S}})();function OS(e){let s=e.getBoundingClientRect(),l=Dr(e);return{left:s.left+l.scrollX,top:s.top+l.scrollY,width:s.width,height:s.height}}var zi={CLICK:"click",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",CHANGE:"change",FOCUS:"focus",BLUR:"blur",INPUT:"input"},MS=class{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingTop="",this._paddingLeft="",this._paddingBottom="",this._paddingRight="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){let s=bs(e);this._maxWidth!==s&&(this._maxWidth=s,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let s=bs(e);this._width!==s&&(this._width=s,this.domNode.style.width=this._width)}setHeight(e){let s=bs(e);this._height!==s&&(this._height=s,this.domNode.style.height=this._height)}setTop(e){let s=bs(e);this._top!==s&&(this._top=s,this.domNode.style.top=this._top)}setLeft(e){let s=bs(e);this._left!==s&&(this._left=s,this.domNode.style.left=this._left)}setBottom(e){let s=bs(e);this._bottom!==s&&(this._bottom=s,this.domNode.style.bottom=this._bottom)}setRight(e){let s=bs(e);this._right!==s&&(this._right=s,this.domNode.style.right=this._right)}setPaddingTop(e){let s=bs(e);this._paddingTop!==s&&(this._paddingTop=s,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let s=bs(e);this._paddingLeft!==s&&(this._paddingLeft=s,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let s=bs(e);this._paddingBottom!==s&&(this._paddingBottom=s,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let s=bs(e);this._paddingRight!==s&&(this._paddingRight=s,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let s=bs(e);this._fontSize!==s&&(this._fontSize=s,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let s=bs(e);this._lineHeight!==s&&(this._lineHeight=s,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let s=bs(e);this._letterSpacing!==s&&(this._letterSpacing=s,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,s){this.domNode.classList.toggle(e,s),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,s){this.domNode.setAttribute(e,s)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function bs(e){return typeof e=="number"?`${e}px`:e}function Io(e){return new MS(e)}var im=class{constructor(){this._hooks=new $n,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,s){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let l=this._onStopCallback;this._onStopCallback=null,e&&l&&l(s)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,s,l,h,g){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=h,this._onStopCallback=g;let m=e;try{e.setPointerCapture(s),this._hooks.add(ei(()=>{try{e.releasePointerCapture(s)}catch{}}))}catch{m=Dr(e)}this._hooks.add(Ke(m,zi.POINTER_MOVE,w=>{if(w.buttons!==l){this.stopMonitoring(!0);return}w.preventDefault(),this._pointerMoveCallback(w)})),this._hooks.add(Ke(m,zi.POINTER_UP,w=>this.stopMonitoring(!0)))}};function BS(e,s,l){let h=null,g=null;if(typeof l.value=="function"?(h="value",g=l.value,g.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof l.get=="function"&&(h="get",g=l.get),!g)throw new Error("not supported");let m=`$memoize$${s}`;l[h]=function(...w){return this.hasOwnProperty(m)||Object.defineProperty(this,m,{configurable:!1,enumerable:!1,writable:!1,value:g.apply(this,w)}),this[m]}}var Nr;(e=>(e.Tap="-xterm-gesturetap",e.Change="-xterm-gesturechange",e.Start="-xterm-gesturestart",e.End="-xterm-gesturesend",e.Contextmenu="-xterm-gesturecontextmenu"))(Nr||={});var No=class ts extends lt{constructor(){super(),this.dispatched=!1,this.targets=new O_,this.ignoreTargets=new O_,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(Ji.runAndSubscribe(RS,({window:s,disposables:l})=>{l.add(Ke(s.document,"touchstart",h=>this.onTouchStart(h),{passive:!1})),l.add(Ke(s.document,"touchend",h=>this.onTouchEnd(s,h))),l.add(Ke(s.document,"touchmove",h=>this.onTouchMove(h),{passive:!1}))},{window:an,disposables:this._store}))}static addTarget(s){if(!ts.isTouchDevice())return lt.None;ts.INSTANCE||(ts.INSTANCE=new ts);let l=ts.INSTANCE.targets.push(s);return ei(l)}static ignoreTarget(s){if(!ts.isTouchDevice())return lt.None;ts.INSTANCE||(ts.INSTANCE=new ts);let l=ts.INSTANCE.ignoreTargets.push(s);return ei(l)}static isTouchDevice(){return"ontouchstart"in an||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(s){let l=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let h=0,g=s.targetTouches.length;h<g;h++){let m=s.targetTouches.item(h);this.activeTouches[m.identifier]={id:m.identifier,initialTarget:m.target,initialTimeStamp:l,initialPageX:m.pageX,initialPageY:m.pageY,rollingTimestamps:[l],rollingPageX:[m.pageX],rollingPageY:[m.pageY]};let w=this.newGestureEvent(Nr.Start,m.target);w.pageX=m.pageX,w.pageY=m.pageY,this.dispatchEvent(w)}this.dispatched&&(s.preventDefault(),s.stopPropagation(),this.dispatched=!1)}onTouchEnd(s,l){let h=Date.now(),g=Object.keys(this.activeTouches).length;for(let m=0,w=l.changedTouches.length;m<w;m++){let b=l.changedTouches.item(m);if(!this.activeTouches.hasOwnProperty(String(b.identifier))){console.warn("move of an UNKNOWN touch",b);continue}let C=this.activeTouches[b.identifier],S=Date.now()-C.initialTimeStamp;if(S<ts.HOLD_DELAY&&Math.abs(C.initialPageX-Ps(C.rollingPageX))<30&&Math.abs(C.initialPageY-Ps(C.rollingPageY))<30){let M=this.newGestureEvent(Nr.Tap,C.initialTarget);M.pageX=Ps(C.rollingPageX),M.pageY=Ps(C.rollingPageY),this.dispatchEvent(M)}else if(S>=ts.HOLD_DELAY&&Math.abs(C.initialPageX-Ps(C.rollingPageX))<30&&Math.abs(C.initialPageY-Ps(C.rollingPageY))<30){let M=this.newGestureEvent(Nr.Contextmenu,C.initialTarget);M.pageX=Ps(C.rollingPageX),M.pageY=Ps(C.rollingPageY),this.dispatchEvent(M)}else if(g===1){let M=Ps(C.rollingPageX),N=Ps(C.rollingPageY),k=Ps(C.rollingTimestamps)-C.rollingTimestamps[0],P=M-C.rollingPageX[0],L=N-C.rollingPageY[0],X=[...this.targets].filter(pe=>C.initialTarget instanceof Node&&pe.contains(C.initialTarget));this.inertia(s,X,h,Math.abs(P)/k,P>0?1:-1,M,Math.abs(L)/k,L>0?1:-1,N)}this.dispatchEvent(this.newGestureEvent(Nr.End,C.initialTarget)),delete this.activeTouches[b.identifier]}this.dispatched&&(l.preventDefault(),l.stopPropagation(),this.dispatched=!1)}newGestureEvent(s,l){let h=document.createEvent("CustomEvent");return h.initEvent(s,!1,!0),h.initialTarget=l,h.tapCount=0,h}dispatchEvent(s){if(s.type===Nr.Tap){let l=new Date().getTime(),h=0;l-this._lastSetTapCountTime>ts.CLEAR_TAP_COUNT_TIME?h=1:h=2,this._lastSetTapCountTime=l,s.tapCount=h}else(s.type===Nr.Change||s.type===Nr.Contextmenu)&&(this._lastSetTapCountTime=0);if(s.initialTarget instanceof Node){for(let h of this.ignoreTargets)if(h.contains(s.initialTarget))return;let l=[];for(let h of this.targets)if(h.contains(s.initialTarget)){let g=0,m=s.initialTarget;for(;m&&m!==h;)g++,m=m.parentElement;l.push([g,h])}l.sort((h,g)=>h[0]-g[0]);for(let[h,g]of l)g.dispatchEvent(s),this.dispatched=!0}}inertia(s,l,h,g,m,w,b,C,S){this.handle=jd(s,()=>{let M=Date.now(),N=M-h,k=0,P=0,L=!0;g+=ts.SCROLL_FRICTION*N,b+=ts.SCROLL_FRICTION*N,g>0&&(L=!1,k=m*g*N),b>0&&(L=!1,P=C*b*N);let X=this.newGestureEvent(Nr.Change);X.translationX=k,X.translationY=P,l.forEach(pe=>pe.dispatchEvent(X)),L||this.inertia(s,l,M,g,m,w+k,b,C,S+P)})}onTouchMove(s){let l=Date.now();for(let h=0,g=s.changedTouches.length;h<g;h++){let m=s.changedTouches.item(h);if(!this.activeTouches.hasOwnProperty(String(m.identifier))){console.warn("end of an UNKNOWN touch",m);continue}let w=this.activeTouches[m.identifier],b=this.newGestureEvent(Nr.Change,w.initialTarget);b.translationX=m.pageX-Ps(w.rollingPageX),b.translationY=m.pageY-Ps(w.rollingPageY),b.pageX=m.pageX,b.pageY=m.pageY,this.dispatchEvent(b),w.rollingPageX.length>3&&(w.rollingPageX.shift(),w.rollingPageY.shift(),w.rollingTimestamps.shift()),w.rollingPageX.push(m.pageX),w.rollingPageY.push(m.pageY),w.rollingTimestamps.push(l)}this.dispatched&&(s.preventDefault(),s.stopPropagation(),this.dispatched=!1)}};No.SCROLL_FRICTION=-.005,No.HOLD_DELAY=700,No.CLEAR_TAP_COUNT_TIME=400,fi([BS],No,"isTouchDevice",1);var IS=No,qd=class extends lt{onclick(e,s){this._register(Ke(e,zi.CLICK,l=>s(new ch(Dr(e),l))))}onmousedown(e,s){this._register(Ke(e,zi.MOUSE_DOWN,l=>s(new ch(Dr(e),l))))}onmouseover(e,s){this._register(Ke(e,zi.MOUSE_OVER,l=>s(new ch(Dr(e),l))))}onmouseleave(e,s){this._register(Ke(e,zi.MOUSE_LEAVE,l=>s(new ch(Dr(e),l))))}onkeydown(e,s){this._register(Ke(e,zi.KEY_DOWN,l=>s(new L_(l))))}onkeyup(e,s){this._register(Ke(e,zi.KEY_UP,l=>s(new L_(l))))}oninput(e,s){this._register(Ke(e,zi.INPUT,s))}onblur(e,s){this._register(Ke(e,zi.BLUR,s))}onfocus(e,s){this._register(Ke(e,zi.FOCUS,s))}onchange(e,s){this._register(Ke(e,zi.CHANGE,s))}ignoreGesture(e){return IS.ignoreTarget(e)}},V_=11,kS=class extends qd{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.style.position="absolute",this.domNode.style.width=V_+"px",this.domNode.style.height=V_+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new im),this._register(F_(this.bgDomNode,zi.POINTER_DOWN,s=>this._arrowPointerDown(s))),this._register(F_(this.domNode,zi.POINTER_DOWN,s=>this._arrowPointerDown(s))),this._pointerdownRepeatTimer=this._register(new DS),this._pointerdownScheduleRepeatTimer=this._register(new Yd)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let s=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,Dr(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(s,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,l=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}},LS=class pd{constructor(s,l,h,g,m,w,b){this._forceIntegerValues=s,this._scrollStateBrand=void 0,this._forceIntegerValues&&(l=l|0,h=h|0,g=g|0,m=m|0,w=w|0,b=b|0),this.rawScrollLeft=g,this.rawScrollTop=b,l<0&&(l=0),g+l>h&&(g=h-l),g<0&&(g=0),m<0&&(m=0),b+m>w&&(b=w-m),b<0&&(b=0),this.width=l,this.scrollWidth=h,this.scrollLeft=g,this.height=m,this.scrollHeight=w,this.scrollTop=b}equals(s){return this.rawScrollLeft===s.rawScrollLeft&&this.rawScrollTop===s.rawScrollTop&&this.width===s.width&&this.scrollWidth===s.scrollWidth&&this.scrollLeft===s.scrollLeft&&this.height===s.height&&this.scrollHeight===s.scrollHeight&&this.scrollTop===s.scrollTop}withScrollDimensions(s,l){return new pd(this._forceIntegerValues,typeof s.width<"u"?s.width:this.width,typeof s.scrollWidth<"u"?s.scrollWidth:this.scrollWidth,l?this.rawScrollLeft:this.scrollLeft,typeof s.height<"u"?s.height:this.height,typeof s.scrollHeight<"u"?s.scrollHeight:this.scrollHeight,l?this.rawScrollTop:this.scrollTop)}withScrollPosition(s){return new pd(this._forceIntegerValues,this.width,this.scrollWidth,typeof s.scrollLeft<"u"?s.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof s.scrollTop<"u"?s.scrollTop:this.rawScrollTop)}createScrollEvent(s,l){let h=this.width!==s.width,g=this.scrollWidth!==s.scrollWidth,m=this.scrollLeft!==s.scrollLeft,w=this.height!==s.height,b=this.scrollHeight!==s.scrollHeight,C=this.scrollTop!==s.scrollTop;return{inSmoothScrolling:l,oldWidth:s.width,oldScrollWidth:s.scrollWidth,oldScrollLeft:s.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:s.height,oldScrollHeight:s.scrollHeight,oldScrollTop:s.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:h,scrollWidthChanged:g,scrollLeftChanged:m,heightChanged:w,scrollHeightChanged:b,scrollTopChanged:C}}},PS=class extends lt{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new De),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new LS(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,s){let l=this._state.withScrollDimensions(e,s);this._setState(l,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let s=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(s,!1)}setScrollPositionSmooth(e,s){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let l=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===l.scrollLeft&&this._smoothScrolling.to.scrollTop===l.scrollTop)return;let h;s?h=new G_(this._smoothScrolling.from,l,this._smoothScrolling.startTime,this._smoothScrolling.duration):h=this._smoothScrolling.combine(this._state,l,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=h}else{let l=this._state.withScrollPosition(e);this._smoothScrolling=G_.start(this._state,l,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),s=this._state.withScrollPosition(e);if(this._setState(s,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,s){let l=this._state;l.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(l,s)))}},W_=class{constructor(e,s,l){this.scrollLeft=e,this.scrollTop=s,this.isDone=l}};function Vf(e,s){let l=s-e;return function(h){return e+l*FS(h)}}function HS(e,s,l){return function(h){return h<l?e(h/l):s((h-l)/(1-l))}}var G_=class xd{constructor(s,l,h,g){this.from=s,this.to=l,this.duration=g,this.startTime=h,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(s,l,h){if(Math.abs(s-l)>2.5*h){let g,m;return s<l?(g=s+.75*h,m=l-.75*h):(g=s-.75*h,m=l+.75*h),HS(Vf(s,g),Vf(m,l),.33)}return Vf(s,l)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(s){this.to=s.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(s){let l=(s-this.startTime)/this.duration;if(l<1){let h=this.scrollLeft(l),g=this.scrollTop(l);return new W_(h,g,!1)}return new W_(this.to.scrollLeft,this.to.scrollTop,!0)}combine(s,l,h){return xd.start(s,l,h)}static start(s,l,h){h=h+10;let g=Date.now()-10;return new xd(s,l,g,h)}};function zS(e){return Math.pow(e,3)}function FS(e){return 1-zS(1-e)}var US=class extends lt{constructor(e,s,l){super(),this._visibility=e,this._visibleClassName=s,this._invisibleClassName=l,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new Yd)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}},VS=140,sm=class extends qd{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new US(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new im),this._shouldRender=!0,this.domNode=Io(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(Ke(this.domNode.domNode,zi.POINTER_DOWN,s=>this._domNodePointerDown(s)))}_createArrow(e){let s=this._register(new kS(e));this.domNode.domNode.appendChild(s.bgDomNode),this.domNode.domNode.appendChild(s.domNode)}_createSlider(e,s,l,h){this.slider=Io(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(s),typeof l=="number"&&this.slider.setWidth(l),typeof h=="number"&&this.slider.setHeight(h),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(Ke(this.slider.domNode,zi.POINTER_DOWN,g=>{g.button===0&&(g.preventDefault(),this._sliderPointerDown(g))})),this.onclick(this.slider.domNode,g=>{g.leftButton&&g.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let s=this.domNode.domNode.getClientRects()[0].top,l=s+this._scrollbarState.getSliderPosition(),h=s+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),g=this._sliderPointerPosition(e);l<=g&&g<=h?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let s,l;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")s=e.offsetX,l=e.offsetY;else{let g=OS(this.domNode.domNode);s=e.pageX-g.left,l=e.pageY-g.top}let h=this._pointerDownRelativePosition(s,l);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(h):this._scrollbarState.getDesiredScrollPositionFromOffset(h)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let s=this._sliderPointerPosition(e),l=this._sliderOrthogonalPointerPosition(e),h=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,g=>{let m=this._sliderOrthogonalPointerPosition(g),w=Math.abs(m-l);if(J2&&w>VS){this._setDesiredScrollPositionNow(h.getScrollPosition());return}let b=this._sliderPointerPosition(g)-s;this._setDesiredScrollPositionNow(h.getDesiredScrollPositionFromDelta(b))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let s={};this.writeScrollPosition(s,e),this._scrollable.setScrollPositionNow(s)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}},rm=class vd{constructor(s,l,h,g,m,w){this._scrollbarSize=Math.round(l),this._oppositeScrollbarSize=Math.round(h),this._arrowSize=Math.round(s),this._visibleSize=g,this._scrollSize=m,this._scrollPosition=w,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new vd(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(s){let l=Math.round(s);return this._visibleSize!==l?(this._visibleSize=l,this._refreshComputedValues(),!0):!1}setScrollSize(s){let l=Math.round(s);return this._scrollSize!==l?(this._scrollSize=l,this._refreshComputedValues(),!0):!1}setScrollPosition(s){let l=Math.round(s);return this._scrollPosition!==l?(this._scrollPosition=l,this._refreshComputedValues(),!0):!1}setScrollbarSize(s){this._scrollbarSize=Math.round(s)}setOppositeScrollbarSize(s){this._oppositeScrollbarSize=Math.round(s)}static _computeValues(s,l,h,g,m){let w=Math.max(0,h-s),b=Math.max(0,w-2*l),C=g>0&&g>h;if(!C)return{computedAvailableSize:Math.round(w),computedIsNeeded:C,computedSliderSize:Math.round(b),computedSliderRatio:0,computedSliderPosition:0};let S=Math.round(Math.max(20,Math.floor(h*b/g))),M=(b-S)/(g-h),N=m*M;return{computedAvailableSize:Math.round(w),computedIsNeeded:C,computedSliderSize:Math.round(S),computedSliderRatio:M,computedSliderPosition:Math.round(N)}}_refreshComputedValues(){let s=vd._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=s.computedAvailableSize,this._computedIsNeeded=s.computedIsNeeded,this._computedSliderSize=s.computedSliderSize,this._computedSliderRatio=s.computedSliderRatio,this._computedSliderPosition=s.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(s){if(!this._computedIsNeeded)return 0;let l=s-this._arrowSize-this._computedSliderSize/2;return Math.round(l/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(s){if(!this._computedIsNeeded)return 0;let l=s-this._arrowSize,h=this._scrollPosition;return l<this._computedSliderPosition?h-=this._visibleSize:h+=this._visibleSize,h}getDesiredScrollPositionFromDelta(s){if(!this._computedIsNeeded)return 0;let l=this._computedSliderPosition+s;return Math.round(l/this._computedSliderRatio)}},WS=class extends sm{constructor(e,s,l){let h=e.getScrollDimensions(),g=e.getCurrentScrollPosition();if(super({lazyRender:s.lazyRender,host:l,scrollbarState:new rm(s.horizontalHasArrows?s.arrowSize:0,s.horizontal===2?0:s.horizontalScrollbarSize,s.vertical===2?0:s.verticalScrollbarSize,h.width,h.scrollWidth,g.scrollLeft),visibility:s.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:s.scrollByPage}),s.horizontalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(Math.floor((s.horizontalScrollbarSize-s.horizontalSliderSize)/2),0,void 0,s.horizontalSliderSize)}_updateSlider(e,s){this.slider.setWidth(e),this.slider.setLeft(s)}_renderDomNode(e,s){this.domNode.setWidth(e),this.domNode.setHeight(s),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,s){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,s){e.scrollLeft=s}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}},GS=class extends sm{constructor(e,s,l){let h=e.getScrollDimensions(),g=e.getCurrentScrollPosition();if(super({lazyRender:s.lazyRender,host:l,scrollbarState:new rm(s.verticalHasArrows?s.arrowSize:0,s.vertical===2?0:s.verticalScrollbarSize,0,h.height,h.scrollHeight,g.scrollTop),visibility:s.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:s.scrollByPage}),s.verticalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(0,Math.floor((s.verticalScrollbarSize-s.verticalSliderSize)/2),s.verticalSliderSize,void 0)}_updateSlider(e,s){this.slider.setHeight(e),this.slider.setTop(s)}_renderDomNode(e,s){this.domNode.setWidth(s),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,s){return s}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,s){e.scrollTop=s}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}},XS=500,X_=50,YS=class{constructor(e,s,l){this.timestamp=e,this.deltaX=s,this.deltaY=l,this.score=0}},Sd=class{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let s=1,l=0,h=1,g=this._rear;do{let m=g===this._front?s:Math.pow(2,-h);if(s-=m,l+=this._memory[g].score*m,g===this._front)break;g=(this._capacity+g-1)%this._capacity,h++}while(!0);return l<=.5}acceptStandardWheelEvent(s){if(Gd){let l=Dr(s.browserEvent),h=sS(l);this.accept(Date.now(),s.deltaX*h,s.deltaY*h)}else this.accept(Date.now(),s.deltaX,s.deltaY)}accept(s,l,h){let g=null,m=new YS(s,l,h);this._front===-1&&this._rear===-1?(this._memory[0]=m,this._front=0,this._rear=0):(g=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=m),m.score=this._computeScore(m,g)}_computeScore(s,l){if(Math.abs(s.deltaX)>0&&Math.abs(s.deltaY)>0)return 1;let h=.5;if((!this._isAlmostInt(s.deltaX)||!this._isAlmostInt(s.deltaY))&&(h+=.25),l){let g=Math.abs(s.deltaX),m=Math.abs(s.deltaY),w=Math.abs(l.deltaX),b=Math.abs(l.deltaY),C=Math.max(Math.min(g,w),1),S=Math.max(Math.min(m,b),1),M=Math.max(g,w),N=Math.max(m,b);M%C===0&&N%S===0&&(h-=.5)}return Math.min(Math.max(h,0),1)}_isAlmostInt(s){return Math.abs(Math.round(s)-s)<.01}};Sd.INSTANCE=new Sd;var jS=Sd,qS=class extends qd{constructor(e,s,l){super(),this._onScroll=this._register(new De),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new De),this.onWillScroll=this._onWillScroll.event,this._options=ZS(s),this._scrollable=l,this._register(this._scrollable.onScroll(g=>{this._onWillScroll.fire(g),this._onDidScroll(g),this._onScroll.fire(g)}));let h={onMouseWheel:g=>this._onMouseWheel(g),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new GS(this._scrollable,this._options,h)),this._horizontalScrollbar=this._register(new WS(this._scrollable,this._options,h)),this._domNode=document.createElement("div"),this._domNode.className="xterm-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Io(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Io(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Io(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,g=>this._onMouseOver(g)),this.onmouseleave(this._listenOnDomNode,g=>this._onMouseLeave(g)),this._hideTimeout=this._register(new Yd),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}get options(){return this._options}dispose(){this._mouseWheelToDispose=Oa(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Or&&(this._options.className+=" mac"),this._domNode.className="xterm-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new H_(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Oa(this._mouseWheelToDispose),e)){let s=l=>{this._onMouseWheel(new H_(l))};this._mouseWheelToDispose.push(Ke(this._listenOnDomNode,zi.MOUSE_WHEEL,s,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let s=jS.INSTANCE;s.acceptStandardWheelEvent(e);let l=!1;if(e.deltaY||e.deltaX){let g=e.deltaY*this._options.mouseWheelScrollSensitivity,m=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&m+g===0?m=g=0:Math.abs(g)>=Math.abs(m)?m=0:g=0),this._options.flipAxes&&([g,m]=[m,g]);let w=!Or&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||w)&&!m&&(m=g,g=0),e.browserEvent&&e.browserEvent.altKey&&(m=m*this._options.fastScrollSensitivity,g=g*this._options.fastScrollSensitivity);let b=this._scrollable.getFutureScrollPosition(),C={};if(g){let S=X_*g,M=b.scrollTop-(S<0?Math.floor(S):Math.ceil(S));this._verticalScrollbar.writeScrollPosition(C,M)}if(m){let S=X_*m,M=b.scrollLeft-(S<0?Math.floor(S):Math.ceil(S));this._horizontalScrollbar.writeScrollPosition(C,M)}C=this._scrollable.validateScrollPosition(C),(b.scrollLeft!==C.scrollLeft||b.scrollTop!==C.scrollTop)&&(this._options.mouseWheelSmoothScroll&&s.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(C):this._scrollable.setScrollPositionNow(C),l=!0)}let h=l;!h&&this._options.alwaysConsumeMouseWheel&&(h=!0),!h&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(h=!0),h&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),s=e.scrollTop>0,l=e.scrollLeft>0,h=l?" left":"",g=s?" top":"",m=l||s?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${h}`),this._topShadowDomNode.setClassName(`shadow${g}`),this._topLeftShadowDomNode.setClassName(`shadow${m}${g}${h}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),XS)}},KS=class extends qS{constructor(e,s,l){super(e,s,l)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}};function ZS(e){let s={lazyRender:typeof e.lazyRender<"u"?e.lazyRender:!1,className:typeof e.className<"u"?e.className:"",useShadows:typeof e.useShadows<"u"?e.useShadows:!0,handleMouseWheel:typeof e.handleMouseWheel<"u"?e.handleMouseWheel:!0,flipAxes:typeof e.flipAxes<"u"?e.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof e.consumeMouseWheelIfScrollbarIsNeeded<"u"?e.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof e.alwaysConsumeMouseWheel<"u"?e.alwaysConsumeMouseWheel:!1,scrollYToX:typeof e.scrollYToX<"u"?e.scrollYToX:!1,mouseWheelScrollSensitivity:typeof e.mouseWheelScrollSensitivity<"u"?e.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof e.fastScrollSensitivity<"u"?e.fastScrollSensitivity:5,scrollPredominantAxis:typeof e.scrollPredominantAxis<"u"?e.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof e.mouseWheelSmoothScroll<"u"?e.mouseWheelSmoothScroll:!0,arrowSize:typeof e.arrowSize<"u"?e.arrowSize:11,listenOnDomNode:typeof e.listenOnDomNode<"u"?e.listenOnDomNode:null,horizontal:typeof e.horizontal<"u"?e.horizontal:1,horizontalScrollbarSize:typeof e.horizontalScrollbarSize<"u"?e.horizontalScrollbarSize:10,horizontalSliderSize:typeof e.horizontalSliderSize<"u"?e.horizontalSliderSize:0,horizontalHasArrows:typeof e.horizontalHasArrows<"u"?e.horizontalHasArrows:!1,vertical:typeof e.vertical<"u"?e.vertical:1,verticalScrollbarSize:typeof e.verticalScrollbarSize<"u"?e.verticalScrollbarSize:10,verticalHasArrows:typeof e.verticalHasArrows<"u"?e.verticalHasArrows:!1,verticalSliderSize:typeof e.verticalSliderSize<"u"?e.verticalSliderSize:0,scrollByPage:typeof e.scrollByPage<"u"?e.scrollByPage:!1};return s.horizontalSliderSize=typeof e.horizontalSliderSize<"u"?e.horizontalSliderSize:s.horizontalScrollbarSize,s.verticalSliderSize=typeof e.verticalSliderSize<"u"?e.verticalSliderSize:s.verticalScrollbarSize,Or&&(s.className+=" mac"),s}var yd=class extends lt{constructor(e,s,l,h,g,m,w,b){super(),this._bufferService=l,this._optionsService=w,this._renderService=b,this._onRequestScrollLines=this._register(new De),this.onRequestScrollLines=this._onRequestScrollLines.event,this._isSyncing=!1,this._isHandlingScroll=!1,this._suppressOnScrollHandler=!1;let C=this._register(new PS({forceIntegerValues:!1,smoothScrollDuration:this._optionsService.rawOptions.smoothScrollDuration,scheduleAtNextAnimationFrame:S=>jd(h.window,S)}));this._register(this._optionsService.onSpecificOptionChange("smoothScrollDuration",()=>{C.setSmoothScrollDuration(this._optionsService.rawOptions.smoothScrollDuration)})),this._scrollableElement=this._register(new KS(s,{vertical:1,horizontal:2,useShadows:!1,mouseWheelSmoothScroll:!0,...this._getChangeOptions()},C)),this._register(this._optionsService.onMultipleOptionChange(["scrollSensitivity","fastScrollSensitivity","overviewRuler"],()=>this._scrollableElement.updateOptions(this._getChangeOptions()))),this._register(g.onProtocolChange(S=>{this._scrollableElement.updateOptions({handleMouseWheel:!(S&16)})})),this._scrollableElement.setScrollDimensions({height:0,scrollHeight:0}),this._register(Ji.runAndSubscribe(m.onChangeColors,()=>{this._scrollableElement.getDomNode().style.backgroundColor=m.colors.background.css})),e.appendChild(this._scrollableElement.getDomNode()),this._register(ei(()=>this._scrollableElement.getDomNode().remove())),this._styleElement=h.mainDocument.createElement("style"),s.appendChild(this._styleElement),this._register(ei(()=>this._styleElement.remove())),this._register(Ji.runAndSubscribe(m.onChangeColors,()=>{this._styleElement.textContent=[".xterm .xterm-scrollable-element > .scrollbar > .slider {",`  background: ${m.colors.scrollbarSliderBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider:hover {",`  background: ${m.colors.scrollbarSliderHoverBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider.active {",`  background: ${m.colors.scrollbarSliderActiveBackground.css};`,"}"].join(`
`)})),this._register(this._bufferService.onResize(()=>this.queueSync())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._latestYDisp=void 0,this.queueSync()})),this._register(this._bufferService.onScroll(()=>this._sync())),this._register(this._scrollableElement.onScroll(S=>this._handleScroll(S)))}scrollLines(e){let s=this._scrollableElement.getScrollPosition();this._scrollableElement.setScrollPosition({reuseAnimation:!0,scrollTop:s.scrollTop+e*this._renderService.dimensions.css.cell.height})}scrollToLine(e,s){s&&(this._latestYDisp=e),this._scrollableElement.setScrollPosition({reuseAnimation:!s,scrollTop:e*this._renderService.dimensions.css.cell.height})}_getChangeOptions(){return{mouseWheelScrollSensitivity:this._optionsService.rawOptions.scrollSensitivity,fastScrollSensitivity:this._optionsService.rawOptions.fastScrollSensitivity,verticalScrollbarSize:this._optionsService.rawOptions.overviewRuler?.width||14}}queueSync(e){e!==void 0&&(this._latestYDisp=e),this._queuedAnimationFrame===void 0&&(this._queuedAnimationFrame=this._renderService.addRefreshCallback(()=>{this._queuedAnimationFrame=void 0,this._sync(this._latestYDisp)}))}_sync(e=this._bufferService.buffer.ydisp){!this._renderService||this._isSyncing||(this._isSyncing=!0,this._suppressOnScrollHandler=!0,this._scrollableElement.setScrollDimensions({height:this._renderService.dimensions.css.canvas.height,scrollHeight:this._renderService.dimensions.css.cell.height*this._bufferService.buffer.lines.length}),this._suppressOnScrollHandler=!1,e!==this._latestYDisp&&this._scrollableElement.setScrollPosition({scrollTop:e*this._renderService.dimensions.css.cell.height}),this._isSyncing=!1)}_handleScroll(e){if(!this._renderService||this._isHandlingScroll||this._suppressOnScrollHandler)return;this._isHandlingScroll=!0;let s=Math.round(e.scrollTop/this._renderService.dimensions.css.cell.height),l=s-this._bufferService.buffer.ydisp;l!==0&&(this._latestYDisp=s,this._onRequestScrollLines.fire(l)),this._isHandlingScroll=!1}};yd=fi([Be(2,hs),Be(3,ln),Be(4,H2),Be(5,Cl),Be(6,us),Be(7,on)],yd);var wd=class extends lt{constructor(e,s,l,h,g){super(),this._screenElement=e,this._bufferService=s,this._coreBrowserService=l,this._decorationService=h,this._renderService=g,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this._register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this._register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this._register(this._decorationService.onDecorationRemoved(m=>this._removeDecoration(m))),this._register(ei(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let e of this._decorationService.decorations)this._renderDecoration(e);this._dimensionsChanged=!1}_renderDecoration(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}_createElement(e){let s=this._coreBrowserService.mainDocument.createElement("div");s.classList.add("xterm-decoration"),s.classList.toggle("xterm-decoration-top-layer",e?.options?.layer==="top"),s.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,s.style.height=`${(e.options.height||1)*this._renderService.dimensions.css.cell.height}px`,s.style.top=`${(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height}px`,s.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let l=e.options.x??0;return l&&l>this._bufferService.cols&&(s.style.display="none"),this._refreshXPosition(e,s),s}_refreshStyle(e){let s=e.marker.line-this._bufferService.buffers.active.ydisp;if(s<0||s>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{let l=this._decorationElements.get(e);l||(l=this._createElement(e),e.element=l,this._decorationElements.set(e,l),this._container.appendChild(l),e.onDispose(()=>{this._decorationElements.delete(e),l.remove()})),l.style.display=this._altBufferIsActive?"none":"block",this._altBufferIsActive||(l.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,l.style.height=`${(e.options.height||1)*this._renderService.dimensions.css.cell.height}px`,l.style.top=`${s*this._renderService.dimensions.css.cell.height}px`,l.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`),e.onRenderEmitter.fire(l)}}_refreshXPosition(e,s=e.element){if(!s)return;let l=e.options.x??0;(e.options.anchor||"left")==="right"?s.style.right=l?`${l*this._renderService.dimensions.css.cell.width}px`:"":s.style.left=l?`${l*this._renderService.dimensions.css.cell.width}px`:""}_removeDecoration(e){this._decorationElements.get(e)?.remove(),this._decorationElements.delete(e),e.dispose()}};wd=fi([Be(1,hs),Be(2,ln),Be(3,Fo),Be(4,on)],wd);var QS=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(e){if(e.options.overviewRulerOptions){for(let s of this._zones)if(s.color===e.options.overviewRulerOptions.color&&s.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(s,e.marker.line))return;if(this._lineAdjacentToZone(s,e.marker.line,e.options.overviewRulerOptions.position)){this._addLineToZone(s,e.marker.line);return}}if(this._zonePoolIndex<this._zonePool.length){this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,this._zones.push(this._zonePool[this._zonePoolIndex++]);return}this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(e){this._linePadding=e}_lineIntersectsZone(e,s){return s>=e.startBufferLine&&s<=e.endBufferLine}_lineAdjacentToZone(e,s,l){return s>=e.startBufferLine-this._linePadding[l||"full"]&&s<=e.endBufferLine+this._linePadding[l||"full"]}_addLineToZone(e,s){e.startBufferLine=Math.min(e.startBufferLine,s),e.endBufferLine=Math.max(e.endBufferLine,s)}},Ar={full:0,left:0,center:0,right:0},jn={full:0,left:0,center:0,right:0},wo={full:0,left:0,center:0,right:0},Eh=class extends lt{constructor(e,s,l,h,g,m,w,b){super(),this._viewportElement=e,this._screenElement=s,this._bufferService=l,this._decorationService=h,this._renderService=g,this._optionsService=m,this._themeService=w,this._coreBrowserService=b,this._colorZoneStore=new QS,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement),this._register(ei(()=>this._canvas?.remove()));let C=this._canvas.getContext("2d");if(C)this._ctx=C;else throw new Error("Ctx cannot be null");this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this._register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0))),this._register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this._register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})),this._register(this._renderService.onRender(()=>{(!this._containerHeight||this._containerHeight!==this._screenElement.clientHeight)&&(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._register(this._optionsService.onSpecificOptionChange("overviewRuler",()=>this._queueRefresh(!0))),this._register(this._themeService.onChangeColors(()=>this._queueRefresh())),this._queueRefresh(!0)}get _width(){return this._optionsService.options.overviewRuler?.width||0}_refreshDrawConstants(){let e=Math.floor((this._canvas.width-1)/3),s=Math.ceil((this._canvas.width-1)/3);jn.full=this._canvas.width,jn.left=e,jn.center=s,jn.right=e,this._refreshDrawHeightConstants(),wo.full=1,wo.left=1,wo.center=1+jn.left,wo.right=1+jn.left+jn.center}_refreshDrawHeightConstants(){Ar.full=Math.round(2*this._coreBrowserService.dpr);let e=this._canvas.height/this._bufferService.buffer.lines.length,s=Math.round(Math.max(Math.min(e,12),6)*this._coreBrowserService.dpr);Ar.left=s,Ar.center=s,Ar.right=s}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*Ar.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*Ar.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*Ar.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*Ar.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let s of this._decorationService.decorations)this._colorZoneStore.addDecoration(s);this._ctx.lineWidth=1,this._renderRulerOutline();let e=this._colorZoneStore.zones;for(let s of e)s.position!=="full"&&this._renderColorZone(s);for(let s of e)s.position==="full"&&this._renderColorZone(s);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderRulerOutline(){this._ctx.fillStyle=this._themeService.colors.overviewRulerBorder.css,this._ctx.fillRect(0,0,1,this._canvas.height),this._optionsService.rawOptions.overviewRuler.showTopBorder&&this._ctx.fillRect(1,0,this._canvas.width-1,1),this._optionsService.rawOptions.overviewRuler.showBottomBorder&&this._ctx.fillRect(1,this._canvas.height-1,this._canvas.width-1,this._canvas.height)}_renderColorZone(e){this._ctx.fillStyle=e.color,this._ctx.fillRect(wo[e.position||"full"],Math.round((this._canvas.height-1)*(e.startBufferLine/this._bufferService.buffers.active.lines.length)-Ar[e.position||"full"]/2),jn[e.position||"full"],Math.round((this._canvas.height-1)*((e.endBufferLine-e.startBufferLine)/this._bufferService.buffers.active.lines.length)+Ar[e.position||"full"]))}_queueRefresh(e,s){this._shouldUpdateDimensions=e||this._shouldUpdateDimensions,this._shouldUpdateAnchor=s||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};Eh=fi([Be(2,hs),Be(3,Fo),Be(4,on),Be(5,us),Be(6,Cl),Be(7,ln)],Eh);var _e;(e=>(e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="\x07",e.BS="\b",e.HT="	",e.LF=`
`,e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="\x1B",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""))(_e||={});var ph;(e=>(e.PAD="",e.HOP="",e.BPH="",e.NBH="",e.IND="",e.NEL="",e.SSA="",e.ESA="",e.HTS="",e.HTJ="",e.VTS="",e.PLD="",e.PLU="",e.RI="",e.SS2="",e.SS3="",e.DCS="",e.PU1="",e.PU2="",e.STS="",e.CCH="",e.MW="",e.SPA="",e.EPA="",e.SOS="",e.SGCI="",e.SCI="",e.CSI="",e.ST="",e.OSC="",e.PM="",e.APC=""))(ph||={});var nm;(e=>e.ST=`${_e.ESC}\\`)(nm||={});var bd=class{constructor(e,s,l,h,g,m){this._textarea=e,this._compositionView=s,this._bufferService=l,this._optionsService=h,this._coreService=g,this._renderService=m,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(e){this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(e){if(this._isComposing||this._isSendingComposition){if(e.keyCode===20||e.keyCode===229||e.keyCode===16||e.keyCode===17||e.keyCode===18)return!1;this._finalizeComposition(!1)}return e.keyCode===229?(this._handleAnyTextareaChanges(),!1):!0}_finalizeComposition(e){if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){let s={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){this._isSendingComposition=!1;let l;s.start+=this._dataAlreadySent.length,this._isComposing?l=this._textarea.value.substring(s.start,this._compositionPosition.start):l=this._textarea.value.substring(s.start),l.length>0&&this._coreService.triggerDataEvent(l,!0)}},0)}else{this._isSendingComposition=!1;let s=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(s,!0)}}_handleAnyTextareaChanges(){let e=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let s=this._textarea.value,l=s.replace(e,"");this._dataAlreadySent=l,s.length>e.length?this._coreService.triggerDataEvent(l,!0):s.length<e.length?this._coreService.triggerDataEvent(`${_e.DEL}`,!0):s.length===e.length&&s!==e&&this._coreService.triggerDataEvent(s,!0)}},0)}updateCompositionElements(e){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let s=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),l=this._renderService.dimensions.css.cell.height,h=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,g=s*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=g+"px",this._compositionView.style.top=h+"px",this._compositionView.style.height=l+"px",this._compositionView.style.lineHeight=l+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let m=this._compositionView.getBoundingClientRect();this._textarea.style.left=g+"px",this._textarea.style.top=h+"px",this._textarea.style.width=Math.max(m.width,1)+"px",this._textarea.style.height=Math.max(m.height,1)+"px",this._textarea.style.lineHeight=m.height+"px"}e||setTimeout(()=>this.updateCompositionElements(!0),0)}}};bd=fi([Be(2,hs),Be(3,us),Be(4,Ba),Be(5,on)],bd);var Fi=0,Ui=0,Vi=0,ui=0,Y_={css:"#00000000",rgba:0},Ai;(e=>{function s(g,m,w,b){return b!==void 0?`#${Ea(g)}${Ea(m)}${Ea(w)}${Ea(b)}`:`#${Ea(g)}${Ea(m)}${Ea(w)}`}e.toCss=s;function l(g,m,w,b=255){return(g<<24|m<<16|w<<8|b)>>>0}e.toRgba=l;function h(g,m,w,b){return{css:e.toCss(g,m,w,b),rgba:e.toRgba(g,m,w,b)}}e.toColor=h})(Ai||={});var Zt;(e=>{function s(C,S){if(ui=(S.rgba&255)/255,ui===1)return{css:S.css,rgba:S.rgba};let M=S.rgba>>24&255,N=S.rgba>>16&255,k=S.rgba>>8&255,P=C.rgba>>24&255,L=C.rgba>>16&255,X=C.rgba>>8&255;Fi=P+Math.round((M-P)*ui),Ui=L+Math.round((N-L)*ui),Vi=X+Math.round((k-X)*ui);let pe=Ai.toCss(Fi,Ui,Vi),me=Ai.toRgba(Fi,Ui,Vi);return{css:pe,rgba:me}}e.blend=s;function l(C){return(C.rgba&255)===255}e.isOpaque=l;function h(C,S,M){let N=xh.ensureContrastRatio(C.rgba,S.rgba,M);if(N)return Ai.toColor(N>>24&255,N>>16&255,N>>8&255)}e.ensureContrastRatio=h;function g(C){let S=(C.rgba|255)>>>0;return[Fi,Ui,Vi]=xh.toChannels(S),{css:Ai.toCss(Fi,Ui,Vi),rgba:S}}e.opaque=g;function m(C,S){return ui=Math.round(S*255),[Fi,Ui,Vi]=xh.toChannels(C.rgba),{css:Ai.toCss(Fi,Ui,Vi,ui),rgba:Ai.toRgba(Fi,Ui,Vi,ui)}}e.opacity=m;function w(C,S){return ui=C.rgba&255,m(C,ui*S/255)}e.multiplyOpacity=w;function b(C){return[C.rgba>>24&255,C.rgba>>16&255,C.rgba>>8&255]}e.toColorRGB=b})(Zt||={});var ri;(e=>{let s,l;try{let g=document.createElement("canvas");g.width=1,g.height=1;let m=g.getContext("2d",{willReadFrequently:!0});m&&(s=m,s.globalCompositeOperation="copy",l=s.createLinearGradient(0,0,1,1))}catch{}function h(g){if(g.match(/#[\da-f]{3,8}/i))switch(g.length){case 4:return Fi=parseInt(g.slice(1,2).repeat(2),16),Ui=parseInt(g.slice(2,3).repeat(2),16),Vi=parseInt(g.slice(3,4).repeat(2),16),Ai.toColor(Fi,Ui,Vi);case 5:return Fi=parseInt(g.slice(1,2).repeat(2),16),Ui=parseInt(g.slice(2,3).repeat(2),16),Vi=parseInt(g.slice(3,4).repeat(2),16),ui=parseInt(g.slice(4,5).repeat(2),16),Ai.toColor(Fi,Ui,Vi,ui);case 7:return{css:g,rgba:(parseInt(g.slice(1),16)<<8|255)>>>0};case 9:return{css:g,rgba:parseInt(g.slice(1),16)>>>0}}let m=g.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(m)return Fi=parseInt(m[1]),Ui=parseInt(m[2]),Vi=parseInt(m[3]),ui=Math.round((m[5]===void 0?1:parseFloat(m[5]))*255),Ai.toColor(Fi,Ui,Vi,ui);if(!s||!l)throw new Error("css.toColor: Unsupported css format");if(s.fillStyle=l,s.fillStyle=g,typeof s.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(s.fillRect(0,0,1,1),[Fi,Ui,Vi,ui]=s.getImageData(0,0,1,1).data,ui!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:Ai.toRgba(Fi,Ui,Vi,ui),css:g}}e.toColor=h})(ri||={});var cs;(e=>{function s(h){return l(h>>16&255,h>>8&255,h&255)}e.relativeLuminance=s;function l(h,g,m){let w=h/255,b=g/255,C=m/255,S=w<=.03928?w/12.92:Math.pow((w+.055)/1.055,2.4),M=b<=.03928?b/12.92:Math.pow((b+.055)/1.055,2.4),N=C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4);return S*.2126+M*.7152+N*.0722}e.relativeLuminance2=l})(cs||={});var xh;(e=>{function s(w,b){if(ui=(b&255)/255,ui===1)return b;let C=b>>24&255,S=b>>16&255,M=b>>8&255,N=w>>24&255,k=w>>16&255,P=w>>8&255;return Fi=N+Math.round((C-N)*ui),Ui=k+Math.round((S-k)*ui),Vi=P+Math.round((M-P)*ui),Ai.toRgba(Fi,Ui,Vi)}e.blend=s;function l(w,b,C){let S=cs.relativeLuminance(w>>8),M=cs.relativeLuminance(b>>8);if(sn(S,M)<C){if(M<S){let P=h(w,b,C),L=sn(S,cs.relativeLuminance(P>>8));if(L<C){let X=g(w,b,C),pe=sn(S,cs.relativeLuminance(X>>8));return L>pe?P:X}return P}let N=g(w,b,C),k=sn(S,cs.relativeLuminance(N>>8));if(k<C){let P=h(w,b,C),L=sn(S,cs.relativeLuminance(P>>8));return k>L?N:P}return N}}e.ensureContrastRatio=l;function h(w,b,C){let S=w>>24&255,M=w>>16&255,N=w>>8&255,k=b>>24&255,P=b>>16&255,L=b>>8&255,X=sn(cs.relativeLuminance2(k,P,L),cs.relativeLuminance2(S,M,N));for(;X<C&&(k>0||P>0||L>0);)k-=Math.max(0,Math.ceil(k*.1)),P-=Math.max(0,Math.ceil(P*.1)),L-=Math.max(0,Math.ceil(L*.1)),X=sn(cs.relativeLuminance2(k,P,L),cs.relativeLuminance2(S,M,N));return(k<<24|P<<16|L<<8|255)>>>0}e.reduceLuminance=h;function g(w,b,C){let S=w>>24&255,M=w>>16&255,N=w>>8&255,k=b>>24&255,P=b>>16&255,L=b>>8&255,X=sn(cs.relativeLuminance2(k,P,L),cs.relativeLuminance2(S,M,N));for(;X<C&&(k<255||P<255||L<255);)k=Math.min(255,k+Math.ceil((255-k)*.1)),P=Math.min(255,P+Math.ceil((255-P)*.1)),L=Math.min(255,L+Math.ceil((255-L)*.1)),X=sn(cs.relativeLuminance2(k,P,L),cs.relativeLuminance2(S,M,N));return(k<<24|P<<16|L<<8|255)>>>0}e.increaseLuminance=g;function m(w){return[w>>24&255,w>>16&255,w>>8&255,w&255]}e.toChannels=m})(xh||={});function Ea(e){let s=e.toString(16);return s.length<2?"0"+s:s}function sn(e,s){return e<s?(s+.05)/(e+.05):(e+.05)/(s+.05)}var JS=class extends zo{constructor(e,s,l){super(),this.content=0,this.combinedData="",this.fg=e.fg,this.bg=e.bg,this.combinedData=s,this._width=l}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(e){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},Ah=class{constructor(e){this._bufferService=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new sr}register(e){let s={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(s),s.id}deregister(e){for(let s=0;s<this._characterJoiners.length;s++)if(this._characterJoiners[s].id===e)return this._characterJoiners.splice(s,1),!0;return!1}getJoinedCharacters(e){if(this._characterJoiners.length===0)return[];let s=this._bufferService.buffer.lines.get(e);if(!s||s.length===0)return[];let l=[],h=s.translateToString(!0),g=0,m=0,w=0,b=s.getFg(0),C=s.getBg(0);for(let S=0;S<s.getTrimmedLength();S++)if(s.loadCell(S,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==b||this._workCell.bg!==C){if(S-g>1){let M=this._getJoinedRanges(h,w,m,s,g);for(let N=0;N<M.length;N++)l.push(M[N])}g=S,w=m,b=this._workCell.fg,C=this._workCell.bg}m+=this._workCell.getChars().length||Jn.length}if(this._bufferService.cols-g>1){let S=this._getJoinedRanges(h,w,m,s,g);for(let M=0;M<S.length;M++)l.push(S[M])}return l}_getJoinedRanges(e,s,l,h,g){let m=e.substring(s,l),w=[];try{w=this._characterJoiners[0].handler(m)}catch(b){console.error(b)}for(let b=1;b<this._characterJoiners.length;b++)try{let C=this._characterJoiners[b].handler(m);for(let S=0;S<C.length;S++)Ah._mergeRanges(w,C[S])}catch(C){console.error(C)}return this._stringRangesToCellRanges(w,h,g),w}_stringRangesToCellRanges(e,s,l){let h=0,g=!1,m=0,w=e[h];if(w){for(let b=l;b<this._bufferService.cols;b++){let C=s.getWidth(b),S=s.getString(b).length||Jn.length;if(C!==0){if(!g&&w[0]<=m&&(w[0]=b,g=!0),w[1]<=m){if(w[1]=b,w=e[++h],!w)break;w[0]<=m?(w[0]=b,g=!0):g=!1}m+=S}}w&&(w[1]=this._bufferService.cols)}}static _mergeRanges(e,s){let l=!1;for(let h=0;h<e.length;h++){let g=e[h];if(l){if(s[1]<=g[0])return e[h-1][1]=s[1],e;if(s[1]<=g[1])return e[h-1][1]=Math.max(s[1],g[1]),e.splice(h,1),e;e.splice(h,1),h--}else{if(s[1]<=g[0])return e.splice(h,0,s),e;if(s[1]<=g[1])return g[0]=Math.min(s[0],g[0]),e;s[0]<g[1]&&(g[0]=Math.min(s[0],g[0]),l=!0);continue}}return l?e[e.length-1][1]=s[1]:e.push(s),e}};Ah=fi([Be(0,hs)],Ah);function $S(e){return 57508<=e&&e<=57558}function ey(e){return 9472<=e&&e<=9631}function ty(e){return $S(e)||ey(e)}function iy(){return{css:{canvas:hh(),cell:hh()},device:{canvas:hh(),cell:hh(),char:{width:0,height:0,left:0,top:0}}}}function hh(){return{width:0,height:0}}var Cd=class{constructor(e,s,l,h,g,m,w){this._document=e,this._characterJoinerService=s,this._optionsService=l,this._coreBrowserService=h,this._coreService=g,this._decorationService=m,this._themeService=w,this._workCell=new sr,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(e,s,l){this._selectionStart=e,this._selectionEnd=s,this._columnSelectMode=l}createRow(e,s,l,h,g,m,w,b,C,S,M){let N=[],k=this._characterJoinerService.getJoinedCharacters(s),P=this._themeService.colors,L=e.getNoBgTrimmedLength();l&&L<m+1&&(L=m+1);let X,pe=0,me="",he=0,te=0,le=0,Oe=0,Re=!1,Y=0,Ne=!1,de=0,Gt=0,je=[],oe=S!==-1&&M!==-1;for(let ae=0;ae<L;ae++){e.loadCell(ae,this._workCell);let Ee=this._workCell.getWidth();if(Ee===0)continue;let U=!1,W=ae>=Gt,Z=ae,ue=this._workCell;if(k.length>0&&ae===k[0][0]&&W){let ze=k.shift(),Li=this._isCellInSelection(ze[0],s);for(he=ze[0]+1;he<ze[1];he++)W&&=Li===this._isCellInSelection(he,s);W&&=!l||m<ze[0]||m>=ze[1],W?(U=!0,ue=new JS(this._workCell,e.translateToString(!0,ze[0],ze[1]),ze[1]-ze[0]),Z=ze[1]-1,Ee=ue.getWidth()):Gt=ze[1]}let Le=this._isCellInSelection(ae,s),Me=l&&ae===m,H=oe&&ae>=S&&ae<=M,re=!1;this._decorationService.forEachDecorationAtCell(ae,s,void 0,ze=>{re=!0});let ye=ue.getChars()||Jn;if(ye===" "&&(ue.isUnderline()||ue.isOverline())&&(ye=""),de=Ee*b-C.get(ye,ue.isBold(),ue.isItalic()),!X)X=this._document.createElement("span");else if(pe&&(Le&&Ne||!Le&&!Ne&&ue.bg===te)&&(Le&&Ne&&P.selectionForeground||ue.fg===le)&&ue.extended.ext===Oe&&H===Re&&de===Y&&!Me&&!U&&!re&&W){ue.isInvisible()?me+=Jn:me+=ye,pe++;continue}else pe&&(X.textContent=me),X=this._document.createElement("span"),pe=0,me="";if(te=ue.bg,le=ue.fg,Oe=ue.extended.ext,Re=H,Y=de,Ne=Le,U&&m>=ae&&m<=Z&&(m=ae),!this._coreService.isCursorHidden&&Me&&this._coreService.isCursorInitialized){if(je.push("xterm-cursor"),this._coreBrowserService.isFocused)w&&je.push("xterm-cursor-blink"),je.push(h==="bar"?"xterm-cursor-bar":h==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(g)switch(g){case"outline":je.push("xterm-cursor-outline");break;case"block":je.push("xterm-cursor-block");break;case"bar":je.push("xterm-cursor-bar");break;case"underline":je.push("xterm-cursor-underline");break}}if(ue.isBold()&&je.push("xterm-bold"),ue.isItalic()&&je.push("xterm-italic"),ue.isDim()&&je.push("xterm-dim"),ue.isInvisible()?me=Jn:me=ue.getChars()||Jn,ue.isUnderline()&&(je.push(`xterm-underline-${ue.extended.underlineStyle}`),me===" "&&(me=""),!ue.isUnderlineColorDefault()))if(ue.isUnderlineColorRGB())X.style.textDecorationColor=`rgb(${zo.toColorRGB(ue.getUnderlineColor()).join(",")})`;else{let ze=ue.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&ue.isBold()&&ze<8&&(ze+=8),X.style.textDecorationColor=P.ansi[ze].css}ue.isOverline()&&(je.push("xterm-overline"),me===" "&&(me="")),ue.isStrikethrough()&&je.push("xterm-strikethrough"),H&&(X.style.textDecoration="underline");let be=ue.getFgColor(),Ve=ue.getFgColorMode(),Se=ue.getBgColor(),$e=ue.getBgColorMode(),ot=!!ue.isInverse();if(ot){let ze=be;be=Se,Se=ze;let Li=Ve;Ve=$e,$e=Li}let dt,$i,Xt=!1;this._decorationService.forEachDecorationAtCell(ae,s,void 0,ze=>{ze.options.layer!=="top"&&Xt||(ze.backgroundColorRGB&&($e=50331648,Se=ze.backgroundColorRGB.rgba>>8&16777215,dt=ze.backgroundColorRGB),ze.foregroundColorRGB&&(Ve=50331648,be=ze.foregroundColorRGB.rgba>>8&16777215,$i=ze.foregroundColorRGB),Xt=ze.options.layer==="top")}),!Xt&&Le&&(dt=this._coreBrowserService.isFocused?P.selectionBackgroundOpaque:P.selectionInactiveBackgroundOpaque,Se=dt.rgba>>8&16777215,$e=50331648,Xt=!0,P.selectionForeground&&(Ve=50331648,be=P.selectionForeground.rgba>>8&16777215,$i=P.selectionForeground)),Xt&&je.push("xterm-decoration-top");let Gi;switch($e){case 16777216:case 33554432:Gi=P.ansi[Se],je.push(`xterm-bg-${Se}`);break;case 50331648:Gi=Ai.toColor(Se>>16,Se>>8&255,Se&255),this._addStyle(X,`background-color:#${j_((Se>>>0).toString(16),"0",6)}`);break;default:ot?(Gi=P.foreground,je.push("xterm-bg-257")):Gi=P.background}switch(dt||ue.isDim()&&(dt=Zt.multiplyOpacity(Gi,.5)),Ve){case 16777216:case 33554432:ue.isBold()&&be<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(be+=8),this._applyMinimumContrast(X,Gi,P.ansi[be],ue,dt,void 0)||je.push(`xterm-fg-${be}`);break;case 50331648:let ze=Ai.toColor(be>>16&255,be>>8&255,be&255);this._applyMinimumContrast(X,Gi,ze,ue,dt,$i)||this._addStyle(X,`color:#${j_(be.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(X,Gi,P.foreground,ue,dt,$i)||ot&&je.push("xterm-fg-257")}je.length&&(X.className=je.join(" "),je.length=0),!Me&&!U&&!re&&W?pe++:X.textContent=me,de!==this.defaultSpacing&&(X.style.letterSpacing=`${de}px`),N.push(X),ae=Z}return X&&pe&&(X.textContent=me),N}_applyMinimumContrast(e,s,l,h,g,m){if(this._optionsService.rawOptions.minimumContrastRatio===1||ty(h.getCode()))return!1;let w=this._getContrastCache(h),b;if(!g&&!m&&(b=w.getColor(s.rgba,l.rgba)),b===void 0){let C=this._optionsService.rawOptions.minimumContrastRatio/(h.isDim()?2:1);b=Zt.ensureContrastRatio(g||s,m||l,C),w.setColor((g||s).rgba,(m||l).rgba,b??null)}return b?(this._addStyle(e,`color:${b.css}`),!0):!1}_getContrastCache(e){return e.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(e,s){e.setAttribute("style",`${e.getAttribute("style")||""}${s};`)}_isCellInSelection(e,s){let l=this._selectionStart,h=this._selectionEnd;return!l||!h?!1:this._columnSelectMode?l[0]<=h[0]?e>=l[0]&&s>=l[1]&&e<h[0]&&s<=h[1]:e<l[0]&&s>=l[1]&&e>=h[0]&&s<=h[1]:s>l[1]&&s<h[1]||l[1]===h[1]&&s===l[1]&&e>=l[0]&&e<h[0]||l[1]<h[1]&&s===h[1]&&e<h[0]||l[1]<h[1]&&s===l[1]&&e>=l[0]}};Cd=fi([Be(1,U2),Be(2,us),Be(3,ln),Be(4,Ba),Be(5,Fo),Be(6,Cl)],Cd);function j_(e,s,l){for(;e.length<l;)e=s+e;return e}var sy=class{constructor(e,s){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=e.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";let l=e.createElement("span");l.classList.add("xterm-char-measure-element");let h=e.createElement("span");h.classList.add("xterm-char-measure-element"),h.style.fontWeight="bold";let g=e.createElement("span");g.classList.add("xterm-char-measure-element"),g.style.fontStyle="italic";let m=e.createElement("span");m.classList.add("xterm-char-measure-element"),m.style.fontWeight="bold",m.style.fontStyle="italic",this._measureElements=[l,h,g,m],this._container.appendChild(l),this._container.appendChild(h),this._container.appendChild(g),this._container.appendChild(m),s.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(e,s,l,h){e===this._font&&s===this._fontSize&&l===this._weight&&h===this._weightBold||(this._font=e,this._fontSize=s,this._weight=l,this._weightBold=h,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${l}`,this._measureElements[1].style.fontWeight=`${h}`,this._measureElements[2].style.fontWeight=`${l}`,this._measureElements[3].style.fontWeight=`${h}`,this.clear())}get(e,s,l){let h=0;if(!s&&!l&&e.length===1&&(h=e.charCodeAt(0))<256){if(this._flat[h]!==-9999)return this._flat[h];let w=this._measure(e,0);return w>0&&(this._flat[h]=w),w}let g=e;s&&(g+="B"),l&&(g+="I");let m=this._holey.get(g);if(m===void 0){let w=0;s&&(w|=1),l&&(w|=2),m=this._measure(e,w),m>0&&this._holey.set(g,m)}return m}_measure(e,s){let l=this._measureElements[s];return l.textContent=e.repeat(32),l.offsetWidth/32}},ry=class{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(e,s,l,h=!1){if(this.selectionStart=s,this.selectionEnd=l,!s||!l||s[0]===l[0]&&s[1]===l[1]){this.clear();return}let g=e.buffers.active.ydisp,m=s[1]-g,w=l[1]-g,b=Math.max(m,0),C=Math.min(w,e.rows-1);if(b>=e.rows||C<0){this.clear();return}this.hasSelection=!0,this.columnSelectMode=h,this.viewportStartRow=m,this.viewportEndRow=w,this.viewportCappedStartRow=b,this.viewportCappedEndRow=C,this.startCol=s[0],this.endCol=l[0]}isCellSelected(e,s,l){return this.hasSelection?(l-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?s>=this.startCol&&l>=this.viewportCappedStartRow&&s<this.endCol&&l<=this.viewportCappedEndRow:s<this.startCol&&l>=this.viewportCappedStartRow&&s>=this.endCol&&l<=this.viewportCappedEndRow:l>this.viewportStartRow&&l<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&l===this.viewportStartRow&&s>=this.startCol&&s<this.endCol||this.viewportStartRow<this.viewportEndRow&&l===this.viewportEndRow&&s<this.endCol||this.viewportStartRow<this.viewportEndRow&&l===this.viewportStartRow&&s>=this.startCol):!1}};function ny(){return new ry}var Wf="xterm-dom-renderer-owner-",er="xterm-rows",uh="xterm-fg-",q_="xterm-bg-",bo="xterm-focus",fh="xterm-selection",ay=1,Ed=class extends lt{constructor(e,s,l,h,g,m,w,b,C,S,M,N,k,P){super(),this._terminal=e,this._document=s,this._element=l,this._screenElement=h,this._viewportElement=g,this._helperContainer=m,this._linkifier2=w,this._charSizeService=C,this._optionsService=S,this._bufferService=M,this._coreService=N,this._coreBrowserService=k,this._themeService=P,this._terminalClass=ay++,this._rowElements=[],this._selectionRenderModel=ny(),this.onRequestRedraw=this._register(new De).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(er),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(fh),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=iy(),this._updateDimensions(),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._themeService.onChangeColors(L=>this._injectCss(L))),this._injectCss(this._themeService.colors),this._rowFactory=b.createInstance(Cd,document),this._element.classList.add(Wf+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this._register(this._linkifier2.onShowLinkUnderline(L=>this._handleLinkHover(L))),this._register(this._linkifier2.onHideLinkUnderline(L=>this._handleLinkLeave(L))),this._register(ei(()=>{this._element.classList.remove(Wf+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new sy(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){let e=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*e,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let l of this._rowElements)l.style.width=`${this.dimensions.css.canvas.width}px`,l.style.height=`${this.dimensions.css.cell.height}px`,l.style.lineHeight=`${this.dimensions.css.cell.height}px`,l.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let s=`${this._terminalSelector} .${er} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=s,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(e){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let s=`${this._terminalSelector} .${er} { pointer-events: none; color: ${e.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;s+=`${this._terminalSelector} .${er} .xterm-dim { color: ${Zt.multiplyOpacity(e.foreground,.5).css};}`,s+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;let l=`blink_underline_${this._terminalClass}`,h=`blink_bar_${this._terminalClass}`,g=`blink_block_${this._terminalClass}`;s+=`@keyframes ${l} { 50% {  border-bottom-style: hidden; }}`,s+=`@keyframes ${h} { 50% {  box-shadow: none; }}`,s+=`@keyframes ${g} { 0% {  background-color: ${e.cursor.css};  color: ${e.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${e.cursor.css}; }}`,s+=`${this._terminalSelector} .${er}.${bo} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${l} 1s step-end infinite;}${this._terminalSelector} .${er}.${bo} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${h} 1s step-end infinite;}${this._terminalSelector} .${er}.${bo} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${g} 1s step-end infinite;}${this._terminalSelector} .${er} .xterm-cursor.xterm-cursor-block { background-color: ${e.cursor.css}; color: ${e.cursorAccent.css};}${this._terminalSelector} .${er} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${e.cursor.css} !important; color: ${e.cursorAccent.css} !important;}${this._terminalSelector} .${er} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${e.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${er} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${e.cursor.css} inset;}${this._terminalSelector} .${er} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${e.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,s+=`${this._terminalSelector} .${fh} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${fh} div { position: absolute; background-color: ${e.selectionBackgroundOpaque.css};}${this._terminalSelector} .${fh} div { position: absolute; background-color: ${e.selectionInactiveBackgroundOpaque.css};}`;for(let[m,w]of e.ansi.entries())s+=`${this._terminalSelector} .${uh}${m} { color: ${w.css}; }${this._terminalSelector} .${uh}${m}.xterm-dim { color: ${Zt.multiplyOpacity(w,.5).css}; }${this._terminalSelector} .${q_}${m} { background-color: ${w.css}; }`;s+=`${this._terminalSelector} .${uh}257 { color: ${Zt.opaque(e.background).css}; }${this._terminalSelector} .${uh}257.xterm-dim { color: ${Zt.multiplyOpacity(Zt.opaque(e.background),.5).css}; }${this._terminalSelector} .${q_}257 { background-color: ${e.foreground.css}; }`,this._themeStyleElement.textContent=s}_setDefaultSpacing(){let e=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${e}px`,this._rowFactory.defaultSpacing=e}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(e,s){for(let l=this._rowElements.length;l<=s;l++){let h=this._document.createElement("div");this._rowContainer.appendChild(h),this._rowElements.push(h)}for(;this._rowElements.length>s;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(e,s){this._refreshRowElements(e,s),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(bo),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(bo),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(e,s,l){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(e,s,l),this.renderRows(0,this._bufferService.rows-1),!e||!s||(this._selectionRenderModel.update(this._terminal,e,s,l),!this._selectionRenderModel.hasSelection))return;let h=this._selectionRenderModel.viewportStartRow,g=this._selectionRenderModel.viewportEndRow,m=this._selectionRenderModel.viewportCappedStartRow,w=this._selectionRenderModel.viewportCappedEndRow,b=this._document.createDocumentFragment();if(l){let C=e[0]>s[0];b.appendChild(this._createSelectionElement(m,C?s[0]:e[0],C?e[0]:s[0],w-m+1))}else{let C=h===m?e[0]:0,S=m===g?s[0]:this._bufferService.cols;b.appendChild(this._createSelectionElement(m,C,S));let M=w-m-1;if(b.appendChild(this._createSelectionElement(m+1,0,this._bufferService.cols,M)),m!==w){let N=g===w?s[0]:this._bufferService.cols;b.appendChild(this._createSelectionElement(w,0,N))}}this._selectionContainer.appendChild(b)}_createSelectionElement(e,s,l,h=1){let g=this._document.createElement("div"),m=s*this.dimensions.css.cell.width,w=this.dimensions.css.cell.width*(l-s);return m+w>this.dimensions.css.canvas.width&&(w=this.dimensions.css.canvas.width-m),g.style.height=`${h*this.dimensions.css.cell.height}px`,g.style.top=`${e*this.dimensions.css.cell.height}px`,g.style.left=`${m}px`,g.style.width=`${w}px`,g}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(let e of this._rowElements)e.replaceChildren()}renderRows(e,s){let l=this._bufferService.buffer,h=l.ybase+l.y,g=Math.min(l.x,this._bufferService.cols-1),m=this._coreService.decPrivateModes.cursorBlink??this._optionsService.rawOptions.cursorBlink,w=this._coreService.decPrivateModes.cursorStyle??this._optionsService.rawOptions.cursorStyle,b=this._optionsService.rawOptions.cursorInactiveStyle;for(let C=e;C<=s;C++){let S=C+l.ydisp,M=this._rowElements[C],N=l.lines.get(S);if(!M||!N)break;M.replaceChildren(...this._rowFactory.createRow(N,S,S===h,w,b,g,m,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${Wf}${this._terminalClass}`}_handleLinkHover(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)}_handleLinkLeave(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)}_setCellUnderline(e,s,l,h,g,m){l<0&&(e=0),h<0&&(s=0);let w=this._bufferService.rows-1;l=Math.max(Math.min(l,w),0),h=Math.max(Math.min(h,w),0),g=Math.min(g,this._bufferService.cols);let b=this._bufferService.buffer,C=b.ybase+b.y,S=Math.min(b.x,g-1),M=this._optionsService.rawOptions.cursorBlink,N=this._optionsService.rawOptions.cursorStyle,k=this._optionsService.rawOptions.cursorInactiveStyle;for(let P=l;P<=h;++P){let L=P+b.ydisp,X=this._rowElements[P],pe=b.lines.get(L);if(!X||!pe)break;X.replaceChildren(...this._rowFactory.createRow(pe,L,L===C,N,k,S,M,this.dimensions.css.cell.width,this._widthCache,m?P===l?e:0:-1,m?(P===h?s:g)-1:-1))}}};Ed=fi([Be(7,Ud),Be(8,Bh),Be(9,us),Be(10,hs),Be(11,Ba),Be(12,ln),Be(13,Cl)],Ed);var Ad=class extends lt{constructor(e,s,l){super(),this._optionsService=l,this.width=0,this.height=0,this._onCharSizeChange=this._register(new De),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this._register(new oy(this._optionsService))}catch{this._measureStrategy=this._register(new ly(e,s,this._optionsService))}this._register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let e=this._measureStrategy.measure();(e.width!==this.width||e.height!==this.height)&&(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};Ad=fi([Be(2,us)],Ad);var am=class extends lt{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(e,s){e!==void 0&&e>0&&s!==void 0&&s>0&&(this._result.width=e,this._result.height=s)}},ly=class extends am{constructor(e,s,l){super(),this._document=e,this._parentElement=s,this._optionsService=l,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}},oy=class extends am{constructor(e){super(),this._optionsService=e,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");let s=this._ctx.measureText("W");if(!("width"in s&&"fontBoundingBoxAscent"in s&&"fontBoundingBoxDescent"in s))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;let e=this._ctx.measureText("W");return this._validateAndSet(e.width,e.fontBoundingBoxAscent+e.fontBoundingBoxDescent),this._result}},cy=class extends lt{constructor(e,s,l){super(),this._textarea=e,this._window=s,this.mainDocument=l,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=this._register(new hy(this._window)),this._onDprChange=this._register(new De),this.onDprChange=this._onDprChange.event,this._onWindowChange=this._register(new De),this.onWindowChange=this._onWindowChange.event,this._register(this.onWindowChange(h=>this._screenDprMonitor.setWindow(h))),this._register(Ji.forward(this._screenDprMonitor.onDprChange,this._onDprChange)),this._register(Ke(this._textarea,"focus",()=>this._isFocused=!0)),this._register(Ke(this._textarea,"blur",()=>this._isFocused=!1))}get window(){return this._window}set window(e){this._window!==e&&(this._window=e,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}},hy=class extends lt{constructor(e){super(),this._parentWindow=e,this._windowResizeListener=this._register(new bl),this._onDprChange=this._register(new De),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this._register(ei(()=>this.clearListener()))}setWindow(e){this._parentWindow=e,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=Ke(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){!this._resolutionMediaMatchList||!this._outerListener||(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}},uy=class extends lt{constructor(){super(),this.linkProviders=[],this._register(ei(()=>this.linkProviders.length=0))}registerLinkProvider(e){return this.linkProviders.push(e),{dispose:()=>{let s=this.linkProviders.indexOf(e);s!==-1&&this.linkProviders.splice(s,1)}}}};function Kd(e,s,l){let h=l.getBoundingClientRect(),g=e.getComputedStyle(l),m=parseInt(g.getPropertyValue("padding-left")),w=parseInt(g.getPropertyValue("padding-top"));return[s.clientX-h.left-m,s.clientY-h.top-w]}function fy(e,s,l,h,g,m,w,b,C){if(!m)return;let S=Kd(e,s,l);if(S)return S[0]=Math.ceil((S[0]+(C?w/2:0))/w),S[1]=Math.ceil(S[1]/b),S[0]=Math.min(Math.max(S[0],1),h+(C?1:0)),S[1]=Math.min(Math.max(S[1],1),g),S}var Td=class{constructor(e,s){this._renderService=e,this._charSizeService=s}getCoords(e,s,l,h,g){return fy(window,e,s,l,h,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,g)}getMouseReportCoords(e,s){let l=Kd(window,e,s);if(this._charSizeService.hasValidSize)return l[0]=Math.min(Math.max(l[0],0),this._renderService.dimensions.css.canvas.width-1),l[1]=Math.min(Math.max(l[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(l[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(l[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(l[0]),y:Math.floor(l[1])}}};Td=fi([Be(0,on),Be(1,Bh)],Td);var dy=class{constructor(e,s){this._renderCallback=e,this._coreBrowserService=s,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(e){return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(e,s,l){this._rowCount=l,e=e!==void 0?e:0,s=s!==void 0?s:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,e):e,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,s):s,!this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0){this._runRefreshCallbacks();return}let e=Math.max(this._rowStart,0),s=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,s),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let e of this._refreshCallbacks)e(0);this._refreshCallbacks=[]}},lm={};bv(lm,{getSafariVersion:()=>_y,isChromeOS:()=>um,isFirefox:()=>om,isIpad:()=>my,isIphone:()=>py,isLegacyEdge:()=>gy,isLinux:()=>Zd,isMac:()=>Th,isNode:()=>Ih,isSafari:()=>cm,isWindows:()=>hm});var Ih=typeof process<"u"&&"title"in process,Uo=Ih?"node":navigator.userAgent,Vo=Ih?"node":navigator.platform,om=Uo.includes("Firefox"),gy=Uo.includes("Edge"),cm=/^((?!chrome|android).)*safari/i.test(Uo);function _y(){if(!cm)return 0;let e=Uo.match(/Version\/(\d+)/);return e===null||e.length<2?0:parseInt(e[1])}var Th=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(Vo),my=Vo==="iPad",py=Vo==="iPhone",hm=["Windows","Win16","Win32","WinCE"].includes(Vo),Zd=Vo.indexOf("Linux")>=0,um=/\bCrOS\b/.test(Uo),fm=class{constructor(){this._tasks=[],this._i=0}enqueue(e){this._tasks.push(e),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let s=0,l=0,h=e.timeRemaining(),g=0;for(;this._i<this._tasks.length;){if(s=performance.now(),this._tasks[this._i]()||this._i++,s=Math.max(1,performance.now()-s),l=Math.max(s,l),g=e.timeRemaining(),l*1.5>g){h-s<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(h-s))}ms`),this._start();return}h=g}this.clear()}},xy=class extends fm{_requestCallback(e){return setTimeout(()=>e(this._createDeadline(16)))}_cancelCallback(e){clearTimeout(e)}_createDeadline(e){let s=performance.now()+e;return{timeRemaining:()=>Math.max(0,s-performance.now())}}},vy=class extends fm{_requestCallback(e){return requestIdleCallback(e)}_cancelCallback(e){cancelIdleCallback(e)}},Rh=!Ih&&"requestIdleCallback"in window?vy:xy,Sy=class{constructor(){this._queue=new Rh}set(e){this._queue.clear(),this._queue.enqueue(e)}flush(){this._queue.flush()}},Rd=class extends lt{constructor(e,s,l,h,g,m,w,b,C){super(),this._rowCount=e,this._optionsService=l,this._charSizeService=h,this._coreService=g,this._coreBrowserService=b,this._renderer=this._register(new bl),this._pausedResizeTask=new Sy,this._observerDisposable=this._register(new bl),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this._register(new De),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this._register(new De),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this._register(new De),this.onRender=this._onRender.event,this._onRefreshRequest=this._register(new De),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new dy((S,M)=>this._renderRows(S,M),this._coreBrowserService),this._register(this._renderDebouncer),this._syncOutputHandler=new yy(this._coreBrowserService,this._coreService,()=>this._fullRefresh()),this._register(ei(()=>this._syncOutputHandler.dispose())),this._register(this._coreBrowserService.onDprChange(()=>this.handleDevicePixelRatioChange())),this._register(w.onResize(()=>this._fullRefresh())),this._register(w.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this._register(m.onDecorationRegistered(()=>this._fullRefresh())),this._register(m.onDecorationRemoved(()=>this._fullRefresh())),this._register(this._optionsService.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(w.cols,w.rows),this._fullRefresh()})),this._register(this._optionsService.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(w.buffer.y,w.buffer.y,!0))),this._register(C.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(this._coreBrowserService.window,s),this._register(this._coreBrowserService.onWindowChange(S=>this._registerIntersectionObserver(S,s)))}get dimensions(){return this._renderer.value.dimensions}_registerIntersectionObserver(e,s){if("IntersectionObserver"in e){let l=new e.IntersectionObserver(h=>this._handleIntersectionChange(h[h.length-1]),{threshold:0});l.observe(s),this._observerDisposable.value=ei(()=>l.disconnect())}}_handleIntersectionChange(e){this._isPaused=e.isIntersecting===void 0?e.intersectionRatio===0:!e.isIntersecting,!this._isPaused&&!this._charSizeService.hasValidSize&&this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(e,s,l=!1){if(this._isPaused){this._needsFullRefresh=!0;return}if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(e,s);return}let h=this._syncOutputHandler.flush();h&&(e=Math.min(e,h.start),s=Math.max(s,h.end)),l||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,s,this._rowCount)}_renderRows(e,s){if(this._renderer.value){if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(e,s);return}e=Math.min(e,this._rowCount-1),s=Math.min(s,this._rowCount-1),this._renderer.value.renderRows(e,s),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:s}),this._onRender.fire({start:e,end:s}),this._isNextRenderRedrawOnly=!0}}resize(e,s){this._rowCount=s,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(e){this._renderer.value=e,this._renderer.value&&(this._renderer.value.onRequestRedraw(s=>this.refreshRows(s.start,s.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(e){return this._renderDebouncer.addRefreshCallback(e)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(e,s){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(e,s)):this._renderer.value.handleResize(e,s),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(e,s,l){this._selectionState.start=e,this._selectionState.end=s,this._selectionState.columnSelectMode=l,this._renderer.value?.handleSelectionChanged(e,s,l)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};Rd=fi([Be(2,us),Be(3,Bh),Be(4,Ba),Be(5,Fo),Be(6,hs),Be(7,ln),Be(8,Cl)],Rd);var yy=class{constructor(e,s,l){this._coreBrowserService=e,this._coreService=s,this._onTimeout=l,this._start=0,this._end=0,this._isBuffering=!1}bufferRows(e,s){this._isBuffering?(this._start=Math.min(this._start,e),this._end=Math.max(this._end,s)):(this._start=e,this._end=s,this._isBuffering=!0),this._timeout===void 0&&(this._timeout=this._coreBrowserService.window.setTimeout(()=>{this._timeout=void 0,this._coreService.decPrivateModes.synchronizedOutput=!1,this._onTimeout()},1e3))}flush(){if(this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0),!this._isBuffering)return;let e={start:this._start,end:this._end};return this._isBuffering=!1,e}dispose(){this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0)}};function wy(e,s,l,h){let g=l.buffer.x,m=l.buffer.y;if(!l.buffer.hasScrollback)return Ey(g,m,e,s,l,h)+kh(m,s,l,h)+Ay(g,m,e,s,l,h);let w;if(m===s)return w=g>e?"D":"C",Lo(Math.abs(g-e),ko(w,h));w=m>s?"D":"C";let b=Math.abs(m-s),C=Cy(m>s?e:g,l)+(b-1)*l.cols+1+by(m>s?g:e);return Lo(C,ko(w,h))}function by(e,s){return e-1}function Cy(e,s){return s.cols-e}function Ey(e,s,l,h,g,m){return kh(s,h,g,m).length===0?"":Lo(gm(e,s,e,s-Ma(s,g),!1,g).length,ko("D",m))}function kh(e,s,l,h){let g=e-Ma(e,l),m=s-Ma(s,l),w=Math.abs(g-m)-Ty(e,s,l);return Lo(w,ko(dm(e,s),h))}function Ay(e,s,l,h,g,m){let w;kh(s,h,g,m).length>0?w=h-Ma(h,g):w=s;let b=h,C=Ry(e,s,l,h,g,m);return Lo(gm(e,w,l,b,C==="C",g).length,ko(C,m))}function Ty(e,s,l){let h=0,g=e-Ma(e,l),m=s-Ma(s,l);for(let w=0;w<Math.abs(g-m);w++){let b=dm(e,s)==="A"?-1:1;l.buffer.lines.get(g+b*w)?.isWrapped&&h++}return h}function Ma(e,s){let l=0,h=s.buffer.lines.get(e),g=h?.isWrapped;for(;g&&e>=0&&e<s.rows;)l++,h=s.buffer.lines.get(--e),g=h?.isWrapped;return l}function Ry(e,s,l,h,g,m){let w;return kh(l,h,g,m).length>0?w=h-Ma(h,g):w=s,e<l&&w<=h||e>=l&&w<h?"C":"D"}function dm(e,s){return e>s?"A":"B"}function gm(e,s,l,h,g,m){let w=e,b=s,C="";for(;(w!==l||b!==h)&&b>=0&&b<m.buffer.lines.length;)w+=g?1:-1,g&&w>m.cols-1?(C+=m.buffer.translateBufferLineToString(b,!1,e,w),w=0,e=0,b++):!g&&w<0&&(C+=m.buffer.translateBufferLineToString(b,!1,0,e+1),w=m.cols-1,e=w,b--);return C+m.buffer.translateBufferLineToString(b,!1,e,w)}function ko(e,s){let l=s?"O":"[";return _e.ESC+l+e}function Lo(e,s){e=Math.floor(e);let l="";for(let h=0;h<e;h++)l+=s;return l}var Ny=class{constructor(e){this._bufferService=e,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:!this.selectionEnd||!this.selectionStart?this.selectionStart:this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?e%this._bufferService.cols===0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[Math.max(e,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let e=this.selectionStart,s=this.selectionEnd;return!e||!s?!1:e[1]>s[1]||e[1]===s[1]&&e[0]>s[0]}handleTrim(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}};function K_(e,s){if(e.start.y>e.end.y)throw new Error(`Buffer range end (${e.end.x}, ${e.end.y}) cannot be before start (${e.start.x}, ${e.start.y})`);return s*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}var Gf=50,Dy=15,Oy=50,My=500,By="",Iy=new RegExp(By,"g"),Nd=class extends lt{constructor(e,s,l,h,g,m,w,b,C){super(),this._element=e,this._screenElement=s,this._linkifier=l,this._bufferService=h,this._coreService=g,this._mouseService=m,this._optionsService=w,this._renderService=b,this._coreBrowserService=C,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new sr,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this._register(new De),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this._register(new De),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this._register(new De),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this._register(new De),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=S=>this._handleMouseMove(S),this._mouseUpListener=S=>this._handleMouseUp(S),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(S=>this._handleTrim(S)),this._register(this._bufferService.buffers.onBufferActivate(S=>this._handleBufferActivate(S))),this.enable(),this._model=new Ny(this._bufferService),this._activeSelectionMode=0,this._register(ei(()=>{this._removeMouseDownListeners()})),this._register(this._bufferService.onResize(S=>{S.rowsChanged&&this.clearSelection()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let e=this._model.finalSelectionStart,s=this._model.finalSelectionEnd;return!e||!s?!1:e[0]!==s[0]||e[1]!==s[1]}get selectionText(){let e=this._model.finalSelectionStart,s=this._model.finalSelectionEnd;if(!e||!s)return"";let l=this._bufferService.buffer,h=[];if(this._activeSelectionMode===3){if(e[0]===s[0])return"";let g=e[0]<s[0]?e[0]:s[0],m=e[0]<s[0]?s[0]:e[0];for(let w=e[1];w<=s[1];w++){let b=l.translateBufferLineToString(w,!0,g,m);h.push(b)}}else{let g=e[1]===s[1]?s[0]:void 0;h.push(l.translateBufferLineToString(e[1],!0,e[0],g));for(let m=e[1]+1;m<=s[1]-1;m++){let w=l.lines.get(m),b=l.translateBufferLineToString(m,!0);w?.isWrapped?h[h.length-1]+=b:h.push(b)}if(e[1]!==s[1]){let m=l.lines.get(s[1]),w=l.translateBufferLineToString(s[1],!0,0,s[0]);m&&m.isWrapped?h[h.length-1]+=w:h.push(w)}}return h.map(g=>g.replace(Iy," ")).join(hm?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(e){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),Zd&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(e){let s=this._getMouseBufferCoords(e),l=this._model.finalSelectionStart,h=this._model.finalSelectionEnd;return!l||!h||!s?!1:this._areCoordsInSelection(s,l,h)}isCellInSelection(e,s){let l=this._model.finalSelectionStart,h=this._model.finalSelectionEnd;return!l||!h?!1:this._areCoordsInSelection([e,s],l,h)}_areCoordsInSelection(e,s,l){return e[1]>s[1]&&e[1]<l[1]||s[1]===l[1]&&e[1]===s[1]&&e[0]>=s[0]&&e[0]<l[0]||s[1]<l[1]&&e[1]===l[1]&&e[0]<l[0]||s[1]<l[1]&&e[1]===s[1]&&e[0]>=s[0]}_selectWordAtCursor(e,s){let l=this._linkifier.currentLink?.link?.range;if(l)return this._model.selectionStart=[l.start.x-1,l.start.y-1],this._model.selectionStartLength=K_(l,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let h=this._getMouseBufferCoords(e);return h?(this._selectWordAt(h,s),this._model.selectionEnd=void 0,!0):!1}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(e,s){this._model.clearSelection(),e=Math.max(e,0),s=Math.min(s,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,s],this.refresh(),this._onSelectionChange.fire()}_handleTrim(e){this._model.handleTrim(e)&&this.refresh()}_getMouseBufferCoords(e){let s=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(s)return s[0]--,s[1]--,s[1]+=this._bufferService.buffer.ydisp,s}_getMouseEventScrollAmount(e){let s=Kd(this._coreBrowserService.window,e,this._screenElement)[1],l=this._renderService.dimensions.css.canvas.height;return s>=0&&s<=l?0:(s>l&&(s-=l),s=Math.min(Math.max(s,-Gf),Gf),s/=Gf,s/Math.abs(s)+Math.round(s*(Dy-1)))}shouldForceSelection(e){return Th?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey}handleMouseDown(e){if(this._mouseDownTimeStamp=e.timeStamp,!(e.button===2&&this.hasSelection)&&e.button===0){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._handleIncrementalClick(e):e.detail===1?this._handleSingleClick(e):e.detail===2?this._handleDoubleClick(e):e.detail===3&&this._handleTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),Oy)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))}_handleSingleClick(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let s=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);s&&s.length!==this._model.selectionStart[0]&&s.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(e){let s=this._getMouseBufferCoords(e);s&&(this._activeSelectionMode=2,this._selectLineAt(s[1]))}shouldColumnSelect(e){return e.altKey&&!(Th&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(e){if(e.stopImmediatePropagation(),!this._model.selectionStart)return;let s=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),!this._model.selectionEnd){this.refresh(!0);return}this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let l=this._bufferService.buffer;if(this._model.selectionEnd[1]<l.lines.length){let h=l.lines.get(this._model.selectionEnd[1]);h&&h.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}(!s||s[0]!==this._model.selectionEnd[0]||s[1]!==this._model.selectionEnd[1])&&this.refresh(!0)}_dragScroll(){if(!(!this._model.selectionEnd||!this._model.selectionStart)&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let e=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}}_handleMouseUp(e){let s=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&s<My&&e.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let l=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(l&&l[0]!==void 0&&l[1]!==void 0){let h=wy(l[0]-1,l[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(h,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let e=this._model.finalSelectionStart,s=this._model.finalSelectionEnd,l=!!e&&!!s&&(e[0]!==s[0]||e[1]!==s[1]);if(!l){this._oldHasSelection&&this._fireOnSelectionChange(e,s,l);return}!e||!s||(!this._oldSelectionStart||!this._oldSelectionEnd||e[0]!==this._oldSelectionStart[0]||e[1]!==this._oldSelectionStart[1]||s[0]!==this._oldSelectionEnd[0]||s[1]!==this._oldSelectionEnd[1])&&this._fireOnSelectionChange(e,s,l)}_fireOnSelectionChange(e,s,l){this._oldSelectionStart=e,this._oldSelectionEnd=s,this._oldHasSelection=l,this._onSelectionChange.fire()}_handleBufferActivate(e){this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim(s=>this._handleTrim(s))}_convertViewportColToCharacterIndex(e,s){let l=s;for(let h=0;s>=h;h++){let g=e.loadCell(h,this._workCell).getChars().length;this._workCell.getWidth()===0?l--:g>1&&s!==h&&(l+=g-1)}return l}setSelection(e,s,l){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,s],this._model.selectionStartLength=l,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(e,s,l=!0,h=!0){if(e[0]>=this._bufferService.cols)return;let g=this._bufferService.buffer,m=g.lines.get(e[1]);if(!m)return;let w=g.translateBufferLineToString(e[1],!1),b=this._convertViewportColToCharacterIndex(m,e[0]),C=b,S=e[0]-b,M=0,N=0,k=0,P=0;if(w.charAt(b)===" "){for(;b>0&&w.charAt(b-1)===" ";)b--;for(;C<w.length&&w.charAt(C+1)===" ";)C++}else{let pe=e[0],me=e[0];m.getWidth(pe)===0&&(M++,pe--),m.getWidth(me)===2&&(N++,me++);let he=m.getString(me).length;for(he>1&&(P+=he-1,C+=he-1);pe>0&&b>0&&!this._isCharWordSeparator(m.loadCell(pe-1,this._workCell));){m.loadCell(pe-1,this._workCell);let te=this._workCell.getChars().length;this._workCell.getWidth()===0?(M++,pe--):te>1&&(k+=te-1,b-=te-1),b--,pe--}for(;me<m.length&&C+1<w.length&&!this._isCharWordSeparator(m.loadCell(me+1,this._workCell));){m.loadCell(me+1,this._workCell);let te=this._workCell.getChars().length;this._workCell.getWidth()===2?(N++,me++):te>1&&(P+=te-1,C+=te-1),C++,me++}}C++;let L=b+S-M+k,X=Math.min(this._bufferService.cols,C-b+M+N-k-P);if(!(!s&&w.slice(b,C).trim()==="")){if(l&&L===0&&m.getCodePoint(0)!==32){let pe=g.lines.get(e[1]-1);if(pe&&m.isWrapped&&pe.getCodePoint(this._bufferService.cols-1)!==32){let me=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(me){let he=this._bufferService.cols-me.start;L-=he,X+=he}}}if(h&&L+X===this._bufferService.cols&&m.getCodePoint(this._bufferService.cols-1)!==32){let pe=g.lines.get(e[1]+1);if(pe?.isWrapped&&pe.getCodePoint(0)!==32){let me=this._getWordAt([0,e[1]+1],!1,!1,!0);me&&(X+=me.length)}}return{start:L,length:X}}}_selectWordAt(e,s){let l=this._getWordAt(e,s);if(l){for(;l.start<0;)l.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[l.start,e[1]],this._model.selectionStartLength=l.length}}_selectToWordAt(e){let s=this._getWordAt(e,!0);if(s){let l=e[1];for(;s.start<0;)s.start+=this._bufferService.cols,l--;if(!this._model.areSelectionValuesReversed())for(;s.start+s.length>this._bufferService.cols;)s.length-=this._bufferService.cols,l++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?s.start:s.start+s.length,l]}}_isCharWordSeparator(e){return e.getWidth()===0?!1:this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0}_selectLineAt(e){let s=this._bufferService.buffer.getWrappedRangeForLine(e),l={start:{x:0,y:s.first},end:{x:this._bufferService.cols-1,y:s.last}};this._model.selectionStart=[0,s.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=K_(l,this._bufferService.cols)}};Nd=fi([Be(3,hs),Be(4,Ba),Be(5,Vd),Be(6,us),Be(7,on),Be(8,ln)],Nd);var Z_=class{constructor(){this._data={}}set(e,s,l){this._data[e]||(this._data[e]={}),this._data[e][s]=l}get(e,s){return this._data[e]?this._data[e][s]:void 0}clear(){this._data={}}},Q_=class{constructor(){this._color=new Z_,this._css=new Z_}setCss(e,s,l){this._css.set(e,s,l)}getCss(e,s){return this._css.get(e,s)}setColor(e,s,l){this._color.set(e,s,l)}getColor(e,s){return this._color.get(e,s)}clear(){this._color.clear(),this._css.clear()}},Bi=Object.freeze((()=>{let e=[ri.toColor("#2e3436"),ri.toColor("#cc0000"),ri.toColor("#4e9a06"),ri.toColor("#c4a000"),ri.toColor("#3465a4"),ri.toColor("#75507b"),ri.toColor("#06989a"),ri.toColor("#d3d7cf"),ri.toColor("#555753"),ri.toColor("#ef2929"),ri.toColor("#8ae234"),ri.toColor("#fce94f"),ri.toColor("#729fcf"),ri.toColor("#ad7fa8"),ri.toColor("#34e2e2"),ri.toColor("#eeeeec")],s=[0,95,135,175,215,255];for(let l=0;l<216;l++){let h=s[l/36%6|0],g=s[l/6%6|0],m=s[l%6];e.push({css:Ai.toCss(h,g,m),rgba:Ai.toRgba(h,g,m)})}for(let l=0;l<24;l++){let h=8+l*10;e.push({css:Ai.toCss(h,h,h),rgba:Ai.toRgba(h,h,h)})}return e})()),Aa=ri.toColor("#ffffff"),Do=ri.toColor("#000000"),J_=ri.toColor("#ffffff"),$_=Do,Co={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117},ky=Aa,Dd=class extends lt{constructor(e){super(),this._optionsService=e,this._contrastCache=new Q_,this._halfContrastCache=new Q_,this._onChangeColors=this._register(new De),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:Aa,background:Do,cursor:J_,cursorAccent:$_,selectionForeground:void 0,selectionBackgroundTransparent:Co,selectionBackgroundOpaque:Zt.blend(Do,Co),selectionInactiveBackgroundTransparent:Co,selectionInactiveBackgroundOpaque:Zt.blend(Do,Co),scrollbarSliderBackground:Zt.opacity(Aa,.2),scrollbarSliderHoverBackground:Zt.opacity(Aa,.4),scrollbarSliderActiveBackground:Zt.opacity(Aa,.5),overviewRulerBorder:Aa,ansi:Bi.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this._register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this._register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(e={}){let s=this._colors;if(s.foreground=Ht(e.foreground,Aa),s.background=Ht(e.background,Do),s.cursor=Zt.blend(s.background,Ht(e.cursor,J_)),s.cursorAccent=Zt.blend(s.background,Ht(e.cursorAccent,$_)),s.selectionBackgroundTransparent=Ht(e.selectionBackground,Co),s.selectionBackgroundOpaque=Zt.blend(s.background,s.selectionBackgroundTransparent),s.selectionInactiveBackgroundTransparent=Ht(e.selectionInactiveBackground,s.selectionBackgroundTransparent),s.selectionInactiveBackgroundOpaque=Zt.blend(s.background,s.selectionInactiveBackgroundTransparent),s.selectionForeground=e.selectionForeground?Ht(e.selectionForeground,Y_):void 0,s.selectionForeground===Y_&&(s.selectionForeground=void 0),Zt.isOpaque(s.selectionBackgroundTransparent)&&(s.selectionBackgroundTransparent=Zt.opacity(s.selectionBackgroundTransparent,.3)),Zt.isOpaque(s.selectionInactiveBackgroundTransparent)&&(s.selectionInactiveBackgroundTransparent=Zt.opacity(s.selectionInactiveBackgroundTransparent,.3)),s.scrollbarSliderBackground=Ht(e.scrollbarSliderBackground,Zt.opacity(s.foreground,.2)),s.scrollbarSliderHoverBackground=Ht(e.scrollbarSliderHoverBackground,Zt.opacity(s.foreground,.4)),s.scrollbarSliderActiveBackground=Ht(e.scrollbarSliderActiveBackground,Zt.opacity(s.foreground,.5)),s.overviewRulerBorder=Ht(e.overviewRulerBorder,ky),s.ansi=Bi.slice(),s.ansi[0]=Ht(e.black,Bi[0]),s.ansi[1]=Ht(e.red,Bi[1]),s.ansi[2]=Ht(e.green,Bi[2]),s.ansi[3]=Ht(e.yellow,Bi[3]),s.ansi[4]=Ht(e.blue,Bi[4]),s.ansi[5]=Ht(e.magenta,Bi[5]),s.ansi[6]=Ht(e.cyan,Bi[6]),s.ansi[7]=Ht(e.white,Bi[7]),s.ansi[8]=Ht(e.brightBlack,Bi[8]),s.ansi[9]=Ht(e.brightRed,Bi[9]),s.ansi[10]=Ht(e.brightGreen,Bi[10]),s.ansi[11]=Ht(e.brightYellow,Bi[11]),s.ansi[12]=Ht(e.brightBlue,Bi[12]),s.ansi[13]=Ht(e.brightMagenta,Bi[13]),s.ansi[14]=Ht(e.brightCyan,Bi[14]),s.ansi[15]=Ht(e.brightWhite,Bi[15]),e.extendedAnsi){let l=Math.min(s.ansi.length-16,e.extendedAnsi.length);for(let h=0;h<l;h++)s.ansi[h+16]=Ht(e.extendedAnsi[h],Bi[h+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(e){this._restoreColor(e),this._onChangeColors.fire(this.colors)}_restoreColor(e){if(e===void 0){for(let s=0;s<this._restoreColors.ansi.length;++s)this._colors.ansi[s]=this._restoreColors.ansi[s];return}switch(e){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[e]=this._restoreColors.ansi[e]}}modifyColors(e){e(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};Dd=fi([Be(0,us)],Dd);function Ht(e,s){if(e!==void 0)try{return ri.toColor(e)}catch{}return s}var Ly=class{constructor(...e){this._entries=new Map;for(let[s,l]of e)this.set(s,l)}set(e,s){let l=this._entries.get(e);return this._entries.set(e,s),l}forEach(e){for(let[s,l]of this._entries.entries())e(s,l)}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}},Py=class{constructor(){this._services=new Ly,this._services.set(Ud,this)}setService(e,s){this._services.set(e,s)}getService(e){return this._services.get(e)}createInstance(e,...s){let l=Dv(e).sort((m,w)=>m.index-w.index),h=[];for(let m of l){let w=this._services.get(m.id);if(!w)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${m.id._id}.`);h.push(w)}let g=l.length>0?l[0].index:s.length;if(s.length!==g)throw new Error(`[createInstance] First service dependency of ${e.name} at position ${g+1} conflicts with ${s.length} static arguments`);return new e(...s,...h)}},Hy={trace:0,debug:1,info:2,warn:3,error:4,off:5},zy="xterm.js: ",Od=class extends lt{constructor(e){super(),this._optionsService=e,this._logLevel=5,this._updateLogLevel(),this._register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}get logLevel(){return this._logLevel}_updateLogLevel(){this._logLevel=Hy[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(e){for(let s=0;s<e.length;s++)typeof e[s]=="function"&&(e[s]=e[s]())}_log(e,s,l){this._evalLazyOptionalParams(l),e.call(console,(this._optionsService.options.logger?"":zy)+s,...l)}trace(e,...s){this._logLevel<=0&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,e,s)}debug(e,...s){this._logLevel<=1&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,e,s)}info(e,...s){this._logLevel<=2&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,e,s)}warn(e,...s){this._logLevel<=3&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,e,s)}error(e,...s){this._logLevel<=4&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,e,s)}};Od=fi([Be(0,us)],Od);var e2=class extends lt{constructor(e){super(),this._maxLength=e,this.onDeleteEmitter=this._register(new De),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this._register(new De),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this._register(new De),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(e){if(this._maxLength===e)return;let s=new Array(e);for(let l=0;l<Math.min(e,this.length);l++)s[l]=this._array[this._getCyclicIndex(l)];this._array=s,this._maxLength=e,this._startIndex=0}get length(){return this._length}set length(e){if(e>this._length)for(let s=this._length;s<e;s++)this._array[s]=void 0;this._length=e}get(e){return this._array[this._getCyclicIndex(e)]}set(e,s){this._array[this._getCyclicIndex(e)]=s}push(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(e,s,...l){if(s){for(let h=e;h<this._length-s;h++)this._array[this._getCyclicIndex(h)]=this._array[this._getCyclicIndex(h+s)];this._length-=s,this.onDeleteEmitter.fire({index:e,amount:s})}for(let h=this._length-1;h>=e;h--)this._array[this._getCyclicIndex(h+l.length)]=this._array[this._getCyclicIndex(h)];for(let h=0;h<l.length;h++)this._array[this._getCyclicIndex(e+h)]=l[h];if(l.length&&this.onInsertEmitter.fire({index:e,amount:l.length}),this._length+l.length>this._maxLength){let h=this._length+l.length-this._maxLength;this._startIndex+=h,this._length=this._maxLength,this.onTrimEmitter.fire(h)}else this._length+=l.length}trimStart(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}shiftElements(e,s,l){if(!(s<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+l<0)throw new Error("Cannot shift elements in list beyond index 0");if(l>0){for(let g=s-1;g>=0;g--)this.set(e+g+l,this.get(e+g));let h=e+s+l-this._length;if(h>0)for(this._length+=h;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let h=0;h<s;h++)this.set(e+h+l,this.get(e+h))}}_getCyclicIndex(e){return(this._startIndex+e)%this._maxLength}},at=3,Ei=Object.freeze(new zo),dh=0,Xf=2,Oo=class _m{constructor(s,l,h=!1){this.isWrapped=h,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(s*at);let g=l||sr.fromCharData([0,I2,1,0]);for(let m=0;m<s;++m)this.setCell(m,g);this.length=s}get(s){let l=this._data[s*at+0],h=l&2097151;return[this._data[s*at+1],l&2097152?this._combined[s]:h?Qn(h):"",l>>22,l&2097152?this._combined[s].charCodeAt(this._combined[s].length-1):h]}set(s,l){this._data[s*at+1]=l[0],l[1].length>1?(this._combined[s]=l[1],this._data[s*at+0]=s|2097152|l[2]<<22):this._data[s*at+0]=l[1].charCodeAt(0)|l[2]<<22}getWidth(s){return this._data[s*at+0]>>22}hasWidth(s){return this._data[s*at+0]&12582912}getFg(s){return this._data[s*at+1]}getBg(s){return this._data[s*at+2]}hasContent(s){return this._data[s*at+0]&4194303}getCodePoint(s){let l=this._data[s*at+0];return l&2097152?this._combined[s].charCodeAt(this._combined[s].length-1):l&2097151}isCombined(s){return this._data[s*at+0]&2097152}getString(s){let l=this._data[s*at+0];return l&2097152?this._combined[s]:l&2097151?Qn(l&2097151):""}isProtected(s){return this._data[s*at+2]&536870912}loadCell(s,l){return dh=s*at,l.content=this._data[dh+0],l.fg=this._data[dh+1],l.bg=this._data[dh+2],l.content&2097152&&(l.combinedData=this._combined[s]),l.bg&268435456&&(l.extended=this._extendedAttrs[s]),l}setCell(s,l){l.content&2097152&&(this._combined[s]=l.combinedData),l.bg&268435456&&(this._extendedAttrs[s]=l.extended),this._data[s*at+0]=l.content,this._data[s*at+1]=l.fg,this._data[s*at+2]=l.bg}setCellFromCodepoint(s,l,h,g){g.bg&268435456&&(this._extendedAttrs[s]=g.extended),this._data[s*at+0]=l|h<<22,this._data[s*at+1]=g.fg,this._data[s*at+2]=g.bg}addCodepointToCell(s,l,h){let g=this._data[s*at+0];g&2097152?this._combined[s]+=Qn(l):g&2097151?(this._combined[s]=Qn(g&2097151)+Qn(l),g&=-2097152,g|=2097152):g=l|1<<22,h&&(g&=-12582913,g|=h<<22),this._data[s*at+0]=g}insertCells(s,l,h){if(s%=this.length,s&&this.getWidth(s-1)===2&&this.setCellFromCodepoint(s-1,0,1,h),l<this.length-s){let g=new sr;for(let m=this.length-s-l-1;m>=0;--m)this.setCell(s+l+m,this.loadCell(s+m,g));for(let m=0;m<l;++m)this.setCell(s+m,h)}else for(let g=s;g<this.length;++g)this.setCell(g,h);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,h)}deleteCells(s,l,h){if(s%=this.length,l<this.length-s){let g=new sr;for(let m=0;m<this.length-s-l;++m)this.setCell(s+m,this.loadCell(s+l+m,g));for(let m=this.length-l;m<this.length;++m)this.setCell(m,h)}else for(let g=s;g<this.length;++g)this.setCell(g,h);s&&this.getWidth(s-1)===2&&this.setCellFromCodepoint(s-1,0,1,h),this.getWidth(s)===0&&!this.hasContent(s)&&this.setCellFromCodepoint(s,0,1,h)}replaceCells(s,l,h,g=!1){if(g){for(s&&this.getWidth(s-1)===2&&!this.isProtected(s-1)&&this.setCellFromCodepoint(s-1,0,1,h),l<this.length&&this.getWidth(l-1)===2&&!this.isProtected(l)&&this.setCellFromCodepoint(l,0,1,h);s<l&&s<this.length;)this.isProtected(s)||this.setCell(s,h),s++;return}for(s&&this.getWidth(s-1)===2&&this.setCellFromCodepoint(s-1,0,1,h),l<this.length&&this.getWidth(l-1)===2&&this.setCellFromCodepoint(l,0,1,h);s<l&&s<this.length;)this.setCell(s++,h)}resize(s,l){if(s===this.length)return this._data.length*4*Xf<this._data.buffer.byteLength;let h=s*at;if(s>this.length){if(this._data.buffer.byteLength>=h*4)this._data=new Uint32Array(this._data.buffer,0,h);else{let g=new Uint32Array(h);g.set(this._data),this._data=g}for(let g=this.length;g<s;++g)this.setCell(g,l)}else{this._data=this._data.subarray(0,h);let g=Object.keys(this._combined);for(let w=0;w<g.length;w++){let b=parseInt(g[w],10);b>=s&&delete this._combined[b]}let m=Object.keys(this._extendedAttrs);for(let w=0;w<m.length;w++){let b=parseInt(m[w],10);b>=s&&delete this._extendedAttrs[b]}}return this.length=s,h*4*Xf<this._data.buffer.byteLength}cleanupMemory(){if(this._data.length*4*Xf<this._data.buffer.byteLength){let s=new Uint32Array(this._data.length);return s.set(this._data),this._data=s,1}return 0}fill(s,l=!1){if(l){for(let h=0;h<this.length;++h)this.isProtected(h)||this.setCell(h,s);return}this._combined={},this._extendedAttrs={};for(let h=0;h<this.length;++h)this.setCell(h,s)}copyFrom(s){this.length!==s.length?this._data=new Uint32Array(s._data):this._data.set(s._data),this.length=s.length,this._combined={};for(let l in s._combined)this._combined[l]=s._combined[l];this._extendedAttrs={};for(let l in s._extendedAttrs)this._extendedAttrs[l]=s._extendedAttrs[l];this.isWrapped=s.isWrapped}clone(){let s=new _m(0);s._data=new Uint32Array(this._data),s.length=this.length;for(let l in this._combined)s._combined[l]=this._combined[l];for(let l in this._extendedAttrs)s._extendedAttrs[l]=this._extendedAttrs[l];return s.isWrapped=this.isWrapped,s}getTrimmedLength(){for(let s=this.length-1;s>=0;--s)if(this._data[s*at+0]&4194303)return s+(this._data[s*at+0]>>22);return 0}getNoBgTrimmedLength(){for(let s=this.length-1;s>=0;--s)if(this._data[s*at+0]&4194303||this._data[s*at+2]&50331648)return s+(this._data[s*at+0]>>22);return 0}copyCellsFrom(s,l,h,g,m){let w=s._data;if(m)for(let C=g-1;C>=0;C--){for(let S=0;S<at;S++)this._data[(h+C)*at+S]=w[(l+C)*at+S];w[(l+C)*at+2]&268435456&&(this._extendedAttrs[h+C]=s._extendedAttrs[l+C])}else for(let C=0;C<g;C++){for(let S=0;S<at;S++)this._data[(h+C)*at+S]=w[(l+C)*at+S];w[(l+C)*at+2]&268435456&&(this._extendedAttrs[h+C]=s._extendedAttrs[l+C])}let b=Object.keys(s._combined);for(let C=0;C<b.length;C++){let S=parseInt(b[C],10);S>=l&&(this._combined[S-l+h]=s._combined[S])}}translateToString(s,l,h,g){l=l??0,h=h??this.length,s&&(h=Math.min(h,this.getTrimmedLength())),g&&(g.length=0);let m="";for(;l<h;){let w=this._data[l*at+0],b=w&2097151,C=w&2097152?this._combined[l]:b?Qn(b):Jn;if(m+=C,g)for(let S=0;S<C.length;++S)g.push(l);l+=w>>22||1}return g&&g.push(l),m}};function Fy(e,s,l,h,g,m){let w=[];for(let b=0;b<e.length-1;b++){let C=b,S=e.get(++C);if(!S.isWrapped)continue;let M=[e.get(b)];for(;C<e.length&&S.isWrapped;)M.push(S),S=e.get(++C);if(!m&&h>=b&&h<C){b+=M.length-1;continue}let N=0,k=Po(M,N,s),P=1,L=0;for(;P<M.length;){let pe=Po(M,P,s),me=pe-L,he=l-k,te=Math.min(me,he);M[N].copyCellsFrom(M[P],L,k,te,!1),k+=te,k===l&&(N++,k=0),L+=te,L===pe&&(P++,L=0),k===0&&N!==0&&M[N-1].getWidth(l-1)===2&&(M[N].copyCellsFrom(M[N-1],l-1,k++,1,!1),M[N-1].setCell(l-1,g))}M[N].replaceCells(k,l,g);let X=0;for(let pe=M.length-1;pe>0&&(pe>N||M[pe].getTrimmedLength()===0);pe--)X++;X>0&&(w.push(b+M.length-X),w.push(X)),b+=M.length-1}return w}function Uy(e,s){let l=[],h=0,g=s[h],m=0;for(let w=0;w<e.length;w++)if(g===w){let b=s[++h];e.onDeleteEmitter.fire({index:w-m,amount:b}),w+=b-1,m+=b,g=s[++h]}else l.push(w);return{layout:l,countRemoved:m}}function Vy(e,s){let l=[];for(let h=0;h<s.length;h++)l.push(e.get(s[h]));for(let h=0;h<l.length;h++)e.set(h,l[h]);e.length=s.length}function Wy(e,s,l){let h=[],g=e.map((C,S)=>Po(e,S,s)).reduce((C,S)=>C+S),m=0,w=0,b=0;for(;b<g;){if(g-b<l){h.push(g-b);break}m+=l;let C=Po(e,w,s);m>C&&(m-=C,w++);let S=e[w].getWidth(m-1)===2;S&&m--;let M=S?l-1:l;h.push(M),b+=M}return h}function Po(e,s,l){if(s===e.length-1)return e[s].getTrimmedLength();let h=!e[s].hasContent(l-1)&&e[s].getWidth(l-1)===1,g=e[s+1].getWidth(0)===2;return h&&g?l-1:l}var mm=class pm{constructor(s){this.line=s,this.isDisposed=!1,this._disposables=[],this._id=pm._nextId++,this._onDispose=this.register(new De),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),Oa(this._disposables),this._disposables.length=0)}register(s){return this._disposables.push(s),s}};mm._nextId=1;var Gy=mm,ki={},Ta=ki.B;ki[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""};ki.A={"#":""};ki.B=void 0;ki[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""};ki.C=ki[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};ki.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};ki.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};ki.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};ki.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""};ki.E=ki[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};ki.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""};ki.H=ki[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};ki["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""};var t2=4294967295,i2=class{constructor(e,s,l){this._hasScrollback=e,this._optionsService=s,this._bufferService=l,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=Ei.clone(),this.savedCharset=Ta,this.markers=[],this._nullCell=sr.fromCharData([0,I2,1,0]),this._whitespaceCell=sr.fromCharData([0,Jn,1,32]),this._isClearing=!1,this._memoryCleanupQueue=new Rh,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new e2(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new Ch),this._nullCell}getWhitespaceCell(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new Ch),this._whitespaceCell}getBlankLine(e,s){return new Oo(this._bufferService.cols,this.getNullCell(e),s)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}_getCorrectBufferLength(e){if(!this._hasScrollback)return e;let s=e+this._optionsService.rawOptions.scrollback;return s>t2?t2:s}fillViewportRows(e){if(this.lines.length===0){e===void 0&&(e=Ei);let s=this._rows;for(;s--;)this.lines.push(this.getBlankLine(e))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new e2(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(e,s){let l=this.getNullCell(Ei),h=0,g=this._getCorrectBufferLength(s);if(g>this.lines.maxLength&&(this.lines.maxLength=g),this.lines.length>0){if(this._cols<e)for(let w=0;w<this.lines.length;w++)h+=+this.lines.get(w).resize(e,l);let m=0;if(this._rows<s)for(let w=this._rows;w<s;w++)this.lines.length<s+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new Oo(e,l)):this.ybase>0&&this.lines.length<=this.ybase+this.y+m+1?(this.ybase--,m++,this.ydisp>0&&this.ydisp--):this.lines.push(new Oo(e,l)));else for(let w=this._rows;w>s;w--)this.lines.length>s+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(g<this.lines.maxLength){let w=this.lines.length-g;w>0&&(this.lines.trimStart(w),this.ybase=Math.max(this.ybase-w,0),this.ydisp=Math.max(this.ydisp-w,0),this.savedY=Math.max(this.savedY-w,0)),this.lines.maxLength=g}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,s-1),m&&(this.y+=m),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=s-1,this._isReflowEnabled&&(this._reflow(e,s),this._cols>e))for(let m=0;m<this.lines.length;m++)h+=+this.lines.get(m).resize(e,l);this._cols=e,this._rows=s,this._memoryCleanupQueue.clear(),h>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);let s=0;for(;this._memoryCleanupPosition<this.lines.length;)if(s+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),s>100)return!0;return e}get _isReflowEnabled(){let e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&e.backend==="conpty"&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(e,s){this._cols!==e&&(e>this._cols?this._reflowLarger(e,s):this._reflowSmaller(e,s))}_reflowLarger(e,s){let l=this._optionsService.rawOptions.reflowCursorLine,h=Fy(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(Ei),l);if(h.length>0){let g=Uy(this.lines,h);Vy(this.lines,g.layout),this._reflowLargerAdjustViewport(e,s,g.countRemoved)}}_reflowLargerAdjustViewport(e,s,l){let h=this.getNullCell(Ei),g=l;for(;g-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<s&&this.lines.push(new Oo(e,h))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-l,0)}_reflowSmaller(e,s){let l=this._optionsService.rawOptions.reflowCursorLine,h=this.getNullCell(Ei),g=[],m=0;for(let w=this.lines.length-1;w>=0;w--){let b=this.lines.get(w);if(!b||!b.isWrapped&&b.getTrimmedLength()<=e)continue;let C=[b];for(;b.isWrapped&&w>0;)b=this.lines.get(--w),C.unshift(b);if(!l){let te=this.ybase+this.y;if(te>=w&&te<w+C.length)continue}let S=C[C.length-1].getTrimmedLength(),M=Wy(C,this._cols,e),N=M.length-C.length,k;this.ybase===0&&this.y!==this.lines.length-1?k=Math.max(0,this.y-this.lines.maxLength+N):k=Math.max(0,this.lines.length-this.lines.maxLength+N);let P=[];for(let te=0;te<N;te++){let le=this.getBlankLine(Ei,!0);P.push(le)}P.length>0&&(g.push({start:w+C.length+m,newLines:P}),m+=P.length),C.push(...P);let L=M.length-1,X=M[L];X===0&&(L--,X=M[L]);let pe=C.length-N-1,me=S;for(;pe>=0;){let te=Math.min(me,X);if(C[L]===void 0)break;if(C[L].copyCellsFrom(C[pe],me-te,X-te,te,!0),X-=te,X===0&&(L--,X=M[L]),me-=te,me===0){pe--;let le=Math.max(pe,0);me=Po(C,le,this._cols)}}for(let te=0;te<C.length;te++)M[te]<e&&C[te].setCell(M[te],h);let he=N-k;for(;he-- >0;)this.ybase===0?this.y<s-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+m)-s&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+N,this.ybase+s-1)}if(g.length>0){let w=[],b=[];for(let X=0;X<this.lines.length;X++)b.push(this.lines.get(X));let C=this.lines.length,S=C-1,M=0,N=g[M];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+m);let k=0;for(let X=Math.min(this.lines.maxLength-1,C+m-1);X>=0;X--)if(N&&N.start>S+k){for(let pe=N.newLines.length-1;pe>=0;pe--)this.lines.set(X--,N.newLines[pe]);X++,w.push({index:S+1,amount:N.newLines.length}),k+=N.newLines.length,N=g[++M]}else this.lines.set(X,b[S--]);let P=0;for(let X=w.length-1;X>=0;X--)w[X].index+=P,this.lines.onInsertEmitter.fire(w[X]),P+=w[X].amount;let L=Math.max(0,C+m-this.lines.maxLength);L>0&&this.lines.onTrimEmitter.fire(L)}}translateBufferLineToString(e,s,l=0,h){let g=this.lines.get(e);return g?g.translateToString(s,l,h):""}getWrappedRangeForLine(e){let s=e,l=e;for(;s>0&&this.lines.get(s).isWrapped;)s--;for(;l+1<this.lines.length&&this.lines.get(l+1).isWrapped;)l++;return{first:s,last:l}}setupTabStops(e){for(e!=null?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}prevStop(e){for(e==null&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}nextStop(e){for(e==null&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}clearMarkers(e){this._isClearing=!0;for(let s=0;s<this.markers.length;s++)this.markers[s].line===e&&(this.markers[s].dispose(),this.markers.splice(s--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].dispose();this.markers.length=0,this._isClearing=!1}addMarker(e){let s=new Gy(e);return this.markers.push(s),s.register(this.lines.onTrim(l=>{s.line-=l,s.line<0&&s.dispose()})),s.register(this.lines.onInsert(l=>{s.line>=l.index&&(s.line+=l.amount)})),s.register(this.lines.onDelete(l=>{s.line>=l.index&&s.line<l.index+l.amount&&s.dispose(),s.line>l.index&&(s.line-=l.amount)})),s.register(s.onDispose(()=>this._removeMarker(s))),s}_removeMarker(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}},Xy=class extends lt{constructor(e,s){super(),this._optionsService=e,this._bufferService=s,this._onBufferActivate=this._register(new De),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this._register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this._register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new i2(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new i2(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(e,s){this._normal.resize(e,s),this._alt.resize(e,s),this.setupTabStops(e)}setupTabStops(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)}},xm=2,vm=1,Md=class extends lt{constructor(e){super(),this.isUserScrolling=!1,this._onResize=this._register(new De),this.onResize=this._onResize.event,this._onScroll=this._register(new De),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,xm),this.rows=Math.max(e.rawOptions.rows||0,vm),this.buffers=this._register(new Xy(e,this)),this._register(this.buffers.onBufferActivate(s=>{this._onScroll.fire(s.activeBuffer.ydisp)}))}get buffer(){return this.buffers.active}resize(e,s){let l=this.cols!==e,h=this.rows!==s;this.cols=e,this.rows=s,this.buffers.resize(e,s),this._onResize.fire({cols:e,rows:s,colsChanged:l,rowsChanged:h})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,s=!1){let l=this.buffer,h;h=this._cachedBlankLine,(!h||h.length!==this.cols||h.getFg(0)!==e.fg||h.getBg(0)!==e.bg)&&(h=l.getBlankLine(e,s),this._cachedBlankLine=h),h.isWrapped=s;let g=l.ybase+l.scrollTop,m=l.ybase+l.scrollBottom;if(l.scrollTop===0){let w=l.lines.isFull;m===l.lines.length-1?w?l.lines.recycle().copyFrom(h):l.lines.push(h.clone()):l.lines.splice(m+1,0,h.clone()),w?this.isUserScrolling&&(l.ydisp=Math.max(l.ydisp-1,0)):(l.ybase++,this.isUserScrolling||l.ydisp++)}else{let w=m-g+1;l.lines.shiftElements(g+1,w-1,-1),l.lines.set(m,h.clone())}this.isUserScrolling||(l.ydisp=l.ybase),this._onScroll.fire(l.ydisp)}scrollLines(e,s){let l=this.buffer;if(e<0){if(l.ydisp===0)return;this.isUserScrolling=!0}else e+l.ydisp>=l.ybase&&(this.isUserScrolling=!1);let h=l.ydisp;l.ydisp=Math.max(Math.min(l.ydisp+e,l.ybase),0),h!==l.ydisp&&(s||this._onScroll.fire(l.ydisp))}};Md=fi([Be(0,us)],Md);var Sl={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnEraseInDisplay:!1,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},reflowCursorLine:!1,rescaleOverlappingGlyphs:!1,rightClickSelectsWord:Th,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRuler:{}},Yy=["normal","bold","100","200","300","400","500","600","700","800","900"],jy=class extends lt{constructor(e){super(),this._onOptionChange=this._register(new De),this.onOptionChange=this._onOptionChange.event;let s={...Sl};for(let l in e)if(l in s)try{let h=e[l];s[l]=this._sanitizeAndValidateOption(l,h)}catch(h){console.error(h)}this.rawOptions=s,this.options={...s},this._setupOptions(),this._register(ei(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(e,s){return this.onOptionChange(l=>{l===e&&s(this.rawOptions[e])})}onMultipleOptionChange(e,s){return this.onOptionChange(l=>{e.indexOf(l)!==-1&&s()})}_setupOptions(){let e=l=>{if(!(l in Sl))throw new Error(`No option with key "${l}"`);return this.rawOptions[l]},s=(l,h)=>{if(!(l in Sl))throw new Error(`No option with key "${l}"`);h=this._sanitizeAndValidateOption(l,h),this.rawOptions[l]!==h&&(this.rawOptions[l]=h,this._onOptionChange.fire(l))};for(let l in this.rawOptions){let h={get:e.bind(this,l),set:s.bind(this,l)};Object.defineProperty(this.options,l,h)}}_sanitizeAndValidateOption(e,s){switch(e){case"cursorStyle":if(s||(s=Sl[e]),!qy(s))throw new Error(`"${s}" is not a valid value for ${e}`);break;case"wordSeparator":s||(s=Sl[e]);break;case"fontWeight":case"fontWeightBold":if(typeof s=="number"&&1<=s&&s<=1e3)break;s=Yy.includes(s)?s:Sl[e];break;case"cursorWidth":s=Math.floor(s);case"lineHeight":case"tabStopWidth":if(s<1)throw new Error(`${e} cannot be less than 1, value: ${s}`);break;case"minimumContrastRatio":s=Math.max(1,Math.min(21,Math.round(s*10)/10));break;case"scrollback":if(s=Math.min(s,4294967295),s<0)throw new Error(`${e} cannot be less than 0, value: ${s}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(s<=0)throw new Error(`${e} cannot be less than or equal to 0, value: ${s}`);break;case"rows":case"cols":if(!s&&s!==0)throw new Error(`${e} must be numeric, value: ${s}`);break;case"windowsPty":s=s??{};break}return s}};function qy(e){return e==="block"||e==="underline"||e==="bar"}function Mo(e,s=5){if(typeof e!="object")return e;let l=Array.isArray(e)?[]:{};for(let h in e)l[h]=s<=1?e[h]:e[h]&&Mo(e[h],s-1);return l}var s2=Object.freeze({insertMode:!1}),r2=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,cursorBlink:void 0,cursorStyle:void 0,origin:!1,reverseWraparound:!1,sendFocus:!1,synchronizedOutput:!1,wraparound:!0}),Bd=class extends lt{constructor(e,s,l){super(),this._bufferService=e,this._logService=s,this._optionsService=l,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this._register(new De),this.onData=this._onData.event,this._onUserInput=this._register(new De),this.onUserInput=this._onUserInput.event,this._onBinary=this._register(new De),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this._register(new De),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=Mo(s2),this.decPrivateModes=Mo(r2)}reset(){this.modes=Mo(s2),this.decPrivateModes=Mo(r2)}triggerDataEvent(e,s=!1){if(this._optionsService.rawOptions.disableStdin)return;let l=this._bufferService.buffer;s&&this._optionsService.rawOptions.scrollOnUserInput&&l.ybase!==l.ydisp&&this._onRequestScrollToBottom.fire(),s&&this._onUserInput.fire(),this._logService.debug(`sending data "${e}"`),this._logService.trace("sending data (codes)",()=>e.split("").map(h=>h.charCodeAt(0))),this._onData.fire(e)}triggerBinaryEvent(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${e}"`),this._logService.trace("sending binary (codes)",()=>e.split("").map(s=>s.charCodeAt(0))),this._onBinary.fire(e))}};Bd=fi([Be(0,hs),Be(1,z2),Be(2,us)],Bd);var n2={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:e=>e.button===4||e.action!==1?!1:(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)},VT200:{events:19,restrict:e=>e.action!==32},DRAG:{events:23,restrict:e=>!(e.action===32&&e.button===3)},ANY:{events:31,restrict:e=>!0}};function Yf(e,s){let l=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return e.button===4?(l|=64,l|=e.action):(l|=e.button&3,e.button&4&&(l|=64),e.button&8&&(l|=128),e.action===32?l|=32:e.action===0&&!s&&(l|=3)),l}var jf=String.fromCharCode,a2={DEFAULT:e=>{let s=[Yf(e,!1)+32,e.col+32,e.row+32];return s[0]>255||s[1]>255||s[2]>255?"":`\x1B[M${jf(s[0])}${jf(s[1])}${jf(s[2])}`},SGR:e=>{let s=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${Yf(e,!0)};${e.col};${e.row}${s}`},SGR_PIXELS:e=>{let s=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${Yf(e,!0)};${e.x};${e.y}${s}`}},Id=class extends lt{constructor(e,s,l){super(),this._bufferService=e,this._coreService=s,this._optionsService=l,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._wheelPartialScroll=0,this._onProtocolChange=this._register(new De),this.onProtocolChange=this._onProtocolChange.event;for(let h of Object.keys(n2))this.addProtocol(h,n2[h]);for(let h of Object.keys(a2))this.addEncoding(h,a2[h]);this.reset()}addProtocol(e,s){this._protocols[e]=s}addEncoding(e,s){this._encodings[e]=s}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(e){if(!this._protocols[e])throw new Error(`unknown protocol "${e}"`);this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(e){if(!this._encodings[e])throw new Error(`unknown encoding "${e}"`);this._activeEncoding=e}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null,this._wheelPartialScroll=0}consumeWheelEvent(e,s,l){if(e.deltaY===0||e.shiftKey||s===void 0||l===void 0)return 0;let h=s/l,g=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(g/=h+0,Math.abs(e.deltaY)<50&&(g*=.3),this._wheelPartialScroll+=g,g=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(g*=this._bufferService.rows),g}_applyScrollModifier(e,s){return s.altKey||s.ctrlKey||s.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}triggerMouseEvent(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows||e.button===4&&e.action===32||e.button===3&&e.action!==32||e.button!==4&&(e.action===2||e.action===3)||(e.col++,e.row++,e.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,e,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(e))return!1;let s=this._encodings[this._activeEncoding](e);return s&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(s):this._coreService.triggerDataEvent(s,!0)),this._lastEvent=e,!0}explainEvents(e){return{down:!!(e&1),up:!!(e&2),drag:!!(e&4),move:!!(e&8),wheel:!!(e&16)}}_equalEvents(e,s,l){if(l){if(e.x!==s.x||e.y!==s.y)return!1}else if(e.col!==s.col||e.row!==s.row)return!1;return!(e.button!==s.button||e.action!==s.action||e.ctrl!==s.ctrl||e.alt!==s.alt||e.shift!==s.shift)}};Id=fi([Be(0,hs),Be(1,Ba),Be(2,us)],Id);var qf=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],Ky=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],Ii;function Zy(e,s){let l=0,h=s.length-1,g;if(e<s[0][0]||e>s[h][1])return!1;for(;h>=l;)if(g=l+h>>1,e>s[g][1])l=g+1;else if(e<s[g][0])h=g-1;else return!0;return!1}var Qy=class{constructor(){if(this.version="6",!Ii){Ii=new Uint8Array(65536),Ii.fill(1),Ii[0]=0,Ii.fill(0,1,32),Ii.fill(0,127,160),Ii.fill(2,4352,4448),Ii[9001]=2,Ii[9002]=2,Ii.fill(2,11904,42192),Ii[12351]=1,Ii.fill(2,44032,55204),Ii.fill(2,63744,64256),Ii.fill(2,65040,65050),Ii.fill(2,65072,65136),Ii.fill(2,65280,65377),Ii.fill(2,65504,65511);for(let e=0;e<qf.length;++e)Ii.fill(0,qf[e][0],qf[e][1]+1)}}wcwidth(e){return e<32?0:e<127?1:e<65536?Ii[e]:Zy(e,Ky)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}charProperties(e,s){let l=this.wcwidth(e),h=l===0&&s!==0;if(h){let g=Na.extractWidth(s);g===0?h=!1:g>l&&(l=g)}return Na.createPropertyValue(0,l,h)}},Na=class vh{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new De,this.onChange=this._onChange.event;let s=new Qy;this.register(s),this._active=s.version,this._activeProvider=s}static extractShouldJoin(s){return(s&1)!==0}static extractWidth(s){return s>>1&3}static extractCharKind(s){return s>>3}static createPropertyValue(s,l,h=!1){return(s&16777215)<<3|(l&3)<<1|(h?1:0)}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(s){if(!this._providers[s])throw new Error(`unknown Unicode version "${s}"`);this._active=s,this._activeProvider=this._providers[s],this._onChange.fire(s)}register(s){this._providers[s.version]=s}wcwidth(s){return this._activeProvider.wcwidth(s)}getStringCellWidth(s){let l=0,h=0,g=s.length;for(let m=0;m<g;++m){let w=s.charCodeAt(m);if(55296<=w&&w<=56319){if(++m>=g)return l+this.wcwidth(w);let S=s.charCodeAt(m);56320<=S&&S<=57343?w=(w-55296)*1024+S-56320+65536:l+=this.wcwidth(S)}let b=this.charProperties(w,h),C=vh.extractWidth(b);vh.extractShouldJoin(b)&&(C-=vh.extractWidth(h)),l+=C,h=b}return l}charProperties(s,l){return this._activeProvider.charProperties(s,l)}},Jy=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(e){this.glevel=e,this.charset=this._charsets[e]}setgCharset(e,s){this._charsets[e]=s,this.glevel===e&&(this.charset=s)}};function l2(e){let s=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1)?.get(e.cols-1),l=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);l&&s&&(l.isWrapped=s[3]!==0&&s[3]!==32)}var Eo=2147483647,$y=256,Sm=class kd{constructor(s=32,l=32){if(this.maxLength=s,this.maxSubParamsLength=l,l>$y)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(s),this.length=0,this._subParams=new Int32Array(l),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(s),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(s){let l=new kd;if(!s.length)return l;for(let h=Array.isArray(s[0])?1:0;h<s.length;++h){let g=s[h];if(Array.isArray(g))for(let m=0;m<g.length;++m)l.addSubParam(g[m]);else l.addParam(g)}return l}clone(){let s=new kd(this.maxLength,this.maxSubParamsLength);return s.params.set(this.params),s.length=this.length,s._subParams.set(this._subParams),s._subParamsLength=this._subParamsLength,s._subParamsIdx.set(this._subParamsIdx),s._rejectDigits=this._rejectDigits,s._rejectSubDigits=this._rejectSubDigits,s._digitIsSub=this._digitIsSub,s}toArray(){let s=[];for(let l=0;l<this.length;++l){s.push(this.params[l]);let h=this._subParamsIdx[l]>>8,g=this._subParamsIdx[l]&255;g-h>0&&s.push(Array.prototype.slice.call(this._subParams,h,g))}return s}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(s){if(this._digitIsSub=!1,this.length>=this.maxLength){this._rejectDigits=!0;return}if(s<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=s>Eo?Eo:s}addSubParam(s){if(this._digitIsSub=!0,!!this.length){if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength){this._rejectSubDigits=!0;return}if(s<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=s>Eo?Eo:s,this._subParamsIdx[this.length-1]++}}hasSubParams(s){return(this._subParamsIdx[s]&255)-(this._subParamsIdx[s]>>8)>0}getSubParams(s){let l=this._subParamsIdx[s]>>8,h=this._subParamsIdx[s]&255;return h-l>0?this._subParams.subarray(l,h):null}getSubParamsAll(){let s={};for(let l=0;l<this.length;++l){let h=this._subParamsIdx[l]>>8,g=this._subParamsIdx[l]&255;g-h>0&&(s[l]=this._subParams.slice(h,g))}return s}addDigit(s){let l;if(this._rejectDigits||!(l=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let h=this._digitIsSub?this._subParams:this.params,g=h[l-1];h[l-1]=~g?Math.min(g*10+s,Eo):s}},Ao=[],ew=class{constructor(){this._state=0,this._active=Ao,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(e,s){this._handlers[e]===void 0&&(this._handlers[e]=[]);let l=this._handlers[e];return l.push(s),{dispose:()=>{let h=l.indexOf(s);h!==-1&&l.splice(h,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=Ao}reset(){if(this._state===2)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=Ao,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||Ao,!this._active.length)this._handlerFb(this._id,"START");else for(let e=this._active.length-1;e>=0;e--)this._active[e].start()}_put(e,s,l){if(!this._active.length)this._handlerFb(this._id,"PUT",Mh(e,s,l));else for(let h=this._active.length-1;h>=0;h--)this._active[h].put(e,s,l)}start(){this.reset(),this._state=1}put(e,s,l){if(this._state!==3){if(this._state===1)for(;s<l;){let h=e[s++];if(h===59){this._state=2,this._start();break}if(h<48||57<h){this._state=3;return}this._id===-1&&(this._id=0),this._id=this._id*10+h-48}this._state===2&&l-s>0&&this._put(e,s,l)}}end(e,s=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),!this._active.length)this._handlerFb(this._id,"END",e);else{let l=!1,h=this._active.length-1,g=!1;if(this._stack.paused&&(h=this._stack.loopPosition-1,l=s,g=this._stack.fallThrough,this._stack.paused=!1),!g&&l===!1){for(;h>=0&&(l=this._active[h].end(e),l!==!0);h--)if(l instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!1,l;h--}for(;h>=0;h--)if(l=this._active[h].end(!1),l instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!0,l}this._active=Ao,this._id=-1,this._state=0}}},Hs=class{constructor(e){this._handler=e,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(e,s,l){this._hitLimit||(this._data+=Mh(e,s,l),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}end(e){let s=!1;if(this._hitLimit)s=!1;else if(e&&(s=this._handler(this._data),s instanceof Promise))return s.then(l=>(this._data="",this._hitLimit=!1,l));return this._data="",this._hitLimit=!1,s}},To=[],tw=class{constructor(){this._handlers=Object.create(null),this._active=To,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=To}registerHandler(e,s){this._handlers[e]===void 0&&(this._handlers[e]=[]);let l=this._handlers[e];return l.push(s),{dispose:()=>{let h=l.indexOf(s);h!==-1&&l.splice(h,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}reset(){if(this._active.length)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=To,this._ident=0}hook(e,s){if(this.reset(),this._ident=e,this._active=this._handlers[e]||To,!this._active.length)this._handlerFb(this._ident,"HOOK",s);else for(let l=this._active.length-1;l>=0;l--)this._active[l].hook(s)}put(e,s,l){if(!this._active.length)this._handlerFb(this._ident,"PUT",Mh(e,s,l));else for(let h=this._active.length-1;h>=0;h--)this._active[h].put(e,s,l)}unhook(e,s=!0){if(!this._active.length)this._handlerFb(this._ident,"UNHOOK",e);else{let l=!1,h=this._active.length-1,g=!1;if(this._stack.paused&&(h=this._stack.loopPosition-1,l=s,g=this._stack.fallThrough,this._stack.paused=!1),!g&&l===!1){for(;h>=0&&(l=this._active[h].unhook(e),l!==!0);h--)if(l instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!1,l;h--}for(;h>=0;h--)if(l=this._active[h].unhook(!1),l instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=h,this._stack.fallThrough=!0,l}this._active=To,this._ident=0}},Bo=new Sm;Bo.addParam(0);var o2=class{constructor(e){this._handler=e,this._data="",this._params=Bo,this._hitLimit=!1}hook(e){this._params=e.length>1||e.params[0]?e.clone():Bo,this._data="",this._hitLimit=!1}put(e,s,l){this._hitLimit||(this._data+=Mh(e,s,l),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}unhook(e){let s=!1;if(this._hitLimit)s=!1;else if(e&&(s=this._handler(this._data,this._params),s instanceof Promise))return s.then(l=>(this._params=Bo,this._data="",this._hitLimit=!1,l));return this._params=Bo,this._data="",this._hitLimit=!1,s}},iw=class{constructor(e){this.table=new Uint8Array(e)}setDefault(e,s){this.table.fill(e<<4|s)}add(e,s,l,h){this.table[s<<8|e]=l<<4|h}addMany(e,s,l,h){for(let g=0;g<e.length;g++)this.table[s<<8|e[g]]=l<<4|h}},ir=160,sw=(function(){let e=new iw(4095),s=Array.apply(null,Array(256)).map((b,C)=>C),l=(b,C)=>s.slice(b,C),h=l(32,127),g=l(0,24);g.push(25),g.push.apply(g,l(28,32));let m=l(0,14),w;e.setDefault(1,0),e.addMany(h,0,2,0);for(w in m)e.addMany([24,26,153,154],w,3,0),e.addMany(l(128,144),w,3,0),e.addMany(l(144,152),w,3,0),e.add(156,w,0,0),e.add(27,w,11,1),e.add(157,w,4,8),e.addMany([152,158,159],w,0,7),e.add(155,w,11,3),e.add(144,w,11,9);return e.addMany(g,0,3,0),e.addMany(g,1,3,1),e.add(127,1,0,1),e.addMany(g,8,0,8),e.addMany(g,3,3,3),e.add(127,3,0,3),e.addMany(g,4,3,4),e.add(127,4,0,4),e.addMany(g,6,3,6),e.addMany(g,5,3,5),e.add(127,5,0,5),e.addMany(g,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(h,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(l(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(h,7,0,7),e.addMany(g,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(l(64,127),3,7,0),e.addMany(l(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(l(48,60),4,8,4),e.addMany(l(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(l(32,64),6,0,6),e.add(127,6,0,6),e.addMany(l(64,127),6,0,0),e.addMany(l(32,48),3,9,5),e.addMany(l(32,48),5,9,5),e.addMany(l(48,64),5,0,6),e.addMany(l(64,127),5,7,0),e.addMany(l(32,48),4,9,5),e.addMany(l(32,48),1,9,2),e.addMany(l(32,48),2,9,2),e.addMany(l(48,127),2,10,0),e.addMany(l(48,80),1,10,0),e.addMany(l(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(l(96,127),1,10,0),e.add(80,1,11,9),e.addMany(g,9,0,9),e.add(127,9,0,9),e.addMany(l(28,32),9,0,9),e.addMany(l(32,48),9,9,12),e.addMany(l(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(g,11,0,11),e.addMany(l(32,128),11,0,11),e.addMany(l(28,32),11,0,11),e.addMany(g,10,0,10),e.add(127,10,0,10),e.addMany(l(28,32),10,0,10),e.addMany(l(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(l(32,48),10,9,12),e.addMany(g,12,0,12),e.add(127,12,0,12),e.addMany(l(28,32),12,0,12),e.addMany(l(32,48),12,9,12),e.addMany(l(48,64),12,0,11),e.addMany(l(64,127),12,12,13),e.addMany(l(64,127),10,12,13),e.addMany(l(64,127),9,12,13),e.addMany(g,13,13,13),e.addMany(h,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(ir,0,2,0),e.add(ir,8,5,8),e.add(ir,6,0,6),e.add(ir,11,0,11),e.add(ir,13,13,13),e})(),rw=class extends lt{constructor(e=sw){super(),this._transitions=e,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new Sm,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(s,l,h)=>{},this._executeHandlerFb=s=>{},this._csiHandlerFb=(s,l)=>{},this._escHandlerFb=s=>{},this._errorHandlerFb=s=>s,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this._register(ei(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this._register(new ew),this._dcsParser=this._register(new tw),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(e,s=[64,126]){let l=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if(l=e.prefix.charCodeAt(0),l&&60>l||l>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let g=0;g<e.intermediates.length;++g){let m=e.intermediates.charCodeAt(g);if(32>m||m>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");l<<=8,l|=m}}if(e.final.length!==1)throw new Error("final must be a single byte");let h=e.final.charCodeAt(0);if(s[0]>h||h>s[1])throw new Error(`final must be in range ${s[0]} .. ${s[1]}`);return l<<=8,l|=h,l}identToString(e){let s=[];for(;e;)s.push(String.fromCharCode(e&255)),e>>=8;return s.reverse().join("")}setPrintHandler(e){this._printHandler=e}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(e,s){let l=this._identifier(e,[48,126]);this._escHandlers[l]===void 0&&(this._escHandlers[l]=[]);let h=this._escHandlers[l];return h.push(s),{dispose:()=>{let g=h.indexOf(s);g!==-1&&h.splice(g,1)}}}clearEscHandler(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]}setEscHandlerFallback(e){this._escHandlerFb=e}setExecuteHandler(e,s){this._executeHandlers[e.charCodeAt(0)]=s}clearExecuteHandler(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]}setExecuteHandlerFallback(e){this._executeHandlerFb=e}registerCsiHandler(e,s){let l=this._identifier(e);this._csiHandlers[l]===void 0&&(this._csiHandlers[l]=[]);let h=this._csiHandlers[l];return h.push(s),{dispose:()=>{let g=h.indexOf(s);g!==-1&&h.splice(g,1)}}}clearCsiHandler(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]}setCsiHandlerFallback(e){this._csiHandlerFb=e}registerDcsHandler(e,s){return this._dcsParser.registerHandler(this._identifier(e),s)}clearDcsHandler(e){this._dcsParser.clearHandler(this._identifier(e))}setDcsHandlerFallback(e){this._dcsParser.setHandlerFallback(e)}registerOscHandler(e,s){return this._oscParser.registerHandler(e,s)}clearOscHandler(e){this._oscParser.clearHandler(e)}setOscHandlerFallback(e){this._oscParser.setHandlerFallback(e)}setErrorHandler(e){this._errorHandler=e}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(e,s,l,h,g){this._parseStack.state=e,this._parseStack.handlers=s,this._parseStack.handlerPos=l,this._parseStack.transition=h,this._parseStack.chunkPos=g}parse(e,s,l){let h=0,g=0,m=0,w;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,m=this._parseStack.chunkPos+1;else{if(l===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let b=this._parseStack.handlers,C=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(l===!1&&C>-1){for(;C>=0&&(w=b[C](this._params),w!==!0);C--)if(w instanceof Promise)return this._parseStack.handlerPos=C,w}this._parseStack.handlers=[];break;case 4:if(l===!1&&C>-1){for(;C>=0&&(w=b[C](),w!==!0);C--)if(w instanceof Promise)return this._parseStack.handlerPos=C,w}this._parseStack.handlers=[];break;case 6:if(h=e[this._parseStack.chunkPos],w=this._dcsParser.unhook(h!==24&&h!==26,l),w)return w;h===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(h=e[this._parseStack.chunkPos],w=this._oscParser.end(h!==24&&h!==26,l),w)return w;h===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break}this._parseStack.state=0,m=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=this._parseStack.transition&15}for(let b=m;b<s;++b){switch(h=e[b],g=this._transitions.table[this.currentState<<8|(h<160?h:ir)],g>>4){case 2:for(let k=b+1;;++k){if(k>=s||(h=e[k])<32||h>126&&h<ir){this._printHandler(e,b,k),b=k-1;break}if(++k>=s||(h=e[k])<32||h>126&&h<ir){this._printHandler(e,b,k),b=k-1;break}if(++k>=s||(h=e[k])<32||h>126&&h<ir){this._printHandler(e,b,k),b=k-1;break}if(++k>=s||(h=e[k])<32||h>126&&h<ir){this._printHandler(e,b,k),b=k-1;break}}break;case 3:this._executeHandlers[h]?this._executeHandlers[h]():this._executeHandlerFb(h),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:b,code:h,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let C=this._csiHandlers[this._collect<<8|h],S=C?C.length-1:-1;for(;S>=0&&(w=C[S](this._params),w!==!0);S--)if(w instanceof Promise)return this._preserveStack(3,C,S,g,b),w;S<0&&this._csiHandlerFb(this._collect<<8|h,this._params),this.precedingJoinState=0;break;case 8:do switch(h){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(h-48)}while(++b<s&&(h=e[b])>47&&h<60);b--;break;case 9:this._collect<<=8,this._collect|=h;break;case 10:let M=this._escHandlers[this._collect<<8|h],N=M?M.length-1:-1;for(;N>=0&&(w=M[N](),w!==!0);N--)if(w instanceof Promise)return this._preserveStack(4,M,N,g,b),w;N<0&&this._escHandlerFb(this._collect<<8|h),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|h,this._params);break;case 13:for(let k=b+1;;++k)if(k>=s||(h=e[k])===24||h===26||h===27||h>127&&h<ir){this._dcsParser.put(e,b,k),b=k-1;break}break;case 14:if(w=this._dcsParser.unhook(h!==24&&h!==26),w)return this._preserveStack(6,[],0,g,b),w;h===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let k=b+1;;k++)if(k>=s||(h=e[k])<32||h>127&&h<ir){this._oscParser.put(e,b,k),b=k-1;break}break;case 6:if(w=this._oscParser.end(h!==24&&h!==26),w)return this._preserveStack(5,[],0,g,b),w;h===27&&(g|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break}this.currentState=g&15}}},nw=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,aw=/^[\da-f]+$/;function c2(e){if(!e)return;let s=e.toLowerCase();if(s.indexOf("rgb:")===0){s=s.slice(4);let l=nw.exec(s);if(l){let h=l[1]?15:l[4]?255:l[7]?4095:65535;return[Math.round(parseInt(l[1]||l[4]||l[7]||l[10],16)/h*255),Math.round(parseInt(l[2]||l[5]||l[8]||l[11],16)/h*255),Math.round(parseInt(l[3]||l[6]||l[9]||l[12],16)/h*255)]}}else if(s.indexOf("#")===0&&(s=s.slice(1),aw.exec(s)&&[3,6,9,12].includes(s.length))){let l=s.length/3,h=[0,0,0];for(let g=0;g<3;++g){let m=parseInt(s.slice(l*g,l*g+l),16);h[g]=l===1?m<<4:l===2?m:l===3?m>>4:m>>8}return h}}function Kf(e,s){let l=e.toString(16),h=l.length<2?"0"+l:l;switch(s){case 4:return l[0];case 8:return h;case 12:return(h+h).slice(0,3);default:return h+h}}function lw(e,s=16){let[l,h,g]=e;return`rgb:${Kf(l,s)}/${Kf(h,s)}/${Kf(g,s)}`}var ow={"(":0,")":1,"*":2,"+":3,"-":1,".":2},qn=131072,h2=10;function u2(e,s){if(e>24)return s.setWinLines||!1;switch(e){case 1:return!!s.restoreWin;case 2:return!!s.minimizeWin;case 3:return!!s.setWinPosition;case 4:return!!s.setWinSizePixels;case 5:return!!s.raiseWin;case 6:return!!s.lowerWin;case 7:return!!s.refreshWin;case 8:return!!s.setWinSizeChars;case 9:return!!s.maximizeWin;case 10:return!!s.fullscreenWin;case 11:return!!s.getWinState;case 13:return!!s.getWinPosition;case 14:return!!s.getWinSizePixels;case 15:return!!s.getScreenSizePixels;case 16:return!!s.getCellSizePixels;case 18:return!!s.getWinSizeChars;case 19:return!!s.getScreenSizeChars;case 20:return!!s.getIconTitle;case 21:return!!s.getWinTitle;case 22:return!!s.pushTitle;case 23:return!!s.popTitle;case 24:return!!s.setWinLines}return!1}var f2=5e3,d2=0,cw=class extends lt{constructor(e,s,l,h,g,m,w,b,C=new rw){super(),this._bufferService=e,this._charsetService=s,this._coreService=l,this._logService=h,this._optionsService=g,this._oscLinkService=m,this._coreMouseService=w,this._unicodeService=b,this._parser=C,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new Rv,this._utf8Decoder=new Nv,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=Ei.clone(),this._eraseAttrDataInternal=Ei.clone(),this._onRequestBell=this._register(new De),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this._register(new De),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this._register(new De),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this._register(new De),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this._register(new De),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this._register(new De),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this._register(new De),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this._register(new De),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this._register(new De),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this._register(new De),this.onLineFeed=this._onLineFeed.event,this._onScroll=this._register(new De),this.onScroll=this._onScroll.event,this._onTitleChange=this._register(new De),this.onTitleChange=this._onTitleChange.event,this._onColor=this._register(new De),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this._register(this._parser),this._dirtyRowTracker=new Ld(this._bufferService),this._activeBuffer=this._bufferService.buffer,this._register(this._bufferService.buffers.onBufferActivate(S=>this._activeBuffer=S.activeBuffer)),this._parser.setCsiHandlerFallback((S,M)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(S),params:M.toArray()})}),this._parser.setEscHandlerFallback(S=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(S)})}),this._parser.setExecuteHandlerFallback(S=>{this._logService.debug("Unknown EXECUTE code: ",{code:S})}),this._parser.setOscHandlerFallback((S,M,N)=>{this._logService.debug("Unknown OSC code: ",{identifier:S,action:M,data:N})}),this._parser.setDcsHandlerFallback((S,M,N)=>{M==="HOOK"&&(N=N.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(S),action:M,payload:N})}),this._parser.setPrintHandler((S,M,N)=>this.print(S,M,N)),this._parser.registerCsiHandler({final:"@"},S=>this.insertChars(S)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},S=>this.scrollLeft(S)),this._parser.registerCsiHandler({final:"A"},S=>this.cursorUp(S)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},S=>this.scrollRight(S)),this._parser.registerCsiHandler({final:"B"},S=>this.cursorDown(S)),this._parser.registerCsiHandler({final:"C"},S=>this.cursorForward(S)),this._parser.registerCsiHandler({final:"D"},S=>this.cursorBackward(S)),this._parser.registerCsiHandler({final:"E"},S=>this.cursorNextLine(S)),this._parser.registerCsiHandler({final:"F"},S=>this.cursorPrecedingLine(S)),this._parser.registerCsiHandler({final:"G"},S=>this.cursorCharAbsolute(S)),this._parser.registerCsiHandler({final:"H"},S=>this.cursorPosition(S)),this._parser.registerCsiHandler({final:"I"},S=>this.cursorForwardTab(S)),this._parser.registerCsiHandler({final:"J"},S=>this.eraseInDisplay(S,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},S=>this.eraseInDisplay(S,!0)),this._parser.registerCsiHandler({final:"K"},S=>this.eraseInLine(S,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},S=>this.eraseInLine(S,!0)),this._parser.registerCsiHandler({final:"L"},S=>this.insertLines(S)),this._parser.registerCsiHandler({final:"M"},S=>this.deleteLines(S)),this._parser.registerCsiHandler({final:"P"},S=>this.deleteChars(S)),this._parser.registerCsiHandler({final:"S"},S=>this.scrollUp(S)),this._parser.registerCsiHandler({final:"T"},S=>this.scrollDown(S)),this._parser.registerCsiHandler({final:"X"},S=>this.eraseChars(S)),this._parser.registerCsiHandler({final:"Z"},S=>this.cursorBackwardTab(S)),this._parser.registerCsiHandler({final:"`"},S=>this.charPosAbsolute(S)),this._parser.registerCsiHandler({final:"a"},S=>this.hPositionRelative(S)),this._parser.registerCsiHandler({final:"b"},S=>this.repeatPrecedingCharacter(S)),this._parser.registerCsiHandler({final:"c"},S=>this.sendDeviceAttributesPrimary(S)),this._parser.registerCsiHandler({prefix:">",final:"c"},S=>this.sendDeviceAttributesSecondary(S)),this._parser.registerCsiHandler({final:"d"},S=>this.linePosAbsolute(S)),this._parser.registerCsiHandler({final:"e"},S=>this.vPositionRelative(S)),this._parser.registerCsiHandler({final:"f"},S=>this.hVPosition(S)),this._parser.registerCsiHandler({final:"g"},S=>this.tabClear(S)),this._parser.registerCsiHandler({final:"h"},S=>this.setMode(S)),this._parser.registerCsiHandler({prefix:"?",final:"h"},S=>this.setModePrivate(S)),this._parser.registerCsiHandler({final:"l"},S=>this.resetMode(S)),this._parser.registerCsiHandler({prefix:"?",final:"l"},S=>this.resetModePrivate(S)),this._parser.registerCsiHandler({final:"m"},S=>this.charAttributes(S)),this._parser.registerCsiHandler({final:"n"},S=>this.deviceStatus(S)),this._parser.registerCsiHandler({prefix:"?",final:"n"},S=>this.deviceStatusPrivate(S)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},S=>this.softReset(S)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},S=>this.setCursorStyle(S)),this._parser.registerCsiHandler({final:"r"},S=>this.setScrollRegion(S)),this._parser.registerCsiHandler({final:"s"},S=>this.saveCursor(S)),this._parser.registerCsiHandler({final:"t"},S=>this.windowOptions(S)),this._parser.registerCsiHandler({final:"u"},S=>this.restoreCursor(S)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},S=>this.insertColumns(S)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},S=>this.deleteColumns(S)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},S=>this.selectProtected(S)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},S=>this.requestMode(S,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},S=>this.requestMode(S,!1)),this._parser.setExecuteHandler(_e.BEL,()=>this.bell()),this._parser.setExecuteHandler(_e.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(_e.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(_e.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(_e.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(_e.BS,()=>this.backspace()),this._parser.setExecuteHandler(_e.HT,()=>this.tab()),this._parser.setExecuteHandler(_e.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(_e.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(ph.IND,()=>this.index()),this._parser.setExecuteHandler(ph.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(ph.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new Hs(S=>(this.setTitle(S),this.setIconName(S),!0))),this._parser.registerOscHandler(1,new Hs(S=>this.setIconName(S))),this._parser.registerOscHandler(2,new Hs(S=>this.setTitle(S))),this._parser.registerOscHandler(4,new Hs(S=>this.setOrReportIndexedColor(S))),this._parser.registerOscHandler(8,new Hs(S=>this.setHyperlink(S))),this._parser.registerOscHandler(10,new Hs(S=>this.setOrReportFgColor(S))),this._parser.registerOscHandler(11,new Hs(S=>this.setOrReportBgColor(S))),this._parser.registerOscHandler(12,new Hs(S=>this.setOrReportCursorColor(S))),this._parser.registerOscHandler(104,new Hs(S=>this.restoreIndexedColor(S))),this._parser.registerOscHandler(110,new Hs(S=>this.restoreFgColor(S))),this._parser.registerOscHandler(111,new Hs(S=>this.restoreBgColor(S))),this._parser.registerOscHandler(112,new Hs(S=>this.restoreCursorColor(S))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let S in ki)this._parser.registerEscHandler({intermediates:"(",final:S},()=>this.selectCharset("("+S)),this._parser.registerEscHandler({intermediates:")",final:S},()=>this.selectCharset(")"+S)),this._parser.registerEscHandler({intermediates:"*",final:S},()=>this.selectCharset("*"+S)),this._parser.registerEscHandler({intermediates:"+",final:S},()=>this.selectCharset("+"+S)),this._parser.registerEscHandler({intermediates:"-",final:S},()=>this.selectCharset("-"+S)),this._parser.registerEscHandler({intermediates:".",final:S},()=>this.selectCharset("."+S)),this._parser.registerEscHandler({intermediates:"/",final:S},()=>this.selectCharset("/"+S));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(S=>(this._logService.error("Parsing error: ",S),S)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new o2((S,M)=>this.requestStatusString(S,M)))}getAttrData(){return this._curAttrData}_preserveStack(e,s,l,h){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=s,this._parseStack.decodedLength=l,this._parseStack.position=h}_logSlowResolvingAsync(e){this._logService.logLevel<=3&&Promise.race([e,new Promise((s,l)=>setTimeout(()=>l("#SLOW_TIMEOUT"),f2))]).catch(s=>{if(s!=="#SLOW_TIMEOUT")throw s;console.warn(`async parser handler taking longer than ${f2} ms`)})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(e,s){let l,h=this._activeBuffer.x,g=this._activeBuffer.y,m=0,w=this._parseStack.paused;if(w){if(l=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,s))return this._logSlowResolvingAsync(l),l;h=this._parseStack.cursorStartX,g=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>qn&&(m=this._parseStack.position+qn)}if(this._logService.logLevel<=1&&this._logService.debug(`parsing data ${typeof e=="string"?` "${e}"`:` "${Array.prototype.map.call(e,S=>String.fromCharCode(S)).join("")}"`}`),this._logService.logLevel===0&&this._logService.trace("parsing data (codes)",typeof e=="string"?e.split("").map(S=>S.charCodeAt(0)):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<qn&&(this._parseBuffer=new Uint32Array(Math.min(e.length,qn))),w||this._dirtyRowTracker.clearRange(),e.length>qn)for(let S=m;S<e.length;S+=qn){let M=S+qn<e.length?S+qn:e.length,N=typeof e=="string"?this._stringDecoder.decode(e.substring(S,M),this._parseBuffer):this._utf8Decoder.decode(e.subarray(S,M),this._parseBuffer);if(l=this._parser.parse(this._parseBuffer,N))return this._preserveStack(h,g,N,S),this._logSlowResolvingAsync(l),l}else if(!w){let S=typeof e=="string"?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer);if(l=this._parser.parse(this._parseBuffer,S))return this._preserveStack(h,g,S,0),this._logSlowResolvingAsync(l),l}(this._activeBuffer.x!==h||this._activeBuffer.y!==g)&&this._onCursorMove.fire();let b=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),C=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);C<this._bufferService.rows&&this._onRequestRefreshRows.fire({start:Math.min(C,this._bufferService.rows-1),end:Math.min(b,this._bufferService.rows-1)})}print(e,s,l){let h,g,m=this._charsetService.charset,w=this._optionsService.rawOptions.screenReaderMode,b=this._bufferService.cols,C=this._coreService.decPrivateModes.wraparound,S=this._coreService.modes.insertMode,M=this._curAttrData,N=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&l-s>0&&N.getWidth(this._activeBuffer.x-1)===2&&N.setCellFromCodepoint(this._activeBuffer.x-1,0,1,M);let k=this._parser.precedingJoinState;for(let P=s;P<l;++P){if(h=e[P],h<127&&m){let me=m[String.fromCharCode(h)];me&&(h=me.charCodeAt(0))}let L=this._unicodeService.charProperties(h,k);g=Na.extractWidth(L);let X=Na.extractShouldJoin(L),pe=X?Na.extractWidth(k):0;if(k=L,w&&this._onA11yChar.fire(Qn(h)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+g-pe>b){if(C){let me=N,he=this._activeBuffer.x-pe;for(this._activeBuffer.x=pe,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),N=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),pe>0&&N instanceof Oo&&N.copyCellsFrom(me,he,0,pe,!1);he<b;)me.setCellFromCodepoint(he++,0,1,M)}else if(this._activeBuffer.x=b-1,g===2)continue}if(X&&this._activeBuffer.x){let me=N.getWidth(this._activeBuffer.x-1)?1:2;N.addCodepointToCell(this._activeBuffer.x-me,h,g);for(let he=g-pe;--he>=0;)N.setCellFromCodepoint(this._activeBuffer.x++,0,0,M);continue}if(S&&(N.insertCells(this._activeBuffer.x,g-pe,this._activeBuffer.getNullCell(M)),N.getWidth(b-1)===2&&N.setCellFromCodepoint(b-1,0,1,M)),N.setCellFromCodepoint(this._activeBuffer.x++,h,g,M),g>0)for(;--g;)N.setCellFromCodepoint(this._activeBuffer.x++,0,0,M)}this._parser.precedingJoinState=k,this._activeBuffer.x<b&&l-s>0&&N.getWidth(this._activeBuffer.x)===0&&!N.hasContent(this._activeBuffer.x)&&N.setCellFromCodepoint(this._activeBuffer.x,0,1,M),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(e,s){return e.final==="t"&&!e.prefix&&!e.intermediates?this._parser.registerCsiHandler(e,l=>u2(l.params[0],this._optionsService.rawOptions.windowOptions)?s(l):!0):this._parser.registerCsiHandler(e,s)}registerDcsHandler(e,s){return this._parser.registerDcsHandler(e,new o2(s))}registerEscHandler(e,s){return this._parser.registerEscHandler(e,s)}registerOscHandler(e,s){return this._parser.registerOscHandler(e,new Hs(s))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);e.hasWidth(this._activeBuffer.x)&&!e.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(e=this._bufferService.cols-1){this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(e,s){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+s):(this._activeBuffer.x=e,this._activeBuffer.y=s),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(e,s){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+s)}cursorUp(e){let s=this._activeBuffer.y-this._activeBuffer.scrollTop;return s>=0?this._moveCursor(0,-Math.min(s,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0}cursorDown(e){let s=this._activeBuffer.scrollBottom-this._activeBuffer.y;return s>=0?this._moveCursor(0,Math.min(s,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0}cursorForward(e){return this._moveCursor(e.params[0]||1,0),!0}cursorBackward(e){return this._moveCursor(-(e.params[0]||1),0),!0}cursorNextLine(e){return this.cursorDown(e),this._activeBuffer.x=0,!0}cursorPrecedingLine(e){return this.cursorUp(e),this._activeBuffer.x=0,!0}cursorCharAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0}charPosAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(e){return this._moveCursor(e.params[0]||1,0),!0}linePosAbsolute(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0}vPositionRelative(e){return this._moveCursor(0,e.params[0]||1),!0}hVPosition(e){return this.cursorPosition(e),!0}tabClear(e){let s=e.params[0];return s===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:s===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let s=e.params[0]||1;for(;s--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let s=e.params[0]||1;for(;s--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(e){let s=e.params[0];return s===1&&(this._curAttrData.bg|=536870912),(s===2||s===0)&&(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(e,s,l,h=!1,g=!1){let m=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);m.replaceCells(s,l,this._activeBuffer.getNullCell(this._eraseAttrData()),g),h&&(m.isWrapped=!1)}_resetBufferLine(e,s=!1){let l=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);l&&(l.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),s),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),l.isWrapped=!1)}eraseInDisplay(e,s=!1){this._restrictCursor(this._bufferService.cols);let l;switch(e.params[0]){case 0:for(l=this._activeBuffer.y,this._dirtyRowTracker.markDirty(l),this._eraseInBufferLine(l++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,s);l<this._bufferService.rows;l++)this._resetBufferLine(l,s);this._dirtyRowTracker.markDirty(l);break;case 1:for(l=this._activeBuffer.y,this._dirtyRowTracker.markDirty(l),this._eraseInBufferLine(l,0,this._activeBuffer.x+1,!0,s),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(l+1).isWrapped=!1);l--;)this._resetBufferLine(l,s);this._dirtyRowTracker.markDirty(0);break;case 2:if(this._optionsService.rawOptions.scrollOnEraseInDisplay){for(l=this._bufferService.rows,this._dirtyRowTracker.markRangeDirty(0,l-1);l--&&!this._activeBuffer.lines.get(this._activeBuffer.ybase+l)?.getTrimmedLength(););for(;l>=0;l--)this._bufferService.scroll(this._eraseAttrData())}else{for(l=this._bufferService.rows,this._dirtyRowTracker.markDirty(l-1);l--;)this._resetBufferLine(l,s);this._dirtyRowTracker.markDirty(0)}break;case 3:let h=this._activeBuffer.lines.length-this._bufferService.rows;h>0&&(this._activeBuffer.lines.trimStart(h),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-h,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-h,0),this._onScroll.fire(0));break}return!0}eraseInLine(e,s=!1){switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,s);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,s);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,s);break}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(e){this._restrictCursor();let s=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let l=this._activeBuffer.ybase+this._activeBuffer.y,h=this._bufferService.rows-1-this._activeBuffer.scrollBottom,g=this._bufferService.rows-1+this._activeBuffer.ybase-h+1;for(;s--;)this._activeBuffer.lines.splice(g-1,1),this._activeBuffer.lines.splice(l,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(e){this._restrictCursor();let s=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let l=this._activeBuffer.ybase+this._activeBuffer.y,h;for(h=this._bufferService.rows-1-this._activeBuffer.scrollBottom,h=this._bufferService.rows-1+this._activeBuffer.ybase-h;s--;)this._activeBuffer.lines.splice(l,1),this._activeBuffer.lines.splice(h,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(e){this._restrictCursor();let s=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return s&&(s.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(e){this._restrictCursor();let s=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return s&&(s.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(e){let s=e.params[0]||1;for(;s--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(e){let s=e.params[0]||1;for(;s--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(Ei));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let s=e.params[0]||1;for(let l=this._activeBuffer.scrollTop;l<=this._activeBuffer.scrollBottom;++l){let h=this._activeBuffer.lines.get(this._activeBuffer.ybase+l);h.deleteCells(0,s,this._activeBuffer.getNullCell(this._eraseAttrData())),h.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let s=e.params[0]||1;for(let l=this._activeBuffer.scrollTop;l<=this._activeBuffer.scrollBottom;++l){let h=this._activeBuffer.lines.get(this._activeBuffer.ybase+l);h.insertCells(0,s,this._activeBuffer.getNullCell(this._eraseAttrData())),h.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let s=e.params[0]||1;for(let l=this._activeBuffer.scrollTop;l<=this._activeBuffer.scrollBottom;++l){let h=this._activeBuffer.lines.get(this._activeBuffer.ybase+l);h.insertCells(this._activeBuffer.x,s,this._activeBuffer.getNullCell(this._eraseAttrData())),h.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let s=e.params[0]||1;for(let l=this._activeBuffer.scrollTop;l<=this._activeBuffer.scrollBottom;++l){let h=this._activeBuffer.lines.get(this._activeBuffer.ybase+l);h.deleteCells(this._activeBuffer.x,s,this._activeBuffer.getNullCell(this._eraseAttrData())),h.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(e){this._restrictCursor();let s=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return s&&(s.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(e){let s=this._parser.precedingJoinState;if(!s)return!0;let l=e.params[0]||1,h=Na.extractWidth(s),g=this._activeBuffer.x-h,m=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(g),w=new Uint32Array(m.length*l),b=0;for(let S=0;S<m.length;){let M=m.codePointAt(S)||0;w[b++]=M,S+=M>65535?2:1}let C=b;for(let S=1;S<l;++S)w.copyWithin(C,0,b),C+=b;return this.print(w,0,C),!0}sendDeviceAttributesPrimary(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(_e.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(_e.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(_e.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(_e.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(_e.ESC+"[>83;40003;0c")),!0}_is(e){return(this._optionsService.rawOptions.termName+"").indexOf(e)===0}setMode(e){for(let s=0;s<e.length;s++)switch(e.params[s]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0;break}return!0}setModePrivate(e){for(let s=0;s<e.length;s++)switch(e.params[s]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,Ta),this._charsetService.setgCharset(1,Ta),this._charsetService.setgCharset(2,Ta),this._charsetService.setgCharset(3,Ta);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!0;break}return!0}resetMode(e){for(let s=0;s<e.length;s++)switch(e.params[s]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1;break}return!0}resetModePrivate(e){for(let s=0;s<e.length;s++)switch(e.params[s]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),e.params[s]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!1,this._onRequestRefreshRows.fire(void 0);break}return!0}requestMode(e,s){let l;(X=>(X[X.NOT_RECOGNIZED=0]="NOT_RECOGNIZED",X[X.SET=1]="SET",X[X.RESET=2]="RESET",X[X.PERMANENTLY_SET=3]="PERMANENTLY_SET",X[X.PERMANENTLY_RESET=4]="PERMANENTLY_RESET"))(l||={});let h=this._coreService.decPrivateModes,{activeProtocol:g,activeEncoding:m}=this._coreMouseService,w=this._coreService,{buffers:b,cols:C}=this._bufferService,{active:S,alt:M}=b,N=this._optionsService.rawOptions,k=(X,pe)=>(w.triggerDataEvent(`${_e.ESC}[${s?"":"?"}${X};${pe}$y`),!0),P=X=>X?1:2,L=e.params[0];return s?L===2?k(L,4):L===4?k(L,P(w.modes.insertMode)):L===12?k(L,3):L===20?k(L,P(N.convertEol)):k(L,0):L===1?k(L,P(h.applicationCursorKeys)):L===3?k(L,N.windowOptions.setWinLines?C===80?2:C===132?1:0:0):L===6?k(L,P(h.origin)):L===7?k(L,P(h.wraparound)):L===8?k(L,3):L===9?k(L,P(g==="X10")):L===12?k(L,P(N.cursorBlink)):L===25?k(L,P(!w.isCursorHidden)):L===45?k(L,P(h.reverseWraparound)):L===66?k(L,P(h.applicationKeypad)):L===67?k(L,4):L===1e3?k(L,P(g==="VT200")):L===1002?k(L,P(g==="DRAG")):L===1003?k(L,P(g==="ANY")):L===1004?k(L,P(h.sendFocus)):L===1005?k(L,4):L===1006?k(L,P(m==="SGR")):L===1015?k(L,4):L===1016?k(L,P(m==="SGR_PIXELS")):L===1048?k(L,1):L===47||L===1047||L===1049?k(L,P(S===M)):L===2004?k(L,P(h.bracketedPasteMode)):L===2026?k(L,P(h.synchronizedOutput)):k(L,0)}_updateAttrColor(e,s,l,h,g){return s===2?(e|=50331648,e&=-16777216,e|=zo.fromColorRGB([l,h,g])):s===5&&(e&=-50331904,e|=33554432|l&255),e}_extractColor(e,s,l){let h=[0,0,-1,0,0,0],g=0,m=0;do{if(h[m+g]=e.params[s+m],e.hasSubParams(s+m)){let w=e.getSubParams(s+m),b=0;do h[1]===5&&(g=1),h[m+b+1+g]=w[b];while(++b<w.length&&b+m+1+g<h.length);break}if(h[1]===5&&m+g>=2||h[1]===2&&m+g>=5)break;h[1]&&(g=1)}while(++m+s<e.length&&m+g<h.length);for(let w=2;w<h.length;++w)h[w]===-1&&(h[w]=0);switch(h[0]){case 38:l.fg=this._updateAttrColor(l.fg,h[1],h[3],h[4],h[5]);break;case 48:l.bg=this._updateAttrColor(l.bg,h[1],h[3],h[4],h[5]);break;case 58:l.extended=l.extended.clone(),l.extended.underlineColor=this._updateAttrColor(l.extended.underlineColor,h[1],h[3],h[4],h[5])}return m}_processUnderline(e,s){s.extended=s.extended.clone(),(!~e||e>5)&&(e=1),s.extended.underlineStyle=e,s.fg|=268435456,e===0&&(s.fg&=-268435457),s.updateExtended()}_processSGR0(e){e.fg=Ei.fg,e.bg=Ei.bg,e.extended=e.extended.clone(),e.extended.underlineStyle=0,e.extended.underlineColor&=-67108864,e.updateExtended()}charAttributes(e){if(e.length===1&&e.params[0]===0)return this._processSGR0(this._curAttrData),!0;let s=e.length,l,h=this._curAttrData;for(let g=0;g<s;g++)l=e.params[g],l>=30&&l<=37?(h.fg&=-50331904,h.fg|=16777216|l-30):l>=40&&l<=47?(h.bg&=-50331904,h.bg|=16777216|l-40):l>=90&&l<=97?(h.fg&=-50331904,h.fg|=16777216|l-90|8):l>=100&&l<=107?(h.bg&=-50331904,h.bg|=16777216|l-100|8):l===0?this._processSGR0(h):l===1?h.fg|=134217728:l===3?h.bg|=67108864:l===4?(h.fg|=268435456,this._processUnderline(e.hasSubParams(g)?e.getSubParams(g)[0]:1,h)):l===5?h.fg|=536870912:l===7?h.fg|=67108864:l===8?h.fg|=1073741824:l===9?h.fg|=2147483648:l===2?h.bg|=134217728:l===21?this._processUnderline(2,h):l===22?(h.fg&=-134217729,h.bg&=-134217729):l===23?h.bg&=-67108865:l===24?(h.fg&=-268435457,this._processUnderline(0,h)):l===25?h.fg&=-536870913:l===27?h.fg&=-67108865:l===28?h.fg&=-1073741825:l===29?h.fg&=2147483647:l===39?(h.fg&=-67108864,h.fg|=Ei.fg&16777215):l===49?(h.bg&=-67108864,h.bg|=Ei.bg&16777215):l===38||l===48||l===58?g+=this._extractColor(e,g,h):l===53?h.bg|=1073741824:l===55?h.bg&=-1073741825:l===59?(h.extended=h.extended.clone(),h.extended.underlineColor=-1,h.updateExtended()):l===100?(h.fg&=-67108864,h.fg|=Ei.fg&16777215,h.bg&=-67108864,h.bg|=Ei.bg&16777215):this._logService.debug("Unknown SGR attribute: %d.",l);return!0}deviceStatus(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent(`${_e.ESC}[0n`);break;case 6:let s=this._activeBuffer.y+1,l=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_e.ESC}[${s};${l}R`);break}return!0}deviceStatusPrivate(e){if(e.params[0]===6){let s=this._activeBuffer.y+1,l=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_e.ESC}[?${s};${l}R`)}return!0}softReset(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=Ei.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(e){let s=e.length===0?1:e.params[0];if(s===0)this._coreService.decPrivateModes.cursorStyle=void 0,this._coreService.decPrivateModes.cursorBlink=void 0;else{switch(s){case 1:case 2:this._coreService.decPrivateModes.cursorStyle="block";break;case 3:case 4:this._coreService.decPrivateModes.cursorStyle="underline";break;case 5:case 6:this._coreService.decPrivateModes.cursorStyle="bar";break}let l=s%2===1;this._coreService.decPrivateModes.cursorBlink=l}return!0}setScrollRegion(e){let s=e.params[0]||1,l;return(e.length<2||(l=e.params[1])>this._bufferService.rows||l===0)&&(l=this._bufferService.rows),l>s&&(this._activeBuffer.scrollTop=s-1,this._activeBuffer.scrollBottom=l-1,this._setCursor(0,0)),!0}windowOptions(e){if(!u2(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;let s=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:s!==2&&this._onRequestWindowsOptionsReport.fire(0);break;case 16:this._onRequestWindowsOptionsReport.fire(1);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${_e.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:(s===0||s===2)&&(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>h2&&this._windowTitleStack.shift()),(s===0||s===1)&&(this._iconNameStack.push(this._iconName),this._iconNameStack.length>h2&&this._iconNameStack.shift());break;case 23:(s===0||s===2)&&this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),(s===0||s===1)&&this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop());break}return!0}saveCursor(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0}setIconName(e){return this._iconName=e,!0}setOrReportIndexedColor(e){let s=[],l=e.split(";");for(;l.length>1;){let h=l.shift(),g=l.shift();if(/^\d+$/.exec(h)){let m=parseInt(h);if(g2(m))if(g==="?")s.push({type:0,index:m});else{let w=c2(g);w&&s.push({type:1,index:m,color:w})}}}return s.length&&this._onColor.fire(s),!0}setHyperlink(e){let s=e.indexOf(";");if(s===-1)return!0;let l=e.slice(0,s).trim(),h=e.slice(s+1);return h?this._createHyperlink(l,h):l.trim()?!1:this._finishHyperlink()}_createHyperlink(e,s){this._getCurrentLinkId()&&this._finishHyperlink();let l=e.split(":"),h,g=l.findIndex(m=>m.startsWith("id="));return g!==-1&&(h=l[g].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:h,uri:s}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(e,s){let l=e.split(";");for(let h=0;h<l.length&&!(s>=this._specialColors.length);++h,++s)if(l[h]==="?")this._onColor.fire([{type:0,index:this._specialColors[s]}]);else{let g=c2(l[h]);g&&this._onColor.fire([{type:1,index:this._specialColors[s],color:g}])}return!0}setOrReportFgColor(e){return this._setOrReportSpecialColor(e,0)}setOrReportBgColor(e){return this._setOrReportSpecialColor(e,1)}setOrReportCursorColor(e){return this._setOrReportSpecialColor(e,2)}restoreIndexedColor(e){if(!e)return this._onColor.fire([{type:2}]),!0;let s=[],l=e.split(";");for(let h=0;h<l.length;++h)if(/^\d+$/.exec(l[h])){let g=parseInt(l[h]);g2(g)&&s.push({type:2,index:g})}return s.length&&this._onColor.fire(s),!0}restoreFgColor(e){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(e){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(e){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,Ta),!0}selectCharset(e){return e.length!==2?(this.selectDefaultCharset(),!0):(e[0]==="/"||this._charsetService.setgCharset(ow[e[0]],ki[e[1]]||Ta),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=Ei.clone(),this._eraseAttrDataInternal=Ei.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=this._curAttrData.bg&67108863,this._eraseAttrDataInternal}setgLevel(e){return this._charsetService.setgLevel(e),!0}screenAlignmentPattern(){let e=new sr;e.content=1<<22|69,e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(let s=0;s<this._bufferService.rows;++s){let l=this._activeBuffer.ybase+this._activeBuffer.y+s,h=this._activeBuffer.lines.get(l);h&&(h.fill(e),h.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(e,s){let l=w=>(this._coreService.triggerDataEvent(`${_e.ESC}${w}${_e.ESC}\\`),!0),h=this._bufferService.buffer,g=this._optionsService.rawOptions;return l(e==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:e==='"p'?'P1$r61;1"p':e==="r"?`P1$r${h.scrollTop+1};${h.scrollBottom+1}r`:e==="m"?"P1$r0m":e===" q"?`P1$r${{block:2,underline:4,bar:6}[g.cursorStyle]-(g.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(e,s){this._dirtyRowTracker.markRangeDirty(e,s)}},Ld=class{constructor(e){this._bufferService=e,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(e){e<this.start?this.start=e:e>this.end&&(this.end=e)}markRangeDirty(e,s){e>s&&(d2=e,e=s,s=d2),e<this.start&&(this.start=e),s>this.end&&(this.end=s)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};Ld=fi([Be(0,hs)],Ld);function g2(e){return 0<=e&&e<256}var hw=5e7,_2=12,uw=50,fw=class extends lt{constructor(e){super(),this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this._register(new De),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(e,s){if(s!==void 0&&this._syncCalls>s){this._syncCalls=0;return}if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;this._isSyncWriting=!0;let l;for(;l=this._writeBuffer.shift();){this._action(l);let h=this._callbacks.shift();h&&h()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(e,s){if(this._pendingData>hw)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput){this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(s),this._innerWrite();return}setTimeout(()=>this._innerWrite())}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(s)}_innerWrite(e=0,s=!0){let l=e||performance.now();for(;this._writeBuffer.length>this._bufferOffset;){let h=this._writeBuffer[this._bufferOffset],g=this._action(h,s);if(g){let w=b=>performance.now()-l>=_2?setTimeout(()=>this._innerWrite(0,b)):this._innerWrite(l,b);g.catch(b=>(queueMicrotask(()=>{throw b}),Promise.resolve(!1))).then(w);return}let m=this._callbacks[this._bufferOffset];if(m&&m(),this._bufferOffset++,this._pendingData-=h.length,performance.now()-l>=_2)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>uw&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}},Pd=class{constructor(e){this._bufferService=e,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(e){let s=this._bufferService.buffer;if(e.id===void 0){let b=s.addMarker(s.ybase+s.y),C={data:e,id:this._nextId++,lines:[b]};return b.onDispose(()=>this._removeMarkerFromLink(C,b)),this._dataByLinkId.set(C.id,C),C.id}let l=e,h=this._getEntryIdKey(l),g=this._entriesWithId.get(h);if(g)return this.addLineToLink(g.id,s.ybase+s.y),g.id;let m=s.addMarker(s.ybase+s.y),w={id:this._nextId++,key:this._getEntryIdKey(l),data:l,lines:[m]};return m.onDispose(()=>this._removeMarkerFromLink(w,m)),this._entriesWithId.set(w.key,w),this._dataByLinkId.set(w.id,w),w.id}addLineToLink(e,s){let l=this._dataByLinkId.get(e);if(l&&l.lines.every(h=>h.line!==s)){let h=this._bufferService.buffer.addMarker(s);l.lines.push(h),h.onDispose(()=>this._removeMarkerFromLink(l,h))}}getLinkData(e){return this._dataByLinkId.get(e)?.data}_getEntryIdKey(e){return`${e.id};;${e.uri}`}_removeMarkerFromLink(e,s){let l=e.lines.indexOf(s);l!==-1&&(e.lines.splice(l,1),e.lines.length===0&&(e.data.id!==void 0&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}};Pd=fi([Be(0,hs)],Pd);var m2=!1,dw=class extends lt{constructor(e){super(),this._windowsWrappingHeuristics=this._register(new bl),this._onBinary=this._register(new De),this.onBinary=this._onBinary.event,this._onData=this._register(new De),this.onData=this._onData.event,this._onLineFeed=this._register(new De),this.onLineFeed=this._onLineFeed.event,this._onResize=this._register(new De),this.onResize=this._onResize.event,this._onWriteParsed=this._register(new De),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this._register(new De),this._instantiationService=new Py,this.optionsService=this._register(new jy(e)),this._instantiationService.setService(us,this.optionsService),this._bufferService=this._register(this._instantiationService.createInstance(Md)),this._instantiationService.setService(hs,this._bufferService),this._logService=this._register(this._instantiationService.createInstance(Od)),this._instantiationService.setService(z2,this._logService),this.coreService=this._register(this._instantiationService.createInstance(Bd)),this._instantiationService.setService(Ba,this.coreService),this.coreMouseService=this._register(this._instantiationService.createInstance(Id)),this._instantiationService.setService(H2,this.coreMouseService),this.unicodeService=this._register(this._instantiationService.createInstance(Na)),this._instantiationService.setService(Bv,this.unicodeService),this._charsetService=this._instantiationService.createInstance(Jy),this._instantiationService.setService(Mv,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(Pd),this._instantiationService.setService(F2,this._oscLinkService),this._inputHandler=this._register(new cw(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this._register(Ji.forward(this._inputHandler.onLineFeed,this._onLineFeed)),this._register(this._inputHandler),this._register(Ji.forward(this._bufferService.onResize,this._onResize)),this._register(Ji.forward(this.coreService.onData,this._onData)),this._register(Ji.forward(this.coreService.onBinary,this._onBinary)),this._register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom(!0))),this._register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this._register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this._register(this._bufferService.onScroll(()=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this._register(new fw((s,l)=>this._inputHandler.parse(s,l))),this._register(Ji.forward(this._writeBuffer.onWriteParsed,this._onWriteParsed))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this._register(new De),this._onScroll.event(e=>{this._onScrollApi?.fire(e.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(e){for(let s in e)this.optionsService.options[s]=e[s]}write(e,s){this._writeBuffer.write(e,s)}writeSync(e,s){this._logService.logLevel<=3&&!m2&&(this._logService.warn("writeSync is unreliable and will be removed soon."),m2=!0),this._writeBuffer.writeSync(e,s)}input(e,s=!0){this.coreService.triggerDataEvent(e,s)}resize(e,s){isNaN(e)||isNaN(s)||(e=Math.max(e,xm),s=Math.max(s,vm),this._bufferService.resize(e,s))}scroll(e,s=!1){this._bufferService.scroll(e,s)}scrollLines(e,s){this._bufferService.scrollLines(e,s)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(e){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){let s=e-this._bufferService.buffer.ydisp;s!==0&&this.scrollLines(s)}registerEscHandler(e,s){return this._inputHandler.registerEscHandler(e,s)}registerDcsHandler(e,s){return this._inputHandler.registerDcsHandler(e,s)}registerCsiHandler(e,s){return this._inputHandler.registerCsiHandler(e,s)}registerOscHandler(e,s){return this._inputHandler.registerOscHandler(e,s)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let e=!1,s=this.optionsService.rawOptions.windowsPty;s&&s.buildNumber!==void 0&&s.buildNumber!==void 0?e=s.backend==="conpty"&&s.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(e=!0),e?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){let e=[];e.push(this.onLineFeed(l2.bind(null,this._bufferService))),e.push(this.registerCsiHandler({final:"H"},()=>(l2(this._bufferService),!1))),this._windowsWrappingHeuristics.value=ei(()=>{for(let s of e)s.dispose()})}}},gw={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};function _w(e,s,l,h){let g={type:0,cancel:!1,key:void 0},m=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:e.key==="UIKeyInputUpArrow"?s?g.key=_e.ESC+"OA":g.key=_e.ESC+"[A":e.key==="UIKeyInputLeftArrow"?s?g.key=_e.ESC+"OD":g.key=_e.ESC+"[D":e.key==="UIKeyInputRightArrow"?s?g.key=_e.ESC+"OC":g.key=_e.ESC+"[C":e.key==="UIKeyInputDownArrow"&&(s?g.key=_e.ESC+"OB":g.key=_e.ESC+"[B");break;case 8:g.key=e.ctrlKey?"\b":_e.DEL,e.altKey&&(g.key=_e.ESC+g.key);break;case 9:if(e.shiftKey){g.key=_e.ESC+"[Z";break}g.key=_e.HT,g.cancel=!0;break;case 13:g.key=e.altKey?_e.ESC+_e.CR:_e.CR,g.cancel=!0;break;case 27:g.key=_e.ESC,e.altKey&&(g.key=_e.ESC+_e.ESC),g.cancel=!0;break;case 37:if(e.metaKey)break;m?g.key=_e.ESC+"[1;"+(m+1)+"D":s?g.key=_e.ESC+"OD":g.key=_e.ESC+"[D";break;case 39:if(e.metaKey)break;m?g.key=_e.ESC+"[1;"+(m+1)+"C":s?g.key=_e.ESC+"OC":g.key=_e.ESC+"[C";break;case 38:if(e.metaKey)break;m?g.key=_e.ESC+"[1;"+(m+1)+"A":s?g.key=_e.ESC+"OA":g.key=_e.ESC+"[A";break;case 40:if(e.metaKey)break;m?g.key=_e.ESC+"[1;"+(m+1)+"B":s?g.key=_e.ESC+"OB":g.key=_e.ESC+"[B";break;case 45:!e.shiftKey&&!e.ctrlKey&&(g.key=_e.ESC+"[2~");break;case 46:m?g.key=_e.ESC+"[3;"+(m+1)+"~":g.key=_e.ESC+"[3~";break;case 36:m?g.key=_e.ESC+"[1;"+(m+1)+"H":s?g.key=_e.ESC+"OH":g.key=_e.ESC+"[H";break;case 35:m?g.key=_e.ESC+"[1;"+(m+1)+"F":s?g.key=_e.ESC+"OF":g.key=_e.ESC+"[F";break;case 33:e.shiftKey?g.type=2:e.ctrlKey?g.key=_e.ESC+"[5;"+(m+1)+"~":g.key=_e.ESC+"[5~";break;case 34:e.shiftKey?g.type=3:e.ctrlKey?g.key=_e.ESC+"[6;"+(m+1)+"~":g.key=_e.ESC+"[6~";break;case 112:m?g.key=_e.ESC+"[1;"+(m+1)+"P":g.key=_e.ESC+"OP";break;case 113:m?g.key=_e.ESC+"[1;"+(m+1)+"Q":g.key=_e.ESC+"OQ";break;case 114:m?g.key=_e.ESC+"[1;"+(m+1)+"R":g.key=_e.ESC+"OR";break;case 115:m?g.key=_e.ESC+"[1;"+(m+1)+"S":g.key=_e.ESC+"OS";break;case 116:m?g.key=_e.ESC+"[15;"+(m+1)+"~":g.key=_e.ESC+"[15~";break;case 117:m?g.key=_e.ESC+"[17;"+(m+1)+"~":g.key=_e.ESC+"[17~";break;case 118:m?g.key=_e.ESC+"[18;"+(m+1)+"~":g.key=_e.ESC+"[18~";break;case 119:m?g.key=_e.ESC+"[19;"+(m+1)+"~":g.key=_e.ESC+"[19~";break;case 120:m?g.key=_e.ESC+"[20;"+(m+1)+"~":g.key=_e.ESC+"[20~";break;case 121:m?g.key=_e.ESC+"[21;"+(m+1)+"~":g.key=_e.ESC+"[21~";break;case 122:m?g.key=_e.ESC+"[23;"+(m+1)+"~":g.key=_e.ESC+"[23~";break;case 123:m?g.key=_e.ESC+"[24;"+(m+1)+"~":g.key=_e.ESC+"[24~";break;default:if(e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey)e.keyCode>=65&&e.keyCode<=90?g.key=String.fromCharCode(e.keyCode-64):e.keyCode===32?g.key=_e.NUL:e.keyCode>=51&&e.keyCode<=55?g.key=String.fromCharCode(e.keyCode-51+27):e.keyCode===56?g.key=_e.DEL:e.keyCode===219?g.key=_e.ESC:e.keyCode===220?g.key=_e.FS:e.keyCode===221&&(g.key=_e.GS);else if((!l||h)&&e.altKey&&!e.metaKey){let w=gw[e.keyCode]?.[e.shiftKey?1:0];if(w)g.key=_e.ESC+w;else if(e.keyCode>=65&&e.keyCode<=90){let b=e.ctrlKey?e.keyCode-64:e.keyCode+32,C=String.fromCharCode(b);e.shiftKey&&(C=C.toUpperCase()),g.key=_e.ESC+C}else if(e.keyCode===32)g.key=_e.ESC+(e.ctrlKey?_e.NUL:" ");else if(e.key==="Dead"&&e.code.startsWith("Key")){let b=e.code.slice(3,4);e.shiftKey||(b=b.toLowerCase()),g.key=_e.ESC+b,g.cancel=!0}}else l&&!e.altKey&&!e.ctrlKey&&!e.shiftKey&&e.metaKey?e.keyCode===65&&(g.type=1):e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&e.key.length===1?g.key=e.key:e.key&&e.ctrlKey&&(e.key==="_"&&(g.key=_e.US),e.key==="@"&&(g.key=_e.NUL));break}return g}var xi=0,mw=class{constructor(e){this._getKey=e,this._array=[],this._insertedValues=[],this._flushInsertedTask=new Rh,this._isFlushingInserted=!1,this._deletedIndices=[],this._flushDeletedTask=new Rh,this._isFlushingDeleted=!1}clear(){this._array.length=0,this._insertedValues.length=0,this._flushInsertedTask.clear(),this._isFlushingInserted=!1,this._deletedIndices.length=0,this._flushDeletedTask.clear(),this._isFlushingDeleted=!1}insert(e){this._flushCleanupDeleted(),this._insertedValues.length===0&&this._flushInsertedTask.enqueue(()=>this._flushInserted()),this._insertedValues.push(e)}_flushInserted(){let e=this._insertedValues.sort((g,m)=>this._getKey(g)-this._getKey(m)),s=0,l=0,h=new Array(this._array.length+this._insertedValues.length);for(let g=0;g<h.length;g++)l>=this._array.length||this._getKey(e[s])<=this._getKey(this._array[l])?(h[g]=e[s],s++):h[g]=this._array[l++];this._array=h,this._insertedValues.length=0}_flushCleanupInserted(){!this._isFlushingInserted&&this._insertedValues.length>0&&this._flushInsertedTask.flush()}delete(e){if(this._flushCleanupInserted(),this._array.length===0)return!1;let s=this._getKey(e);if(s===void 0||(xi=this._search(s),xi===-1)||this._getKey(this._array[xi])!==s)return!1;do if(this._array[xi]===e)return this._deletedIndices.length===0&&this._flushDeletedTask.enqueue(()=>this._flushDeleted()),this._deletedIndices.push(xi),!0;while(++xi<this._array.length&&this._getKey(this._array[xi])===s);return!1}_flushDeleted(){this._isFlushingDeleted=!0;let e=this._deletedIndices.sort((g,m)=>g-m),s=0,l=new Array(this._array.length-e.length),h=0;for(let g=0;g<this._array.length;g++)e[s]===g?s++:l[h++]=this._array[g];this._array=l,this._deletedIndices.length=0,this._isFlushingDeleted=!1}_flushCleanupDeleted(){!this._isFlushingDeleted&&this._deletedIndices.length>0&&this._flushDeletedTask.flush()}*getKeyIterator(e){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(xi=this._search(e),!(xi<0||xi>=this._array.length)&&this._getKey(this._array[xi])===e))do yield this._array[xi];while(++xi<this._array.length&&this._getKey(this._array[xi])===e)}forEachByKey(e,s){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(xi=this._search(e),!(xi<0||xi>=this._array.length)&&this._getKey(this._array[xi])===e))do s(this._array[xi]);while(++xi<this._array.length&&this._getKey(this._array[xi])===e)}values(){return this._flushCleanupInserted(),this._flushCleanupDeleted(),[...this._array].values()}_search(e){let s=0,l=this._array.length-1;for(;l>=s;){let h=s+l>>1,g=this._getKey(this._array[h]);if(g>e)l=h-1;else if(g<e)s=h+1;else{for(;h>0&&this._getKey(this._array[h-1])===e;)h--;return h}}return s}},Zf=0,p2=0,pw=class extends lt{constructor(){super(),this._decorations=new mw(e=>e?.marker.line),this._onDecorationRegistered=this._register(new De),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this._register(new De),this.onDecorationRemoved=this._onDecorationRemoved.event,this._register(ei(()=>this.reset()))}get decorations(){return this._decorations.values()}registerDecoration(e){if(e.marker.isDisposed)return;let s=new xw(e);if(s){let l=s.marker.onDispose(()=>s.dispose()),h=s.onDispose(()=>{h.dispose(),s&&(this._decorations.delete(s)&&this._onDecorationRemoved.fire(s),l.dispose())});this._decorations.insert(s),this._onDecorationRegistered.fire(s)}return s}reset(){for(let e of this._decorations.values())e.dispose();this._decorations.clear()}*getDecorationsAtCell(e,s,l){let h=0,g=0;for(let m of this._decorations.getKeyIterator(s))h=m.options.x??0,g=h+(m.options.width??1),e>=h&&e<g&&(!l||(m.options.layer??"bottom")===l)&&(yield m)}forEachDecorationAtCell(e,s,l,h){this._decorations.forEachByKey(s,g=>{Zf=g.options.x??0,p2=Zf+(g.options.width??1),e>=Zf&&e<p2&&(!l||(g.options.layer??"bottom")===l)&&h(g)})}},xw=class extends $n{constructor(e){super(),this.options=e,this.onRenderEmitter=this.add(new De),this.onRender=this.onRenderEmitter.event,this._onDispose=this.add(new De),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=e.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=ri.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=ri.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}},vw=1e3,Sw=class{constructor(e,s=vw){this._renderCallback=e,this._debounceThresholdMS=s,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(e,s,l){this._rowCount=l,e=e!==void 0?e:0,s=s!==void 0?s:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,e):e,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,s):s;let h=performance.now();if(h-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=h,this._innerRefresh();else if(!this._additionalRefreshRequested){let g=h-this._lastRefreshMs,m=this._debounceThresholdMS-g;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=performance.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},m)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let e=Math.max(this._rowStart,0),s=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,s)}},x2=20,Nh=class extends lt{constructor(e,s,l,h){super(),this._terminal=e,this._coreBrowserService=l,this._renderService=h,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="";let g=this._coreBrowserService.mainDocument;this._accessibilityContainer=g.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=g.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let m=0;m<this._terminal.rows;m++)this._rowElements[m]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[m]);if(this._topBoundaryFocusListener=m=>this._handleBoundaryFocus(m,0),this._bottomBoundaryFocusListener=m=>this._handleBoundaryFocus(m,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=g.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this._register(new Sw(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this._register(this._terminal.onResize(m=>this._handleResize(m.rows))),this._register(this._terminal.onRender(m=>this._refreshRows(m.start,m.end))),this._register(this._terminal.onScroll(()=>this._refreshRows())),this._register(this._terminal.onA11yChar(m=>this._handleChar(m))),this._register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this._register(this._terminal.onA11yTab(m=>this._handleTab(m))),this._register(this._terminal.onKey(m=>this._handleKey(m.key))),this._register(this._terminal.onBlur(()=>this._clearLiveRegion())),this._register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._register(Ke(g,"selectionchange",()=>this._handleSelectionChange())),this._register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRowsDimensions(),this._refreshRows(),this._register(ei(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(e){for(let s=0;s<e;s++)this._handleChar(" ")}_handleChar(e){this._liveRegionLineCount<x2+1&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,e===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===x2+1&&(this._liveRegion.textContent+=sd.get())))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(e){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(e)||this._charsToConsume.push(e)}_refreshRows(e,s){this._liveRegionDebouncer.refresh(e,s,this._terminal.rows)}_renderRows(e,s){let l=this._terminal.buffer,h=l.lines.length.toString();for(let g=e;g<=s;g++){let m=l.lines.get(l.ydisp+g),w=[],b=m?.translateToString(!0,void 0,void 0,w)||"",C=(l.ydisp+g+1).toString(),S=this._rowElements[g];S&&(b.length===0?(S.textContent="",this._rowColumns.set(S,[0,1])):(S.textContent=b,this._rowColumns.set(S,w)),S.setAttribute("aria-posinset",C),S.setAttribute("aria-setsize",h),this._alignRowWidth(S))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(e,s){let l=e.target,h=this._rowElements[s===0?1:this._rowElements.length-2],g=l.getAttribute("aria-posinset"),m=s===0?"1":`${this._terminal.buffer.lines.length}`;if(g===m||e.relatedTarget!==h)return;let w,b;if(s===0?(w=l,b=this._rowElements.pop(),this._rowContainer.removeChild(b)):(w=this._rowElements.shift(),b=l,this._rowContainer.removeChild(w)),w.removeEventListener("focus",this._topBoundaryFocusListener),b.removeEventListener("focus",this._bottomBoundaryFocusListener),s===0){let C=this._createAccessibilityTreeNode();this._rowElements.unshift(C),this._rowContainer.insertAdjacentElement("afterbegin",C)}else{let C=this._createAccessibilityTreeNode();this._rowElements.push(C),this._rowContainer.appendChild(C)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(s===0?-1:1),this._rowElements[s===0?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;let e=this._coreBrowserService.mainDocument.getSelection();if(!e)return;if(e.isCollapsed){this._rowContainer.contains(e.anchorNode)&&this._terminal.clearSelection();return}if(!e.anchorNode||!e.focusNode){console.error("anchorNode and/or focusNode are null");return}let s={node:e.anchorNode,offset:e.anchorOffset},l={node:e.focusNode,offset:e.focusOffset};if((s.node.compareDocumentPosition(l.node)&Node.DOCUMENT_POSITION_PRECEDING||s.node===l.node&&s.offset>l.offset)&&([s,l]=[l,s]),s.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(s={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(s.node))return;let h=this._rowElements.slice(-1)[0];if(l.node.compareDocumentPosition(h)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(l={node:h,offset:h.textContent?.length??0}),!this._rowContainer.contains(l.node))return;let g=({node:b,offset:C})=>{let S=b instanceof Text?b.parentNode:b,M=parseInt(S?.getAttribute("aria-posinset"),10)-1;if(isNaN(M))return console.warn("row is invalid. Race condition?"),null;let N=this._rowColumns.get(S);if(!N)return console.warn("columns is null. Race condition?"),null;let k=C<N.length?N[C]:N.slice(-1)[0]+1;return k>=this._terminal.cols&&(++M,k=0),{row:M,column:k}},m=g(s),w=g(l);if(!(!m||!w)){if(m.row>w.row||m.row===w.row&&m.column>=w.column)throw new Error("invalid range");this._terminal.select(m.column,m.row,(w.row-m.row)*this._terminal.cols-m.column+w.column)}}_handleResize(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let s=this._rowContainer.children.length;s<this._terminal.rows;s++)this._rowElements[s]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[s]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let e=this._coreBrowserService.mainDocument.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){Object.assign(this._accessibilityContainer.style,{width:`${this._renderService.dimensions.css.canvas.width}px`,fontSize:`${this._terminal.options.fontSize}px`}),this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e]),this._alignRowWidth(this._rowElements[e])}}_refreshRowDimensions(e){e.style.height=`${this._renderService.dimensions.css.cell.height}px`}_alignRowWidth(e){e.style.transform="";let s=e.getBoundingClientRect().width,l=this._rowColumns.get(e)?.slice(-1)?.[0];if(!l)return;let h=l*this._renderService.dimensions.css.cell.width;e.style.transform=`scaleX(${h/s})`}};Nh=fi([Be(1,Ud),Be(2,ln),Be(3,on)],Nh);var Hd=class extends lt{constructor(e,s,l,h,g){super(),this._element=e,this._mouseService=s,this._renderService=l,this._bufferService=h,this._linkProviderService=g,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this._register(new De),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this._register(new De),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this._register(ei(()=>{Oa(this._linkCacheDisposables),this._linkCacheDisposables.length=0,this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this._register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this._register(Ke(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this._register(Ke(this._element,"mousemove",this._handleMouseMove.bind(this))),this._register(Ke(this._element,"mousedown",this._handleMouseDown.bind(this))),this._register(Ke(this._element,"mouseup",this._handleMouseUp.bind(this)))}get currentLink(){return this._currentLink}_handleMouseMove(e){this._lastMouseEvent=e;let s=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!s)return;this._isMouseOut=!1;let l=e.composedPath();for(let h=0;h<l.length;h++){let g=l[h];if(g.classList.contains("xterm"))break;if(g.classList.contains("xterm-hover"))return}(!this._lastBufferCell||s.x!==this._lastBufferCell.x||s.y!==this._lastBufferCell.y)&&(this._handleHover(s),this._lastBufferCell=s)}_handleHover(e){if(this._activeLine!==e.y||this._wasResized){this._clearCurrentLink(),this._askForLink(e,!1),this._wasResized=!1;return}this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,s){(!this._activeProviderReplies||!s)&&(this._activeProviderReplies?.forEach(h=>{h?.forEach(g=>{g.link.dispose&&g.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=e.y);let l=!1;for(let[h,g]of this._linkProviderService.linkProviders.entries())s?this._activeProviderReplies?.get(h)&&(l=this._checkLinkProviderResult(h,e,l)):g.provideLinks(e.y,m=>{if(this._isMouseOut)return;let w=m?.map(b=>({link:b}));this._activeProviderReplies?.set(h,w),l=this._checkLinkProviderResult(h,e,l),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)})}_removeIntersectingLinks(e,s){let l=new Set;for(let h=0;h<s.size;h++){let g=s.get(h);if(g)for(let m=0;m<g.length;m++){let w=g[m],b=w.link.range.start.y<e?0:w.link.range.start.x,C=w.link.range.end.y>e?this._bufferService.cols:w.link.range.end.x;for(let S=b;S<=C;S++){if(l.has(S)){g.splice(m--,1);break}l.add(S)}}}}_checkLinkProviderResult(e,s,l){if(!this._activeProviderReplies)return l;let h=this._activeProviderReplies.get(e),g=!1;for(let m=0;m<e;m++)(!this._activeProviderReplies.has(m)||this._activeProviderReplies.get(m))&&(g=!0);if(!g&&h){let m=h.find(w=>this._linkAtPosition(w.link,s));m&&(l=!0,this._handleNewLink(m))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!l)for(let m=0;m<this._activeProviderReplies.size;m++){let w=this._activeProviderReplies.get(m)?.find(b=>this._linkAtPosition(b.link,s));if(w){l=!0,this._handleNewLink(w);break}}return l}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._currentLink)return;let s=this._positionFromMouseEvent(e,this._element,this._mouseService);s&&this._mouseDownLink&&yw(this._mouseDownLink.link,this._currentLink.link)&&this._linkAtPosition(this._currentLink.link,s)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,s){!this._currentLink||!this._lastMouseEvent||(!e||!s||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=s)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,Oa(this._linkCacheDisposables),this._linkCacheDisposables.length=0)}_handleNewLink(e){if(!this._lastMouseEvent)return;let s=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);s&&this._linkAtPosition(e.link,s)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:e.link.decorations===void 0?!0:e.link.decorations.underline,pointerCursor:e.link.decorations===void 0?!0:e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:l=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==l&&(this._currentLink.state.decorations.pointerCursor=l,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",l))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:l=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==l&&(this._currentLink.state.decorations.underline=l,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,l))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(l=>{if(!this._currentLink)return;let h=l.start===0?0:l.start+1+this._bufferService.buffer.ydisp,g=this._bufferService.buffer.ydisp+1+l.end;if(this._currentLink.link.range.start.y>=h&&this._currentLink.link.range.end.y<=g&&(this._clearCurrentLink(h,g),this._lastMouseEvent)){let m=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);m&&this._askForLink(m,!1)}})))}_linkHover(e,s,l){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),s.hover&&s.hover(l,s.text)}_fireUnderlineEvent(e,s){let l=e.range,h=this._bufferService.buffer.ydisp,g=this._createLinkUnderlineEvent(l.start.x-1,l.start.y-h-1,l.end.x,l.end.y-h-1,void 0);(s?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(g)}_linkLeave(e,s,l){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),s.leave&&s.leave(l,s.text)}_linkAtPosition(e,s){let l=e.range.start.y*this._bufferService.cols+e.range.start.x,h=e.range.end.y*this._bufferService.cols+e.range.end.x,g=s.y*this._bufferService.cols+s.x;return l<=g&&g<=h}_positionFromMouseEvent(e,s,l){let h=l.getCoords(e,s,this._bufferService.cols,this._bufferService.rows);if(h)return{x:h[0],y:h[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,s,l,h,g){return{x1:e,y1:s,x2:l,y2:h,cols:this._bufferService.cols,fg:g}}};Hd=fi([Be(1,Vd),Be(2,on),Be(3,hs),Be(4,V2)],Hd);function yw(e,s){return e.text===s.text&&e.range.start.x===s.range.start.x&&e.range.start.y===s.range.start.y&&e.range.end.x===s.range.end.x&&e.range.end.y===s.range.end.y}var ww=class extends dw{constructor(e={}){super(e),this._linkifier=this._register(new bl),this.browser=lm,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this._register(new bl),this._onCursorMove=this._register(new De),this.onCursorMove=this._onCursorMove.event,this._onKey=this._register(new De),this.onKey=this._onKey.event,this._onRender=this._register(new De),this.onRender=this._onRender.event,this._onSelectionChange=this._register(new De),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this._register(new De),this.onTitleChange=this._onTitleChange.event,this._onBell=this._register(new De),this.onBell=this._onBell.event,this._onFocus=this._register(new De),this._onBlur=this._register(new De),this._onA11yCharEmitter=this._register(new De),this._onA11yTabEmitter=this._register(new De),this._onWillOpen=this._register(new De),this._setup(),this._decorationService=this._instantiationService.createInstance(pw),this._instantiationService.setService(Fo,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(uy),this._instantiationService.setService(V2,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(nd)),this._register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this._register(this._inputHandler.onRequestRefreshRows(s=>this.refresh(s?.start??0,s?.end??this.rows-1))),this._register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this._register(this._inputHandler.onRequestReset(()=>this.reset())),this._register(this._inputHandler.onRequestWindowsOptionsReport(s=>this._reportWindowsOptions(s))),this._register(this._inputHandler.onColor(s=>this._handleColorEvent(s))),this._register(Ji.forward(this._inputHandler.onCursorMove,this._onCursorMove)),this._register(Ji.forward(this._inputHandler.onTitleChange,this._onTitleChange)),this._register(Ji.forward(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this._register(Ji.forward(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this._register(this._bufferService.onResize(s=>this._afterResize(s.cols,s.rows))),this._register(ei(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}get linkifier(){return this._linkifier.value}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(e){if(this._themeService)for(let s of e){let l,h="";switch(s.index){case 256:l="foreground",h="10";break;case 257:l="background",h="11";break;case 258:l="cursor",h="12";break;default:l="ansi",h="4;"+s.index}switch(s.type){case 0:let g=Zt.toColorRGB(l==="ansi"?this._themeService.colors.ansi[s.index]:this._themeService.colors[l]);this.coreService.triggerDataEvent(`${_e.ESC}]${h};${lw(g)}${nm.ST}`);break;case 1:if(l==="ansi")this._themeService.modifyColors(m=>m.ansi[s.index]=Ai.toColor(...s.color));else{let m=l;this._themeService.modifyColors(w=>w[m]=Ai.toColor(...s.color))}break;case 2:this._themeService.restoreColor(s.index);break}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(e){e?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Nh,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(_e.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(_e.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let e=this.buffer.ybase+this.buffer.y,s=this.buffer.lines.get(e);if(!s)return;let l=Math.min(this.buffer.x,this.cols-1),h=this._renderService.dimensions.css.cell.height,g=s.getWidth(l),m=this._renderService.dimensions.css.cell.width*g,w=this.buffer.y*this._renderService.dimensions.css.cell.height,b=l*this._renderService.dimensions.css.cell.width;this.textarea.style.left=b+"px",this.textarea.style.top=w+"px",this.textarea.style.width=m+"px",this.textarea.style.height=h+"px",this.textarea.style.lineHeight=h+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this._register(Ke(this.element,"copy",s=>{this.hasSelection()&&Av(s,this._selectionService)}));let e=s=>Tv(s,this.textarea,this.coreService,this.optionsService);this._register(Ke(this.textarea,"paste",e)),this._register(Ke(this.element,"paste",e)),om?this._register(Ke(this.element,"mousedown",s=>{s.button===2&&R_(s,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this._register(Ke(this.element,"contextmenu",s=>{R_(s,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),Zd&&this._register(Ke(this.element,"auxclick",s=>{s.button===1&&B2(s,this.textarea,this.screenElement)}))}_bindKeys(){this._register(Ke(this.textarea,"keyup",e=>this._keyUp(e),!0)),this._register(Ke(this.textarea,"keydown",e=>this._keyDown(e),!0)),this._register(Ke(this.textarea,"keypress",e=>this._keyPress(e),!0)),this._register(Ke(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this._register(Ke(this.textarea,"compositionupdate",e=>this._compositionHelper.compositionupdate(e))),this._register(Ke(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this._register(Ke(this.textarea,"input",e=>this._inputEvent(e),!0)),this._register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(e){if(!e)throw new Error("Terminal requires a parent element.");if(e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService){this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView);return}this._document=e.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),e.appendChild(this.element);let s=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),s.appendChild(this._viewportElement),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._register(Ke(this.screenElement,"mousemove",g=>this.updateCursorStyle(g))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),s.appendChild(this.screenElement);let l=this.textarea=this._document.createElement("textarea");this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",id.get()),um||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._register(this.optionsService.onSpecificOptionChange("disableStdin",()=>l.readOnly=this.optionsService.rawOptions.disableStdin)),this.textarea.readOnly=this.optionsService.rawOptions.disableStdin,this._coreBrowserService=this._register(this._instantiationService.createInstance(cy,this.textarea,e.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(ln,this._coreBrowserService),this._register(Ke(this.textarea,"focus",g=>this._handleTextAreaFocus(g))),this._register(Ke(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(Ad,this._document,this._helperContainer),this._instantiationService.setService(Bh,this._charSizeService),this._themeService=this._instantiationService.createInstance(Dd),this._instantiationService.setService(Cl,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(Ah),this._instantiationService.setService(U2,this._characterJoinerService),this._renderService=this._register(this._instantiationService.createInstance(Rd,this.rows,this.screenElement)),this._instantiationService.setService(on,this._renderService),this._register(this._renderService.onRenderedViewportChange(g=>this._onRender.fire(g))),this.onResize(g=>this._renderService.resize(g.cols,g.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(bd,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(Td),this._instantiationService.setService(Vd,this._mouseService);let h=this._linkifier.value=this._register(this._instantiationService.createInstance(Hd,this.screenElement));this.element.appendChild(s);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this._register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this._register(this.onBlur(()=>this._renderService.handleBlur())),this._register(this.onFocus(()=>this._renderService.handleFocus())),this._viewport=this._register(this._instantiationService.createInstance(yd,this.element,this.screenElement)),this._register(this._viewport.onRequestScrollLines(g=>{super.scrollLines(g,!1),this.refresh(0,this.rows-1)})),this._selectionService=this._register(this._instantiationService.createInstance(Nd,this.element,this.screenElement,h)),this._instantiationService.setService(kv,this._selectionService),this._register(this._selectionService.onRequestScrollLines(g=>this.scrollLines(g.amount,g.suppressScrollEvent))),this._register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this._register(this._selectionService.onRequestRedraw(g=>this._renderService.handleSelectionChanged(g.start,g.end,g.columnSelectMode))),this._register(this._selectionService.onLinuxMouseSelection(g=>{this.textarea.value=g,this.textarea.focus(),this.textarea.select()})),this._register(Ji.any(this._onScroll.event,this._inputHandler.onScroll)(()=>{this._selectionService.refresh(),this._viewport?.queueSync()})),this._register(this._instantiationService.createInstance(wd,this.screenElement)),this._register(Ke(this.element,"mousedown",g=>this._selectionService.handleMouseDown(g))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Nh,this)),this._register(this.optionsService.onSpecificOptionChange("screenReaderMode",g=>this._handleScreenReaderModeOptionChange(g))),this.options.overviewRuler.width&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(Eh,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRuler",g=>{!this._overviewRulerRenderer&&g&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(Eh,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(Ed,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){let e=this,s=this.element;function l(m){let w=e._mouseService.getMouseReportCoords(m,e.screenElement);if(!w)return!1;let b,C;switch(m.overrideType||m.type){case"mousemove":C=32,m.buttons===void 0?(b=3,m.button!==void 0&&(b=m.button<3?m.button:3)):b=m.buttons&1?0:m.buttons&4?1:m.buttons&2?2:3;break;case"mouseup":C=0,b=m.button<3?m.button:3;break;case"mousedown":C=1,b=m.button<3?m.button:3;break;case"wheel":if(e._customWheelEventHandler&&e._customWheelEventHandler(m)===!1)return!1;let S=m.deltaY;if(S===0||e.coreMouseService.consumeWheelEvent(m,e._renderService?.dimensions?.device?.cell?.height,e._coreBrowserService?.dpr)===0)return!1;C=S<0?0:1,b=4;break;default:return!1}return C===void 0||b===void 0||b>4?!1:e.coreMouseService.triggerMouseEvent({col:w.col,row:w.row,x:w.x,y:w.y,button:b,action:C,ctrl:m.ctrlKey,alt:m.altKey,shift:m.shiftKey})}let h={mouseup:null,wheel:null,mousedrag:null,mousemove:null},g={mouseup:m=>(l(m),m.buttons||(this._document.removeEventListener("mouseup",h.mouseup),h.mousedrag&&this._document.removeEventListener("mousemove",h.mousedrag)),this.cancel(m)),wheel:m=>(l(m),this.cancel(m,!0)),mousedrag:m=>{m.buttons&&l(m)},mousemove:m=>{m.buttons||l(m)}};this._register(this.coreMouseService.onProtocolChange(m=>{m?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(m)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),m&8?h.mousemove||(s.addEventListener("mousemove",g.mousemove),h.mousemove=g.mousemove):(s.removeEventListener("mousemove",h.mousemove),h.mousemove=null),m&16?h.wheel||(s.addEventListener("wheel",g.wheel,{passive:!1}),h.wheel=g.wheel):(s.removeEventListener("wheel",h.wheel),h.wheel=null),m&2?h.mouseup||(h.mouseup=g.mouseup):(this._document.removeEventListener("mouseup",h.mouseup),h.mouseup=null),m&4?h.mousedrag||(h.mousedrag=g.mousedrag):(this._document.removeEventListener("mousemove",h.mousedrag),h.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this._register(Ke(s,"mousedown",m=>{if(m.preventDefault(),this.focus(),!(!this.coreMouseService.areMouseEventsActive||this._selectionService.shouldForceSelection(m)))return l(m),h.mouseup&&this._document.addEventListener("mouseup",h.mouseup),h.mousedrag&&this._document.addEventListener("mousemove",h.mousedrag),this.cancel(m)})),this._register(Ke(s,"wheel",m=>{if(!h.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(m)===!1)return!1;if(!this.buffer.hasScrollback){if(m.deltaY===0)return!1;if(e.coreMouseService.consumeWheelEvent(m,e._renderService?.dimensions?.device?.cell?.height,e._coreBrowserService?.dpr)===0)return this.cancel(m,!0);let w=_e.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(m.deltaY<0?"A":"B");return this.coreService.triggerDataEvent(w,!0),this.cancel(m,!0)}}},{passive:!1}))}refresh(e,s){this._renderService?.refreshRows(e,s)}updateCursorStyle(e){this._selectionService?.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(e,s){this._viewport?this._viewport.scrollLines(e):super.scrollLines(e,s),this.refresh(0,this.rows-1)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(e){e&&this._viewport?this._viewport.scrollToLine(this.buffer.ybase,!0):this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){let s=e-this._bufferService.buffer.ydisp;s!==0&&this.scrollLines(s)}paste(e){M2(e,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(e){this._customKeyEventHandler=e}attachCustomWheelEventHandler(e){this._customWheelEventHandler=e}registerLinkProvider(e){return this._linkProviderService.registerLinkProvider(e)}registerCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let s=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),s}deregisterCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(e){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)}registerDecoration(e){return this._decorationService.registerDecoration(e)}hasSelection(){return this._selectionService?this._selectionService.hasSelection:!1}select(e,s,l){this._selectionService.setSelection(e,s,l)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(!(!this._selectionService||!this._selectionService.hasSelection))return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(e,s){this._selectionService?.selectLines(e,s)}_keyDown(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;let s=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!s&&!this._compositionHelper.keydown(e))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(!0),!1;!s&&(e.key==="Dead"||e.key==="AltGraph")&&(this._unprocessedDeadKey=!0);let l=_w(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),l.type===3||l.type===2){let h=this.rows-1;return this.scrollLines(l.type===2?-h:h),this.cancel(e,!0)}if(l.type===1&&this.selectAll(),this._isThirdLevelShift(this.browser,e)||(l.cancel&&this.cancel(e,!0),!l.key)||e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.key.length===1&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)return!0;if(this._unprocessedDeadKey)return this._unprocessedDeadKey=!1,!0;if((l.key===_e.ETX||l.key===_e.CR)&&(this.textarea.value=""),this._onKey.fire({key:l.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(l.key,!0),!this.optionsService.rawOptions.screenReaderMode||e.altKey||e.ctrlKey)return this.cancel(e,!0);this._keyDownHandled=!0}_isThirdLevelShift(e,s){let l=e.isMac&&!this.options.macOptionIsMeta&&s.altKey&&!s.ctrlKey&&!s.metaKey||e.isWindows&&s.altKey&&s.ctrlKey&&!s.metaKey||e.isWindows&&s.getModifierState("AltGraph");return s.type==="keypress"?l:l&&(!s.keyCode||s.keyCode>47)}_keyUp(e){this._keyDownSeen=!1,!(this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)&&(bw(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)}_keyPress(e){let s;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;if(this.cancel(e),e.charCode)s=e.charCode;else if(e.which===null||e.which===void 0)s=e.keyCode;else if(e.which!==0&&e.charCode!==0)s=e.which;else return!1;return!s||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)?!1:(s=String.fromCharCode(s),this._onKey.fire({key:s,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(s,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,!0)}_inputEvent(e){if(e.data&&e.inputType==="insertText"&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let s=e.data;return this.coreService.triggerDataEvent(s,!0),this.cancel(e),!0}return!1}resize(e,s){if(e===this.cols&&s===this.rows){this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure();return}super.resize(e,s)}_afterResize(e,s){this._charSizeService?.measure()}clear(){if(!(this.buffer.ybase===0&&this.buffer.y===0)){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(Ei));this._onScroll.fire({position:this.buffer.ydisp}),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;let e=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this._customKeyEventHandler=e,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(_e.ESC+"[I"):this.coreService.triggerDataEvent(_e.ESC+"[O")}_reportWindowsOptions(e){if(this._renderService)switch(e){case 0:let s=this._renderService.dimensions.css.canvas.width.toFixed(0),l=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${_e.ESC}[4;${l};${s}t`);break;case 1:let h=this._renderService.dimensions.css.cell.width.toFixed(0),g=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${_e.ESC}[6;${g};${h}t`);break}}cancel(e,s){if(!(!this.options.cancelEvents&&!s))return e.preventDefault(),e.stopPropagation(),!1}};function bw(e){return e.keyCode===16||e.keyCode===17||e.keyCode===18}var Cw=class{constructor(){this._addons=[]}dispose(){for(let e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()}loadAddon(e,s){let l={instance:s,dispose:s.dispose,isDisposed:!1};this._addons.push(l),s.dispose=()=>this._wrappedAddonDispose(l),s.activate(e)}_wrappedAddonDispose(e){if(e.isDisposed)return;let s=-1;for(let l=0;l<this._addons.length;l++)if(this._addons[l]===e){s=l;break}if(s===-1)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(s,1)}},Ew=class{constructor(e){this._line=e}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(e,s){if(!(e<0||e>=this._line.length))return s?(this._line.loadCell(e,s),s):this._line.loadCell(e,new sr)}translateToString(e,s,l){return this._line.translateToString(e,s,l)}},v2=class{constructor(e,s){this._buffer=e,this.type=s}init(e){return this._buffer=e,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(e){let s=this._buffer.lines.get(e);if(s)return new Ew(s)}getNullCell(){return new sr}},Aw=class extends lt{constructor(e){super(),this._core=e,this._onBufferChange=this._register(new De),this.onBufferChange=this._onBufferChange.event,this._normal=new v2(this._core.buffers.normal,"normal"),this._alternate=new v2(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}},Tw=class{constructor(e){this._core=e}registerCsiHandler(e,s){return this._core.registerCsiHandler(e,l=>s(l.toArray()))}addCsiHandler(e,s){return this.registerCsiHandler(e,s)}registerDcsHandler(e,s){return this._core.registerDcsHandler(e,(l,h)=>s(l,h.toArray()))}addDcsHandler(e,s){return this.registerDcsHandler(e,s)}registerEscHandler(e,s){return this._core.registerEscHandler(e,s)}addEscHandler(e,s){return this.registerEscHandler(e,s)}registerOscHandler(e,s){return this._core.registerOscHandler(e,s)}addOscHandler(e,s){return this.registerOscHandler(e,s)}},Rw=class{constructor(e){this._core=e}register(e){this._core.unicodeService.register(e)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(e){this._core.unicodeService.activeVersion=e}},Nw=["cols","rows"],Tr=0,Dw=class extends lt{constructor(e){super(),this._core=this._register(new ww(e)),this._addonManager=this._register(new Cw),this._publicOptions={...this._core.options};let s=h=>this._core.options[h],l=(h,g)=>{this._checkReadonlyOptions(h),this._core.options[h]=g};for(let h in this._core.options){let g={get:s.bind(this,h),set:l.bind(this,h)};Object.defineProperty(this._publicOptions,h,g)}}_checkReadonlyOptions(e){if(Nw.includes(e))throw new Error(`Option "${e}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new Tw(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new Rw(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this._register(new Aw(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let e=this._core.coreService.decPrivateModes,s="none";switch(this._core.coreMouseService.activeProtocol){case"X10":s="x10";break;case"VT200":s="vt200";break;case"DRAG":s="drag";break;case"ANY":s="any";break}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:s,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,synchronizedOutputMode:e.synchronizedOutput,wraparoundMode:e.wraparound}}get options(){return this._publicOptions}set options(e){for(let s in e)this._publicOptions[s]=e[s]}blur(){this._core.blur()}focus(){this._core.focus()}input(e,s=!0){this._core.input(e,s)}resize(e,s){this._verifyIntegers(e,s),this._core.resize(e,s)}open(e){this._core.open(e)}attachCustomKeyEventHandler(e){this._core.attachCustomKeyEventHandler(e)}attachCustomWheelEventHandler(e){this._core.attachCustomWheelEventHandler(e)}registerLinkProvider(e){return this._core.registerLinkProvider(e)}registerCharacterJoiner(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)}deregisterCharacterJoiner(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)}registerMarker(e=0){return this._verifyIntegers(e),this._core.registerMarker(e)}registerDecoration(e){return this._checkProposedApi(),this._verifyPositiveIntegers(e.x??0,e.width??0,e.height??0),this._core.registerDecoration(e)}hasSelection(){return this._core.hasSelection()}select(e,s,l){this._verifyIntegers(e,s,l),this._core.select(e,s,l)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(e,s){this._verifyIntegers(e,s),this._core.selectLines(e,s)}dispose(){super.dispose()}scrollLines(e){this._verifyIntegers(e),this._core.scrollLines(e)}scrollPages(e){this._verifyIntegers(e),this._core.scrollPages(e)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(e){this._verifyIntegers(e),this._core.scrollToLine(e)}clear(){this._core.clear()}write(e,s){this._core.write(e,s)}writeln(e,s){this._core.write(e),this._core.write(`\r
`,s)}paste(e){this._core.paste(e)}refresh(e,s){this._verifyIntegers(e,s),this._core.refresh(e,s)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(e){this._addonManager.loadAddon(this,e)}static get strings(){return{get promptLabel(){return id.get()},set promptLabel(e){id.set(e)},get tooMuchOutput(){return sd.get()},set tooMuchOutput(e){sd.set(e)}}}_verifyIntegers(...e){for(Tr of e)if(Tr===1/0||isNaN(Tr)||Tr%1!==0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...e){for(Tr of e)if(Tr&&(Tr===1/0||isNaN(Tr)||Tr%1!==0||Tr<0))throw new Error("This API only accepts positive integers")}};const Ow={background:"#1a1a1a",foreground:"#e0e0e0",cursor:"#e0e0e0",cursorAccent:"#1a1a1a",black:"#1a1a1a",red:"#ff5f56",green:"#27c93f",yellow:"#ffbd2e",blue:"#2ea6ff",magenta:"#d75fff",cyan:"#5fd7ff",white:"#e0e0e0",brightBlack:"#7f7f7f",brightRed:"#ff6e67",brightGreen:"#5af78e",brightYellow:"#f9f1a5",brightBlue:"#57c7ff",brightMagenta:"#ff6ac1",brightCyan:"#9aedfe",brightWhite:"#ffffff"},Sh=.6,Ra=8,ym=1,Mw='Menlo, Monaco, "Courier New", monospace';function Qf(e,s){const l=e/(s*Sh);return Math.max(Ra,Math.floor(l))}function Jf(e,s){const l=s*(ym+.2);return Math.max(1,Math.floor(e/l))}function Bw({containerRef:e,ptyId:s,ptyCols:l,send:h,subscribe:g,visible:m}){const w=Te.useRef(null),b=Te.useRef(l);return b.current=l,Te.useEffect(()=>{const C=e.current;if(!C)return;const S=C.clientWidth,M=C.clientHeight,N=Qf(S,l);N<=Ra&&S<l*Ra*Sh?C.style.overflowX="auto":C.style.overflowX="";const P=Jf(M,N),L=new Dw({cols:l,rows:P,cursorBlink:!0,disableStdin:!0,fontFamily:Mw,fontSize:N,lineHeight:ym,theme:Ow,scrollback:5e3});L.open(C),w.current=L;const X=()=>{const he=C.clientWidth,te=C.clientHeight,le=b.current,Oe=Qf(he,le),Re=Jf(te,Oe),Y=Oe<=Ra&&he<le*Ra*Sh;C.style.overflowX=Y?"auto":"",L.options.fontSize=Oe,L.resize(le,Math.max(1,Re))},pe=new ResizeObserver(X);pe.observe(C);const me=g(he=>{if(he.type==="pty_output"&&he.payload.pty_id===s)L.write(he.payload.data);else if(he.type==="pty_exit"&&he.payload.pty_id===s)L.write(`\r
\x1B[90m[Process exited with code ${he.payload.exit_code??"unknown"}]\x1B[0m\r
`);else if(he.type==="pty_resize"&&he.payload.pty_id===s){const te=he.payload.cols,le=he.payload.rows;b.current=te;const Oe=C.clientWidth,Re=C.clientHeight,Y=Qf(Oe,te),Ne=Jf(Re,Y),de=Y<=Ra&&Oe<te*Ra*Sh;C.style.overflowX=de?"auto":"",L.options.fontSize=Y,L.resize(te,Math.max(1,Math.min(le,Ne)))}});return requestAnimationFrame(()=>{L.refresh(0,L.rows-1),h({type:"pty_input",payload:{pty_id:s,data:"\r"}})}),()=>{me(),pe.disconnect(),C.style.overflowX="",L.dispose(),w.current=null}},[e,s,l,h,g]),Te.useEffect(()=>{const C=w.current;!m||!C||requestAnimationFrame(()=>{C.refresh(0,C.rows-1)})},[m]),{terminalRef:w}}const Iw=[{label:"Ctrl",modifier:"ctrl"},{label:"Enter",key:"\r"},{label:"Del",key:""},{label:"Esc",key:"\x1B"},{label:"Tab",key:"	"},{label:"",key:"\x1B[A"},{label:"",key:"\x1B[B"},{label:"",key:"\x1B[D"},{label:"",key:"\x1B[C"}],kw=[{label:"C-c",key:""},{label:"C-d",key:""},{label:"C-z",key:""},{label:"C-l",key:"\f"},{label:"S+Tab",key:"\x1B[Z"},{label:"/",key:"/"},{label:"@",key:"@"},{label:"!",key:"!"},{label:"|",key:"|"},{label:"~",key:"~"},{label:"y",key:"y"},{label:"n",key:"n"}],Lw=300;function Pw({ptyId:e,ptyCols:s,send:l,subscribe:h,visible:g}){const m=Te.useRef(null),w=Te.useRef(null),b=Te.useRef(null),[C,S]=Te.useState(null),[M,N]=Te.useState(""),[k,P]=Te.useState(!1),L=Te.useRef(0);Bw({containerRef:w,ptyId:e,ptyCols:s,send:l,subscribe:h,visible:g}),Te.useEffect(()=>{const Y=window.visualViewport,Ne=m.current;if(!Y||!Ne)return;const de=Y.height,Gt=()=>{if(Y.height<de*.9){const oe=Ne.getBoundingClientRect().top-Y.offsetTop,ae=Y.height-oe;Ne.style.height=`${Math.max(0,ae)}px`}else Ne.style.height=""};return Y.addEventListener("resize",Gt),Y.addEventListener("scroll",Gt),()=>{Y.removeEventListener("resize",Gt),Y.removeEventListener("scroll",Gt),Ne.style.height=""}},[]),Te.useEffect(()=>{if(!k)return;const Y=()=>P(!1);return document.addEventListener("pointerdown",Y),()=>document.removeEventListener("pointerdown",Y)},[k]);const X=Te.useCallback(Y=>{l({type:"pty_input",payload:{pty_id:e,data:Y}})},[l,e]),pe=Te.useCallback(Y=>{const Ne=Y.toUpperCase().charCodeAt(0)-64;return Ne>=0&&Ne<=31?String.fromCharCode(Ne):Y},[]),me=Te.useCallback(()=>C?(C.locked||S(null),!0):!1,[C]),he=Te.useCallback(()=>{let Y=M;Y.length>0&&me()&&(Y=pe(Y[0])+Y.slice(1)),X(Y),N("")},[M,me,X,pe]),te=Te.useCallback(()=>{const Y=Date.now(),Ne=Y-L.current;L.current=Y,S(de=>de===null?{type:"ctrl",locked:!1}:!de.locked&&Ne<Lw?{type:"ctrl",locked:!0}:null)},[]),le=Te.useCallback(Y=>{if("modifier"in Y){te();return}let Ne=Y.key;me()&&Ne.length===1&&(Ne=pe(Ne)),X(Ne),b.current?.focus()},[te,me,X,pe]),Oe=Te.useCallback(Y=>{X(Y),P(!1),b.current?.focus()},[X]),Re=C?C.locked?"bg-blue-600 text-white ring-2 ring-blue-400":"bg-blue-600 text-white":"bg-[#333] text-[#ccc] active:bg-[#555]";return ee.jsxs("div",{ref:m,className:"flex flex-col h-full",children:[ee.jsx("div",{ref:w,className:"flex-1 overflow-hidden bg-[#1a1a1a]",style:{minHeight:0}}),ee.jsxs("div",{className:"flex items-center px-2 py-1 bg-[#252525] border-t border-[#333] shrink-0",children:[ee.jsx("div",{className:"flex gap-1 overflow-x-auto flex-1",children:Iw.map(Y=>{const Ne="modifier"in Y;return ee.jsx("button",{type:"button",className:`px-2 py-1 text-xs rounded shrink-0 ${Ne?Re:"bg-[#333] text-[#ccc] active:bg-[#555]"}`,onPointerDown:de=>{de.preventDefault(),le(Y)},children:Y.label},Y.label)})}),ee.jsxs("div",{className:"ml-1 relative",children:[ee.jsx("button",{type:"button",className:`px-2 py-1 text-xs rounded shrink-0 ${k?"bg-blue-600 text-white":"bg-[#333] text-[#ccc] active:bg-[#555]"}`,onPointerDown:Y=>{Y.preventDefault(),Y.stopPropagation(),P(Ne=>!Ne)},children:""}),k&&ee.jsx("div",{className:"absolute bottom-full right-0 mb-1 bg-[#2d2d2d] border border-[#555] rounded p-1 grid grid-cols-4 gap-1 z-50",style:{minWidth:"180px"},onPointerDown:Y=>Y.stopPropagation(),children:kw.map(Y=>ee.jsx("button",{type:"button",className:"px-2 py-1.5 text-xs bg-[#333] text-[#ccc] rounded active:bg-[#555] whitespace-nowrap",onPointerDown:Ne=>{Ne.preventDefault(),Oe(Y.key)},children:Y.label},Y.label))})]})]}),ee.jsxs("div",{className:"flex gap-2 px-2 py-2 bg-[#1e1e1e] border-t border-[#333] shrink-0",children:[ee.jsx("textarea",{ref:b,value:M,onChange:Y=>N(Y.target.value),rows:1,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,className:"flex-1 px-3 py-2 bg-[#2d2d2d] text-[#e0e0e0] border border-[#444] rounded text-sm outline-none focus:border-blue-500 resize-none max-h-24 leading-5",placeholder:"..."}),ee.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white rounded text-sm active:bg-blue-700 shrink-0",onClick:he,children:""})]})]})}const Hw={connected:{label:"",color:"bg-green-500"},connecting:{label:"",color:"bg-yellow-500 animate-pulse"},authenticating:{label:"",color:"bg-yellow-500 animate-pulse"},disconnected:{label:"",color:"bg-red-500"}};function zw({status:e}){const s=Hw[e];return ee.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-neutral-800 text-sm",children:[ee.jsx("span",{className:`w-2 h-2 rounded-full ${s.color}`}),ee.jsx("span",{className:"text-neutral-300",children:s.label})]})}function Fw(){const e=Te.useRef(new Set),s=Te.useCallback(h=>{for(const g of e.current)g(h)},[]),l=Te.useCallback(h=>(e.current.add(h),()=>{e.current.delete(h)}),[]);return{dispatch:s,subscribe:l}}function Uw({subscribe:e,send:s}){const[l,h]=Te.useState(null),[g,m]=Te.useState(!1),w=Te.useRef(null),b=Te.useCallback(S=>{w.current=S,m(!0),s({type:"file_content_request",payload:{path:S}})},[s]);Te.useEffect(()=>e(S=>{S.type==="file_content_response"?S.payload.path===w.current&&(h({path:S.payload.path,original:S.payload.original,modified:S.payload.modified}),m(!1)):S.type==="file_change"&&S.payload.path===w.current&&s({type:"file_content_request",payload:{path:w.current}})}),[e,s]);const C=Te.useCallback(()=>{w.current=null,h(null),m(!1)},[]);return{content:l,loading:g,requestContent:b,clear:C}}function Vw({send:e,subscribe:s}){const[l,h]=Te.useState(null);Te.useEffect(()=>s(b=>{b.type==="git_stage_result"&&!b.payload.success&&h(b.payload.error??"Unknown error")}),[s]);const g=Te.useCallback(b=>{h(null),e({type:"git_stage",payload:{paths:b}})},[e]),m=Te.useCallback(b=>{h(null),e({type:"git_unstage",payload:{paths:b}})},[e]),w=Te.useCallback(()=>h(null),[]);return{stage:g,unstage:m,error:l,clearError:w}}function Ww({subscribe:e}){const[s,l]=Te.useState([]);Te.useEffect(()=>e(m=>{(m.type==="git_status_sync"||m.type==="git_stage_result"&&m.payload.success)&&l(m.payload.files)}),[e]);const h=s.filter(m=>m.index_status!=="none"),g=s.filter(m=>m.worktree_status!=="none"&&m.worktree_status!=="ignored");return{files:s,stagedFiles:h,changedFiles:g}}function Gw(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function S2(e,s=""){if(!Number.isSafeInteger(e)||e<0){const l=s&&`"${s}" `;throw new Error(`${l}expected integer >= 0, got ${e}`)}}function Ho(e,s,l=""){const h=Gw(e),g=e?.length,m=s!==void 0;if(!h||m&&g!==s){const w=l&&`"${l}" `,b=m?` of length ${s}`:"",C=h?`length=${g}`:`type=${typeof e}`;throw new Error(w+"expected Uint8Array"+b+", got "+C)}return e}function Xw(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");S2(e.outputLen),S2(e.blockLen)}function Dh(e,s=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(s&&e.finished)throw new Error("Hash#digest() has already been called")}function Yw(e,s){Ho(e,void 0,"digestInto() output");const l=s.outputLen;if(e.length<l)throw new Error('"digestInto() output" expected to be of length >='+l)}function Oh(...e){for(let s=0;s<e.length;s++)e[s].fill(0)}function $f(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Rr(e,s){return e<<32-s|e>>>s}const jw=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",qw=Array.from({length:256},(e,s)=>s.toString(16).padStart(2,"0"));function Kw(e){if(Ho(e),jw)return e.toHex();let s="";for(let l=0;l<e.length;l++)s+=qw[e[l]];return s}function Zw(e,s={}){const l=(g,m)=>e(m).update(g).digest(),h=e(void 0);return l.outputLen=h.outputLen,l.blockLen=h.blockLen,l.create=g=>e(g),Object.assign(l,s),Object.freeze(l)}const Qw=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});class wm{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(s,l){if(Xw(s),Ho(l,void 0,"key"),this.iHash=s.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const h=this.blockLen,g=new Uint8Array(h);g.set(l.length>h?s.create().update(l).digest():l);for(let m=0;m<g.length;m++)g[m]^=54;this.iHash.update(g),this.oHash=s.create();for(let m=0;m<g.length;m++)g[m]^=106;this.oHash.update(g),Oh(g)}update(s){return Dh(this),this.iHash.update(s),this}digestInto(s){Dh(this),Ho(s,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(s),this.oHash.update(s),this.oHash.digestInto(s),this.destroy()}digest(){const s=new Uint8Array(this.oHash.outputLen);return this.digestInto(s),s}_cloneInto(s){s||=Object.create(Object.getPrototypeOf(this),{});const{oHash:l,iHash:h,finished:g,destroyed:m,blockLen:w,outputLen:b}=this;return s=s,s.finished=g,s.destroyed=m,s.blockLen=w,s.outputLen=b,s.oHash=l._cloneInto(s.oHash),s.iHash=h._cloneInto(s.iHash),s}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const bm=(e,s,l)=>new wm(e,s).update(l).digest();bm.create=(e,s)=>new wm(e,s);function Jw(e,s,l){return e&s^~e&l}function $w(e,s,l){return e&s^e&l^s&l}class eb{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(s,l,h,g){this.blockLen=s,this.outputLen=l,this.padOffset=h,this.isLE=g,this.buffer=new Uint8Array(s),this.view=$f(this.buffer)}update(s){Dh(this),Ho(s);const{view:l,buffer:h,blockLen:g}=this,m=s.length;for(let w=0;w<m;){const b=Math.min(g-this.pos,m-w);if(b===g){const C=$f(s);for(;g<=m-w;w+=g)this.process(C,w);continue}h.set(s.subarray(w,w+b),this.pos),this.pos+=b,w+=b,this.pos===g&&(this.process(l,0),this.pos=0)}return this.length+=s.length,this.roundClean(),this}digestInto(s){Dh(this),Yw(s,this),this.finished=!0;const{buffer:l,view:h,blockLen:g,isLE:m}=this;let{pos:w}=this;l[w++]=128,Oh(this.buffer.subarray(w)),this.padOffset>g-w&&(this.process(h,0),w=0);for(let N=w;N<g;N++)l[N]=0;h.setBigUint64(g-8,BigInt(this.length*8),m),this.process(h,0);const b=$f(s),C=this.outputLen;if(C%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const S=C/4,M=this.get();if(S>M.length)throw new Error("_sha2: outputLen bigger than state");for(let N=0;N<S;N++)b.setUint32(4*N,M[N],m)}digest(){const{buffer:s,outputLen:l}=this;this.digestInto(s);const h=s.slice(0,l);return this.destroy(),h}_cloneInto(s){s||=new this.constructor,s.set(...this.get());const{blockLen:l,buffer:h,length:g,finished:m,destroyed:w,pos:b}=this;return s.destroyed=w,s.finished=m,s.length=g,s.pos=b,g%l&&s.buffer.set(h),s}clone(){return this._cloneInto()}}const Kn=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),tb=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Zn=new Uint32Array(64);class ib extends eb{constructor(s){super(64,s,8,!1)}get(){const{A:s,B:l,C:h,D:g,E:m,F:w,G:b,H:C}=this;return[s,l,h,g,m,w,b,C]}set(s,l,h,g,m,w,b,C){this.A=s|0,this.B=l|0,this.C=h|0,this.D=g|0,this.E=m|0,this.F=w|0,this.G=b|0,this.H=C|0}process(s,l){for(let N=0;N<16;N++,l+=4)Zn[N]=s.getUint32(l,!1);for(let N=16;N<64;N++){const k=Zn[N-15],P=Zn[N-2],L=Rr(k,7)^Rr(k,18)^k>>>3,X=Rr(P,17)^Rr(P,19)^P>>>10;Zn[N]=X+Zn[N-7]+L+Zn[N-16]|0}let{A:h,B:g,C:m,D:w,E:b,F:C,G:S,H:M}=this;for(let N=0;N<64;N++){const k=Rr(b,6)^Rr(b,11)^Rr(b,25),P=M+k+Jw(b,C,S)+tb[N]+Zn[N]|0,X=(Rr(h,2)^Rr(h,13)^Rr(h,22))+$w(h,g,m)|0;M=S,S=C,C=b,b=w+P|0,w=m,m=g,g=h,h=P+X|0}h=h+this.A|0,g=g+this.B|0,m=m+this.C|0,w=w+this.D|0,b=b+this.E|0,C=C+this.F|0,S=S+this.G|0,M=M+this.H|0,this.set(h,g,m,w,b,C,S,M)}roundClean(){Oh(Zn)}destroy(){this.set(0,0,0,0,0,0,0,0),Oh(this.buffer)}}class sb extends ib{A=Kn[0]|0;B=Kn[1]|0;C=Kn[2]|0;D=Kn[3]|0;E=Kn[4]|0;F=Kn[5]|0;G=Kn[6]|0;H=Kn[7]|0;constructor(){super(32)}}const rb=Zw(()=>new sb,Qw(1));function y2(e){return JSON.stringify(e)}function nb(e){return JSON.parse(e)}const ab=3e4,w2=1e3;function lb(e,s){const l=new TextEncoder;return Kw(bm(rb,l.encode(s),l.encode(e)))}function ob({url:e,token:s,onMessage:l,onStatusChange:h}){const[g,m]=Te.useState("disconnected"),w=Te.useRef(null),b=Te.useRef(w2),C=Te.useRef(null),S=Te.useRef(!0),M=Te.useRef(l),N=Te.useRef(h);M.current=l,N.current=h;const k=Te.useCallback(me=>{m(me),N.current?.(me)},[]),P=Te.useCallback(me=>{w.current?.readyState===WebSocket.OPEN&&w.current.send(y2(me))},[]),L=Te.useCallback(()=>{if(!S.current||!e||!s)return;w.current&&(w.current.close(),w.current=null),k("connecting");const me=new WebSocket(e);w.current=me,me.onopen=()=>{k("authenticating")},me.onmessage=async he=>{let te;try{te=nb(he.data)}catch(le){console.warn("Failed to parse WebSocket message:",le);return}if(te.type==="auth_challenge"){const le=await lb(te.payload.challenge,s);me.send(y2({type:"auth_response",payload:{hmac:le}}));return}if(te.type==="auth_result"){te.payload.success?(k("connected"),b.current=w2):me.close();return}M.current?.(te)},me.onclose=()=>{w.current=null,S.current&&(k("disconnected"),X())},me.onerror=()=>{}},[e,s,k]),X=Te.useCallback(()=>{if(!S.current)return;const me=b.current;b.current=Math.min(me*2,ab),C.current=setTimeout(()=>{L()},me)},[L]),pe=Te.useCallback(()=>{C.current&&(clearTimeout(C.current),C.current=null),w.current&&(w.current.close(),w.current=null),k("disconnected")},[k]);return Te.useEffect(()=>(S.current=!0,e&&s&&L(),()=>{S.current=!1,pe()}),[e,s,L,pe]),{status:g,send:P,disconnect:pe,reconnect:L}}const cb=[{id:"changes",label:"Changes",icon:ux},{id:"diff",label:"Diff",icon:cx},{id:"comments",label:"Comments",icon:ed},{id:"terminal",label:"Terminal",icon:wx}];function hb(){const[e,s]=Te.useState(null),[l,h]=Te.useState(null),[g,m]=Te.useState(null),[w,b]=Te.useState(80),[C,S]=Te.useState("changes"),[M,N]=Te.useState(!1),[k,P]=Te.useState([]),{dispatch:L,subscribe:X}=Fw(),pe=Te.useCallback(Me=>{Me.type==="pty_ready"&&(m(Me.payload.pty_id),b(Me.payload.cols)),Me.type==="comments_sync"&&P(Me.payload.comments.map(H=>({id:H.id,filePath:H.file_path,lineNumber:H.line_number,...H.end_line!=null&&{endLine:H.end_line},content:H.content,status:H.status,createdAt:H.created_at}))),L(Me)},[L]),{status:me,send:he,disconnect:te}=ob({url:e?.url??"",token:e?.token??"",onMessage:pe}),{stagedFiles:le,changedFiles:Oe}=Ww({subscribe:X}),{content:Re,loading:Y,requestContent:Ne}=Uw({subscribe:X,send:he}),{stage:de,unstage:Gt,error:je,clearError:oe}=Vw({send:he,subscribe:X}),ae=Te.useCallback((Me,H)=>{s({url:Me,token:H})},[]),Ee=Te.useCallback(()=>{te(),s(null),m(null)},[te]),U=Te.useCallback(Me=>{h(Me),Ne(Me)},[Ne]),W=Te.useCallback(()=>{S("diff")},[]),Z=Te.useCallback(()=>{he({type:"git_status_request",payload:{}})},[he]),ue=Te.useCallback((Me,H,re,ye)=>{he({type:"add_comment",payload:{file_path:Me,line_number:H,...ye!=null&&{end_line:ye},content:re}});const be={id:`pwa-${Date.now()}-${Math.random().toString(36).slice(2,7)}`,filePath:Me,lineNumber:H,...ye!=null&&{endLine:ye},content:re,status:"unsent",createdAt:Date.now()};P(Ve=>[...Ve,be])},[he]),Le=Te.useCallback(Me=>{const H=Ex(Me);H&&g!=null&&(he({type:"pty_input",payload:{pty_id:g,data:`${H}
`}}),P(re=>re.map(ye=>Me.some(be=>be.id===ye.id)?{...ye,status:"sent"}:ye)))},[he,g]);return e?ee.jsxs("div",{className:"flex flex-col h-dvh bg-neutral-950 text-neutral-100",children:[ee.jsxs("header",{className:"flex items-center justify-between px-3 py-1.5 border-b border-neutral-800 bg-neutral-900 shrink-0",children:[ee.jsx("h1",{className:"text-sm font-semibold",children:"Releash Remote"}),ee.jsxs("div",{className:"flex items-center gap-2",children:[ee.jsx(zw,{status:me}),ee.jsx("button",{type:"button",onClick:Ee,className:"text-xs px-2 py-0.5 rounded bg-neutral-800 hover:bg-neutral-700 transition-colors",children:""})]})]}),ee.jsxs("main",{className:"flex-1 overflow-hidden relative",children:[ee.jsx("div",{className:"absolute inset-0",style:{display:C==="changes"?void 0:"none"},children:ee.jsx(yv,{stagedFiles:le,changedFiles:Oe,selectedPath:l,onSelectFile:U,onStage:de,onUnstage:Gt,error:je,onClearError:oe,onNavigateToDiff:W,onRefresh:Z})}),ee.jsxs("div",{className:"absolute inset-0 flex flex-col",style:{display:C==="diff"?void 0:"none"},children:[l&&ee.jsx("div",{className:"flex items-center px-3 py-1 border-b border-neutral-800 bg-neutral-900 shrink-0",children:ee.jsx("span",{className:"text-xs text-neutral-500 truncate",children:l})}),ee.jsx("div",{className:"flex-1",style:{minHeight:0},children:me==="connected"?ee.jsx(pv,{path:l,original:Re?.original??"",modified:Re?.modified??"",loading:Y,onAddComment:ue}):ee.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500",children:ee.jsx("p",{children:"..."})})})]}),ee.jsx("div",{className:"absolute inset-0",style:{display:C==="comments"?void 0:"none"},children:ee.jsx(iv,{comments:k,onSendToTerminal:Le})}),ee.jsx("div",{className:"absolute inset-0",style:{visibility:C==="terminal"?"visible":"hidden",pointerEvents:C==="terminal"?"auto":"none"},children:M&&me==="connected"&&g!=null?ee.jsx(Pw,{ptyId:g,ptyCols:w,send:he,subscribe:X,visible:C==="terminal"}):C==="terminal"&&me==="connected"&&g==null?ee.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500",children:ee.jsx("p",{children:""})}):null})]}),ee.jsx("nav",{className:"flex shrink-0 border-t border-neutral-800 bg-neutral-900",children:cb.map(Me=>{const H=Me.icon,re=C===Me.id;return ee.jsxs("button",{type:"button",className:`flex-1 flex flex-col items-center justify-center h-12 gap-0.5 transition-colors ${re?"text-blue-400 border-t-2 border-blue-400":"text-neutral-500"}`,onClick:()=>{S(Me.id),Me.id==="terminal"&&N(!0)},children:[ee.jsx(H,{className:"h-4 w-4"}),ee.jsx("span",{className:"text-[10px]",children:Me.label})]},Me.id)})})]}):ee.jsx(tv,{onConnect:ae})}Jp.createRoot(document.getElementById("root")).render(ee.jsx(Gp.StrictMode,{children:ee.jsx(hb,{})}));
